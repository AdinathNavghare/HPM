package payroll.Core;

import java.io.File;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Date;
import java.util.List;
import java.util.Locale;
import java.util.Properties;

import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFCellStyle;
import org.apache.poi.hssf.usermodel.HSSFFont;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.hssf.util.HSSFColor;
import org.jfree.ui.Align;

import payroll.DAO.BankStmntHandler;
import payroll.DAO.CodeMasterHandler;
import payroll.DAO.ConnectionManager;
import payroll.DAO.EmpOffHandler;
import payroll.DAO.GradeHandler;
import payroll.DAO.LookupHandler;
import payroll.DAO.TranHandler;
import payroll.Model.BankStmntBean;
import payroll.Model.ExtraFieldBean;
import payroll.Model.PFExcelBean;
import payroll.Model.RepoartBean;
import payroll.Model.TranBean;
import payroll.Model.TransactionBean;

import com.ibm.icu.math.BigDecimal;
import com.ibm.icu.text.NumberFormat;
import com.ibm.icu.util.Calendar;
import com.lowagie.text.Chunk;
import com.lowagie.text.Document;
import com.lowagie.text.DocumentException;
import com.lowagie.text.Element;
import com.lowagie.text.ExceptionConverter;
import com.lowagie.text.Font;
import com.lowagie.text.Image;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.Phrase;
import com.lowagie.text.Rectangle;
import com.lowagie.text.pdf.ColumnText;
import com.lowagie.text.pdf.GrayColor;
import com.lowagie.text.pdf.PdfPCell;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfPageEventHelper;
import com.lowagie.text.pdf.PdfTemplate;
import com.lowagie.text.pdf.PdfWriter;


/**
 * @author Disha
 * 
 */
public class UtilityDAO {
	static String lable1 = "";
	static String label2 = "";

	public class Footer extends PdfPageEventHelper {

		protected Phrase footer;
		protected Phrase header;
		private final Font footerFont = new Font(Font.TIMES_ROMAN, 8, Font.BOLD);
		PdfTemplate total;

		@Override
		public void onOpenDocument(PdfWriter writer, Document document) {
			total = writer.getDirectContent().createTemplate(20, 30);
		}

		public Footer(String lbl) {
			UtilityDAO.lable1 = lbl;
		}

		@Override
		public void onEndPage(PdfWriter writer, Document document) {

			PdfPTable table = new PdfPTable(3);
			DateFormat df = new SimpleDateFormat("HH:mm:ss");

			Calendar calobj = Calendar.getInstance();
			// System.out.println(df.format(calobj.getTime()));
			try {
				table.setWidths(new int[] { 24, 24, 2 });
				table.setTotalWidth(880);
				table.setLockedWidth(true);
				table.getDefaultCell().setFixedHeight(30);
				table.getDefaultCell().setBorder(Rectangle.BOTTOM);
				table.getDefaultCell().setHorizontalAlignment(
						Element.ALIGN_MIDDLE);
				table.addCell(new Phrase(
						("Page No.  " + writer.getPageNumber()), footerFont));
				table.addCell(new Phrase(lable1 + " ( "
						+ ReportDAO.getSysDate() + " ) Time : "
						+ df.format(calobj.getTime()) + " ", footerFont));

				PdfPCell cell = new PdfPCell(Image.getInstance(total));
				cell.setBorder(0);
				cell.setHorizontalAlignment(Align.CENTER);
				cell.setFixedHeight(72f);
				table.addCell(cell);
				table.writeSelectedRows(0, -1, 5, 25, writer.getDirectContent());

			} catch (DocumentException de) {
				throw new ExceptionConverter(de);
			}

		}

		@Override
		public void onCloseDocument(PdfWriter writer, Document document) {
			ColumnText.showTextAligned(total, Element.ALIGN_BOTTOM, new Phrase(
					String.valueOf(writer.getPageNumber() - 1), footerFont),
					15, 20, 0);
		}

	}

	public class Footer1 extends PdfPageEventHelper {

		protected Phrase footer;
		protected Phrase header;
		PdfTemplate total;

		private final Font footerFont = new Font(Font.TIMES_ROMAN, 20,
				Font.BOLD);

		@Override
		public void onOpenDocument(PdfWriter writer, Document document) {
			total = writer.getDirectContent().createTemplate(40, 40);
		}

		public Footer1(String lbl) {
			UtilityDAO.lable1 = lbl;
		}

		@Override
		public void onEndPage(PdfWriter writer, Document document) {

			PdfPTable table = new PdfPTable(3);
			DateFormat df = new SimpleDateFormat("HH:mm:ss");

			Calendar calobj = Calendar.getInstance();

			try {
				table.setWidths(new int[] { 24, 24, 2 });
				table.setTotalWidth(2380);
				table.setLockedWidth(true);
				table.getDefaultCell().setFixedHeight(30);
				table.getDefaultCell().setBorder(Rectangle.BOTTOM);
				table.getDefaultCell().setHorizontalAlignment(
						Element.ALIGN_RIGHT);

				table.addCell(new Phrase(lable1 + "( " + ReportDAO.getSysDate()
						+ " )  :" + df.format(calobj.getTime()) + " ",
						footerFont));

				table.addCell(new Phrase(String.format("Page %d of  ",
						writer.getPageNumber()), footerFont));
				PdfPCell cell = new PdfPCell(Image.getInstance(total));
				cell.setBorder(0);
				// cell.setFixedHeight(72f);
				table.addCell(cell);
				table.writeSelectedRows(0, -1, 10, 45,
						writer.getDirectContent());

			} catch (DocumentException de) {
				throw new ExceptionConverter(de);
			}

		}

		@Override
		public void onCloseDocument(PdfWriter writer, Document document) {
			ColumnText.showTextAligned(total, Element.ALIGN_CENTER, new Phrase(
					String.valueOf(writer.getPageNumber() - 1), footerFont),
					15, 20, 0);
		}

	}

	public static int dateDiff(String dtDiffIn, java.sql.Date frmDate,
			java.sql.Date toDt) {

		int diff = 0;

		if (dtDiffIn.equalsIgnoreCase("D")) {
			long d1 = frmDate.getTime();
			long d2 = toDt.getTime();

			long difference = d2 - d1;
			diff = (int) (difference / (1000 * 60 * 60 * 24));
		}
		return diff;
	}

	public static void PrintBlankLine(RepoartBean repBean) {
		String str1 = "       |                                          |";
		int aCtr = 0;
		for (int i = aCtr + 1; i <= 12; i++) {
			str1 = str1 + ReportDAO.addSpaces("", 14) + "|";
		}
		ReportDAO.println(str1, 10, 1, false, "BANK", repBean);
	}

	public static String GetBranch(int brncd, RepoartBean repBean) {
		Statement st;
		String result = "";
		try {
			st = repBean.getCn().createStatement();
			ResultSet rs = st.executeQuery("SELECT * FROM BRANCH WHERE BRCD = "
					+ brncd);
			if (rs.next()) {
				result = rs.getString("BRNAME");
			} else
				result = "not found";
			repBean.getCn().close();

		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return result;

	}

	/*
	 * public static void Branch_Footer(){ bCode = bCode + 1; int i = 0; for(i =
	 * 100;i <= 200;i++){ bInc[bCode][i] = Inc[i]; } for(i = 200;i <= 300;i++){
	 * bDed[bCode][i] = ded[i]; } for(i = 1;i <= 4;i++){ BtotBngd[bCode][i] =
	 * TotBngd[i]; } PrintFootLines(Inc, ded, TotBngd, "TOTAL->" + "|" +
	 * "Grand Total For Current Month :"+ReportDAO.addSpaces("", 10) + "|");
	 * PrintFootLines(PInc, PDed, PTotBNGD, "        " + "|" +
	 * "Grand Total For Previous Month :"+ReportDAO.addSpaces("", 9) + "|");
	 * for(i = 100;i <= 200;i++){ Inc[i] = Math.abs(Inc[i] - PInc[i]);
	 * 
	 * } for(i = 200;i <= 300;i++){ ded[i] = Math.abs(ded[i] - PDed[i]);
	 * 
	 * } for(i = 1;i <= 4;i++){ TotBngd[i] = Math.abs(TotBngd[i] - PTotBNGD[i]);
	 * 
	 * } PrintFootLines(Inc, ded, TotBngd, "        " + "|" +
	 * "Variance Betwn Previous & Current Month:"+ReportDAO.addSpaces("", 2) +
	 * "|"); for(i = 100;i <= 200;i++){ Inc[i] = 0; PInc[i] = 0;
	 * 
	 * } for(i = 200;i <= 300;i++){ ded[i] = 0; PDed[i] = 0;
	 * 
	 * } for(i = 1;i <= 4;i++){ TotBngd[i] = 0; PTotBNGD[i] = 0;
	 * 
	 * } }
	 */

	public static void PrintFootLines(int INC1[], int DED1[], int TOTBNGD1[],
			String s1, RepoartBean repBean) {
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		String Arr1 = "";
		String Arr2 = "";
		repBean.setPayrep(true);
		int i = 0;
		for (i = 1; i <= 24; i++) {
			if (i <= 12) {
				if (repBean.getIcode(i) != 0) {
					Str1 = Str1
							+ FixStr(
									trans(INC1[repBean.getIcode(i)],
											"999,99,999.99", "", false, false),
									14, 3) + "|";
				} else {
					Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
				}
			} else {
				if (repBean.getIcode(i) != 0) {
					Str2 = Str2
							+ FixStr(
									trans(INC1[repBean.getIcode(i)],
											"999,99,999.99", "", false, false),
									14, 3) + "|";
				} else {
					Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
				}
			}

			if (i <= 12) {
				if (repBean.getEcode(i) != 0) {
					Str3 = Str3
							+ FixStr(
									trans(DED1[repBean.getEcode(i)],
											"999,99,999.99", "", false, false),
									14, 3) + "|";
				} else {
					Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
				}
			} else {
				if (repBean.getEcode(i) != 0) {
					Str4 = Str4
							+ FixStr(
									trans(DED1[repBean.getEcode(i)],
											"999,99,999.99", "", false, false),
									14, 3) + "|";
				} else {
					Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
				}
			}
		}
		Str1 = s1 + Str1;
		Str2 = ReportDAO.addSpaces("", 7) + "|" + ReportDAO.addSpaces("", 42)
				+ "|" + Str2;
		Str3 = ReportDAO.addSpaces("", 7)
				+ "|"
				+ FixStr(trans(TOTBNGD1[1], "99,99,999.99", "", false, false),
						14, 3) + ReportDAO.addSpaces("", 28) + "|" + Str3;
		Str4 = FixStr(trans(TOTBNGD1[3], "99,99,999.99", "", false, false), 14,
				3)
				+ FixStr(trans(TOTBNGD1[4], "99,99,999.99", "", false, false),
						14, 3)
				+ FixStr(trans(TOTBNGD1[2], "99,99,999.99", "", false, false),
						14, 3) + "|" + Str4;
		Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|";
		Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|";
		ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
		PrintBlankLine(repBean);

		ReportDAO.println(Str2, 10, 1, false, "BANK", repBean);
		ReportDAO.println(Str3, 10, 1, false, "BANK", repBean);
		PrintBlankLine(repBean);
		// ReportDAO.println(trans(repBean.getNoEmp(), "9999", "", false,
		// false), 10, 0, false, "BANK",repBean);
		ReportDAO.println(FixStr(String.valueOf(repBean.getNoEmp()), 7, 1)
				+ "|" + Str4, 10, 1, false, "BANK", repBean);

		PrintBlankLine(repBean);
		PrintBlankLine(repBean);

	}

	public static String stringOfSize(int size, char ch) {
		final char[] array = new char[size];
		Arrays.fill(array, ch);
		return new String(array);
	}

	public static boolean compareDate(String date1, String date2) {
		boolean flag = false;
		try {

			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");

			Date Date1 = sdf.parse(date1);
			Date Date2 = sdf.parse(date2);
			if (Date1.compareTo(Date2) > 0) {
				flag = true;
			} else if (Date1.compareTo(Date2) < 0) {
				flag = false;
			} else if (Date1.compareTo(Date2) == 0) {
				flag = true;
			}
		} catch (ParseException ex) {
			ex.printStackTrace();
		}
		return flag;
	}

	public static String trans(int p_num, String p_pic, String p_lzc,
			boolean p_sgn, boolean blankif0) {
		NumberFormat format = com.ibm.icu.text.NumberFormat
				.getCurrencyInstance(new Locale("en", "in"));
		String result = p_num<0?(String.valueOf(p_num)+format.format(0).substring(5)):format.format(p_num).substring(4);
		int Reslength = result.length();
		int p_picLength = p_pic.length();
		if (Reslength < p_picLength) {
			result = ReportDAO.addSpaces("", p_picLength - Reslength) + result;
		}
		return result;
	}

	public static void encashPDF(String rdt, String filepath, String prjname,
			String projcode, int flag, String foryear) {
		System.out.println("in encashPDF...");

		RepoartBean repBean = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");

		try {
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			// Document doc = new Document(new Rectangle(900,700));
			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);

			// PdfWriter writer =PdfWriter.getInstance(doc, new
			// FileOutputStream(filepath));
			doc.open();
			doc.setPageSize(PageSize.A4);
			Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
					new GrayColor(0.75f));
			// ColumnText.showTextAligned(writer.getDirectContentUnder(),
			// Element.ALIGN_CENTER, new Phrase("HARSH CONSTRUCTION",FONT),
			// 297.5f, 421, 45);

			Phrase title = new Phrase("Harsh Construction Pvt.Ltd.", new Font(
					FONT.TIMES_ROMAN, 15, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			doc.add(para);
			para = new Paragraph(
					new Phrase(
							"1,Sanskruti,Murkute Lane No.2,New Pandit Colony, Gangapur Road, Nashik - 42200",
							new Font(Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					"Tel : 0253-2317143,Fax : 0253-2317621", new Font(
							Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Email : careers@hcpl.co.in	",
					new Font(Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Encashment Report  for " + prjname
					+ ", " + foryear, new Font(Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			PdfPTable tab = new PdfPTable(9);
			tab.getDefaultCell().setHorizontalAlignment(Element.ALIGN_LEFT);
			tab.getDefaultCell().setVerticalAlignment(Element.ALIGN_MIDDLE);
			tab.setWidthPercentage(new float[] { 5, 6, 38, 10, 10, 10, 10, 10,
					10 }, new Rectangle(100, 100));
			tab.setSpacingBefore(5);
			// tab.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(new Phrase("SR NO", new Font(Font.TIMES_ROMAN, 8,
					FONT.BOLD)));
			tab.addCell(new Phrase("EMPCODE", new Font(Font.TIMES_ROMAN, 8,
					FONT.BOLD)));

			tab.addCell(new Phrase("EMPLOYEE NAME", new Font(Font.TIMES_ROMAN,
					8, FONT.BOLD)));
			tab.addCell(new Phrase("ON HO ", new Font(Font.TIMES_ROMAN, 8,
					FONT.BOLD)));
			tab.addCell(new Phrase("LEAVE ON HO ", new Font(Font.TIMES_ROMAN,
					8, FONT.BOLD)));
			tab.addCell(new Phrase("ON SITE ", new Font(Font.TIMES_ROMAN, 8,
					FONT.BOLD)));
			tab.addCell(new Phrase("LEAVE ON SITE ", new Font(Font.TIMES_ROMAN,
					8, FONT.BOLD)));
			tab.addCell(new Phrase("INPUT_AMOUNT", new Font(Font.TIMES_ROMAN,
					8, FONT.BOLD)));
			tab.addCell(new Phrase("ENCASH_AMOUNT", new Font(Font.TIMES_ROMAN,
					8, FONT.BOLD)));

			tab.setHeaderRows(1);
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();
			if (flag == 1) {
				EmpSql = "select y1.*,rtrim(y2.FNAME)+'		'+rtrim(y2.MNAME)+'		'+rtrim(y2 .LNAME) as NAME from encashmentonleave y1 ,EMPMAST y2 where  y1.Empno=y2.EMPNO  and  y1.Empno  in (select  e.EMPNO from EMPMAST e,EMPTRAN e1 where e.empno=e1.empno and e.STATUS='A' and e1.STATUS =1 and e1.PRJ_CODE='"
						+ projcode
						+ "') and y2.STATUS='A' and y1.Year='"
						+ foryear
						+ "-06-01"
						+ "'  order by convert(int,y1.EmpCode)";
			} else {

				if (projcode.equalsIgnoreCase("Left")) {
					System.out.println("left report query...........");
					EmpSql = "select rtrim(e.FNAME)+'		'+rtrim(e.MNAME)+'		'+rtrim(e.LNAME) as NAME,e1.EmpCode,e1.OnHO,e1.LeaveOnHO,e1.OnOsite,e1.LeaveOnOS,e1.basic,e1.encashment from EMPMAST e,EncashmentOnLeave e1 where e.EMPNO=e1.Empno and e.STATUS='N' and e1.Year='"
							+ foryear
							+ "-06-01"
							+ "' order by convert(int,e.EMPCODE)";

				} else {
					System.out.println("Active report query...........");
					EmpSql = "select rtrim(e.FNAME)+'		'+rtrim(e.MNAME)+'		'+rtrim(e.LNAME) as NAME,e1.EmpCode,e1.OnHO,e1.LeaveOnHO,e1.OnOsite,e1.LeaveOnOS,e1.basic,e1.encashment from EMPMAST e,EncashmentOnLeave e1 where e.EMPNO=e1.Empno and e.STATUS='A' and e1.Year='"
							+ foryear
							+ "-06-01"
							+ "' order by convert(int,e.EMPCODE)";

				}
			}

			Statement st;
			// System.out.println(table_name+"----"+EmpSql);
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);
			if (!emp.next()) {
				System.out.println("No Any Record Found");
				return;
			}

			int count = 1, eno = 0;
			float encash1 = 0.0f, inptamt = 0.0f;
			emp.previous();

			while (emp.next()) {

				System.out.println("empname....." + emp.getString("NAME"));

				tab.addCell(new Phrase("" + count++, new Font(Font.TIMES_ROMAN,
						8)));

				tab.addCell(new Phrase(emp.getString("EmpCode"), new Font(
						Font.TIMES_ROMAN, 8)));
				// eno=Integer.parseInt(emp.getString("EMPNO"));

				tab.addCell(new Phrase(
						"" + emp.getString("NAME").toUpperCase(), new Font(
								Font.TIMES_ROMAN, 8)));
				/*
				 * int [] noofdays=ofh1.getNoOfDays(eno); float day=0.0f;
				 * 
				 * double hday= noofdays[0]; float day1=(float)(hday*19/365);
				 * int hodayleav=Math.round(day1);
				 * 
				 * 
				 * System.out.println("dayssssss111..."+hodayleav); double day2=
				 * noofdays[1]; float day11=(float)(day2*30/365); int
				 * osdayleav=Math.round(day11);
				 */

				tab.addCell(new Phrase("" + emp.getInt("OnHO") + " D",
						new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("" + emp.getInt("LeaveOnHO") + " D",
						new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("" + emp.getInt("OnOsite") + " D",
						new Font(Font.TIMES_ROMAN, 8)));
				tab.addCell(new Phrase("" + emp.getInt("LeaveOnOS") + " D",
						new Font(Font.TIMES_ROMAN, 8)));
				/*
				 * float basic=tbn1.getBasic(eno); inptamt+=basic;
				 * 
				 * BigDecimal finalbasic=new BigDecimal(basic);
				 * finalbasic=finalbasic.setScale(2,BigDecimal.ROUND_HALF_EVEN);
				 */

				tab.addCell(new Phrase("" + emp.getString("Basic"), new Font(
						Font.TIMES_ROMAN, 8)));
				inptamt += Float.parseFloat(emp.getString("Basic"));
				encash1 += Float.parseFloat(emp.getString("Encashment"));
				/*
				 * float encash=ofh1.getEncashmentAmnt1(eno,basic,noofdays);
				 * encash1+=encash; BigDecimal finalencash=new
				 * BigDecimal(encash);
				 * finalencash=finalencash.setScale(2,BigDecimal
				 * .ROUND_HALF_EVEN);
				 */

				tab.addCell(new Phrase("" + emp.getString("Encashment"),
						new Font(Font.TIMES_ROMAN, 8)));

			}
			BigDecimal totalinputamt = new BigDecimal(inptamt);
			totalinputamt = totalinputamt.setScale(2,
					BigDecimal.ROUND_HALF_EVEN);

			BigDecimal totalencashment = new BigDecimal(encash1);
			totalencashment = totalencashment.setScale(2,
					BigDecimal.ROUND_HALF_EVEN);

			PdfPTable tab1 = new PdfPTable(6);

			tab1.setWidthPercentage(new float[] { 31, 38, 10, 10, 10, 10 },
					new Rectangle(100, 100));
			tab1.setSpacingBefore(0);

			PdfPCell tot = new PdfPCell(new Phrase("Total Employee : "
					+ (count - 1), new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			tot.setHorizontalAlignment(PdfPCell.ALIGN_CENTER);
			/* tot.setVerticalAlignment(Element.ALIGN_CENTER); */
			// tot.setVerticalAlignment(PdfPCell.ALIGN_TOP);
			tot.setColspan(3);
			tot.setLeading(1f, 1.5f);

			tab1.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER);
			tab1.getDefaultCell().setVerticalAlignment(Element.ALIGN_BOTTOM);
			tab1.addCell(tot);
			tab.setHorizontalAlignment(Element.ALIGN_CENTER);

			tab1.addCell(new Phrase("Total", new Font(Font.TIMES_ROMAN, 8,
					FONT.BOLD)));
			tab1.addCell(new Phrase("" + totalinputamt, new Font(
					Font.TIMES_ROMAN, 8, FONT.BOLD)));

			tab1.addCell(new Phrase("" + totalencashment, new Font(
					Font.TIMES_ROMAN, 8, FONT.BOLD)));

			doc.add(tab);
			doc.add(tab1);
			doc.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void EncashExcel(String rdt, String filepath,
			String projcode, String img, String prjname, int flag,
			String foryear) {
		int eno = 0;
		float inptamt = 0.0f, encash1 = 0.0f, basic = 0.0f;
		TranHandler tbn1 = new TranHandler();
		EmpOffHandler ofh1 = new EmpOffHandler();
		Properties prop = new Properties();
		ResultSet rs = null;
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant properties Manager " + e);
		}

		try {
			System.out.println("Into Generalised_EmpListDAO.....");
			RepoartBean repBean = new RepoartBean();

			LookupHandler lkh = new LookupHandler();
			Connection con = null;
			System.out.println(filepath);
			FileOutputStream out1 = new FileOutputStream(new File(filepath));
			HSSFWorkbook hwb = new HSSFWorkbook();
			HSSFSheet sheet = hwb.createSheet("EncashExcel");

			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");

			sheet.setColumnWidth((short) 0, (short) 3000);
			sheet.setColumnWidth((short) 1, (short) 3000);
			sheet.setColumnWidth((short) 2, (short) 11000);
			sheet.setColumnWidth((short) 3, (short) 5000);
			sheet.setColumnWidth((short) 4, (short) 5000);
			sheet.setColumnWidth((short) 5, (short) 6000);
			sheet.setColumnWidth((short) 6, (short) 6000);
			sheet.setColumnWidth((short) 7, (short) 6000);
			sheet.setColumnWidth((short) 8, (short) 6000);

			HSSFCellStyle my_style = hwb.createCellStyle();
			HSSFCellStyle my_style1 = hwb.createCellStyle();

			HSSFFont my_font = hwb.createFont();
			my_font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
			my_style.setFont(my_font);

			HSSFCellStyle mystl = hwb.createCellStyle();
			mystl.setAlignment(HSSFCellStyle.ALIGN_CENTER);
			HSSFCellStyle mystl1 = hwb.createCellStyle();
			mystl1.setAlignment(HSSFCellStyle.ALIGN_LEFT);

			HSSFRow rowtitle = sheet.createRow((short) 0);
			HSSFCell cell = rowtitle.createCell((short) 4);

			cell.setCellValue(prop.getProperty("companyName"));
			cell.setCellStyle(my_style1);
			HSSFRow rowtitle1 = sheet.createRow((short) 1);
			HSSFCell cell1 = rowtitle1.createCell((short) 3);
			cell1.setCellValue(prop.getProperty("addressForReport"));
			cell1.setCellStyle(my_style);
			HSSFRow rowtitle2 = sheet.createRow((short) 2);
			HSSFCell cell2 = rowtitle2.createCell((short) 4);
			cell2.setCellValue(prop.getProperty("contactForReport"));
			cell2.setCellStyle(my_style1);
			HSSFRow rowtitle31 = sheet.createRow((short) 3);
			cell2 = rowtitle31.createCell((short) 4);
			cell2.setCellValue(prop.getProperty("mailForReport"));
			cell2.setCellStyle(my_style1);
			HSSFRow rowtitle3 = sheet.createRow((short) 4);
			cell2 = rowtitle3.createCell((short) 4);
			cell2.setCellValue("       Report For: " + prjname + ", " + foryear);
			cell2.setCellStyle(my_style1);
			HSSFRow rowtitle4 = sheet.createRow((short) 5);
			rowtitle4.createCell((short) 0).setCellValue("");
			HSSFRow rowtitle5 = sheet.createRow((short) 6);
			rowtitle5.createCell((short) 0).setCellValue("");

			HSSFFont blueFont = hwb.createFont();
			blueFont.setColor(HSSFColor.BLUE.index);

			HSSFCellStyle style = hwb.createCellStyle();
			// style.setFont(blueFont);
			style.setFillForegroundColor(HSSFColor.BLUE.index);

			HSSFRow head = sheet.createRow((short) 7);
			head.createCell((short) 0).setCellValue("");
			HSSFRow heading = sheet.createRow((short) 8);
			HSSFCell cell3 = heading.createCell((short) 0);

			cell3.setCellValue("");
			cell3.setCellStyle(my_style1);
			HSSFRow rowhead = sheet.createRow((short) 9);
			sheet.createFreezePane(0, 10, 0, 10);

			my_style1.setAlignment((short) 2);
			my_font.setBoldweight(HSSFFont.BOLDWEIGHT_BOLD);
			my_style1.setFont(my_font);

			cell3 = rowhead.createCell((short) 0);
			cell3.setCellValue("SR.NO");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 1);
			cell3.setCellValue("EMPCODE");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 2);
			cell3.setCellValue("EMPLOYEE NAME");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 3);
			cell3.setCellValue("ON HO");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 4);
			cell3.setCellValue("LEAVE ON HO");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 5);
			cell3.setCellValue("ON SITE");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 6);
			cell3.setCellValue("LEAVE ON SITE");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 7);
			cell3.setCellValue("INPUT_AMOUNT");
			cell3.setCellStyle(my_style1);
			cell3 = rowhead.createCell((short) 8);
			cell3.setCellValue("ENCASHMENT_AMOUNT");
			cell3.setCellStyle(my_style1);

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			int i = 12;
			int count = 1;
			String Name = "";
			if (flag == 1) {
				rs = st.executeQuery("select y1.*,(y2.FNAME),(y2.MNAME),(y2 .LNAME)  from encashmentonleave y1 ,EMPMAST y2 where  y1.Empno=y2.EMPNO  and  y1.Empno  in (select  e.EMPNO from EMPMAST e,EMPTRAN e1 where e.empno=e1.empno and e.STATUS='A' and e1.STATUS =1 and e1.PRJ_CODE='"
						+ projcode
						+ "') and y2.STATUS='A' and y1.Year='"
						+ foryear + "' order by convert(int,y1.EmpCode)");
			} else {

				if (projcode.equalsIgnoreCase("Left")) {
					rs = st.executeQuery("select (e.FNAME),(e.MNAME),(e.LNAME),e1.EmpCode,e1.OnHO,e1.LeaveOnHO,e1.OnOsite,e1.LeaveOnOS,e1.basic,e1.encashment from EMPMAST e,EncashmentOnLeave e1 where e.EMPNO=e1.Empno and e.STATUS='N' and e1.Year='"
							+ foryear
							+ "-06-01"
							+ "' order by convert(int,e.EMPCODE)");
				} else {
					rs = st.executeQuery("select (e.FNAME),(e.MNAME),(e.LNAME),e1.EmpCode,e1.OnHO,e1.LeaveOnHO,e1.OnOsite,e1.LeaveOnOS,e1.basic,e1.encashment from EMPMAST e,EncashmentOnLeave e1 where e.EMPNO=e1.Empno and e.STATUS='a' and e1.Year='"
							+ foryear
							+ "-06-01"
							+ "' order by convert(int,e.EMPCODE)");

				}
			}
			while (rs.next()) {
				HSSFRow row = sheet.createRow((short) i++);
				Name = rs.getString("FNAME") + " " + rs.getString("MNAME")
						+ " " + rs.getString("LNAME");
				cell = row.createCell((short) 0);
				cell.setCellValue("" + (count++));
				cell.setCellStyle(mystl);
				cell = row.createCell((short) 1);
				cell.setCellValue(" " + rs.getString("EmpCode"));
				cell.setCellStyle(mystl);
				cell = row.createCell((short) 2);
				cell.setCellValue(" 	" + Name.toUpperCase());
				cell.setCellStyle(mystl1);
				// eno=Integer.parseInt(rs.getString("EMPNO"));

				/*
				 * System.out.println("in xxxxxxxx   "+eno); int []
				 * noofdays=ofh1.getNoOfDays(eno);/*make int array[]
				 * 
				 * double hday= noofdays[0]; float day1=(float)(hday*19/365);
				 * int hodayleav=Math.round(day1);
				 * 
				 * 
				 * System.out.println("dayssssss111..."+hodayleav); double day2=
				 * noofdays[1]; float day11=(float)(day2*30/365); int
				 * osdayleav=Math.round(day11);
				 * 
				 * basic=tbn1.getBasic(eno); inptamt+=basic; BigDecimal
				 * finalbasic=new BigDecimal(basic);
				 * finalbasic=finalbasic.setScale(2,BigDecimal.ROUND_HALF_EVEN);
				 * float encash=ofh1.getEncashmentAmnt1(eno,basic,noofdays);
				 * encash1+=encash;
				 * 
				 * BigDecimal finalencash=new BigDecimal(encash);
				 * finalencash=finalencash
				 * .setScale(2,BigDecimal.ROUND_HALF_EVEN);
				 */

				cell = row.createCell((short) 3);
				cell.setCellValue("" + rs.getInt("OnHO") + "D");
				cell.setCellStyle(mystl);

				cell = row.createCell((short) 4);
				cell.setCellValue("" + rs.getInt("LeaveOnHO") + "D");
				cell.setCellStyle(mystl);

				cell = row.createCell((short) 5);
				cell.setCellValue("" + rs.getInt("OnOsite") + "D");
				cell.setCellStyle(mystl);

				cell = row.createCell((short) 6);
				cell.setCellValue("" + rs.getInt("LeaveOnOS") + "D");
				cell.setCellStyle(mystl);

				cell = row.createCell((short) 7);
				cell.setCellValue("" + rs.getString("Basic"));
				cell.setCellStyle(mystl);
				inptamt += Float.parseFloat(rs.getString("Basic"));
				cell = row.createCell((short) 8);
				cell.setCellValue("" + rs.getString("Encashment"));
				cell.setCellStyle(mystl);
				encash1 += Float.parseFloat(rs.getString("Encashment"));

			}
			BigDecimal totalinputamt = new BigDecimal(inptamt);
			totalinputamt = totalinputamt.setScale(2,
					BigDecimal.ROUND_HALF_EVEN);

			BigDecimal totalencashamt = new BigDecimal(encash1);
			totalencashamt = totalencashamt.setScale(2,
					BigDecimal.ROUND_HALF_EVEN);

			HSSFRow row = sheet.createRow((short) i + 1);

			cell = row.createCell((short) 0);
			cell.setCellValue("Total Employees : " + (count - 1));
			cell.setCellStyle(my_style);
			cell = row.createCell((short) 6);
			cell.setCellValue("Total : ");
			cell.setCellStyle(my_style1);
			cell = row.createCell((short) 7);
			cell.setCellValue("" + totalinputamt);
			cell.setCellStyle(my_style1);
			cell = row.createCell((short) 8);
			cell.setCellValue(" " + totalencashamt);
			cell.setCellStyle(my_style1);

			DateFormat df = new SimpleDateFormat("dd/MM/yy HH:mm:ss");

			Calendar calobj = Calendar.getInstance();

			HSSFRow row1 = sheet.createRow((short) i + 3);
			// row1.createCell((short) 0).setCellValue(" ");
			// row1 = sheet.createRow((short) i+3);

			cell = row1.createCell((short) 2);
			cell.setCellValue("Report Date And Time"
					+ df.format(calobj.getTime()));
			cell.setCellStyle(my_style1);
			/*
			 * cell=row1.createCell((short) 5); cell.setCellValue(" ");
			 */
			hwb.write(out1);
			out1.close();
			st.close();
			con.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static String FixStr(String str11, int ctr, int lrc) {
		// System.out.println("Before :->"+str11);
		String result = "";
		String s1 = "";
		str11 = str11.trim();
		if (str11.length() > ctr) {
			result = str11.substring(0, ctr); // confirm From Mr P H Patil for
												// Mid Functuon
			return result;
		}
		str11 = str11.trim();
		switch (lrc) {
		case 1:
			s1 = str11 + ReportDAO.addSpaces("", ctr - str11.length());
			break;
		case 2:
			s1 = ReportDAO.addSpaces("", (ctr - str11.length()) / 2) + str11
					+ ReportDAO.addSpaces("", (ctr - str11.length()) / 2);
			break;
		case 3:
			s1 = ReportDAO.addSpaces("", ctr - str11.length()) + str11;
			break;
		default:
			break;
		}
		if (s1.length() < ctr) {
			s1 = s1 + ReportDAO.addSpaces("", ctr - s1.length());
		} else {
			s1 = s1.substring(0, ctr);// confirm From Mr P H Patil for Mid
										// Functuon
		}
		result = s1;
		// System.out.println("After :->"+result);
		return result;
	}

	public static String ltrim(String s) {
		int i = 0;
		while (i < s.length() && Character.isWhitespace(s.charAt(i))) {
			i++;
		}
		return s.substring(i);
	}

	public static String rtrim(String s) {
		int i = s.length() - 1;
		while (i >= 0 && Character.isWhitespace(s.charAt(i))) {
			i--;
		}
		return s.substring(0, i + 1);
	}

	public static void PaySummary(int s, RepoartBean repBean) {
		String str1 = "";
		String str2 = "";
		String str3 = "";
		String str4 = "";

		String Arr1 = "";
		String Arr2 = "";
		String s1 = "       " + "|"
				+ FixStr(" Branch Total For : " + GetBranch(s, repBean), 42, 1)
				+ "|";
		int i;
		repBean.setPayrep(true);
		for (i = 1; i <= 24; i++) {
			if (i <= 12) {
				if (repBean.getIcode(i) != 0) {
					str1 = str1
							+ FixStr(
									trans(repBean.getbInc(s,
											repBean.getIcode(i)),
											"999,99,999.99", "", false, false),
									14, 3) + "|"; // Chk bt ph patil sir
				} else
					str1 = str1 + ReportDAO.addSpaces("", 14) + "|";
			} else if (repBean.getIcode(i) != 0) {
				str2 = str2
						+ FixStr(
								trans(repBean.getbInc(s, repBean.getIcode(i)),
										"999,99,999.99", "", false, false), 14,
								3) + "|"; // Chk bt ph patil sir
			} else
				str2 = str2 + ReportDAO.addSpaces("", 14) + "|";

			if (i <= 12) {
				if (repBean.getEcode(i) != 0) {
					str3 = str3
							+ FixStr(
									trans(repBean.getbDed(s,
											repBean.getEcode(i)),
											"999,99,999.99", "", false, false),
									14, 3) + "|"; // Chk bt ph patil sir
				} else
					str3 = str3 + ReportDAO.addSpaces("", 14) + "|";
			} else if (repBean.getEcode(i) != 0) {
				str4 = str4
						+ FixStr(
								trans(repBean.getbDed(s, repBean.getEcode(i)),
										"999,99,999.99", "", false, false), 14,
								3) + "|"; // Chk bt ph patil sir
			} else
				str4 = str4 + ReportDAO.addSpaces("", 14) + "|";
		}

		str1 = s1 + str1;
		str2 = ReportDAO.addSpaces("", 7) + "|" + ReportDAO.addSpaces("", 42)
				+ "|" + str2;
		str3 = ReportDAO.addSpaces("", 7)
				+ "|"
				+ FixStr(
						trans(repBean.getBtotBngd(s, 1), "999,99,999.99", "",
								false, false), 14, 3) + "|" + str3;
		str4 = "|"
				+ ReportDAO.addSpaces("", 7)
				+ "|"
				+ FixStr(
						trans(repBean.getBtotBngd(s, 3), "999,99,999.99", "",
								false, false), 14, 3)
				+ ReportDAO.addSpaces("", 7)
				+ "|"
				+ FixStr(
						trans(repBean.getBtotBngd(s, 4), "999,99,999.99", "",
								false, false), 14, 3)
				+ ReportDAO.addSpaces("", 7)
				+ "|"
				+ FixStr(
						trans(repBean.getBtotBngd(s, 2), "999,99,999.99", "",
								false, false), 14, 3) + "|" + str4;
		Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|";
		Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|";
		ReportDAO.println(str1, 0, 1, false, "BANK", repBean);
		PrintBlankLine(repBean);
		ReportDAO.println(str2, 0, 1, false, "BANK", repBean);
		ReportDAO.println(str3, 0, 1, false, "BANK", repBean);
		PrintBlankLine(repBean);
		ReportDAO.println(str4, 0, 1, false, "BANK", repBean);
		PrintBlankLine(repBean);

	}

	// payslip printing
	public static void PaySlipPDF(String dt, String empList, String filepath, String imgpath) {
		RepoartBean repBean = new RepoartBean();
		Statement mst = null;
		System.out.println("i am in PaySlipPDF....ak");
		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		try {
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();
			LookupHandler lkp = new LookupHandler();
			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs = null;
			ResultSet mrs = null;
			ResultSet wrs = null;

			String EmpSql = "";

			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;

			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			nodays = Calculate.getDays(dt);
			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MMM-yyyy");
			Date date = sdf.parse(dt);
			String slrydt = dt;

			String dt1 = "";

			Statement st3 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,t.BANK_NAME FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO"
					+ " AND emp.EMPNO in ("
					+ empList
					+ ") AND t.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 "
					+ " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(dt) + "') ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);

			System.out.println("---------------" + EmpSql);

			if (!rs3.next()) {
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Payslip date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while (rs3.next()) {
				// akshay nikam == for selecting glwf or mlwf according to
				// employee
				Statement st08 = Cn.createStatement();
				ResultSet rs008 = null;
				String prjn = "select PRJ_SRNO,Site_State from EMPTRAN emp "
						+ "left join HPM.dbo.Project_Sites prj on emp.PRJ_SRNO=Prj.SITE_ID where "
						+ "SRNO=(SELECT MAX(E2.SRNO)FROM [hpmpayroll].[dbo].EMPTRAN E2 WHERE E2.EMPNO ="
						+ rs3.getInt("empno") + ")and EMPNO="
						+ rs3.getInt("empno") + "";
				System.out.println("int qu  " + prjn);//

				int prj = 0;
				String state = null;//
				rs008 = st08.executeQuery(prjn);
				while (rs008.next()) {
					prj = rs008.getInt("PRJ_SRNO");
					state = rs008.getString("Site_State");

					System.out.println("siteid  " + prj);
					System.out.println("statestate  " + state);//
					System.out.println("empno  " + rs3.getInt("empno"));
				}
				st08.close();

				// AKSHAY NIKAM end here
				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;

				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				// nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;

				paiddays = nodays;

				String WorkMssage = "";
				String BirthdayMessage = "";
				String MarrdMessage = "";
				String mssgdate = "";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 10, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10);

				Paragraph parab = new Paragraph(title);

				Paragraph param = new Paragraph(title);

				Paragraph paraw = new Paragraph(title);

				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Salary Slip For "
						+ slrydt.substring(3), new Font(Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				sdf = new SimpleDateFormat("yyyy-MM-dd");
				dt = sdf.format(date);

				final Calendar date1 = Calendar.getInstance();
				date1.setTime(date);
				date1.add(Calendar.MONTH, 1);

				String bday = sdf.format(date1.getTime());
				// System.out.println("here is the bday"+bday);

				date1.add(Calendar.DATE, 1);

				String qery = "SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"
						+ bday + "') and e.empno=" + rs3.getInt("empno");
				mst = Cn.createStatement();

				brs = mst.executeQuery(qery);
				while (brs.next()) {

					BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
					BirthdayMessage = "***" + BirthdayMessage + "( "
							+ sdf1.format(brs.getDate("dob")) + " ) !!!";
				}
				brs.close();

				/*
				 * mrs = mst.executeQuery(
				 * "SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"
				 * +dt+"') and e.empno="+rs3.getInt("empno")); while(mrs.next())
				 * { MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
				 * MarrdMessage
				 * ="***"+MarrdMessage+"( "+sdf1.format(mrs.getDate("MARRIEDDT"
				 * ))+" )  !!!"; } mrs.close();
				 * 
				 * wrs = mst.executeQuery(
				 * "SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"
				 * +dt+"') and e.empno="+rs3.getInt("empno")); while(wrs.next())
				 * { WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
				 * WorkMssage
				 * ="***"+WorkMssage+"( "+sdf1.format(wrs.getDate("doj"
				 * ))+" ) !!!";
				 * 
				 * } wrs.close();
				 */

				parab = new Paragraph(new Phrase("" + BirthdayMessage,
						new Font(Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase("" + MarrdMessage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase("" + WorkMssage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);

				// System.out.println("BMssg=> "+BirthdayMessage+" Wmssg=> "+WorkMssage+" Mmssg=> "+MarrdMessage);

				Rectangle rec = new Rectangle(100, 100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(40);
				tab.setWidthPercentage(new float[] { 100 }, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[] { 100 }, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[] { 50, 50 },
						new Rectangle(100, 100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(4);

				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);

				PdfPTable tab5 = new PdfPTable(2);
				PdfPTable tab6 = new PdfPTable(2);

				PdfPTable tab7 = new PdfPTable(2);
				PdfPTable tab8 = new PdfPTable(2);
				PdfPTable tab9 = new PdfPTable(2);
				PdfPTable tab10 = new PdfPTable(2);

				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();

				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				// PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				boolean isRecord = false;
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="
						+ rs3.getInt("EMPNO") + " and TRNDT  LIKE '"
						+ dt.substring(0, 7) + "%' order by trncd");

				if (rs.next()) {
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1 = rs.getString("TRNDT");
					// rs1 =
					// st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
					rs1 = st1
							.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="
									+ rs3.getInt("EMPNO")
									+ " and TRNDT  ='"
									+ dt1
									+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

				} else {
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="
							+ rs3.getInt("EMPNO")
							+ " and TRNDT  LIKE '"
							+ dt.substring(0, 7) + "%' order by trncd");
					if (rs.next()) {
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1 = rs.getString("TRNDT");
						// rs1 =
						// st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
						rs1 = st1
								.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="
										+ rs3.getInt("EMPNO")
										+ " and TRNDT  ='"
										+ dt1
										+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					} else {
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="
								+ rs3.getInt("EMPNO")
								+ " and TRNDT  LIKE '"
								+ dt.substring(0, 7) + "%' order by trncd");
						if (rs.next()) {
							frmTable = "PAYTRAN_STAGE";
							isRecord = true;
							dt1 = rs.getString("TRNDT");
							rs1 = st1
									.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="
											+ rs3.getInt("EMPNO")
											+ " and TRNDT  ='"
											+ dt1
											+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						}
					}

				}

				ArrayList<TranBean> trblist = new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3
						.getString("EMPNO"));

				if (isRecord) {
					while (rs1.next()) {

						tb = new TranBean();
						tb = th.getPaySlipTran(rs3.getInt("EMPNO"),
								rs1.getInt(1), 0, dt1, frmTable);
						trblist.add(tb);

					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					// System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7 = statement.executeQuery("select "
							+ Calculate.getDays(monthDate)
							+ " - DAY(DOJ)+1 from empmast where empno ="
							+ rs3.getInt("EMPNO") + " and doj between cast('"
							+ ReportDAO.BOM(monthDate)
							+ "' as DATE) and cast('"
							+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						paiddays = rs7.getFloat(1);
					}
					// === For Date of Leaving in same Month
					rs7 = statement
							.executeQuery("select "
									+ paiddays
									+ " - (DAY(cast('"
									+ ReportDAO.EOM(monthDate)
									+ "' as DATE))- DAY(DOL)) from empmast where empno ="
									+ rs3.getInt("EMPNO")
									+ " and dol between cast('"
									+ ReportDAO.BOM(monthDate)
									+ "' as DATE) and cast('"
									+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						/*
						 * int day = rs7.getInt(1); paiddays = day;
						 */
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[] { 65, 35 },
							new Rectangle(100, 100));
					PdfPCell subcell4 = new PdfPCell(new Phrase(
							"Salary & Allowances ", new Font(Font.TIMES_ROMAN,
									10, Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);

					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);

					/*
					 * PdfPCell subcellin1 = new PdfPCell(new
					 * Phrase("Arrears ",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * tab5.addCell(subcellin1);
					 * 
					 * 
					 * PdfPCell subcellin2 = new PdfPCell(new
					 * Phrase("Total ",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * tab5.addCell(subcellin2);
					 */

					tab6.setWidthPercentage(new float[] { 65, 35 },
							new Rectangle(100, 100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase(
							"Deductions ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					// tab6.setWidthPercentage(new float[]{55,15,15,15},new
					// Rectangle(100,100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase(
							"Amount.(Rs) ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					/*
					 * //tab6.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcellout3 = new
					 * PdfPCell(new Phrase("Arrears ",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * tab6.addCell(subcellout3);
					 * 
					 * //tab6.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcellout4 = new
					 * PdfPCell(new Phrase("Total ",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * tab6.addCell(subcellout4);
					 */

					for (TranBean trbn1 : trblist) {
						if (trbn1.getTRNCD() < 199 && trbn1.getTRNCD() != 127) {

							// tab5.setWidthPercentage(new float[]{65,35},new
							// Rectangle(100,100));
							PdfPCell subcells = new PdfPCell(new Phrase(""
									+ CodeMasterHandler.getCDesc(trbn1
											.getTRNCD()), new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);
							// tab5.setWidthPercentage(new
							// float[]{55,15,15,15},new Rectangle(100,100));
							PdfPCell subcells1 = new PdfPCell(
									new Phrase(""
											+ UtilityDAO.trans(
													((int) trbn1.getCAL_AMT()),
													"999,99,999.99", "", false,
													false), new Font(
											Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells1
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							/*
							 * // tab5.setWidthPercentage(new
							 * float[]{55,15,15,15},new Rectangle(100,100));
							 * PdfPCell subcells2 = new PdfPCell(new
							 * Phrase(""+trbn1.getARR_AMT(),new
							 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							 * subcells2
							 * .setHorizontalAlignment(Element.ALIGN_RIGHT);
							 * tab5.addCell(subcells2);
							 * 
							 * // tab5.setWidthPercentage(new
							 * float[]{55,15,15,15},new Rectangle(100,100));
							 * PdfPCell subcells3 = new PdfPCell(new
							 * Phrase(""+trbn1.getNET_AMT(),new
							 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
							 * subcells3
							 * .setHorizontalAlignment(Element.ALIGN_RIGHT);
							 * tab5.addCell(subcells3);
							 */
							total_amntIN = total_amntIN + trbn1.getCAL_AMT();
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();

						}

						else if (300 > trbn1.getTRNCD()
								&& trbn1.getTRNCD() > 200) {
							// / akshay nikam== = for displaying deserve trncd
							// accrdng to employee in paysliip...
							if (state.equalsIgnoreCase("goa")
									&& trbn1.getTRNCD() == 238) {
								tab6.setWidthPercentage(new float[] { 65, 35 },
										new Rectangle(100, 100));
								PdfPCell subcells = new PdfPCell(new Phrase(""
										+ CodeMasterHandler.getCDesc(trbn1
												.getTRNCD()), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));
								subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
								tab6.addCell(subcells);

								// tab6.setWidthPercentage(new
								// float[]{55,15,15,15},new Rectangle(100,100));
								PdfPCell subcells1 = new PdfPCell(new Phrase(""
										+ UtilityDAO.trans(
												(int) trbn1.getNET_AMT(),
												"999,99,999.99", "", false,
												false), new Font(
										Font.TIMES_ROMAN, 10, Font.NORMAL)));
								subcells1
										.setHorizontalAlignment(Element.ALIGN_RIGHT);
								tab6.addCell(subcells1);

								/*
								 * // tab6.setWidthPercentage(new
								 * float[]{55,15,15,15},new Rectangle(100,100));
								 * PdfPCell subcells2 = new PdfPCell(new
								 * Phrase(""+trbn1.getARR_AMT(),new
								 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
								 * subcells2
								 * .setHorizontalAlignment(Element.ALIGN_RIGHT);
								 * tab6.addCell(subcells2);
								 * 
								 * // tab6.setWidthPercentage(new
								 * float[]{55,15,15,15},new Rectangle(100,100));
								 * PdfPCell subcells3 = new PdfPCell(new
								 * Phrase(""+trbn1.getNET_AMT(),new
								 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
								 * subcells3
								 * .setHorizontalAlignment(Element.ALIGN_RIGHT);
								 * tab6.addCell(subcells3);
								 */
							} else {
								if (!state.equalsIgnoreCase("goa")
										&& trbn1.getTRNCD() == 211) {
									tab6.setWidthPercentage(new float[] { 65,
											35 }, new Rectangle(100, 100));
									PdfPCell subcells = new PdfPCell(
											new Phrase(
													""
															+ CodeMasterHandler
																	.getCDesc(trbn1
																			.getTRNCD()),
													new Font(Font.TIMES_ROMAN,
															10, Font.BOLD)));
									subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
									tab6.addCell(subcells);

									// tab6.setWidthPercentage(new
									// float[]{55,15,15,15},new
									// Rectangle(100,100));
									PdfPCell subcells1 = new PdfPCell(
											new Phrase(
													""
															+ UtilityDAO.trans(
																	(int) trbn1
																			.getNET_AMT(),
																	"999,99,999.99",
																	"", false,
																	false),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells1
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells1);

									/*
									 * // tab6.setWidthPercentage(new
									 * float[]{55,15,15,15},new
									 * Rectangle(100,100)); PdfPCell subcells2 =
									 * new PdfPCell(new
									 * Phrase(""+trbn1.getARR_AMT(),new
									 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
									 * subcells2
									 * .setHorizontalAlignment(Element.
									 * ALIGN_RIGHT ); tab6.addCell(subcells2);
									 * 
									 * // tab6.setWidthPercentage(new
									 * float[]{55,15,15,15},new
									 * Rectangle(100,100)); PdfPCell subcells3 =
									 * new PdfPCell(new
									 * Phrase(""+trbn1.getNET_AMT(),new
									 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
									 * subcells3
									 * .setHorizontalAlignment(Element.
									 * ALIGN_RIGHT ); tab6.addCell(subcells3);
									 */
								} else if (300 > trbn1.getTRNCD()
										&& trbn1.getTRNCD() > 200
										&& trbn1.getTRNCD() != 238
										&& trbn1.getTRNCD() != 211) {
									tab6.setWidthPercentage(new float[] { 65,
											35 }, new Rectangle(100, 100));
									PdfPCell subcells = new PdfPCell(
											new Phrase(
													""
															+ CodeMasterHandler
																	.getCDesc(trbn1
																			.getTRNCD()),
													new Font(Font.TIMES_ROMAN,
															10, Font.BOLD)));
									subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
									tab6.addCell(subcells);

									// tab6.setWidthPercentage(new
									// float[]{55,15,15,15},new
									// Rectangle(100,100));
									PdfPCell subcells1 = new PdfPCell(
											new Phrase(
													""
															+ UtilityDAO.trans(
																	(int) trbn1
																			.getNET_AMT(),
																	"999,99,999.99",
																	"", false,
																	false),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells1
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells1);

									/*
									 * // tab6.setWidthPercentage(new
									 * float[]{55,15,15,15},new
									 * Rectangle(100,100)); PdfPCell subcells2 =
									 * new PdfPCell(new
									 * Phrase(""+trbn1.getARR_AMT(),new
									 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
									 * subcells2
									 * .setHorizontalAlignment(Element.
									 * ALIGN_RIGHT ); tab6.addCell(subcells2);
									 * 
									 * // tab6.setWidthPercentage(new
									 * float[]{55,15,15,15},new
									 * Rectangle(100,100)); PdfPCell subcells3 =
									 * new PdfPCell(new
									 * Phrase(""+trbn1.getNET_AMT(),new
									 * Font(Font.TIMES_ROMAN,10,Font.NORMAL)));
									 * subcells3
									 * .setHorizontalAlignment(Element.
									 * ALIGN_RIGHT ); tab6.addCell(subcells3);
									 */
								}
							}
							// // akshay ==end here
							total_amntDED = total_amntDED + trbn1.getCAL_AMT();
							total_arrDED = total_arrDED + trbn1.getARR_AMT();
							total_totDED = total_totDED + trbn1.getNET_AMT();
						}
						if (trbn1.getTRNCD() == 301) {
							absent = trbn1.getCAL_AMT();
							paiddays = paiddays - absent;
						}
						if (trbn1.getTRNCD() == 199) {
							gross = trbn1.getINP_AMT();
						}

						monthygross = (int) gross
								- Math.round(((gross / nodays) * absent));

					}
					tab7.setWidthPercentage(new float[] { 65, 35 },
							new Rectangle(100, 100));
					PdfPCell subcelltin = new PdfPCell(new Phrase(
							"Gross Salary", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					// tab7.setWidthPercentage(new float[]{55,15,15,15},new
					// Rectangle(100,100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""
							+ UtilityDAO.trans((int) total_totIN,
									"999,99,999.99", "", false, false),
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					/*
					 * //tab7.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcelltin2 = new
					 * PdfPCell(new Phrase(""+total_arrIN,new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * tab7.addCell(subcelltin2);
					 * 
					 * //tab7.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcelltin3 = new
					 * PdfPCell(new Phrase(""+total_totIN,new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * tab7.addCell(subcelltin3);
					 */

					tab8.setWidthPercentage(new float[] { 65, 35 },
							new Rectangle(100, 100));
					PdfPCell subcelltded = new PdfPCell(new Phrase(
							"TOTAL DEDUCTION", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					// tab8.setWidthPercentage(new float[]{55,15,15,15},new
					// Rectangle(100,100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""
							+ UtilityDAO.trans((int) total_totDED,
									"999,99,999.99", "", false, false),
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					/*
					 * //tab8.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcelltded2 = new
					 * PdfPCell(new Phrase(""+total_arrDED,new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * tab8.addCell(subcelltded2);
					 * 
					 * //tab8.setWidthPercentage(new float[]{55,15,15,15},new
					 * Rectangle(100,100)); PdfPCell subcelltded3 = new
					 * PdfPCell(new Phrase(""+total_totDED,new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * tab8.addCell(subcelltded3);
					 */
					tab9.setWidthPercentage(new float[] { 65, 35 },
							new Rectangle(100, 100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					// tab9.setWidthPercentage(new float[]{55,15,15,15},new
					// Rectangle(100,100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""
							+ UtilityDAO.trans(
									(int)(total_totIN - total_totDED),
									"999,99,999.99", "", false, false),
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					// tab9.setWidthPercentage(new float[]{55,15,15,15},new
					// Rectangle(100,100));
					/*
					 * PdfPCell subcellts2 = new PdfPCell(new Phrase("",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * subcellts2.setColspan(2);
					 * subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * tab9.addCell(subcellts2);
					 */

					tab10.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcellt = new PdfPCell(
							new Phrase(
									"Net Salary In Words :- "
											+ originalNumToLetter
													.getInWords(""
															+ (int) (total_totIN - total_totDED)),
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);

					tab1.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell = new PdfPCell(new Phrase(
							"Employee Number ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEMPCODE(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEmpname(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DEPT",
									trbn.getDept()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DESIG",
									trbn.getDesg()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ lkp.getLKP_Desc("BANK", rs3.getInt("BANK_NAME")),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("A/No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getAccno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					/*
					 * subcell = new PdfPCell(new Phrase("PF No ", new Font(
					 * Font.TIMES_ROMAN, 10, Font.BOLD)));
					 * subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					 * tab1.addCell(subcell);
					 * 
					 * subcell = new PdfPCell(new Phrase("" + trbn.getPfno(),
					 * new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					 * subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					 * tab1.addCell(subcell);
					 */

					subcell = new PdfPCell(new Phrase("Uan Number ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(
							new Phrase(""
									+ ((trbn.getUanno() == "" || trbn
											.getUanno() == null) ? "" : trbn
											.getUanno()), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getPanno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					// String
					// lesql="SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' AND LEAVECD=1 AND EMPNO="+rs3.getInt("EMPNO")+" GROUP BY LEAVECD";
					String lesql = "SELECT SUM(DAYS) AS TOTDED,LEAVECD  FROM LEAVETRAN WHERE TODT BETWEEN '"
							+ ReportDAO.BOM(slrydt)
							+ "' AND '"
							+ ReportDAO.EOM(slrydt)
							+ "' AND LEAVECD=1 AND EMPNO="
							+ rs3.getInt("EMPNO")
							+ " "
							+ " AND STATUS='SANCTION' AND TRNTYPE='D' GROUP BY LEAVECD  ";
					cl = 0;
					pl = 0;
					sl = 0;
					ml = 0;
					ResultSet rsleave = st1.executeQuery(lesql);
					while (rsleave.next()) {
						String leave = new LookupHandler().getLKP_Desc("LEAVE",
								rsleave.getInt(2));

						if (leave.equalsIgnoreCase("PL")) {
							pl = rsleave.getFloat("TOTDED");
						}
						/*
						 * if(leave.equalsIgnoreCase("CL")){ cl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("SL")){ sl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("ML")){ ml =
						 * rsleave.getInt(1); }
						 */
					}
					/*
					 * cl=0; pl=0; sl=0; ml=0; int otherlv=0; st1 =
					 * Cn.createStatement(); rs1= st1.executeQuery(
					 * "SELECT DISTINCT(LEAVECD) FROM LEAVEBAL WHERE EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					 * while(rs1.next()) { if(rs1.getInt(1) == 4){ st =
					 * Cn.createStatement(); rs=st.executeQuery(
					 * "SELECT SUM(DAYS) FROM LEAVETRAN WHERE TRNDATE BETWEEN '"
					 * +
					 * ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' "
					 * +
					 * "AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="+rs3.getInt("EMPNO"
					 * )+" AND STATUS='SANCTION' GROUP BY LEAVECD");
					 * if(rs.next()){ otherlv = rs.getInt(1); } rs.close();
					 * st.close(); } st = Cn.createStatement();
					 * rs=st.executeQuery
					 * ("SELECT TOP 1 * FROM LEAVEBAL WHERE BALDT<='"
					 * +ReportDAO.EOM
					 * (slrydt)+"' AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY BALDT DESC");
					 * if(rs.next()) { String leave = new
					 * LookupHandler().getLKP_Desc("LEAVE",rs.getInt(3));
					 * 
					 * if(leave.equalsIgnoreCase("PL")){ pl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("CL")){
					 * cl = rs.getFloat("BAL"); }
					 * if(leave.equalsIgnoreCase("SL")){ sl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("ML")){
					 * ml = rs.getFloat("BAL"); } } rs.close(); st.close(); }
					 * rs1.close(); st1.close();
					 */

					tab2.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell2 = new PdfPCell(new Phrase(
							"Date Of Joining ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + trbn.getDOJ(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Leave ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Gross Amount / Rate (Day)", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""
							+ UtilityDAO.trans((int) (gross), "999,99,999.99",
									"", false, false), new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Sick Leave", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + sl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Unpaid Absent",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + absent, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + pl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Monthly Gross Payable Amount", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(""
							+ UtilityDAO.trans((int) (monthygross),
									"999,99,999.99", "", false, false),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Casual Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + cl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Days", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + paiddays, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Maternity Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + ml, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);

					// for loop for getting label and values for payslip income
					// for loop for getting label and values for payslip
					// Deduction

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);

					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);

					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);

					// tab.
					// doc.add(Chunk.NEWLINE);
					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					if (!(BirthdayMessage.equals(""))
							|| BirthdayMessage != null) {
						doc.add(parab);
					}
					if (!(MarrdMessage.equals("")) || MarrdMessage != null) {
						doc.add(param);
					}

					if (!(WorkMssage.equals("")) || WorkMssage != null) {
						doc.add(paraw);
					}

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					/*
					 * para = new Paragraph(new Phrase(
					 * "For                                                                           "
					 * ,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * para.setAlignment(Element.ALIGN_RIGHT);
					 * para.setSpacingBefore(40); doc.add(para); para = new
					 * Paragraph(new Phrase(""+prop.getProperty("companyName")+
					 * "                              ",new
					 * Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * para.setAlignment(Element.ALIGN_RIGHT);
					 * para.setSpacingAfter(0); doc.add(para);
					 */

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					/*
					 * para = new Paragraph(new
					 * Phrase(""+prop.getProperty("hrmanager"
					 * )+"                                             ",new
					 * Font(Font.TIMES_ROMAN,10)));
					 * para.setAlignment(Element.ALIGN_RIGHT);
					 * para.setSpacingAfter(0); doc.add(para); para = new
					 * Paragraph(new Phrase(
					 * "Authorised Signture & Stamp                              "
					 * ,new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
					 * para.setAlignment(Element.ALIGN_RIGHT);
					 * para.setSpacingAfter(0); doc.add(para);
					 */
					para = new Paragraph(
							new Phrase(
									"Note:This is computer"
											+ " generated statement, hence Signature not required"));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(0);
					doc.add(para);

				}
				doc.newPage();
			}
			doc.close();

			Cn.close();

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void PaySlipPDFOld(String dt, String empList,
			String filepath, String imgpath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		Statement mst = null;
		try {
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();
			LookupHandler lkp = new LookupHandler();
			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs = null;
			ResultSet mrs = null;
			ResultSet wrs = null;

			String EmpSql = "";

			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;

			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			nodays = Calculate.getDays(dt);
			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MMM-yyyy");
			Date date = sdf.parse(dt);
			String slrydt = dt;

			String dt1 = "";

			Statement st3 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,t.BANK_NAME FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO"
					+ " AND emp.EMPNO in ("
					+ empList
					+ ") AND t.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 "
					+ " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(dt) + "') ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);
			// System.out.println("---------------"+EmpSql);

			if (!rs3.next()) {
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Payslip date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while (rs3.next()) {
				// akshay nikam == for selecting glwf or mlwf according to
				// employee
				Statement st08 = Cn.createStatement();
				ResultSet rs008 = null;
				String prjn = "select PRJ_SRNO,Site_State from EMPTRAN emp "
						+ "left join HPM.dbo.Project_Sites prj on emp.PRJ_SRNO=Prj.SITE_ID where "
						+ "SRNO=(SELECT MAX(E2.SRNO)FROM [DesaiPayroll].[dbo].EMPTRAN E2 WHERE E2.EMPNO ="
						+ rs3.getInt("empno") + ")and EMPNO="
						+ rs3.getInt("empno") + "";
				System.out.println("int qu  " + prjn);//

				int prj = 0;
				String state = null;//
				rs008 = st08.executeQuery(prjn);
				while (rs008.next()) {
					prj = rs008.getInt("PRJ_SRNO");
					state = rs008.getString("Site_State");

					System.out.println("siteid  " + prj);
					System.out.println("statestate  " + state);//
					System.out.println("empno  " + rs3.getInt("empno"));
				}
				st08.close();

				// AKSHAY NIKAM end here
				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;

				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				// nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;

				paiddays = nodays;

				String WorkMssage = "";
				String BirthdayMessage = "";
				String MarrdMessage = "";
				String mssgdate = "";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 10, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10);

				Paragraph parab = new Paragraph(title);

				Paragraph param = new Paragraph(title);

				Paragraph paraw = new Paragraph(title);

				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Salary Slip For "
						+ slrydt.substring(3), new Font(Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				sdf = new SimpleDateFormat("yyyy-MM-dd");
				dt = sdf.format(date);
				String qery = "SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"
						+ dt + "') and e.empno=" + rs3.getInt("empno");
				mst = Cn.createStatement();

				brs = mst.executeQuery(qery);
				while (brs.next()) {

					BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
					BirthdayMessage = "***" + BirthdayMessage + "( "
							+ sdf1.format(brs.getDate("dob")) + " ) !!!";
				}
				brs.close();

				mrs = mst
						.executeQuery("SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"
								+ dt + "') and e.empno=" + rs3.getInt("empno"));
				while (mrs.next()) {
					MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
					MarrdMessage = "***" + MarrdMessage + "( "
							+ sdf1.format(mrs.getDate("MARRIEDDT")) + " )  !!!";
				}
				mrs.close();

				wrs = mst
						.executeQuery("SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"
								+ dt + "') and e.empno=" + rs3.getInt("empno"));
				while (wrs.next()) {
					WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
					WorkMssage = "***" + WorkMssage + "( "
							+ sdf1.format(wrs.getDate("doj")) + " ) !!!";

				}
				wrs.close();

				parab = new Paragraph(new Phrase("" + BirthdayMessage,
						new Font(Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase("" + MarrdMessage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase("" + WorkMssage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);

				// System.out.println("BMssg=> "+BirthdayMessage+" Wmssg=> "+WorkMssage+" Mmssg=> "+MarrdMessage);

				Rectangle rec = new Rectangle(100, 100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(40);
				tab.setWidthPercentage(new float[] { 100 }, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[] { 100 }, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[] { 50, 50 },
						new Rectangle(100, 100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(4);

				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);

				PdfPTable tab5 = new PdfPTable(4);
				PdfPTable tab6 = new PdfPTable(4);

				PdfPTable tab7 = new PdfPTable(4);
				PdfPTable tab8 = new PdfPTable(4);
				PdfPTable tab9 = new PdfPTable(4);
				PdfPTable tab10 = new PdfPTable(2);

				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();

				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				// PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				boolean isRecord = false;
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="
						+ rs3.getInt("EMPNO") + " and TRNDT  LIKE '"
						+ dt.substring(0, 7) + "%' order by trncd");

				if (rs.next()) {
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1 = rs.getString("TRNDT");
					// rs1 =
					// st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
					rs1 = st1
							.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="
									+ rs3.getInt("EMPNO")
									+ " and TRNDT  ='"
									+ dt1
									+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

				} else {
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="
							+ rs3.getInt("EMPNO")
							+ " and TRNDT  LIKE '"
							+ dt.substring(0, 7) + "%' order by trncd");
					if (rs.next()) {
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1 = rs.getString("TRNDT");
						// rs1 =
						// st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
						rs1 = st1
								.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="
										+ rs3.getInt("EMPNO")
										+ " and TRNDT  ='"
										+ dt1
										+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					} else {
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="
								+ rs3.getInt("EMPNO")
								+ " and TRNDT  LIKE '"
								+ dt.substring(0, 7) + "%' order by trncd");
						if (rs.next())
							frmTable = "PAYTRAN_STAGE";
						isRecord = true;
						System.out
								.println("errorrrrrrrrrrrrr select trndt  from PAYTRAN_STAGE where empno="
										+ rs3.getInt("EMPNO")
										+ " and TRNDT  LIKE '"
										+ dt.substring(0, 7)
										+ "%' order by trncd");
						dt1 = rs.getString("TRNDT");

						rs1 = st1
								.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="
										+ rs3.getInt("EMPNO")
										+ " and TRNDT  ='"
										+ dt1
										+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					}

				}

				ArrayList<TranBean> trblist = new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3
						.getString("EMPNO"));

				if (isRecord) {
					while (rs1.next()) {

						tb = new TranBean();
						tb = th.getPaySlipTran(rs3.getInt("EMPNO"),
								rs1.getInt(1), 0, dt1, frmTable);
						trblist.add(tb);

					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					// System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7 = statement.executeQuery("select "
							+ Calculate.getDays(monthDate)
							+ " - DAY(DOJ)+1 from empmast where empno ="
							+ rs3.getInt("EMPNO") + " and doj between cast('"
							+ ReportDAO.BOM(monthDate)
							+ "' as DATE) and cast('"
							+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						paiddays = rs7.getFloat(1);
					}
					// === For Date of Leaving in same Month
					rs7 = statement
							.executeQuery("select "
									+ paiddays
									+ " - (DAY(cast('"
									+ ReportDAO.EOM(monthDate)
									+ "' as DATE))- DAY(DOL)) from empmast where empno ="
									+ rs3.getInt("EMPNO")
									+ " and dol between cast('"
									+ ReportDAO.BOM(monthDate)
									+ "' as DATE) and cast('"
									+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						/*
						 * int day = rs7.getInt(1); paiddays = day;
						 */
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcell4 = new PdfPCell(new Phrase(
							"Salary & Allowances ", new Font(Font.TIMES_ROMAN,
									10, Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);

					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);

					PdfPCell subcellin1 = new PdfPCell(new Phrase("Arrears ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin1);

					PdfPCell subcellin2 = new PdfPCell(new Phrase("Total ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin2);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase(
							"Deductions ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase(
							"Amount.(Rs) ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout3 = new PdfPCell(new Phrase("Arrears ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout3);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout4 = new PdfPCell(new Phrase("Total ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout4);

					for (TranBean trbn1 : trblist) {
						if (trbn1.getTRNCD() < 199 && trbn1.getTRNCD() != 127) {

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells = new PdfPCell(new Phrase(""
									+ CodeMasterHandler.getCDesc(trbn1
											.getTRNCD()), new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""
									+ trbn1.getCAL_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells1
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""
									+ trbn1.getARR_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells2
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells2);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""
									+ trbn1.getNET_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells3
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells3);

							total_amntIN = total_amntIN + trbn1.getCAL_AMT();
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();

						}

						else if (300 > trbn1.getTRNCD()
								&& trbn1.getTRNCD() > 200) {
							// / akshay nikam== = for displaying deserve trncd
							// accrdng to employee in paysliip...

							if (state.equalsIgnoreCase("goa")
									&& trbn1.getTRNCD() == 238) {

								tab6.setWidthPercentage(new float[] { 55, 15,
										15, 15 }, new Rectangle(100, 100));
								PdfPCell subcells = new PdfPCell(new Phrase(""
										+ CodeMasterHandler.getCDesc(trbn1
												.getTRNCD()), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));
								subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
								tab6.addCell(subcells);

								tab6.setWidthPercentage(new float[] { 55, 15,
										15, 15 }, new Rectangle(100, 100));
								PdfPCell subcells1 = new PdfPCell(new Phrase(""
										+ trbn1.getCAL_AMT(), new Font(
										Font.TIMES_ROMAN, 10, Font.NORMAL)));
								subcells1
										.setHorizontalAlignment(Element.ALIGN_RIGHT);
								tab6.addCell(subcells1);

								tab6.setWidthPercentage(new float[] { 55, 15,
										15, 15 }, new Rectangle(100, 100));
								PdfPCell subcells2 = new PdfPCell(new Phrase(""
										+ trbn1.getARR_AMT(), new Font(
										Font.TIMES_ROMAN, 10, Font.NORMAL)));
								subcells2
										.setHorizontalAlignment(Element.ALIGN_RIGHT);
								tab6.addCell(subcells2);

								tab6.setWidthPercentage(new float[] { 55, 15,
										15, 15 }, new Rectangle(100, 100));
								PdfPCell subcells3 = new PdfPCell(new Phrase(""
										+ trbn1.getNET_AMT(), new Font(
										Font.TIMES_ROMAN, 10, Font.NORMAL)));
								subcells3
										.setHorizontalAlignment(Element.ALIGN_RIGHT);
								tab6.addCell(subcells3);

								total_amntDED = total_amntDED
										+ trbn1.getCAL_AMT();
								total_arrDED = total_arrDED
										+ trbn1.getARR_AMT();
								total_totDED = total_totDED
										+ trbn1.getNET_AMT();
							} else {
								if (!state.equalsIgnoreCase("Goa")
										&& trbn1.getTRNCD() == 211) {

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells = new PdfPCell(
											new Phrase(
													""
															+ CodeMasterHandler
																	.getCDesc(trbn1
																			.getTRNCD()),
													new Font(Font.TIMES_ROMAN,
															10, Font.BOLD)));
									subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
									tab6.addCell(subcells);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells1 = new PdfPCell(
											new Phrase("" + trbn1.getCAL_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells1
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells1);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells2 = new PdfPCell(
											new Phrase("" + trbn1.getARR_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells2
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells2);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells3 = new PdfPCell(
											new Phrase("" + trbn1.getNET_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells3
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells3);

									total_amntDED = total_amntDED
											+ trbn1.getCAL_AMT();
									total_arrDED = total_arrDED
											+ trbn1.getARR_AMT();
									total_totDED = total_totDED
											+ trbn1.getNET_AMT();
								} else if (300 > trbn1.getTRNCD()
										&& trbn1.getTRNCD() > 200
										&& trbn1.getTRNCD() != 238
										&& trbn1.getTRNCD() != 211)

								{

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells = new PdfPCell(
											new Phrase(
													""
															+ CodeMasterHandler
																	.getCDesc(trbn1
																			.getTRNCD()),
													new Font(Font.TIMES_ROMAN,
															10, Font.BOLD)));
									subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
									tab6.addCell(subcells);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells1 = new PdfPCell(
											new Phrase("" + trbn1.getCAL_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells1
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells1);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells2 = new PdfPCell(
											new Phrase("" + trbn1.getARR_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells2
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells2);

									tab6.setWidthPercentage(new float[] { 55,
											15, 15, 15 }, new Rectangle(100,
											100));
									PdfPCell subcells3 = new PdfPCell(
											new Phrase("" + trbn1.getNET_AMT(),
													new Font(Font.TIMES_ROMAN,
															10, Font.NORMAL)));
									subcells3
											.setHorizontalAlignment(Element.ALIGN_RIGHT);
									tab6.addCell(subcells3);

									total_amntDED = total_amntDED
											+ trbn1.getCAL_AMT();
									total_arrDED = total_arrDED
											+ trbn1.getARR_AMT();
									total_totDED = total_totDED
											+ trbn1.getNET_AMT();
								}

							}
						}
						// ak === end here
						if (trbn1.getTRNCD() == 301) {
							absent = trbn1.getCAL_AMT();
							paiddays = paiddays - absent;
						}
						if (trbn1.getTRNCD() == 199) {
							gross = trbn1.getINP_AMT();
						}

						monthygross = (int) gross
								- Math.round(((gross / nodays) * absent));

					}
					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin = new PdfPCell(new Phrase(
							"Gross Salary", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""
							+ total_amntIN, new Font(Font.TIMES_ROMAN, 8,
							Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin2 = new PdfPCell(new Phrase(""
							+ total_arrIN, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin2);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin3 = new PdfPCell(new Phrase(""
							+ total_totIN, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin3);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded = new PdfPCell(new Phrase(
							"TOTAL DEDUCTION", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""
							+ total_amntDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded2 = new PdfPCell(new Phrase(""
							+ total_arrDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded2);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded3 = new PdfPCell(new Phrase(""
							+ total_totDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded3);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""
							+ (total_totIN - total_totDED), new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts2 = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts2.setColspan(2);
					subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts2);

					tab10.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcellt = new PdfPCell(
							new Phrase(
									"Net Salary In Words :- "
											+ originalNumToLetter
													.getInWords(""
															+ (int) (total_totIN - total_totDED)),
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);

					tab1.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell = new PdfPCell(new Phrase(
							"Employee Number ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEMPCODE(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEmpname(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DEPT",
									trbn.getDept()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DESIG",
									trbn.getDesg()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ lkp.getLKP_Desc("BANK", rs3.getInt("BANK_NAME")),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("A/No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getAccno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					/*
					 * subcell = new PdfPCell(new Phrase("PF No ", new Font(
					 * Font.TIMES_ROMAN, 10, Font.BOLD)));
					 * subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					 * tab1.addCell(subcell);
					 * 
					 * subcell = new PdfPCell(new Phrase("" + trbn.getPfno(),
					 * new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					 * subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					 * tab1.addCell(subcell);
					 */

					subcell = new PdfPCell(new Phrase("Uan Number ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(
							new Phrase(""
									+ ((trbn.getUanno() == "" || trbn
											.getUanno() == null) ? "" : trbn
											.getUanno()), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getPanno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					String lesql = "SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"
							+ ReportDAO.BOM(slrydt)
							+ "' AND '"
							+ ReportDAO.EOM(slrydt)
							+ "' AND LEAVECD=1 AND EMPNO="
							+ rs3.getInt("EMPNO") + " GROUP BY LEAVECD";
					cl = 0;
					pl = 0;
					sl = 0;
					ml = 0;
					ResultSet rsleave = st1.executeQuery(lesql);
					while (rsleave.next()) {
						String leave = new LookupHandler().getLKP_Desc("LEAVE",
								rsleave.getInt(2));

						if (leave.equalsIgnoreCase("PL")) {
							pl = rsleave.getFloat("TOTDED");
						}
						/*
						 * if(leave.equalsIgnoreCase("CL")){ cl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("SL")){ sl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("ML")){ ml =
						 * rsleave.getInt(1); }
						 */
					}
					/*
					 * cl=0; pl=0; sl=0; ml=0; int otherlv=0; st1 =
					 * Cn.createStatement(); rs1= st1.executeQuery(
					 * "SELECT DISTINCT(LEAVECD) FROM LEAVEBAL WHERE EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					 * while(rs1.next()) { if(rs1.getInt(1) == 4){ st =
					 * Cn.createStatement(); rs=st.executeQuery(
					 * "SELECT SUM(DAYS) FROM LEAVETRAN WHERE TRNDATE BETWEEN '"
					 * +
					 * ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' "
					 * +
					 * "AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="+rs3.getInt("EMPNO"
					 * )+" AND STATUS='SANCTION' GROUP BY LEAVECD");
					 * if(rs.next()){ otherlv = rs.getInt(1); } rs.close();
					 * st.close(); } st = Cn.createStatement();
					 * rs=st.executeQuery
					 * ("SELECT TOP 1 * FROM LEAVEBAL WHERE BALDT<='"
					 * +ReportDAO.EOM
					 * (slrydt)+"' AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY BALDT DESC");
					 * if(rs.next()) { String leave = new
					 * LookupHandler().getLKP_Desc("LEAVE",rs.getInt(3));
					 * 
					 * if(leave.equalsIgnoreCase("PL")){ pl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("CL")){
					 * cl = rs.getFloat("BAL"); }
					 * if(leave.equalsIgnoreCase("SL")){ sl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("ML")){
					 * ml = rs.getFloat("BAL"); } } rs.close(); st.close(); }
					 * rs1.close(); st1.close();
					 */

					tab2.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell2 = new PdfPCell(new Phrase(
							"Date Of Joining ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + trbn.getDOJ(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Leave ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Gross Amount / Rate (Day)", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + gross, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Sick Leave", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + sl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Absent", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + absent, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + pl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Monthly Gross Payable Amount", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + monthygross,
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Casual Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + cl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Days", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + paiddays, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Maternity Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + ml, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);

					// for loop for getting label and values for payslip income
					// for loop for getting label and values for payslip
					// Deduction

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);

					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);

					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);

					// tab.
					// doc.add(Chunk.NEWLINE);
					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					/*
					 * if(!(BirthdayMessage.equals("")) ||BirthdayMessage!=null
					 * ) { doc.add(parab); } if(!(MarrdMessage.equals(""))
					 * ||MarrdMessage!=null ) { doc.add(param); }
					 * 
					 * if(!(WorkMssage.equals("")) ||WorkMssage!=null ) {
					 * doc.add(paraw); }
					 */

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					para = new Paragraph(
							new Phrase(
									"For                                                                           ",
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingBefore(40);
					doc.add(para);
					para = new Paragraph(new Phrase(""
							+ prop.getProperty("companyName")
							+ "                              ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					para = new Paragraph(new Phrase(""
							+ prop.getProperty("hrmanager")
							+ "                                             ",
							new Font(Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(
							new Phrase(
									"Authorised Signture & Stamp                              ",
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);

				}
				doc.newPage();
			}

			doc.close();

			Cn.close();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void PaySlip(String dt, String empList, String filepath,
			String imagepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		Statement mst = null;
		try {
			Connection Cn = null;
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();
			LookupHandler lkp = new LookupHandler();
			ResultSet rs = null;
			ResultSet rs1 = null;
			ResultSet brs = null;
			ResultSet mrs = null;
			ResultSet wrs = null;

			String EmpSql = "";

			float total_amntIN = 0.0f;
			float total_arrIN = 0.0f;
			float total_totIN = 0.0f;

			float total_amntDED = 0.0f;
			float total_arrDED = 0.0f;
			float total_totDED = 0.0f;
			float absent = 0.0f;
			float gross = 0.0f;
			float nodays = 0.0f;
			float paiddays = 0.0f;
			float monthygross = 0.0f;
			float cl = 0;
			float pl = 0;
			float sl = 0;
			float ml = 0;
			nodays = Calculate.getDays(dt);
			SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MMM-yyyy");
			Date date = sdf.parse(dt);
			String slrydt = dt;

			String dt1 = "";

			Statement st3 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			EmpSql = "SELECT emp.*,t.ACNO,t.BRANCH,t.GRADE,t.BANK_NAME FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO"
					+ " AND emp.EMPNO in ("
					+ empList
					+ ") AND t.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 "
					+ " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(dt) + "') ORDER BY emp.EMPNO";
			ResultSet rs3 = st3.executeQuery(EmpSql);

			System.out.println("---------------" + EmpSql);

			if (!rs3.next()) {
				System.out.println("Recordset EMpty");
			}

			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Payslip date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			rs3.beforeFirst();
			while (rs3.next()) {

				total_amntIN = 0.0f;
				total_arrIN = 0.0f;
				total_totIN = 0.0f;

				total_amntDED = 0.0f;
				total_arrDED = 0.0f;
				total_totDED = 0.0f;
				absent = 0.0f;
				gross = 0;
				// nodays = 0.0f;
				paiddays = 0.0f;
				monthygross = 0;

				paiddays = nodays;

				String WorkMssage = "";
				String BirthdayMessage = "";
				String MarrdMessage = "";
				String mssgdate = "";

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);

				Image image1 = Image.getInstance(imagepath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 10, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10);

				Paragraph parab = new Paragraph(title);

				Paragraph param = new Paragraph(title);

				Paragraph paraw = new Paragraph(title);

				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase("Salary Slip For "
						+ slrydt.substring(3), new Font(Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				sdf = new SimpleDateFormat("yyyy-MM-dd");
				dt = sdf.format(date);

				final Calendar date1 = Calendar.getInstance();
				date1.setTime(date);
				date1.add(Calendar.MONTH, 1);

				String bday = sdf.format(date1.getTime());
				// System.out.println("here is the bday"+bday);

				date1.add(Calendar.DATE, 1);

				String qery = "SELECT e.empno,e.fname,e.dob FROM empmast e WHERE MONTH(e.dob) = MONTH('"
						+ bday + "') and e.empno=" + rs3.getInt("empno");
				mst = Cn.createStatement();

				brs = mst.executeQuery(qery);
				while (brs.next()) {

					BirthdayMessage = ReportDAO.getWishMessage("BIRTHDAY", Cn);
					BirthdayMessage = "***" + BirthdayMessage + "( "
							+ sdf1.format(brs.getDate("dob")) + " ) !!!";
				}
				brs.close();

				/*
				 * mrs = mst.executeQuery(
				 * "SELECT e.empno,e.fname,e.MARRIEDDT FROM empmast e WHERE MONTH(e.MARRIEDDT) = MONTH('"
				 * +dt+"') and e.empno="+rs3.getInt("empno")); while(mrs.next())
				 * { MarrdMessage = ReportDAO.getWishMessage("WEDDING", Cn);
				 * MarrdMessage
				 * ="***"+MarrdMessage+"( "+sdf1.format(mrs.getDate("MARRIEDDT"
				 * ))+" )  !!!"; } mrs.close();
				 * 
				 * wrs = mst.executeQuery(
				 * "SELECT e.empno,e.fname,e.doj FROM empmast e WHERE MONTH(e.doj) = MONTH('"
				 * +dt+"') and e.empno="+rs3.getInt("empno")); while(wrs.next())
				 * { WorkMssage = ReportDAO.getWishMessage("WORK", Cn);
				 * WorkMssage
				 * ="***"+WorkMssage+"( "+sdf1.format(wrs.getDate("doj"
				 * ))+" ) !!!";
				 * 
				 * } wrs.close();
				 */

				parab = new Paragraph(new Phrase("" + BirthdayMessage,
						new Font(Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				parab.setAlignment(Element.ALIGN_LEFT);
				param = new Paragraph(new Phrase("" + MarrdMessage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				param.setAlignment(Element.ALIGN_LEFT);
				paraw = new Paragraph(new Phrase("" + WorkMssage, new Font(
						Font.TIMES_ROMAN, 10, FONT.BOLDITALIC)));
				paraw.setAlignment(Element.ALIGN_LEFT);

				// System.out.println("BMssg=> "+BirthdayMessage+" Wmssg=> "+WorkMssage+" Mmssg=> "+MarrdMessage);

				Rectangle rec = new Rectangle(100, 100);

				PdfPTable tab = new PdfPTable(1);
				tab.setSpacingBefore(40);
				tab.setWidthPercentage(new float[] { 100 }, rec);
				tab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabt = new PdfPTable(1);
				tabt.setWidthPercentage(new float[] { 100 }, rec);
				tabt.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPTable tabsec = new PdfPTable(2);
				tabsec.setWidthPercentage(new float[] { 50, 50 },
						new Rectangle(100, 100));
				tabsec.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell = new PdfPCell();
				PdfPCell cellt = new PdfPCell();

				PdfPTable tab1 = new PdfPTable(4);
				PdfPTable tab2 = new PdfPTable(4);

				PdfPTable tab3 = new PdfPTable(2);
				PdfPTable tab4 = new PdfPTable(2);

				PdfPTable tab5 = new PdfPTable(4);
				PdfPTable tab6 = new PdfPTable(4);

				PdfPTable tab7 = new PdfPTable(4);
				PdfPTable tab8 = new PdfPTable(4);
				PdfPTable tab9 = new PdfPTable(4);
				PdfPTable tab10 = new PdfPTable(2);

				PdfPCell cell3 = new PdfPCell();
				PdfPCell cell4 = new PdfPCell();

				PdfPCell cell5 = new PdfPCell();
				PdfPCell cell6 = new PdfPCell();
				PdfPCell cell7 = new PdfPCell();
				// PdfPCell cell8 = new PdfPCell();

				Statement st = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement st1 = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				boolean isRecord = false;
				String frmTable = "";
				rs = st.executeQuery("select trndt  from PAYTRAN where empno="
						+ rs3.getInt("EMPNO") + " and TRNDT  LIKE '"
						+ dt.substring(0, 7) + "%' order by trncd");

				if (rs.next()) {
					frmTable = "PAYTRAN";
					isRecord = true;
					dt1 = rs.getString("TRNDT");
					// rs1 =
					// st1.executeQuery("select distinct(trncd)  from PAYTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
					rs1 = st1
							.executeQuery("select distinct(pay.trncd)  from PAYTRAN pay,cdmast cd where empno="
									+ rs3.getInt("EMPNO")
									+ " and TRNDT  ='"
									+ dt1
									+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

				} else {
					rs = st.executeQuery("select trndt  from YTDTRAN where empno="
							+ rs3.getInt("EMPNO")
							+ " and TRNDT  LIKE '"
							+ dt.substring(0, 7) + "%' order by trncd");
					if (rs.next()) {
						frmTable = "YTDTRAN";
						isRecord = true;
						dt1 = rs.getString("TRNDT");
						// rs1 =
						// st1.executeQuery("select distinct(trncd)  from YTDTRAN where empno="+rs3.getInt("EMPNO")+" and TRNDT  ='"+dt1+"' order by trncd");
						rs1 = st1
								.executeQuery("select distinct(pay.trncd)  from YTDTRAN pay,cdmast cd where empno="
										+ rs3.getInt("EMPNO")
										+ " and TRNDT  ='"
										+ dt1
										+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");

					} else {
						rs = st.executeQuery("select trndt  from PAYTRAN_STAGE where empno="
								+ rs3.getInt("EMPNO")
								+ " and TRNDT  LIKE '"
								+ dt.substring(0, 7) + "%' order by trncd");
						if (rs.next()) {
							frmTable = "PAYTRAN_STAGE";
							isRecord = true;
							dt1 = rs.getString("TRNDT");
							rs1 = st1
									.executeQuery("select distinct(pay.trncd)  from PAYTRAN_STAGE pay,cdmast cd where empno="
											+ rs3.getInt("EMPNO")
											+ " and TRNDT  ='"
											+ dt1
											+ "' and pay.trncd = cd.trncd and cd.pslipyn = 'Y' order by trncd");
						}
					}

				}

				ArrayList<TranBean> trblist = new ArrayList<TranBean>();
				TranBean tb;
				TranHandler th = new TranHandler();
				TransactionBean trbn = new EmpOffHandler().getInfoEmpTran(rs3
						.getString("EMPNO"));

				if (isRecord) {
					while (rs1.next()) {

						tb = new TranBean();
						tb = th.getPaySlipTran(rs3.getInt("EMPNO"),
								rs1.getInt(1), 0, dt1, frmTable);
						trblist.add(tb);

					}

					SimpleDateFormat from = new SimpleDateFormat("yyyy-MM-dd");
					SimpleDateFormat to = new SimpleDateFormat("dd-MMM-yyyy");
					Date d = from.parse(dt);
					String monthDate = to.format(d);
					// System.out.println(monthDate);

					ResultSet rs7 = null;
					Statement statement = repBean.getCn().createStatement();
					rs7 = statement.executeQuery("select "
							+ Calculate.getDays(monthDate)
							+ " - DAY(DOJ)+1 from empmast where empno ="
							+ rs3.getInt("EMPNO") + " and doj between cast('"
							+ ReportDAO.BOM(monthDate)
							+ "' as DATE) and cast('"
							+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						paiddays = rs7.getFloat(1);
					}
					// === For Date of Leaving in same Month
					rs7 = statement
							.executeQuery("select "
									+ paiddays
									+ " - (DAY(cast('"
									+ ReportDAO.EOM(monthDate)
									+ "' as DATE))- DAY(DOL)) from empmast where empno ="
									+ rs3.getInt("EMPNO")
									+ " and dol between cast('"
									+ ReportDAO.BOM(monthDate)
									+ "' as DATE) and cast('"
									+ ReportDAO.EOM(monthDate) + "' as DATE)");
					if (rs7.next()) {
						/*
						 * int day = rs7.getInt(1); paiddays = day;
						 */
						paiddays = rs7.getFloat(1);
					}

					tab3.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell3 = new PdfPCell(new Phrase("INCOME ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell3.setColspan(2);
					subcell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab3.addCell(subcell3);

					tab4.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcell5 = new PdfPCell(new Phrase("DEDUCTIONS ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell5.setColspan(2);
					subcell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(subcell5);

					tab5.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcell4 = new PdfPCell(new Phrase(
							"Salary & Allowances ", new Font(Font.TIMES_ROMAN,
									10, Font.BOLD)));
					subcell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcell4);

					PdfPCell subcellin = new PdfPCell(new Phrase("Amount.(Rs)",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin);

					PdfPCell subcellin1 = new PdfPCell(new Phrase("Arrears ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin1);

					PdfPCell subcellin2 = new PdfPCell(new Phrase("Total ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellin2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab5.addCell(subcellin2);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout1 = new PdfPCell(new Phrase(
							"Deductions ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout1.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout1);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout2 = new PdfPCell(new Phrase(
							"Amount.(Rs) ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcellout2.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout2);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout3 = new PdfPCell(new Phrase("Arrears ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellout3.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout3);

					tab6.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellout4 = new PdfPCell(new Phrase("Total ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellout4.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab6.addCell(subcellout4);

					for (TranBean trbn1 : trblist) {
						if (trbn1.getTRNCD() < 199 && trbn1.getTRNCD() != 127) {

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells = new PdfPCell(new Phrase(""
									+ CodeMasterHandler.getCDesc(trbn1
											.getTRNCD()), new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab5.addCell(subcells);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""
									+ trbn1.getCAL_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells1
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells1);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""
									+ trbn1.getARR_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells2
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells2);

							tab5.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""
									+ trbn1.getNET_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells3
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab5.addCell(subcells3);

							total_amntIN = total_amntIN + trbn1.getCAL_AMT();
							total_arrIN = total_arrIN + trbn1.getARR_AMT();
							total_totIN = total_totIN + trbn1.getNET_AMT();

						}

						else if (300 > trbn1.getTRNCD()
								&& trbn1.getTRNCD() > 200) {

							tab6.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells = new PdfPCell(new Phrase(""
									+ CodeMasterHandler.getCDesc(trbn1
											.getTRNCD()), new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
							subcells.setHorizontalAlignment(Element.ALIGN_LEFT);
							tab6.addCell(subcells);

							tab6.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells1 = new PdfPCell(new Phrase(""
									+ trbn1.getCAL_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells1
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells1);

							tab6.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells2 = new PdfPCell(new Phrase(""
									+ trbn1.getARR_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells2
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells2);

							tab6.setWidthPercentage(new float[] { 55, 15, 15,
									15 }, new Rectangle(100, 100));
							PdfPCell subcells3 = new PdfPCell(new Phrase(""
									+ trbn1.getNET_AMT(), new Font(
									Font.TIMES_ROMAN, 10, Font.NORMAL)));
							subcells3
									.setHorizontalAlignment(Element.ALIGN_RIGHT);
							tab6.addCell(subcells3);

							total_amntDED = total_amntDED + trbn1.getCAL_AMT();
							total_arrDED = total_arrDED + trbn1.getARR_AMT();
							total_totDED = total_totDED + trbn1.getNET_AMT();
						}
						if (trbn1.getTRNCD() == 301) {
							absent = trbn1.getCAL_AMT();
							paiddays = paiddays - absent;
						}
						if (trbn1.getTRNCD() == 199) {
							gross = trbn1.getINP_AMT();
						}

						monthygross = (int) gross
								- Math.round(((gross / nodays) * absent));

					}
					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin = new PdfPCell(new Phrase(
							"Gross Salary", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltin.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin1 = new PdfPCell(new Phrase(""
							+ total_amntIN, new Font(Font.TIMES_ROMAN, 8,
							Font.BOLD)));
					subcelltin1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin1);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin2 = new PdfPCell(new Phrase(""
							+ total_arrIN, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltin2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin2);

					tab7.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltin3 = new PdfPCell(new Phrase(""
							+ total_totIN, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltin3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab7.addCell(subcelltin3);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded = new PdfPCell(new Phrase(
							"TOTAL DEDUCTION", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcelltded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded1 = new PdfPCell(new Phrase(""
							+ total_amntDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded1);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded2 = new PdfPCell(new Phrase(""
							+ total_arrDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded2);

					tab8.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcelltded3 = new PdfPCell(new Phrase(""
							+ total_totDED, new Font(Font.TIMES_ROMAN, 10,
							Font.BOLD)));
					subcelltded3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab8.addCell(subcelltded3);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts = new PdfPCell(new Phrase("Net Salary",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts1 = new PdfPCell(new Phrase(""
							+ (total_totIN - total_totDED), new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts1);

					tab9.setWidthPercentage(new float[] { 55, 15, 15, 15 },
							new Rectangle(100, 100));
					PdfPCell subcellts2 = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellts2.setColspan(2);
					subcellts2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab9.addCell(subcellts2);

					tab10.setWidthPercentage(new float[] { 50, 50 },
							new Rectangle(100, 100));
					PdfPCell subcellt = new PdfPCell(
							new Phrase(
									"Net Salary In Words :- "
											+ originalNumToLetter
													.getInWords(""
															+ (int) (total_totIN - total_totDED)),
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcellt.setHorizontalAlignment(Element.ALIGN_LEFT);
					subcellt.setColspan(2);
					tab10.addCell(subcellt);

					tab1.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell = new PdfPCell(new Phrase(
							"Employee Number ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEMPCODE(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Employee Name ",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getEmpname(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Department ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DEPT",
									trbn.getDept()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Designation ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ new LookupHandler().getLKP_Desc("DESIG",
									trbn.getDesg()), new Font(Font.TIMES_ROMAN,
							10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("Bank Name ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase(""
							+ lkp.getLKP_Desc("BANK", rs3.getInt("BANK_NAME")),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("A/No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getAccno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PF No ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getPfno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("PAN No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("" + trbn.getPanno(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("ESI No. ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					subcell = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab1.addCell(subcell);

					// String
					// lesql="SELECT SUM(TOTDR) AS TOTDED,LEAVECD FROM LEAVEBAL WHERE BALDT BETWEEN '"+ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' AND LEAVECD=1 AND EMPNO="+rs3.getInt("EMPNO")+" GROUP BY LEAVECD";
					String lesql = "SELECT SUM(DAYS) AS TOTDED,LEAVECD  FROM LEAVETRAN WHERE TODT BETWEEN '"
							+ ReportDAO.BOM(slrydt)
							+ "' AND '"
							+ ReportDAO.EOM(slrydt)
							+ "' AND LEAVECD=1 AND EMPNO="
							+ rs3.getInt("EMPNO")
							+ " "
							+ " AND STATUS='SANCTION' AND TRNTYPE='D' GROUP BY LEAVECD  ";
					cl = 0;
					pl = 0;
					sl = 0;
					ml = 0;
					ResultSet rsleave = st1.executeQuery(lesql);
					while (rsleave.next()) {
						String leave = new LookupHandler().getLKP_Desc("LEAVE",
								rsleave.getInt(2));

						if (leave.equalsIgnoreCase("PL")) {
							pl = rsleave.getFloat("TOTDED");
						}
						/*
						 * if(leave.equalsIgnoreCase("CL")){ cl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("SL")){ sl =
						 * rsleave.getInt(1); }
						 * if(leave.equalsIgnoreCase("ML")){ ml =
						 * rsleave.getInt(1); }
						 */
					}
					/*
					 * cl=0; pl=0; sl=0; ml=0; int otherlv=0; st1 =
					 * Cn.createStatement(); rs1= st1.executeQuery(
					 * "SELECT DISTINCT(LEAVECD) FROM LEAVEBAL WHERE EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY LEAVECD");
					 * while(rs1.next()) { if(rs1.getInt(1) == 4){ st =
					 * Cn.createStatement(); rs=st.executeQuery(
					 * "SELECT SUM(DAYS) FROM LEAVETRAN WHERE TRNDATE BETWEEN '"
					 * +
					 * ReportDAO.BOM(slrydt)+"' AND '"+ReportDAO.EOM(slrydt)+"' "
					 * +
					 * "AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="+rs3.getInt("EMPNO"
					 * )+" AND STATUS='SANCTION' GROUP BY LEAVECD");
					 * if(rs.next()){ otherlv = rs.getInt(1); } rs.close();
					 * st.close(); } st = Cn.createStatement();
					 * rs=st.executeQuery
					 * ("SELECT TOP 1 * FROM LEAVEBAL WHERE BALDT<='"
					 * +ReportDAO.EOM
					 * (slrydt)+"' AND LEAVECD="+rs1.getInt(1)+" AND EMPNO="
					 * +rs3.getInt("EMPNO")+" ORDER BY BALDT DESC");
					 * if(rs.next()) { String leave = new
					 * LookupHandler().getLKP_Desc("LEAVE",rs.getInt(3));
					 * 
					 * if(leave.equalsIgnoreCase("PL")){ pl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("CL")){
					 * cl = rs.getFloat("BAL"); }
					 * if(leave.equalsIgnoreCase("SL")){ sl =
					 * rs.getFloat("BAL"); } if(leave.equalsIgnoreCase("ML")){
					 * ml = rs.getFloat("BAL"); } } rs.close(); st.close(); }
					 * rs1.close(); st1.close();
					 */

					tab2.setWidthPercentage(new float[] { 25, 25, 25, 25 },
							new Rectangle(100, 100));
					PdfPCell subcell2 = new PdfPCell(new Phrase(
							"Date Of Joining ", new Font(Font.TIMES_ROMAN, 10,
									Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + trbn.getDOJ(),
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Leave ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Gross Amount / Rate (Day)", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + gross, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Sick Leave", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + sl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Unpaid Absent",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + absent, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Priviledge Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + pl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase(
							"Monthly Gross Payable Amount", new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + monthygross,
							new Font(Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Casual Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + cl, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Paid Days", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + paiddays, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("Maternity Leave",
							new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					subcell2 = new PdfPCell(new Phrase("" + ml, new Font(
							Font.TIMES_ROMAN, 10, Font.NORMAL)));
					subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					tab2.addCell(subcell2);

					tab1.addCell(subcell);
					cell.addElement(tab1);
					tab.addCell(cell);

					tab2.addCell(subcell2);
					cellt.addElement(tab2);
					tabt.addCell(cellt);

					// for loop for getting label and values for payslip income
					// for loop for getting label and values for payslip
					// Deduction

					cell3.addElement(tab3);
					cell3.addElement(tab5);
					cell5.addElement(tab7);
					cell5.addElement(tab9);
					cell7.addElement(tab10);
					cell7.setColspan(2);

					cell4.addElement(tab4);
					cell4.addElement(tab6);
					cell6.addElement(tab8);

					tabsec.addCell(cell3);
					tabsec.addCell(cell4);
					tabsec.addCell(cell5);
					tabsec.addCell(cell6);
					tabsec.addCell(cell7);

					// tab.
					// doc.add(Chunk.NEWLINE);
					doc.add(tab);
					doc.add(tabt);
					doc.add(tabsec);

					doc.add(Chunk.NEWLINE);

					if (!(BirthdayMessage.equals(""))
							|| BirthdayMessage != null) {
						doc.add(parab);
					}
					if (!(MarrdMessage.equals("")) || MarrdMessage != null) {
						doc.add(param);
					}

					if (!(WorkMssage.equals("")) || WorkMssage != null) {
						doc.add(paraw);
					}

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					para = new Paragraph(
							new Phrase(
									"For                                                                           ",
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingBefore(40);
					doc.add(para);
					para = new Paragraph(new Phrase(""
							+ prop.getProperty("companyName")
							+ "                           ", new Font(
							Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);

					doc.add(Chunk.NEWLINE);
					doc.add(Chunk.NEWLINE);

					para = new Paragraph(new Phrase(""
							+ prop.getProperty("hrmanager")
							+ "                                             ",
							new Font(Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);
					para = new Paragraph(
							new Phrase(
									"Authorised Signture & Stamp                              ",
									new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
					para.setAlignment(Element.ALIGN_RIGHT);
					para.setSpacingAfter(0);
					doc.add(para);

				}
				doc.newPage();
			}
			doc.close();

			Cn.close();

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void payreg(String PAYREGDT, String Desgn, String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		ResultSet arrrec = null;
		FileWriter Fp;
		int aCtr = 0;
		int lCtr = 0;
		int ctr = 0;
		int printBasic = 0;
		int printNet = 0;
		int printGross = 0;
		int printTotDed = 0;
		int LOPDays = 0;
		String BomDt = "";
		String EomDt = "";
		boolean DtrFind = false;
		String lBomDt = "";
		String lEomDt = "";
		int i = 0;
		int j = 0;
		String dtrsql = "";
		String CdmSql = "";
		String EmpSql = "";
		String[] pdet = new String[7];
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		int Str2Ctr = 0;
		int Str4Ctr = 0;
		int Str1Ctr = 0;
		int Arr1Ctr = 0;
		int Arr2Ctr = 0;
		int count = 1;
		String sLOPDTr = "";
		ResultSet LOPDTr = null;
		ReportDAO.inithead(repBean);
		// Initvar *****already variable are initialised not need of initvar
		ReportDAO.make_prn_file(filepath, repBean);

		Connection Cn = null;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		int Hdg6Ctr = 0;
		int Hdg4Ctr = 0;
		int HdgArr1 = 0;
		int HdgArr2 = 0;
		boolean Barr1 = false;
		boolean Barr2 = false;
		boolean fnd = false;
		String Arr1 = "";
		String Arr2 = "";
		String nm = "";
		String pBranch = "";
		String SLINE = "";

		repBean.setbCode(0);
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd"); // Added
																			// by
																			// nakul
																			// for
																			// campareDate
																			// fun()

		for (i = 1; i <= 26; i++) {
			repBean.setIcode(0, i);
			repBean.setEcode(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 100; i <= 200; i++) {
				repBean.setbInc(0, j, i);
			}
		}
		for (i = 100; i <= 199; i++) {
			repBean.setInc(0, i);
		}
		for (i = 200; i <= 300; i++) {
			repBean.setDed(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 200; i <= 300; i++) {
				repBean.setbDed(0, j, i);
			}
		}
		for (i = 1; i <= 4; i++) {
			repBean.setTotBngd(0, i);
			repBean.setRepTotBNGD(0, i);
		}
		for (i = 1; i <= 20; i++) {
			for (j = 1; j <= 4; j++) {
				repBean.setBtotBngd(0, i, j);
			}
		}

		repBean.setLnCount(0);
		repBean.setPayrep(true);
		repBean.setPageNo(1);
		repBean.setLineLen(231);
		repBean.setPageLen(65);
		BomDt = ReportDAO.BOM(PAYREGDT);
		repBean.setFoot_Fl(true);

		EomDt = ReportDAO.EOM(PAYREGDT);
		lBomDt = ReportDAO.BOM(ReportDAO.DateAdd('m', -1, PAYREGDT));
		lEomDt = ReportDAO.EOM(lBomDt);
		ReportDAO.make_prn_file(filepath, repBean);
		String temp = PAYREGDT.substring(3);
		repBean.setHdg1("Salary Sheet For The Month Of :- " + temp);
		SLINE = stringOfSize(232, '-');
		String str2 = "";

		if (!Desgn.equalsIgnoreCase("0")) {
			Str2 = "AND T.DESIG = " + Desgn;
		}

		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
				+ "' AND '" + EomDt + "'";
		try {
			Statement st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM YTDTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";
			} else {
				DtrFind = true;
				dtrsql = "SELECT * FROM YTDTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";
				dtrsql = dtrsql
						+ "UNION SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + EomDt + "'";
			}

			// -----CHanged By PHP Sir

			CdmSql = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT(TRNCD) FROM YTDTRAN WHERE TRNDT BETWEEN '"
					+ BomDt + "' AND '" + EomDt + "') ORDER BY TRNCD";
			EmpSql = "SELECT EMP.*, T.ACNO, T.BRANCH, T.GRADE FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"
					+ PAYREGDT
					+ "') AND EMP.STATUS = 'A' "
					+ Str2
					+ " ORDER BY T.BRANCH, EMP.EMPNO";

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";
				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					System.out.println("Transactions not found");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}

			}
			Barr1 = false;
			Barr2 = false;
			DTR.beforeFirst();
			while (DTR.next()) {
				if (DTR.getInt("TRNCD") <= 200) {
					if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
							.getInt("ARR_AMT")) != 0) {
						Barr1 = true;
					}

				} else {
					if (DTR.getInt("TRNCD") <= 293) {
						if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
								.getInt("ARR_AMT")) != 0) {
							Barr2 = true;
						}

					}
				}
			}
			CDM = st.executeQuery(CdmSql);
			if (!CDM.next()) {
				CdmSql = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT (TRNCD) FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + EomDt + "') ORDER BY TRNCD";
				CDM = st.executeQuery(CdmSql);
				if (!CDM.next()) {
					System.out.println("No any Code to print");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			repBean.setHdg2("Empno  |       Employee Name        Allowances:-> |");
			repBean.setHdg3("       |                            Arrears    :->|");
			repBean.setHdg4("       | SB.A/c No.                               |");
			repBean.setHdg5("Sr.No. | Original Basic   LOP Days   Deductions:->|");
			repBean.setHdg6("       |                            Arrears    :->|");
			repBean.setHdg7("       | Gross Pay.    Total Ded.      Net Pay    |");

			while (CDM.next()) {
				if (CDM.getInt("TRNCD") <= 200) {
					aCtr = aCtr + 1;
					if (aCtr <= 12) {
						repBean.setHdg2(repBean.getHdg2()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
					} else {
						repBean.setHdg4(repBean.getHdg4()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
						Hdg4Ctr = Hdg4Ctr + 1;
					}
				} else {
					lCtr = lCtr + 1;
					if (lCtr <= 12) {
						repBean.setHdg5(repBean.getHdg5()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
					} else {
						repBean.setHdg7(repBean.getHdg7()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
						Hdg6Ctr = Hdg6Ctr + 1;
					}
				}
			}

			for (i = 1; i <= 12; i++) {
				repBean.setHdg3(repBean.getHdg3() + ReportDAO.addSpaces("", 14)
						+ "|");
				repBean.setHdg6(repBean.getHdg6() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (i = Hdg4Ctr + 1; i <= 12; i++) {
				repBean.setHdg4(repBean.getHdg4() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (j = Hdg6Ctr + 1; j <= 12; j++) {
				repBean.setHdg7(repBean.getHdg7() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			Statement st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("Employee Recordset is Empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			pBranch = "";
			emp.beforeFirst();
			while (emp.next()) {
				if (!DtrFind) {
					dtrsql = "SELECT * FROM YTDTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY Y.TRNCD ";

				} else {
					dtrsql = "SELECT * FROM YTDTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'";
					dtrsql = dtrsql
							+ " UNION SELECT * FROM PAYTRAN Y ,CDMAST C WHERE ( Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY 3";
				}

				Str1 = "";
				Str2 = "";
				Str3 = "";
				Str4 = "";
				Arr1 = "";
				Arr2 = "";
				nm = "";
				aCtr = 0;
				Str2Ctr = 0;
				Str1Ctr = 0;
				Arr1Ctr = 0;
				Arr2Ctr = 0;
				lCtr = 0;
				LOPDays = 0;
				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY Y.TRNCD,Y.TRNDT ";

					DTR = st.executeQuery(dtrsql);
					if (!DTR.next()) {
						System.out
								.println("Transaction not found for this Employee "
										+ emp.getInt("EMPNO"));
					}

				}

				// System.out.println(dtrsql);
				if (DTR.next()) {
					ctr = ctr + 1;
					if (pBranch != emp.getString("BRANCH")) {
						repBean.setBrnNo(emp.getInt("BRANCH"));
						System.out.println("-----------------");

						if (!repBean.isPayrep()) {
							ReportDAO.println(SLINE, 0, 1, false, "BANK",
									repBean);

							// Branch_footer function remaining
							ReportDAO.println(SLINE, 0, 1, false, "BANK",
									repBean);
						}
						repBean.setNoEmp(0);
						ctr = 1;
						ReportDAO.println(String.valueOf((char) 15), 0, 0,
								false, "BANK", repBean);

						ReportDAO.println("", 0, 1, false, "BANK", repBean);
						// ReportDAO.println(SLINE, 0, 1, false,
						// "BANK",repBean);
						repBean.setPayrep(false);
						if (Barr1 && Barr2) {
							ReportDAO.page_head(repBean.getBrnNo(),
									repBean.getHdg1(), repBean.getHdg2(),
									repBean.getHdg3(), repBean.getHdg4(),
									repBean.getHdg5(), repBean.getHdg6(),
									repBean.getHdg7(), repBean);
						} else {
							if (Barr1) {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										repBean.getHdg3(), repBean.getHdg4(),
										repBean.getHdg5(), "",
										repBean.getHdg7(), repBean);
							} else if (Barr2) {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										"", repBean.getHdg4(),
										repBean.getHdg5(), repBean.getHdg6(),
										repBean.getHdg7(), repBean);
							} else {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										"", repBean.getHdg4(),
										repBean.getHdg5(), "",
										repBean.getHdg7(), repBean);
							}
						}
						pBranch = emp.getString("BRANCH");
					}
					DTR.beforeFirst();
					while (DTR.next()) {

						if (compareDate(outputFormat.format(inputFormat
								.parse(DTR.getString("TRNDT"))), lBomDt)
								&& compareDate(lEomDt,
										outputFormat.format(inputFormat
												.parse(DTR.getString("TRNDT"))))) // Changed
						{
							if (DTR.getInt("TRNCD") <= 200) {

								repBean.setPInc(
										repBean.getPInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotINC(
										repBean.getPRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else if (DTR.getInt("TRNCD") <= 293) {
								repBean.setPDed(
										repBean.getPDed(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotDED(
										repBean.getPRepTotDED(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							}
							if (DTR.getInt("TRNCD") == 101) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(1)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 1);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(1)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										1);
							}
							if (DTR.getInt("TRNCD") == 999) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(2)
										+ (DTR.getString("NET_AMT") == null ? 0
												: DTR.getInt("NET_AMT")), 2);
								repBean.setPTotBNGD(repBean.getPTotBNGD(3)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 3);
								repBean.setPTotBNGD(repBean.getPTotBNGD(4)
										+ (DTR.getString("CAL_AMT") == null ? 0
												: DTR.getInt("CAL_AMT")), 4);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(2)
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT")),
										2);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(3)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										3);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(4)
												+ (DTR.getString("CAL_AMT") == null ? 0
														: DTR.getInt("CAL_AMT")),
										4);
							}
						} else {
							if (DTR.getInt("TRNCD") <= 200) {
								aCtr = aCtr + 1;
								if (aCtr <= 12) {
									if (repBean.getIcode(aCtr) != DTR
											.getInt("TRNCD")) {
										while (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											if (aCtr <= 12) {
												Str1 = Str1
														+ ReportDAO.addSpaces(
																"", 14) + "|";
											} else {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
											}
											aCtr = aCtr + 1;
											if (aCtr > 24) {
												break;
											}
										}
										if (aCtr > 12) {
											Str2 = Str2
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Str2Ctr = Str2Ctr + 1;
										}
									}
									if (aCtr <= 12) {
										Str1 = Str1
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";

										if ((DTR.getString("ARR_AMT") == null ? 0
												: DTR.getInt("ARR_AMT")) != 0) {
											Arr1 = Arr1
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Arr1Ctr = Arr1Ctr + 1;
										}
									}
								} else {
									if (aCtr < 24) {
										// System.out.println("Trncd is "+DTR.getInt("TRNCD"));
										if (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getIcode(aCtr) != DTR
													.getInt("TRNCD")) {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
												aCtr = aCtr + 1;
												if (aCtr > 24)// Added by nakul
																// patil for
																// arrayindexofboundsexception
												{
													break;
												}
											}
										}
									}
									Str2 = Str2
											+ FixStr(
													trans((DTR
															.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT")),
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									Str2Ctr = Str2Ctr + 1;

								}
								repBean.setInc(
										repBean.getInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setRepTotINC(
										repBean.getRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else {
								if (DTR.getInt("TRNCD") <= 293) {
									lCtr = lCtr + 1;
									if (lCtr <= 12) {
										if (repBean.getEcode(lCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												if (lCtr <= 12) {
													Str3 = Str3
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
												} else {
													Str4 = Str4
															+ FixStr(
																	trans((DTR
																			.getString("NET_AMT") == null ? 0
																			: DTR.getInt("NET_AMT")),
																			"999,99,999.99",
																			"",
																			false,
																			false),
																	14, 3)
															+ "|";
													Str4Ctr = Str4Ctr + 1;

												}
												lCtr = lCtr + 1;
												if (lCtr > 24) {
													break;
												}

											}
											if (lCtr > 12) {
												Str4 = Str4
														+ FixStr(
																trans((DTR
																		.getString("NET_AMT") == null ? 0
																		: DTR.getInt("NET_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Str4Ctr = Str4Ctr + 1;
											}

										}
										if (lCtr <= 12) {
											Str3 = Str3
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";

											if ((DTR.getString("ARR_AMT") == null ? 0
													: DTR.getInt("ARR_AMT")) != 0) {
												Arr2 = Arr2
														+ FixStr(
																trans((DTR
																		.getString("ARR_AMT") == null ? 0
																		: DTR.getInt("ARR_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Arr2Ctr = Arr2Ctr + 1;
											}
										}
									} else {
										if (lCtr < 24) {
											if (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												while (repBean.getEcode(lCtr) != DTR
														.getInt("TRNCD")) {
													Str4 = Str4
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
													lCtr = lCtr + 1;
													if (lCtr > 24) {
														break;
													}
												}
											}
										}
										Str4 = Str4
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";
										Str4Ctr = Str4Ctr + 1;

									}
									repBean.setDed(
											repBean.getDed(DTR.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
									repBean.setRepTotDED(
											repBean.getRepTotDED(DTR
													.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
								}
							}
							if (DTR.getInt("TRNCD") == 101) {
								printBasic = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								repBean.setTotBngd(repBean.getTotBngd(1)
										+ printBasic, 1);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(1)
										+ printBasic, 1);
							}
							if (DTR.getInt("TRNCD") == 999) {
								printNet = DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								printGross = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								printTotDed = DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
								repBean.setTotBngd(repBean.getTotBngd(2)
										+ printNet, 2);
								repBean.setTotBngd(repBean.getTotBngd(3)
										+ printGross, 3);
								repBean.setTotBngd(repBean.getTotBngd(4)
										+ printTotDed, 4);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(2)
										+ printNet, 2);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(3)
										+ printGross, 3);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(4)
										+ printTotDed, 4);
							}
							if (DTR.getInt("TRNCD") == 301) {
								LOPDays = DTR.getInt("INP_AMT");
							}
						}
					}
					for (i = Arr1Ctr + 1; i <= 12; i++) {
						Arr1 = Arr1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Arr2Ctr + 1; i <= 12; i++) {
						Arr2 = Arr2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = aCtr + 1; i <= 12; i++) {
						Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = lCtr + 1; j <= 12; j++) {
						Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Str2Ctr + 1; i <= 12; i++) {
						Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = Str4Ctr + 1; j <= 12; j++) {
						Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
					}
					nm = ltrim(FixStr(
							emp.getString("LNAME").trim()
									+ "  "
									+ emp.getString("FNAME").trim()
									+ "  "
									+ emp.getString("MNAME").trim()
									+ "   "
									+ GradeHandler.GetGrade(
											emp.getInt("GRADE"), "Y", repBean),
							42, 1));
					Str1 = FixStr(String.valueOf(emp.getInt("EMPNO")), 7, 1)
							.substring(0, 7) + "|" + nm + "|" + Str1;
					Str2 = "|"
							+ FixStr(String.valueOf(emp.getString("ACNO")), 16,
									1) + ReportDAO.addSpaces("", 26) + "|"
							+ Str2;
					Str3 = FixStr(String.valueOf(count++), 7, 1)
							+ "|"
							+ FixStr(
									trans(printBasic, "99,99,999.99", "",
											false, false), 14, 3) + " "
							+ trans(LOPDays, "999", "", false, false)
							+ ReportDAO.addSpaces("", 23) + "|" + Str3;
					Str4 = "|"
							+ FixStr(
									trans(printGross, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printTotDed, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printNet, "99,99,999.99", "", false,
											false), 14, 3) + "|" + Str4;
					if (printNet < 0) {
						System.out
								.println("THIS EMPLOYEE SALARY GOES -VE PLEASE CHECK IT AND PROCESS PAYCAL AGAIN");
						return;
					}
					Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr1;
					Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr2;
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);
					if (Barr1) {
						ReportDAO.println(Arr1, 7, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str2, 7, 1, false, "BANK", repBean);
					ReportDAO.println(Str3, 0, 1, false, "BANK", repBean);
					if (Barr2) {
						ReportDAO.println(Arr2, 7, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str4, 7, 1, false, "BANK", repBean);

					PrintBlankLine(repBean);

				}
				printBasic = 0;
				printNet = 0;
				printGross = 0;
				printTotDed = 0;
				repBean.setNoEmp(repBean.getNoEmp() + 1);
				repBean.setBNoEmp(repBean.getBNoEmp() + 1);

			}
			if (!repBean.isPayrep()) {
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				// BrachFooter remaining
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			}
			repBean.setNoEmp(repBean.getBNoEmp());
			for (i = 100; i <= 200; i++) {
				repBean.setBRepTotINC(repBean.getRepTotINC(i), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setBRepTotDED(repBean.getRepTotDED(i), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setBRepTotBNGD(repBean.getRepTotBNGD(i), i);
			}
			// ***********************REMAINING**************************************
			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);

			PrintFootLines(repBean.getObjPRepTotINC(),
					repBean.getObjPRepTotDED(), repBean.getObjPRepTotBNGD(),
					"       " + "|"
							+ " Grand Total ALL BRANCHES Previous Month :"
							+ "|", repBean);

			for (i = 100; i <= 200; i++) {
				repBean.setRepTotINC(
						Math.abs(repBean.getRepTotINC(i)
								- repBean.getPRepTotINC(i)), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setRepTotDED(
						Math.abs(repBean.getRepTotDED(i)
								- repBean.getPRepTotDED(i)), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setRepTotBNGD(
						Math.abs(repBean.getRepTotBNGD(i)
								- repBean.getPRepTotBNGD(i)), i);
			}
			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"       " + "|"
							+ " Variance In SAL. OF ALL BRANCHES     :-> "
							+ "|", repBean);
			// PrintFootLines RepTotINC, RepTotDED, RepTotBNGD, "       " & "|"
			// & " Variance In Sal. Of ALL BRANCHES      :-> " & "|"
			ReportDAO.println(SLINE, 0, 4, false, "BANK", repBean);
			ReportDAO.println("AUTHORISED SIGNATORY", 130, 2, false, "BANK",
					repBean);
			// Print #fp Chr(12)
			// Print #fp Chr(18)
			repBean.setLnCount(0);
			repBean.setBrnNo(999);
			repBean.setPageNo(1);
			ReportDAO.println(String.valueOf((char) 15), 0, 4, false, "BANK",
					repBean); // ***********Remain CHr()
			temp = PAYREGDT.substring(3);
			repBean.setHdg1("Summary Of Salary Sheet For The Month Of :- "
					+ temp);
			ReportDAO.println("", 0, 1, false, "BANK", repBean);
			repBean.setPayrep(false);
			if (Barr1 && Barr2) {
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(),
						repBean.getHdg4(), repBean.getHdg5(),
						repBean.getHdg6(), repBean.getHdg7(), repBean);
			} else {
				if (Barr1) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), repBean.getHdg3(),
							repBean.getHdg4(), repBean.getHdg5(), "",
							repBean.getHdg7(), repBean);
				} else if (Barr2) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), repBean.getHdg6(),
							repBean.getHdg7(), repBean);
				} else {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), "", repBean.getHdg7(), repBean);
				}
			}

			for (int Kk = 1; Kk <= repBean.getbCode(); Kk++) {
				PaySummary(Kk, repBean);
			}
			ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			PrintFootLines(repBean.getObjBRepTotINC(),
					repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);

			ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void PfList(String rdt, String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		RepoartBean repBean = new RepoartBean();
		String SLINE = "";
		int arrcal = 0;
		Connection Cn = null;
		FileWriter Fp;
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		int pfchk = 0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(132);
		repBean.setPageLen(65);
		repBean.setFoot_Fl(true);
		ReportDAO.make_prn_file(filepath, repBean);
		repBean.setBrnNo(999);
		ReportDAO.println(String.valueOf((char) 15), 1, 1, false, "BANK",
				repBean);
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

		/*
		 * EmpSql =
		 * " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name "
		 * +
		 * ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt , b.arr_amt , t1.net_amt basic,t2.net_amt+t3.net_amt+t4.net_amt  totda,t5.net_amt pf"
		 * +
		 * " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2,PAYTRAN t3,PAYTRAN t4 ,PAYTRAN t5 "
		 * +
		 * "  Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 "
		 * + " and t2.empno = emp.empno and t2.trncd = 102 " +
		 * " and t5.empno = emp.empno and t5.trncd = 201 " +
		 * " and t3.empno = emp.empno and t3.trncd = 113 " +
		 * " and t4.empno = emp.empno and t4.trncd = 114 " +
		 * " and t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
		 * " WHERE e2.empno = emp.empno and  E2.EFFDATE <= '"+rdt+"' ) " +
		 * " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME = 2 "
		 * + " Union " +
		 * " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name"
		 * +
		 * ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt,b.arr_amt, t1.net_amt basic,t2.net_amt  totda ,t3.net_amt pf"
		 * +
		 * " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2 , PAYTRAN t3 "
		 * +
		 * " Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 "
		 * + "  and t2.empno = emp.empno and t2.trncd = 102" +
		 * "  and t3.empno = emp.empno and t3.trncd = 201" +
		 * " and t.effdate = ( SELECT MAX(E2.EFFDATE)" + " FROM EMPTRAN E2 " +
		 * " wHERE e2.empno = emp.empno and " + " E2.EFFDATE <= '"+rdt+"'  ) " +
		 * " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME <> 2"
		 * + " order by branch,empno";
		 */

		EmpSql = "select e.salute , e.empno,e.fname,e.mname,e.lname,e.pfno,p.prj_name,p.prj_srno, (select net_amt from ytdtran where trncd=101 and empno=e.empno and trndt between '"
				+ ReportDAO.BOM(rdt)
				+ "' and '"
				+ ReportDAO.EOM(rdt)
				+ "') basic,"
				+ "(select net_amt from ytdtran where trncd=201 and empno=e.empno and trndt between '"
				+ ReportDAO.BOM(rdt)
				+ "' and '"
				+ ReportDAO.EOM(rdt)
				+ "') as pf,"
				+ "(select net_amt from ytdtran where trncd=102 and empno=e.empno and trndt between '"
				+ ReportDAO.BOM(rdt)
				+ "' and '"
				+ ReportDAO.EOM(rdt)
				+ "') da,"
				+ "(select net_amt from ytdtran where trncd=199 and empno=e.empno and upddt between '"
				+ ReportDAO.BOM(rdt)
				+ "' and '"
				+ ReportDAO.EOM(rdt)
				+ "') ctc,"
				+ "(select arr_amt from ytdtran where trncd=201 and empno=e.empno and upddt between '"
				+ ReportDAO.BOM(rdt)
				+ "' and '"
				+ ReportDAO.EOM(rdt)
				+ "') arr_amt "
				+ "from empmast e, prj p,emptran t where e.status = 'A' and t.empno= e.empno and t.prj_srno=p.prj_srno order by p.prj_srno,e.empno";

		SLINE = stringOfSize(132, '-');
		// System.out.println("pf query"+EmpSql);
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);
			// System.out.println(EmpSql);
			if (!emp.next()) {
				System.out.println("No Any Record Found");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			repBean.setHdg1("Project Wise Provident Fund List");
			repBean.setHdg2("For The Month Of :-" + rdt.substring(3, 11));
			repBean.setHdg3("empno NAME OF EMPLOYEE                       PFNO       Basic         DA             Gross      PF           @8.33%       @3.67%    ");
			repBean.setHdg4("                                                                                         Arrears                           ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(),
					repBean.getHdg5(), repBean.getHdg6(), repBean.getHdg7(),
					repBean);
			int i;
			for (i = 1; i <= 7; i++) {
				ALLbrtot[i] = 0;
			}
			emp.previous();
			while (emp.next()) {
				for (i = 1; i <= 7; i++) {
					brtot[i] = 0;
				}

				ReportDAO.println(emp.getString("prj_name"), 1, 1, false,
						"BANK", repBean);
				ReportDAO.println("", 0, 1, false, "BANK", repBean);
				PBRCD = emp.getInt("prj_srno");
				while (PBRCD == emp.getInt("prj_srno")) {
					// System.out.println(""+emp.getInt("EMPNO"));
					if (emp.getInt("EMPNO") < 10) {
						ReportDAO.println("0" + emp.getInt("EMPNO"), 1, 0,
								false, "BANK", repBean);
					} else {
						ReportDAO.println(String.valueOf(emp.getInt("EMPNO")),
								1, 0, false, "BANK", repBean);
					}
					String salute = new LookupHandler().getLKP_Desc("SALUTE",
							Integer.parseInt(emp.getString("SALUTE")));

					if (emp.getString("MNAME").equals(null)
							|| emp.getString("MNAME").equals("")) {
						ReportDAO.println(
								FixStr(salute + emp.getString("FNAME") + " "
										+ emp.getString("MNAME") + " "
										+ emp.getString("LNAME"), 30, 1), 7, 0,
								false, "BANK", repBean);
					} else {

						ReportDAO
								.println(
										FixStr(salute
												+ emp.getString("FNAME")
												+ " "
												+ emp.getString("MNAME")
														.charAt(0) + ". "
												+ emp.getString("LNAME"), 30, 1),
										7, 0, false, "BANK", repBean);
					}

					ReportDAO.println(FixStr(emp.getString("PFNO"), 15, 1), 38,
							0, false, "BANK", repBean);
					ReportDAO.println(
							trans(emp.getInt("BASIC"), "999,999.99", "", false,
									false), 55, 0, false, "BANK", repBean);
					brtot[1] = brtot[1] + Math.round(emp.getInt("BASIC"));
					ReportDAO.println(
							trans(emp.getInt("DA"), "999,999.99", "", false,
									false), 66, 0, false, "BANK", repBean);
					brtot[2] = brtot[2] + Math.round(emp.getInt("DA"));
					gross = (emp.getString("BASIC") != null ? 0 : emp
							.getInt("BASIC"))
							+ (emp.getString("DA") != null ? 0 : emp
									.getInt("DA"));
					if (gross >= 6500) {
						gross = 6500;
					}
					brtot[3] = brtot[3] + gross;
					ReportDAO.println(
							trans(gross, "999,999.99", "", false, false), 79,
							0, false, "BANK", repBean);
					ReportDAO.println(
							trans(emp.getInt("PF"), "999,999.99", "", false,
									false), 92, 0, false, "BANK", repBean);
					brtot[4] = brtot[4] + emp.getInt("PF");
					pfchk = (int) (Math.round(gross * 0.0367) + Math
							.round(gross * 0.0833));
					if (pfchk < emp.getInt("PF")) {
						pfchk = emp.getInt("PF") - pfchk;
					} else if (emp.getInt("PF") < pfchk) {
						pfchk = emp.getInt("PF") - pfchk;
					} else
						pfchk = 0;
					ReportDAO.println(
							trans((int) Math.round(gross * 0.0833) + pfchk,
									"999,999.99", "", false, false), 105, 0,
							false, "BANK", repBean);
					brtot[5] = (brtot[5] + (int) (Math.round(gross * 0.0833)) + pfchk);
					ReportDAO.println(
							trans((int) Math.round(gross * 0.0367),
									"999,999.99", "", false, false), 118, 1,
							false, "BANK", repBean);
					brtot[6] = brtot[6] + (int) (Math.round(gross * 0.0367));
					if (!(emp.getString("ARR_AMT") == null)) {
						if (emp.getInt("ARR_AMT") != 0) {
							ReportDAO.println(
									trans(emp.getInt("ARR_AMT"), "999,999.99",
											"", false, false), 92, 0, false,
									"BANK", repBean);
							brtot[4] = brtot[4] + emp.getInt("ARR_AMT");
							arrcal = (int) Math
									.round(emp.getInt("ARR_AMT") * 8.33 / 12);
							brtot[5] = brtot[5] + arrcal;
							arrcal = emp.getInt("ARR_AMT") - arrcal;
							ReportDAO.println(
									trans((int) (arrcal * 8.33), "999,999.99",
											"", false, false), 118, 0, false,
									"BANK", repBean);
							brtot[6] = brtot[6] + arrcal;

						}
					}
					if (!emp.next()) {
						break;
					}
					if (PBRCD != emp.getInt("prj_srno")) {
						emp.previous();
						break;
					}
				}
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				ReportDAO
						.println("Project Total", 0, 0, false, "BANK", repBean);
				ReportDAO.println(
						trans(brtot[1], "999,999.99", "", false, false), 55, 0,
						false, "BANK", repBean);
				ALLbrtot[1] = ALLbrtot[1] + brtot[1];
				ReportDAO.println(
						trans(brtot[2], "999,999.99", "", false, false), 66, 0,
						false, "BANK", repBean);
				ALLbrtot[2] = ALLbrtot[2] + brtot[2];
				ReportDAO.println(
						trans(brtot[3], "999,999.99", "", false, false), 79, 0,
						false, "BANK", repBean);
				ALLbrtot[3] = ALLbrtot[3] + brtot[3];
				ReportDAO.println(
						trans(brtot[4], "999,999.99", "", false, false), 92, 0,
						false, "BANK", repBean);
				ALLbrtot[4] = ALLbrtot[4] + brtot[4];
				ReportDAO.println(
						trans(brtot[5], "999,999.99", "", false, false), 105,
						0, false, "BANK", repBean);
				ALLbrtot[5] = ALLbrtot[5] + brtot[5];
				ReportDAO.println(
						trans(brtot[6], "999,999.99", "", false, false), 118,
						1, false, "BANK", repBean);
				ALLbrtot[6] = ALLbrtot[6] + brtot[6];
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);

			}
			ReportDAO.println("All Branch Total :  ", 0, 0, false, "BANK",
					repBean);
			ReportDAO.println(
					trans(ALLbrtot[1], "99,99,999.99", "", false, false), 50,
					0, false, "BANK", repBean);
			ReportDAO.println(
					trans(ALLbrtot[2], "99,99,999.99", "", false, false), 63,
					0, false, "BANK", repBean);
			ReportDAO.println(
					trans(ALLbrtot[3], "99,99,999.99", "", false, false), 76,
					0, false, "BANK", repBean);
			ReportDAO.println(
					trans(ALLbrtot[4], "99,99,999.99", "", false, false), 89,
					0, false, "BANK", repBean);
			ReportDAO.println(
					trans(ALLbrtot[5], "99,99,999.99", "", false, false), 102,
					0, false, "BANK", repBean);
			ReportDAO.println(
					trans(ALLbrtot[6], "99,99,999.99", "", false, false), 115,
					0, false, "BANK", repBean);
			ReportDAO.println(SLINE, 0, 4, false, "BANK", repBean);

			ReportDAO.println("AUTHORISED SIGNATORY", 80, 2, false, "BANK",
					repBean);
			// Print #fp Chr(12)
			// Print #fp Chr(18)
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	public static void EMPLIST(String rdt, String rdt1, String EMPBRN,
			String filepath, String imagepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;
		String SLINE = "";

		ResultSet emp = null;
		String EmpSql = "";

		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		String pBrcd1 = "";
		int gross = 0;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		if (!(EMPBRN.equalsIgnoreCase("J"))) {
			ReportDAO.inithead(repBean);
			repBean.setLnCount(0);
			repBean.setPageNo(1);
			repBean.setLineLen(80);
			repBean.setPageLen(65);
			repBean.setFoot_Fl(true);
			ReportDAO.make_prn_file(filepath, repBean);
			repBean.setBrnNo(999);

		}

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");

		if (EMPBRN.equalsIgnoreCase("A")) {
			/*
			 * EmpSql =
			 * " select emp.empno,emp.empcode,emp.salute,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) "
			 * +
			 * " name ,EMP.DOB,EMP.DOJ,DATEDIFF(YEAR,EMP.DOB,GETDATE()) as Age from empmast emp"
			 * + " where emp.status = 'A' order by age desc ";
			 */
			EmpSql = " select emp.empcode,emp.salute,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) "
					+ " name ,EMP.DOB,EMP.DOJ,DATEDIFF(YEAR,EMP.DOB,GETDATE()) as Age from empmast emp"
					+ " where emp.status = 'A' order by age desc,emp.empcode ";
			// repBean.setHdg1("Age Wise Employee List For :-" +
			// rdt.substring(3, 11));
		} else if (EMPBRN.equals("B")) {
			/*
			 * EmpSql =
			 * " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno"
			 * + " from empmast emp, emptran t , branch s , grade g " +
			 * " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
			 * + " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '" + rdt +
			 * "'  ) " + " and emp.status = 'A' and s.brcd = t.branch " +
			 * " order by t.branch,emp.empno ";
			 */
			/*
			 * EmpSql =
			 * " select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.prj_srno ,s.prj_name,t.DESIG ,t.acno"
			 * + " from empmast emp, emptran t , prj s" +
			 * " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
			 * + " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '" + rdt +
			 * "'  ) " + " and emp.status = 'A' and s.prj_srno = t.prj_srno " +
			 * " order by t.prj_srno,emp.empno ";
			 */
			EmpSql = " select emp.empcode,emp.salute,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.DESIG,t.acno"
					+ " from empmast emp, emptran t , branch s "
					+ " Where EMP.EMPNO = T.EMPNO and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <=  '"
					+ rdt
					+ "'  ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by t.branch,emp.empcode ";

			// repBean.setHdg1("Branch Wise List For :-" + rdt.substring(3,
			// 11));
		} else if (EMPBRN.equalsIgnoreCase("J")) {
			/*
			 * EmpSql=
			 * "SELECT E.EMPNO ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,T.DESIG FROM EMPMAST E,EMPTRAN T  "
			 * +
			 * "WHERE E.EMPNO=T.EMPNO and E.DOJ BETWEEN  '"+ReportDAO.BOM(rdt)+
			 * "' AND '"+ReportDAO.EOM(rdt)+"' ORDER BY E.DOJ,E.EMPNO";
			 */
			EmpSql = "SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ FROM EMPMAST E "
					+ "WHERE E.DOJ BETWEEN  '"
					+ ReportDAO.BOM(rdt)
					+ "' AND '"
					+ ReportDAO.EOM(rdt1) + "' ORDER BY E.DOJ,E.EMPNO";
			// System.out.println(EmpSql);
		} else if (EMPBRN.equalsIgnoreCase("L"))// here check status ='n' and
												// dol
		{
			/*
			 * EmpSql=
			 * "SELECT E.EMPNO ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL,T.DESIG FROM EMPMAST E,EMPTRAN T  "
			 * + "WHERE E.EMPNO=T.EMPNO and E.STATUS='N' AND E.DOL BETWEEN  '"+
			 * ReportDAO
			 * .BOM(rdt)+"' AND '"+ReportDAO.EOM(rdt)+"' ORDER BY E.DOJ,E.EMPNO"
			 * ;
			 */
			EmpSql = "SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL FROM EMPMAST E "
					+ "WHERE E.STATUS='N' AND E.DOL BETWEEN  '"
					+ ReportDAO.BOM(rdt)
					+ "' AND '"
					+ ReportDAO.EOM(rdt1)
					+ "'ORDER BY E.DOJ,E.EMPNO";
			// System.out.println(EmpSql);

		} else if (EMPBRN.equalsIgnoreCase("An")) {
			EmpSql = "SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOB,DATEADD(YEAR,60,DOB) as Ann "
					+ "FROM EMPMAST E WHERE STATUS = 'A' "
					+
					// "and DATEPART(MM,DOB)BETWEEN datepart(mm,'"+ReportDAO.BOM(rdt)+"') and datepart(mm,'"+ReportDAO.EOM(rdt1)+"') and "
					// +
					// "DATEPART(YEAR,dateadd(YEAR,60,DOB)) BETWEEN datepart(YEAR,'"+ReportDAO.BOM(rdt)+"') and datepart(YEAR,'"+ReportDAO.EOM(rdt1)+"') "
					// +
					"and dateadd(YEAR,60,DOB) >='"
					+ ReportDAO.BOM(rdt)
					+ "' and  dateadd(YEAR,60,DOB) <='"
					+ ReportDAO.EOM(rdt1)
					+ "' " + "ORDER BY E.DOB,E.EMPNO";
			// System.out.println(EmpSql);

		} else if (EMPBRN.equalsIgnoreCase("C")) {
			EmpSql = "SELECT E.EMPNO,E.EMPCODE ,E.SALUTE ,E.FNAME,E.MNAME,E.LNAME,E.DOJ,E.DOL,E.STATUS FROM EMPMAST E  ORDER BY E.STATUS, E.EMPNO";
		} else if (EMPBRN.equalsIgnoreCase("G")) {
			EmpSql = "select * from LOOKUP where LKP_CODE = 'gd' and LKP_SRNO <> 0";

		}

		else if (EMPBRN.equalsIgnoreCase("P")) {
			EmpSql = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,"
					+ " EMP.DOB,EMP.DOJ,t.DESIG,t.PRJ_SRNO "
					+ " from empmast emp,emptran t where emp.status = 'A' AND t.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 "
					+ " WHERE E2.EMPNO = emp.EMPNO "
					+ " )  and emp.empno = t.empno order by t.PRJ_SRNO,emp.empcode";
		} else if (EMPBRN.equalsIgnoreCase("S")) {
			EmpSql = "select emp.empcode,emp.empno,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,"
					+ "EMP.DOJ,t.DESIG,t.PRJ_SRNO from empmast emp,emptran t where emp.status = 'A' AND "
					+ "t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
					+ rdt
					+ "')  "
					+ "and emp.empno = t.empno order by t.PRJ_SRNO,t.DESIG,emp.empcode";
		}

		else {

			/*
			 * EmpSql =
			 * "  select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,"
			 * + /*EmpSql =
			 * "  select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,"
			 * + " EMP.DOB,EMP.DOJ,t.DESIG " +
			 * " from empmast emp,emptran t   where emp.status = 'A'  and emp.empno = t.empno order by t.DESIG"
			 * ;
			 */
			/*
			 * EmpSql =
			 * "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,"
			 * +
			 * 
			 * " EMP.DOB,EMP.DOJ,t.DESIG " +
			 * 
			 * " from empmast emp,emptran t   where emp.status = 'A'  and emp.empno = t.empno order by t.DESIG"
			 * ;
			 */
			/*
			 * EmpSql =
			 * "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,"
			 * + " EMP.DOB,EMP.DOJ,t.DESIG, t.DEPT " +
			 * " from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 "
			 * + " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '" + rdt +
			 * "') order by t.dept,emp.empcode";
			 */

			// new query for active employee and display it designation
			// wise..@ni
			EmpSql = "SELECT emp.empcode, emp.salute, emp.empno, "
					+ "Rtrim(emp.fname) + ' ' + Rtrim(emp.mname) + ' '  + Rtrim(emp.lname)              NAME, "
					+ "EMP.dob,  EMP.doj, t.desig, t.dept, "
					+ "(SELECT 'Not Entered' FROM   lookup WHERE  lkp_code = 'ed' "
					+ "AND lkp_srno = q.degree)AS qual "
					+ "FROM   empmast emp, emptran t,qual q "
					+ "WHERE  emp.status = 'A' AND emp.empno NOT IN(SELECT DISTINCT empno "
					+ "FROM   qual WHERE  empno = emp.empno) "
					+ "AND q.srno = (SELECT Max(q1.srno) "
					+ "FROM   qual q1 WHERE  q1.empno <> emp.empno) "
					+ "AND emp.empno = t.empno AND t.effdate = (SELECT Max(E2.effdate) "
					+ "FROM   emptran E2 WHERE  E2.empno = emp.empno "
					+ "AND E2.effdate <= '"
					+ rdt
					+ "') "
					+ "AND t.srno IN(SELECT Max(srno) FROM emptran e3 WHERE  e3.empno = t.empno) "

					+ "UNION "
					+ "SELECT emp.empcode, emp.salute, emp.empno, "
					+ "Rtrim(emp.fname) + ' ' + Rtrim(emp.mname) + ' ' + Rtrim(emp.lname)              NAME, "
					+ "EMP.dob, EMP.doj, t.desig, t.dept, "
					+ "(SELECT lkp_disc FROM lookup WHERE  lkp_code = 'ed' AND lkp_srno = q.degree)AS qual "
					+ "FROM   empmast emp, emptran t, qual q WHERE  emp.status = 'A' "
					+ "AND q .empno = t.empno AND q.srno = (SELECT Max(q1.srno) "
					+ "FROM   qual q1 WHERE  q1.empno = emp.empno) "
					+ "AND emp.empno = t.empno AND t.effdate = (SELECT Max(E2.effdate) "
					+ "FROM   emptran E2 WHERE  E2.empno = emp.empno "
					+ "AND E2.effdate <= '"
					+ rdt
					+ "') "
					+ "AND t.srno IN(SELECT Max(srno) FROM emptran e3 WHERE  e3.empno = t.empno) "
					+ "ORDER  BY t.DESIG,qual";

			// repBean.setHdg1("Desig'n Wise Employee List For :-" +
			// rdt.substring(3, 11));

			/*
			 * " from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno order by t.desig,emp.empcode"
			 * ;
			 */
			// repBean.setHdg1("Desig'n Wise Employee List For :-" +
			// rdt.substring(3, 11));

		}
		// SLINE = stringOfSize(80, '-');
		// System.out.println("-------------===="+EmpSql);
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			if (!(EMPBRN.equalsIgnoreCase("J") || EMPBRN.equalsIgnoreCase("L") || EMPBRN
					.equalsIgnoreCase("C"))) {

				emp = st.executeQuery(EmpSql);
				// System.out.println(EmpSql+"empsql");
				if (!emp.next()) {
					System.out.println("No Any Record Found");
					// Fp = repBean.getFp();
					// Fp.close();
					// return;
				}
				alltot = 0;

				emp.beforeFirst();
			}

			if (EMPBRN.equals("A")) {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase(
							"Age Wise Employee List For :-"
									+ rdt.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(5);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(
							new float[] { 10, 50, 10, 15, 15 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Age", new Font(
								Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						while (emp.next()) {
							pBrcd1 = emp.getString("Age");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase(
									"Employee's List for Age : "
											+ emp.getString("Age"), new Font(
											Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (pBrcd1.equals(emp.getString("Age"))) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										50, 10, 15, 15 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ emp.getString("Age"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOB")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (!pBrcd1.equals(emp.getString("Age"))) {
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));

						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}

				/*
				 * repBean.setHdg3(
				 * "Empno Name Of Employee                         Age            DOB           DOJ"
				 * ); ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
				 * repBean.getHdg2(), repBean.getHdg3(), "", "", "",
				 * "",repBean); tot_no_emp = 0; while (emp.next()) {
				 * ReportDAO.println("", 0, 1, false, "BANK",repBean);
				 * ReportDAO.println("Age :- ", 0, 0, false, "BANK",repBean);
				 * ReportDAO.println(emp.getString("Age"), 14, 1, false,
				 * "BANK",repBean); ReportDAO.println(SLINE, 0, 1, false,
				 * "BANK",repBean);
				 * 
				 * pBrcd1 = emp.getString("Age"); br_tot_no_emp = 0; while
				 * (pBrcd1.equals(emp.getString("Age"))) {
				 * ReportDAO.println(emp.getString("EMPNO"), 0, 0, false,
				 * "BANK",repBean);
				 * ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1), 7, 0,
				 * false, "BANK",repBean); ReportDAO.println(
				 * FixStr(emp.getString("Age"), 10, 1), 45, 0, false,
				 * "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("dob"))), 10, 1), 57, 0, false,
				 * "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("doj"))), 10, 1), 70, 1, false,
				 * "BANK",repBean); tot_no_emp = tot_no_emp + 1; br_tot_no_emp =
				 * br_tot_no_emp + 1; if (!emp.next()) { break; }
				 * if(!pBrcd1.equals(emp.getString("Age"))){ emp.previous();
				 * break; } } ReportDAO.println(SLINE, 0, 1, false,
				 * "BANK",repBean); ReportDAO.println("No Of Emp :", 0, 0,
				 * false, "BANK",repBean);
				 * ReportDAO.println(""+br_tot_no_emp,42, 0, false,
				 * "BANK",repBean); ReportDAO.println(SLINE, 0, 1, false,
				 * "BANK",repBean); alltot = alltot + gross; gross = 0; }
				 */
			} else if (EMPBRN.equals("B")) {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Branch Wise List For :-"
							+ rdt.substring(3, 11), new Font(Font.TIMES_ROMAN,
							10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(5);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(
							new float[] { 10, 35, 25, 15, 15 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						LookupHandler lkph = new LookupHandler();
						while (emp.next()) {
							PBRCD = emp.getInt("branch");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase(
									"Employee's List Of Branch : "
											+ emp.getString("brname"),
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (PBRCD == emp.getInt("branch")) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										35, 25, 15, 15 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								String desc = lkph.getLKP_Desc("DESIG",
										emp.getInt("DESIG"));
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ desc, new Font(Font.TIMES_ROMAN, 8,
										Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOB")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (PBRCD != emp.getInt("branch")) {
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));

						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}

				/*
				 * repBean.setHdg3(
				 * "Empno  Name Of Employee                      Desig            DOB           DOJ"
				 * ); ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
				 * repBean.getHdg2(), repBean.getHdg3(), "", "", "",
				 * "",repBean); LookupHandler lkph = new LookupHandler(); while
				 * (emp.next()) { ReportDAO.println("", 0, 1, false,
				 * "BANK",repBean); ReportDAO.println("Branch :- ", 0, 0, false,
				 * "BANK",repBean); ReportDAO.println(emp.getString("prj_name"),
				 * 14, 1, false, "BANK",repBean); ReportDAO.println(SLINE, 0, 1,
				 * false, "BANK",repBean); PBRCD = emp.getInt("PRJ_SRNO");
				 * br_tot_no_emp = 0; while (PBRCD == emp.getInt("PRJ_SRNO")) {
				 * ReportDAO.println(emp.getString("EMPNO"), 0, 0, false,
				 * "BANK",repBean);
				 * ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1), 7, 0,
				 * false, "BANK",repBean); String desc =
				 * lkph.getLKP_Desc("DESIG", emp.getInt("DESIG"));
				 * ReportDAO.println(FixStr(desc, 10, 1), 45, 0, false,
				 * "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("dob"))), 10, 1), 57, 0, false,
				 * "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("doj"))), 10, 1), 70, 1, false,
				 * "BANK",repBean); br_tot_no_emp = br_tot_no_emp + 1;
				 * tot_no_emp = tot_no_emp + 1; if (!emp.next()) { break; }
				 * if(PBRCD != emp.getInt("PRJ_SRNO")){ emp.previous(); break; }
				 * } ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
				 * ReportDAO.println("No Of Emp :", 0, 0, false,
				 * "BANK",repBean); ReportDAO.println(""+br_tot_no_emp,42, 0,
				 * false, "BANK",repBean); ReportDAO.println(SLINE, 0, 1, false,
				 * "BANK",repBean); alltot = alltot + gross;
				 * 
				 * gross = 0; //
				 * Remaining......................................***********
				 * 
				 * // * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66 //*
				 * PageNo = 0 println "", 0, Fp, 1 End If
				 * 
				 * 
				 * }
				 */
			} else if (EMPBRN.equals("P")) {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase(
							"Employees List According To Project Sites "
									+ rdt.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(5);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(
							new float[] { 10, 35, 25, 15, 15 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Project",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;

						while (emp.next()) {
							String prj_name = null;
							String prj_Code = null;
							Connection conn = ConnectionManager
									.getConnectionTech();
							Statement stmt = conn.createStatement();
							String prjquery = "select Site_Name,Project_Code from Project_Sites where Site_ID = '"
									+ emp.getString("PRJ_SRNO") + "'";
							// System.out.println(prjquery);
							ResultSet prj = stmt.executeQuery(prjquery);
							if (prj.next()) {
								prj_name = prj.getString("Site_Name");
								prj_Code = prj.getString("Project_Code");
							}
							pBrcd1 = emp.getString("PRJ_SRNO");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase(
									"Employee's List Of Project Site Wise : "
											+ prj_name + " (" + prj_Code + ")",
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);
							prj.close();
							stmt.close();
							conn.close();
							while (pBrcd1.equals(emp.getString("PRJ_SRNO"))) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										35, 25, 15, 15 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ prj_Code, new Font(Font.TIMES_ROMAN,
										8, Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOB")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (!pBrcd1.equals(emp.getString("PRJ_SRNO"))) {
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));
						c1.setColspan(5);
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}
			} else if (EMPBRN.equals("G")) {

				try {
					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));

					/*
					 * HeaderFooter footer = new HeaderFooter( new Phrase("",
					 * new Font(Font.TIMES_ROMAN,10)), true);
					 * footer.setBorder(Rectangle.NO_BORDER);
					 * footer.setAlignment(Element.ALIGN_RIGHT);
					 * doc.setFooter(footer);
					 */
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase(
							"Grade  Wise Employee List For : "
									+ rdt.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(5);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(
							new float[] { 10, 35, 25, 15, 15 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int desig = 0;

						while (emp.next()) {
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("GD",
									emp.getInt("LKP_SRNO"));
							// int j = emp.getInt("LKP_SRNO");
							para = new Paragraph(new Phrase(
									"Employee's List For Grade : " + desc,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);
							br_tot_no_emp = 0;
							String EmpSql2 = "select lkp_srno from LOOKUP where LKP_CODE = 'desig' and LKP_RECR = "
									+ emp.getInt("LKP_SRNO");
							Statement stmt = Cn.createStatement();
							ResultSet rst = stmt.executeQuery(EmpSql2);
							while (rst.next()) {

								String EmpSql3 = "  select emp.empcode,emp.salute,emp.empno,rtrim(emp.fname)+' '+rtrim(emp.mname)+' '+rtrim(emp.lname) name ,"
										+ " EMP.DOB,EMP.DOJ,t.DESIG, t.DEPT "
										+ " from empmast emp,emptran t where emp.status = 'A'  and emp.empno = t.empno and t.desig ="
										+ rst.getInt("LKP_SRNO")
										+ "  and emp.empno = t.empno AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 "
										+ " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
										+ rdt
										+ "') order by t.desig,emp.empcode";

								Statement stmt1 = Cn.createStatement();
								ResultSet rst1 = stmt1.executeQuery(EmpSql3);

								while (rst1.next()) {
									datatab = new PdfPTable(5);
									datatab.setWidthPercentage(new float[] {
											10, 35, 25, 15, 15 }, rec);
									datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
									PdfPCell cell1 = new PdfPCell(new Phrase(""
											+ rst1.getString("EMPCODE"),
											new Font(Font.TIMES_ROMAN, 8,
													Font.NORMAL)));
									datatab.addCell(cell1);
									PdfPCell cell2 = new PdfPCell(new Phrase(""
											+ lkhp.getLKP_Desc("SALUTE",
													rst1.getInt("SALUTE"))
											+ " " + rst1.getString("name"),
											new Font(Font.TIMES_ROMAN, 8,
													Font.NORMAL)));
									datatab.addCell(cell2);
									PdfPCell cell3 = new PdfPCell(new Phrase(""
											+ lkhp.getLKP_Desc("DESIG",
													rst.getInt("LKP_SRNO")),
											new Font(Font.TIMES_ROMAN, 8,
													Font.NORMAL)));
									datatab.addCell(cell3);
									PdfPCell cell4 = new PdfPCell(new Phrase(""
											+ EmpOffHandler.dateFormat(rst1
													.getDate("DOB")), new Font(
											Font.TIMES_ROMAN, 8, Font.NORMAL)));
									datatab.addCell(cell4);
									PdfPCell cell5 = new PdfPCell(new Phrase(""
											+ EmpOffHandler.dateFormat(rst1
													.getDate("DOJ")), new Font(
											Font.TIMES_ROMAN, 8, Font.NORMAL)));
									datatab.addCell(cell5);

									doc.add(datatab);

									tot_no_emp = tot_no_emp + 1;
									br_tot_no_emp = br_tot_no_emp + 1;

								}

							}
							para = new Paragraph(new Phrase(
									"No Of Employee's : " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee's : " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);

					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));

						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}
			} else if (EMPBRN.equals("S")) {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase("Employees List "
							+ rdt.substring(3, 11), new Font(Font.TIMES_ROMAN,
							10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(7);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[] { 4, 5, 30, 10, 18,
							25, 8 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);
					LookupHandler lkhp = new LookupHandler();
					emp = st.executeQuery(EmpSql);

					if (emp.next()) {
						emp.beforeFirst();
						// headtab.setSpacingBefore(10);
						PdfPCell c0 = new PdfPCell(new Phrase("SR NO",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c0);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Designation",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase("Qualification",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c5);
						PdfPCell c6 = new PdfPCell(new Phrase("Monthly CTC",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c6);

						PdfPTable datatab;
						tot_no_emp = 0;
						int srno = 1;

						while (emp.next()) {
							String prj_name = null;
							String prj_Code = null;
							Connection conn = ConnectionManager
									.getConnectionTech();
							Statement stmt = conn.createStatement();
							String prjquery = "select Site_Name,Project_Code from Project_Sites where Site_ID = '"
									+ emp.getString("PRJ_SRNO") + "'";
							// System.out.println(prjquery);
							ResultSet prj = stmt.executeQuery(prjquery);
							if (prj.next()) {
								prj_name = prj.getString("Site_Name");
								prj_Code = prj.getString("Project_Code");
							}
							pBrcd1 = emp.getString("PRJ_SRNO");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase("Project Name : "
									+ prj_name + " (" + prj_Code + ")",
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingBefore(5);
							doc.add(para);
							doc.add(headtab);
							prj.close();
							stmt.close();
							conn.close();
							int desig = 0;
							while (pBrcd1.equals(emp.getString("PRJ_SRNO"))) {
								datatab = new PdfPTable(7);
								datatab.setWidthPercentage(new float[] { 4, 5,
										30, 10, 18, 25, 8 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell0 = new PdfPCell(new Phrase(""
										+ srno, new Font(Font.TIMES_ROMAN, 8,
										Font.NORMAL)));
								datatab.addCell(cell0);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("DESIG",
												emp.getInt("DESIG")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								Statement ss = Cn.createStatement();
								String edu = "SELECT DEGREE FROM QUAL WHERE EMPNO ="
										+ emp.getInt("EMPNO") + "order by srno";
								ResultSet qul = ss.executeQuery(edu);
								String disp_edu = "";
								String disp = "";
								while (qul.next()) {
									disp_edu = lkhp.getLKP_Desc("ED",
											qul.getInt("DEGREE"));
									disp = disp + disp_edu + " ,";
								}
								if (disp.endsWith(",")) {
									disp = disp.substring(0, disp.length() - 1);
								}
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ disp, new Font(Font.TIMES_ROMAN, 8,
										Font.NORMAL)));
								datatab.addCell(cell5);

								String ctc = "select sum(inp_amt) from ctcdisplay where empno="
										+ emp.getInt("EMPNO");
								ResultSet ctcrs = ss.executeQuery(ctc);
								PdfPCell cell6;
								if (ctcrs.next())
									cell6 = new PdfPCell(new Phrase(""
											+ ctcrs.getFloat(1), new Font(
											Font.TIMES_ROMAN, 8, Font.NORMAL)));
								else
									cell6 = new PdfPCell(new Phrase("--",
											new Font(Font.TIMES_ROMAN, 8,
													Font.NORMAL)));
								datatab.addCell(cell6);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								srno = srno + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (!pBrcd1.equals(emp.getString("PRJ_SRNO"))) {
									emp.previous();
									break;
								}

							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));
						c1.setColspan(5);
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}

			} else if (EMPBRN.equals("J") || EMPBRN.equalsIgnoreCase("L")
					|| EMPBRN.equalsIgnoreCase("C")
					|| EMPBRN.equalsIgnoreCase("An")) {
				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 740f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					if (EMPBRN.equalsIgnoreCase("J")) {

						// para = new Paragraph(new
						// Phrase("Employees List According to Date Of joining for Month -"+rdt.substring(3),new
						// Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase(
								"Employees List According to Date Of joining from "
										+ rdt.substring(3) + " To "
										+ rdt1.substring(3), new Font(
										Font.TIMES_ROMAN, 10)));

					} else if (EMPBRN.equalsIgnoreCase("L")) {
						// para = new Paragraph(new
						// Phrase("Employees List According to Date Of Leaving "+rdt.substring(3),new
						// Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase(
								"Employees List According to Date Of Leaving from "
										+ rdt.substring(3) + " To "
										+ rdt1.substring(3), new Font(
										Font.TIMES_ROMAN, 10)));
					} else if (EMPBRN.equalsIgnoreCase("An")) {
						// para = new Paragraph(new
						// Phrase("Employees List According to Date Of Leaving "+rdt.substring(3),new
						// Font(Font.TIMES_ROMAN,10)));
						para = new Paragraph(new Phrase(
								"Employees List According to Date Of Anotation from "
										+ rdt.substring(3) + " To "
										+ rdt1.substring(3), new Font(
										Font.TIMES_ROMAN, 10)));
					} else {
						para = new Paragraph(new Phrase("All Employees List ",
								new Font(Font.TIMES_ROMAN, 10)));
					}
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;
					if (EMPBRN.equals("L") || EMPBRN.equals("An")) {
						headtab = new PdfPTable(5);
						headtab.setWidthPercentage(new float[] { 10, 10, 50,
								15, 15 }, rec);
					} else if (EMPBRN.equalsIgnoreCase("C")) {
						headtab = new PdfPTable(5);
						headtab.setWidthPercentage(new float[] { 10, 10, 40,
								20, 20 }, rec);
					} else {
						headtab = new PdfPTable(4);
						headtab.setWidthPercentage(
								new float[] { 10, 10, 50, 30 }, rec);
					}
					headtab.setSpacingBefore(10);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);
					emp = st.executeQuery(EmpSql);
					if (emp.next()) {
						emp.beforeFirst();
						PdfPCell c1 = new PdfPCell(new Phrase("Sr.No",
								new Font(FONT.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Emp Code",
								new Font(FONT.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Employee Name",
								new Font(FONT.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(FONT.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c4);
						if (EMPBRN.equalsIgnoreCase("L")) {
							PdfPCell c5 = new PdfPCell(new Phrase(
									"Date of Leaving", new Font(
											FONT.TIMES_ROMAN, 8, Font.BOLD)));
							headtab.addCell(c5);
						}
						if (EMPBRN.equalsIgnoreCase("An")) {
							PdfPCell c5 = new PdfPCell(new Phrase(
									"Date of Anotation", new Font(
											FONT.TIMES_ROMAN, 8, Font.BOLD)));
							headtab.addCell(c5);
						}
						if (EMPBRN.equalsIgnoreCase("C")) {
							PdfPCell c5 = new PdfPCell(new Phrase("Status",
									new Font(FONT.TIMES_ROMAN, 8, Font.BOLD)));
							headtab.addCell(c5);
						}

						doc.add(headtab);

						int j = 0;
						LookupHandler lkhp = new LookupHandler();

						while (emp.next()) {
							j++;

							PdfPTable datatab;
							if (EMPBRN.equalsIgnoreCase("L")
									|| EMPBRN.equalsIgnoreCase("An")) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										10, 50, 15, 15 }, rec);

							} else if (EMPBRN.equalsIgnoreCase("C")) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										10, 40, 20, 20 }, rec);

							} else {
								datatab = new PdfPTable(4);
								datatab.setWidthPercentage(new float[] { 10,
										10, 50, 30 }, rec);
							}

							// System.out.println(""+j);

							datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
							PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
									new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""
									+ emp.getString("EMPCODE"), new Font(
									FONT.TIMES_ROMAN, 8, Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(
									new Phrase(""
											+ lkhp.getLKP_Desc("SALUTE",
													emp.getInt("SALUTE")) + " "
											+ " " + emp.getString("FNAME")
											+ " " + emp.getString("MNAME")
											+ " " + emp.getString("LNAME"),
											new Font(FONT.TIMES_ROMAN, 8,
													Font.NORMAL))));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""
									+ EmpOffHandler.dateFormat(emp
											.getDate("DOJ")), new Font(
									FONT.TIMES_ROMAN, 8, Font.NORMAL)));
							datatab.addCell(cell4);

							if (EMPBRN.equalsIgnoreCase("L")) {
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOL")), new Font(
										FONT.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);
							}
							if (EMPBRN.equalsIgnoreCase("An")) {
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("Ann")), new Font(
										FONT.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);
							}
							if (EMPBRN.equalsIgnoreCase("C")) {
								PdfPCell cell5 = new PdfPCell(
										new Phrase(
												""
														+ ((emp.getString("status"))
																.equalsIgnoreCase("a") ? "ACTIVE"
																: "NON-ACTIVE"),
												new Font(FONT.TIMES_ROMAN, 8,
														Font.NORMAL)));
								datatab.addCell(cell5);
							}
							doc.add(datatab);

						}

					} else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"No Record found for the Duration "
										+ rdt.substring(3) + " To "
										+ rdt1.substring(3), new Font(
										FONT.TIMES_ROMAN, 10, Font.BOLD)));
						if (EMPBRN.equalsIgnoreCase("L")
								|| EMPBRN.equalsIgnoreCase("An")) {
							c1.setColspan(5);
						} else {
							c1.setColspan(4);
						}
						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}
			}

			else if (EMPBRN.equals("D")) {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase(
							"Designation  Wise Employee List For :- "
									+ rdt.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new Rectangle(102, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(6);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(new float[] { 6, 34, 17, 25, 10,
							10 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						// added this as "Qualification" new column @ni...
						PdfPCell c21 = new PdfPCell(new Phrase("Qualification",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c21);
						PdfPCell c3 = new PdfPCell(new Phrase("Designation",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int desig = 0;

						while (emp.next()) {
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("DESIG",
									emp.getInt("DESIG"));
							desig = emp.getInt("DESIG");
							br_tot_no_emp = 0;
							para = new Paragraph(
									new Phrase(
											"Employee's List For Designation : "
													+ desc, new Font(
													Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (desig == emp.getInt("DESIG")) {
								datatab = new PdfPTable(6);
								datatab.setWidthPercentage(new float[] { 6, 34,
										17, 25, 10, 10 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								// added this as "Qualification" new column
								// @ni...
								PdfPCell cell3q = new PdfPCell(new Phrase(""
										+ emp.getString("qual"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell3q);
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ desc, new Font(Font.TIMES_ROMAN, 8,
										Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOB")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (desig != emp.getInt("DESIG")) {
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));

						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}

				/*
				 * repBean.setHdg3(
				 * "Empno Name Of Employee                         Desig            DOB           DOJ"
				 * );
				 * 
				 * else {
				 * 
				 * 
				 * try {
				 * 
				 * Document doc = new Document(); PdfWriter writer
				 * =PdfWriter.getInstance(doc, new FileOutputStream(filepath));
				 * doc.open(); doc.setPageSize(PageSize.A4);
				 * 
				 * Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL, new
				 * GrayColor(0.75f));
				 * ColumnText.showTextAligned(writer.getDirectContentUnder(),
				 * Element.ALIGN_CENTER, new
				 * Phrase(prop.getProperty("watermark"),FONT), 297.5f, 421, 45);
				 * Image image1 = Image.getInstance(imagepath); Phrase title =
				 * new Phrase(prop.getProperty("companyName"),new
				 * Font(FONT.TIMES_ROMAN,8,Font.BOLD)); Paragraph para = new
				 * Paragraph(title); para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingBefore(0);
				 * 
				 * image1.scaleAbsolute(60f,50f);
				 * image1.setAbsolutePosition(40f, 750f);
				 * 
				 * doc.add(image1); doc.add(para);
				 * 
				 * 
				 * para = new Paragraph(new
				 * Phrase(prop.getProperty("addressForReport"),new
				 * Font(Font.TIMES_ROMAN,8)));
				 * para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingAfter(0);
				 * 
				 * doc.add(para); para = new Paragraph(new
				 * Phrase(prop.getProperty("contactForReport"),new
				 * Font(Font.TIMES_ROMAN,8)));
				 * para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingAfter(0);
				 * 
				 * doc.add(para); para = new Paragraph(new
				 * Phrase(prop.getProperty("mailForReport"),new
				 * Font(Font.TIMES_ROMAN,8)));
				 * para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingAfter(0);
				 * 
				 * doc.add(para);
				 * 
				 * para = new Paragraph(new
				 * Phrase("Designation  Wise Employee List For :- "
				 * +rdt.substring(3, 11),new Font(Font.TIMES_ROMAN,10)));
				 * para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingAfter(10); doc.add(para);
				 * 
				 * Rectangle rec = new Rectangle(100,100); PdfPTable headtab =
				 * null;
				 * 
				 * headtab= new PdfPTable(5); headtab.setSpacingBefore(5);
				 * headtab.setWidthPercentage(new float[]{10,35,25,15,15}, rec);
				 * 
				 * headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * //System.out.println(EmpSql);
				 * 
				 * emp = st.executeQuery(EmpSql); if(emp.next()) {
				 * emp.beforeFirst(); headtab.setSpacingBefore(10); PdfPCell c1
				 * = new PdfPCell(new Phrase("Emp Code",new
				 * Font(Font.TIMES_ROMAN,8,Font.BOLD))); headtab.addCell(c1);
				 * PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",new
				 * Font(Font.TIMES_ROMAN,8,Font.BOLD))); headtab.addCell(c2);
				 * PdfPCell c3 = new PdfPCell(new Phrase("Designation",new
				 * Font(Font.TIMES_ROMAN,8,Font.BOLD))); headtab.addCell(c3);
				 * PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",new
				 * Font(Font.TIMES_ROMAN,8,Font.BOLD))); headtab.addCell(c4);
				 * PdfPCell c5 = new PdfPCell(new Phrase("Date of Joining",new
				 * Font(Font.TIMES_ROMAN,8,Font.BOLD))); headtab.addCell(c5);
				 * 
				 * doc.add(headtab);
				 * 
				 * PdfPTable datatab; tot_no_emp = 0; int desig = 0;
				 * 
				 * 
				 * while(emp.next()) { LookupHandler lkhp = new LookupHandler();
				 * String desc = lkhp.getLKP_Desc("DESIG", emp.getInt("DESIG"));
				 * desig = emp.getInt("DESIG"); br_tot_no_emp = 0; para = new
				 * Paragraph(new
				 * Phrase("Employee's List For Designation : "+desc,new
				 * Font(Font.TIMES_ROMAN,10)));
				 * para.setAlignment(Element.ALIGN_LEFT);
				 * para.setSpacingAfter(4); doc.add(para);
				 * 
				 * while (desig == emp.getInt("DESIG")) { datatab = new
				 * PdfPTable(5); datatab.setWidthPercentage(new
				 * float[]{10,35,25,15,15}, rec);
				 * datatab.setHorizontalAlignment(Element.ALIGN_LEFT); PdfPCell
				 * cell1 = new PdfPCell(new
				 * Phrase(""+emp.getString("EMPCODE"),new
				 * Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
				 * datatab.addCell(cell1); PdfPCell cell2 = new PdfPCell(new
				 * Phrase(""+lkhp.getLKP_Desc("SALUTE",
				 * emp.getInt("SALUTE"))+" "+emp.getString("name"),new
				 * Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
				 * datatab.addCell(cell2); PdfPCell cell3 = new PdfPCell(new
				 * Phrase(""+desc,new Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
				 * datatab.addCell(cell3); PdfPCell cell4 = new PdfPCell(new
				 * Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOB")) ,new
				 * Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
				 * datatab.addCell(cell4); PdfPCell cell5 = new PdfPCell(new
				 * Phrase(""+EmpOffHandler.dateFormat(emp.getDate("DOJ")),new
				 * Font(Font.TIMES_ROMAN,8,Font.NORMAL)));
				 * datatab.addCell(cell5);
				 * 
				 * doc.add(datatab);
				 * 
				 * 
				 * tot_no_emp = tot_no_emp + 1; br_tot_no_emp = br_tot_no_emp +
				 * 1; if (!emp.next()) { break; } if(desig !=
				 * emp.getInt("DESIG")){ emp.previous(); break; } } para = new
				 * Paragraph(new Phrase("No Of Employee :- "+br_tot_no_emp,new
				 * Font(Font.TIMES_ROMAN,10)));
				 * para.setAlignment(Element.ALIGN_LEFT);
				 * para.setSpacingAfter(10); doc.add(para);
				 * 
				 * 
				 * } para = new Paragraph(new
				 * Phrase("Total No Of Employee :- "+tot_no_emp,new
				 * Font(Font.TIMES_ROMAN,10)));
				 * para.setAlignment(Element.ALIGN_LEFT);
				 * para.setSpacingAfter(10); doc.add(para); }
				 * 
				 * 
				 * 
				 * else { System.out.println("no record found"); PdfPCell c1 =
				 * new PdfPCell(new
				 * Phrase("Record is Not found for the Month "+rdt
				 * .substring(3),new Font(Font.TIMES_ROMAN,10,Font.BOLD)));
				 * 
				 * 
				 * c1.setColspan(5);
				 * 
				 * headtab.setSpacingBefore(40); headtab.addCell(c1);
				 * doc.add(headtab);
				 * 
				 * }
				 * 
				 * 
				 * 
				 * 
				 * 
				 * doc.close(); } catch(Exception e) { e.printStackTrace(); }
				 * 
				 * 
				 * /*repBean.setHdg3(
				 * "Empno Name Of Employee                         Desig            DOB           DOJ"
				 * );
				 * 
				 * ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
				 * repBean.getHdg2(), repBean.getHdg3(), "", "", "",
				 * "",repBean); tot_no_emp = 0; int desig = 0; while
				 * (emp.next()) {
				 * 
				 * LookupHandler lkph = new LookupHandler(); String desc =
				 * lkph.getLKP_Desc("DESIG", emp.getInt("DESIG"));
				 * ReportDAO.println("", 0, 1, false, "BANK",repBean);
				 * ReportDAO.println("Desig :- ", 0, 0, false, "BANK",repBean);
				 * ReportDAO.println(desc, 14, 1, false, "BANK",repBean);
				 * ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean); desig
				 * = emp.getInt("DESIG"); br_tot_no_emp = 0; while (desig ==
				 * emp.getInt("DESIG")) {
				 * ReportDAO.println(emp.getString("EMPNO"), 0, 0, false,
				 * "BANK",repBean);
				 * ReportDAO.println(FixStr(emp.getString("NAME"), 35, 1), 7, 0,
				 * false, "BANK",repBean); ReportDAO.println(FixStr(desc, 10,
				 * 1), 45, 0,false, "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("dob"))), 10, 1), 57, 0, false,
				 * "BANK",repBean); ReportDAO.println(
				 * FixStr(outputFormat.format(inputFormat
				 * .parse(emp.getString("doj"))), 10, 1), 70, 1, false,
				 * "BANK",repBean); tot_no_emp = tot_no_emp + 1; br_tot_no_emp =
				 * br_tot_no_emp + 1; if (!emp.next()) { break; } if(desig !=
				 * emp.getInt("DESIG")){ emp.previous(); break; } }
				 * ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
				 * ReportDAO.println("No Of Emp :", 0, 0, false,
				 * "BANK",repBean); ReportDAO.println(""+br_tot_no_emp,42, 0,
				 * false, "BANK",repBean); ReportDAO.println(SLINE, 0, 1, false,
				 * "BANK",repBean); alltot = alltot + gross; gross = 0; //
				 * Remaining......................................***********
				 *//**
				 * If frmrpt.pgbrk.Value = vbChecked //Then LnCount = 66*
				 * PageNo = 0 println "", 0, Fp, 1 End If
				 */
				/*
				 * 
				 * }
				 */
			}

			else {

				try {

					Document doc = new Document();
					PdfWriter writer = PdfWriter.getInstance(doc,
							new FileOutputStream(filepath));
					UtilityDAO dao = new UtilityDAO();
					UtilityDAO.lable1 = "Report date : ";
					Footer ftr = dao.new Footer(lable1);
					writer.setPageEvent(ftr);
					doc.open();
					doc.setPageSize(PageSize.A4);

					Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
							new GrayColor(0.75f));
					ColumnText.showTextAligned(writer.getDirectContentUnder(),
							Element.ALIGN_CENTER,
							new Phrase(prop.getProperty("watermark"), FONT),
							297.5f, 421, 45);
					Image image1 = Image.getInstance(imagepath);
					Phrase title = new Phrase(prop.getProperty("companyName"),
							new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
					Paragraph para = new Paragraph(title);
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingBefore(0);

					image1.scaleAbsolute(60f, 50f);
					image1.setAbsolutePosition(40f, 750f);

					doc.add(image1);
					doc.add(para);

					para = new Paragraph(new Phrase(
							prop.getProperty("addressForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("contactForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);
					para = new Paragraph(new Phrase(
							prop.getProperty("mailForReport"), new Font(
									Font.TIMES_ROMAN, 8)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

					doc.add(para);

					para = new Paragraph(new Phrase(
							"Department  Wise Employee List For :- "
									+ rdt.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(10);
					doc.add(para);

					Rectangle rec = new Rectangle(100, 100);
					PdfPTable headtab = null;

					headtab = new PdfPTable(5);
					headtab.setSpacingBefore(5);
					headtab.setWidthPercentage(
							new float[] { 10, 35, 25, 15, 15 }, rec);

					headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
					// System.out.println(EmpSql);

					emp = st.executeQuery(EmpSql);
					if (emp.next()) {
						emp.beforeFirst();
						headtab.setSpacingBefore(10);
						PdfPCell c1 = new PdfPCell(new Phrase("Emp Code",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c1);
						PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c2);
						PdfPCell c3 = new PdfPCell(new Phrase("Department",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c3);
						PdfPCell c4 = new PdfPCell(new Phrase("Date of Birth",
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						headtab.addCell(c4);
						PdfPCell c5 = new PdfPCell(new Phrase(
								"Date of Joining", new Font(Font.TIMES_ROMAN,
										8, Font.BOLD)));
						headtab.addCell(c5);

						doc.add(headtab);

						PdfPTable datatab;
						tot_no_emp = 0;
						int deptr = 0;

						while (emp.next()) {
							LookupHandler lkhp = new LookupHandler();
							String desc = lkhp.getLKP_Desc("DEPT",
									emp.getInt("DEPT"));
							deptr = emp.getInt("DEPT");
							br_tot_no_emp = 0;
							para = new Paragraph(new Phrase(
									"Employee's List For Department : " + desc,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(4);
							doc.add(para);

							while (deptr == emp.getInt("DEPT")) {
								datatab = new PdfPTable(5);
								datatab.setWidthPercentage(new float[] { 10,
										35, 25, 15, 15 }, rec);
								datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
								PdfPCell cell1 = new PdfPCell(new Phrase(""
										+ emp.getString("EMPCODE"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell1);
								PdfPCell cell2 = new PdfPCell(new Phrase(""
										+ lkhp.getLKP_Desc("SALUTE",
												emp.getInt("SALUTE")) + " "
										+ emp.getString("name"), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell2);
								PdfPCell cell3 = new PdfPCell(new Phrase(""
										+ desc, new Font(Font.TIMES_ROMAN, 8,
										Font.NORMAL)));
								datatab.addCell(cell3);
								PdfPCell cell4 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOB")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell4);
								PdfPCell cell5 = new PdfPCell(new Phrase(""
										+ EmpOffHandler.dateFormat(emp
												.getDate("DOJ")), new Font(
										Font.TIMES_ROMAN, 8, Font.NORMAL)));
								datatab.addCell(cell5);

								doc.add(datatab);

								tot_no_emp = tot_no_emp + 1;
								br_tot_no_emp = br_tot_no_emp + 1;
								if (!emp.next()) {
									break;
								}
								if (deptr != emp.getInt("DEPT")) {
									emp.previous();
									break;
								}
							}
							para = new Paragraph(new Phrase(
									"No Of Employee :- " + br_tot_no_emp,
									new Font(Font.TIMES_ROMAN, 10)));
							para.setAlignment(Element.ALIGN_LEFT);
							para.setSpacingAfter(10);
							doc.add(para);

						}
						para = new Paragraph(new Phrase(
								"Total No Of Employee :- " + tot_no_emp,
								new Font(Font.TIMES_ROMAN, 10)));
						para.setAlignment(Element.ALIGN_LEFT);
						para.setSpacingAfter(10);
						doc.add(para);
					}

					else {
						System.out.println("no record found");
						PdfPCell c1 = new PdfPCell(new Phrase(
								"Record is Not found for the Month "
										+ rdt.substring(3), new Font(
										Font.TIMES_ROMAN, 10, Font.BOLD)));

						c1.setColspan(5);

						headtab.setSpacingBefore(40);
						headtab.addCell(c1);
						doc.add(headtab);

					}

					doc.close();
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
			/*
			 * if(!(EMPBRN.equalsIgnoreCase("J") ||
			 * EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")))
			 * 
			 * /*if(!(EMPBRN.equalsIgnoreCase("J") ||
			 * EMPBRN.equalsIgnoreCase("L")||EMPBRN.equalsIgnoreCase("C")))
			 * 
			 * { ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
			 * ReportDAO.println( "TOTAL NO OF EMPLOYEES = " +
			 * String.valueOf(tot_no_emp), 10, 1, false, "BANK",repBean);
			 * ReportDAO.println(SLINE, 0, 1, false, "BANK",repBean);
			 * ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false,
			 * "BANK",repBean); // Print #fp Chr(12) // Print #fp Chr(18) Fp =
			 * repBean.getFp(); Fp.close(); Cn.close(); return;
			 * 
			 * }
			 */

		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	
	
	public static void Leave_report(String Fdt, String TDT, String EMPBRN,
			int days, String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;
		String SLINE = "";
		String dtrsql = "";

		ResultSet emp = null;

		String EmpSql = "";
		int Pempno = 0;
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;

		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setFoot_Fl(true);
		ReportDAO.make_prn_file(filepath, repBean);
		repBean.setBrnNo(999);
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

		EmpSql = " select emp.empno,rtrim(emp.lname)+' '+substring(rtrim(emp.fname),1,1)+'. '+substring(rtrim(emp.mname),1,1) as  name ,"
				+ " leavecd,leavepurp,brcdch,l.lkp_disc disc,Frmdt,todt,DATEDIFF(day,todt,FRMDT) + 1 nodays , trndate,leavepurp "
				+ ",EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,LT.STATUS,TRNTYPE "
				+ " from leavetran lt,empmast emp, emptran t , branch s , grade g , lookup l "
				+ " where l.lkp_code = 'LPURP' and l.lkp_srno = lt.leavepurp and LT.STATUS <> 98 AND TRNTYPE = 'D' AND lreason <> 'AUTO CR' "
				+ " and frmdt between '"
				+ Fdt
				+ "' and '"
				+ TDT
				+ "' "
				+ " and leavepurp not in (4,1) and (DATEDIFF(day,todt,FRMDT) + 1) >= "
				+ days
				+ " "
				+ " and lt.empno = emp.empno "
				+ " and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = "
				+ " ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
				+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
				+ TDT
				+ "' )"
				+ " and emp.status = 'A' and s.brcd = t.branch "
				+ " order by t.branch,emp.empno ";
		// System.out.println(EmpSql);
		// repBean.setHdg1("Branch Wise Leave Report From :- " +
		// Fdt.substring(3, 11) + " To " + TDT.substring(3, 11));
		SLINE = stringOfSize(80, '-');
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("No Any Record Found");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			alltot = 0;
			Pempno = 0;
			tot_no_emp = 0;
			br_tot_no_emp = 0;
			repBean.setHdg2("Empno| Name Of Employee      |Branch |Leave|From Date | To_date  |No.Days|Total  ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), "", "", "", "", "", repBean);
			if (EMPBRN.equals("8")) {
				emp.beforeFirst();
				while (emp.next()) {
					br_tot_no_emp = 0;
					ReportDAO.println("Branch :- ", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(emp.getString("BRNAME"), 14, 0, false,
							"BANK", repBean);
					ReportDAO.println(
							"----------------------------------------------",
							0, 1, false, "BANK", repBean);
					PBRCD = emp.getInt("BRANCH");
					alltot = 0;
					Pempno = emp.getInt("EMPNO");
					System.out.println(emp.getInt("EMPNO"));
					while (PBRCD == emp.getInt("BRANCH")) {
						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false,
								"BANK", repBean);
						ReportDAO.println("|", 6, 0, false, "BANK", repBean);
						String st45 = emp.getString("NAME");
						ReportDAO
								.println(
										FixStr(emp.getString("NAME").substring(
												0,
												emp.getString("NAME").length()),
												21, 1), 7, 0, false, "BANK",
										repBean);
						ReportDAO.println("|", 29, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("BRCDCH"), 7, 1), 32, 0,
								false, "BANK", repBean);
						ReportDAO.println("|", 37, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("LEAVECD"), 2, 1), 39, 0,
								false, "BANK", repBean);
						ReportDAO.println("|", 43, 0, false, "BANK", repBean);
						ReportDAO
								.println(
										FixStr(outputFormat.format(inputFormat
												.parse(emp.getString("frmdt"))),
												10, 1), 44, 0, false, "BANK",
										repBean);
						ReportDAO.println("|", 54, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("todt"))), 10, 1),
								55, 0, false, "BANK", repBean);
						ReportDAO.println("|", 65, 0, false, "BANK", repBean);
						ReportDAO.println(emp.getString("nodays"), 66, 0,
								false, "BANK", repBean);
						alltot = alltot + emp.getInt("nodays");
						ReportDAO.println("|", 73, 0, false, "BANK", repBean);
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;

						if (!emp.next()) {
							ReportDAO.println(String.valueOf(alltot), 74, 1,
									false, "BANK", repBean);
							break;
						}

						if (PBRCD != emp.getInt("BRANCH")) {
							emp.previous();
							ReportDAO.println(String.valueOf(alltot), 74, 1,
									false, "BANK", repBean);
							System.out.println("in emp previous"
									+ emp.getInt("EMPNO"));
							break;
						}
						if (Pempno != emp.getInt("EMPNO")) {
							ReportDAO.println(String.valueOf(alltot), 74, 1,
									false, "BANK", repBean);
							alltot = 0;
						} else {
							ReportDAO
									.println("", 75, 1, false, "BANK", repBean);
						}
						Pempno = emp.getInt("EMPNO");

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp), 42, 0,
							false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);

				}
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				ReportDAO.println("Total No Of Emp :", 0, 0, false, "BANK",
						repBean);
				ReportDAO.println(String.valueOf(tot_no_emp), 42, 0, false,
						"BANK", repBean);
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",
					repBean);
			// Print #fp Chr(12)
			// Print #fp Chr(18)
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	// ............Hemant Bhavsar..............EMPLIST_with_edu,
	// caste_cate_EMPLIST,LeaveRep

	public static void Leave_Ledger_ReportText(int feno1, int teno1,
			String Fdt, String TDT, String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;
		int feno = 0;
		int teno = 0;
		String fdate = "";
		String tdate = "";
		int clbal = 0;
		int plbal = 0;

		int slbal = 0;
		int mlbal = 0;
		int nopl = 0;
		int nosl = 0;
		int nocl = 0;
		ResultSet emp = null;
		String Str1 = "";
		String SLINE = "";
		int TCnopl = 0;
		int TCnosl = 0;
		int TCnocl = 0;

		int TDnopl = 0;
		int TDnosl = 0;
		int TDnocl = 0;

		ResultSet trn = null;
		ResultSet bal = null;
		String EmpSql = "";
		String dtrsql = "";

		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);

		ReportDAO.make_prn_file(filepath, repBean);

		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

		fdate = Fdt;
		tdate = TDT;

		SLINE = stringOfSize(80, '-');
		repBean.setHdg1("Leave Ledger Printing for the period :-> "
				+ fdate.substring(3, 11) + " To " + tdate.substring(3, 11));
		repBean.setHdg2(SLINE);
		repBean.setHdg3("Appl.Date | Leave | From Date  |  To Date   |     CL    |     PL    |     SL");
		repBean.setHdg4("          | code  |            |            | DR  | CR  | DR  | CR  | DR  |  CR");

		// SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

		EmpSql = "select emp.*, t.acno, t.branch, t.grade from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO >= "
				+ feno1
				+ " AND EMP.EMPNO <= "
				+ teno1
				+ " AND "
				+ " t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"
				+ fdate + "')" + " and emp.status = 'A' order by emp.empno ";
		// System.out.println(EmpSql);
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			// System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);
			if (!emp.next()) {
				System.out.println("Employee Record Set Is Empty ");
				return;
			}
			ReportDAO.println("", 0, 1, false, "BANK", repBean);
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), repBean.getHdg3(), repBean.getHdg4(),
					"", "", "", repBean);
			emp.beforeFirst();
			while (emp.next()) {

				clbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 3, fdate,
						"O", repBean); // CL
				slbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 2, fdate,
						"O", repBean); // SL
				plbal = ReportDAO.get_leave_bal(emp.getInt("EMPNO"), 1, fdate,
						"O", repBean); // PL

				Str1 = "Emp.Code: "
						+ FixStr(emp.getString("empno"), 16, 1)
						+ "  Name  : "
						+ FixStr(
								(FixStr(emp.getString("lname") + "  "
										+ emp.getString("fname") + "  "
										+ (emp.getString("mname")), 42, 1)),
								50, 1);
				ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);
				Str1 = " Desig.: "
						+ GradeHandler.GetGrade(emp.getInt("grade"), "N",
								repBean) + " Branch: "; // +GetBranch(emp!BRANCH)
														// remaining
				ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);
				Str1 = "                               Opening Bal->|       "
						+ FixStr("" + clbal, 3, 3) + " |       "
						+ FixStr("" + plbal, 3, 3) + " |       "
						+ FixStr("" + slbal, 3, 3);
				ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				Str1 = "SELECT * FROM LEAVETRAN WHERE EMPNO ="
						+ emp.getInt("EMPNO")
						+ " and LEAVETRAN.STATUS <> 98 AND frmdt >= '" + Fdt
						+ "' and todt <= '" + TDT + "'";
				// System.out.println(Str1);
				Statement st1 = Cn.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				trn = st1.executeQuery(Str1);

				if (!trn.next()) {
					ReportDAO.println(
							"NO ANY TRANSACTIONS FOUND FOR "
									+ emp.getInt("EMPNO"), 0, 1, false, "BANK",
							repBean);

				}
				trn.beforeFirst();
				while (trn.next()) {
					Str1 = FixStr(trn.getString("appldt"), 10, 3) + "| "
							+ FixStr(trn.getString("leavecd"), 5, 3) + " | "
							+ FixStr(trn.getString("frmdt"), 10, 3) + " | "
							+ FixStr(trn.getString("todt"), 10, 3) + " | ";
					nocl = 0;
					nopl = 0;
					nosl = 0;

					if (trn.getInt("leavecd") == 3) // CL
					{
						// nocl = dateDiff("D",trn.getDate("frmdt"),
						// trn.getDate("todt"));
						nocl = trn.getInt("DAYS");

						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnocl = TCnocl + nocl;
						} else {
							TDnocl = TDnocl + nocl;
						}
					} else if (trn.getInt("leavecd") == 1) // PL
					{
						// nopl = dateDiff("D",trn.getDate("frmdt"),
						// trn.getDate("todt"));
						nopl = trn.getInt("DAYS");
						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnopl = TCnopl + nopl;
						} else {
							TDnopl = TDnopl + nopl;
						}
					} else if (trn.getInt("leavecd") == 2) // SL
					{

						// nosl = dateDiff("D",trn.getDate("frmdt"),
						// trn.getDate("todt"));
						nosl = trn.getInt("DAYS");

						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnosl = TCnosl + nosl;
						} else {
							TDnosl = TDnosl + nosl;
						}
					}

					if (trn.getString("trntype").trim().equalsIgnoreCase("D")) {
						Str1 = Str1 + FixStr("" + nocl, 3, 3) + " | "
								+ ReportDAO.addSpaces("", 3) + " | "
								+ FixStr("" + nopl, 3, 3) + " | "
								+ ReportDAO.addSpaces("", 3) + " | "
								+ FixStr("" + nosl, 3, 3) + " | "
								+ ReportDAO.addSpaces("", 3) + " | ";
					} else {
						Str1 = Str1 + ReportDAO.addSpaces("", 3) + " | "
								+ FixStr("" + nocl, 3, 3) + " | "
								+ ReportDAO.addSpaces("", 3) + " | "
								+ FixStr("" + nopl, 3, 3) + " | "
								+ ReportDAO.addSpaces("", 3) + " | "
								+ FixStr("" + nosl, 3, 3) + " | ";
					}

					ReportDAO.println(Str1, 0, 1, false, "BANK", repBean);

				}
				clbal = clbal + TCnocl - TDnocl;
				slbal = slbal + TCnosl - TDnosl;
				plbal = plbal + TCnopl - TDnopl;
				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				ReportDAO.println(
						"Closing Bal->|       " + FixStr("" + clbal, 3, 3)
								+ " |      " + FixStr("" + plbal, 3, 3)
								+ "  |       " + FixStr("" + slbal, 3, 3), 31,
						1, false, "BANK", repBean);
				// println "Closing Bal->|      " & FixStr(Str(clbal), 3, 3) &
				// " |      " & FixStr(Str(plbal), 3, 3) & "  |       " &
				// FixStr(Str(slbal), 3, 3), 32, Fp, 1

				ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
				clbal = 0;
				plbal = 0;
				slbal = 0;
				TCnocl = 0;
				TCnopl = 0;
				TCnosl = 0;
				TDnocl = 0;
				TDnopl = 0;
				TDnosl = 0;

			}

			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void Leave_Ledger_ReportPDF(String list, String Fdt,
			String TDT, String filepath, String imgpath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		Connection con = null;
		String EmpSql = "";
		Statement st;
		ResultSet rsemp;
		ResultSet trn;
		int clbal = 0;
		int plbal = 0;

		int slbal = 0;
		int mlbal = 0;
		int nopl = 0;
		int nosl = 0;
		int nocl = 0;

		int TCnopl = 0;
		int TCnosl = 0;
		int TCnocl = 0;

		int TDnopl = 0;
		int TDnosl = 0;
		int TDnocl = 0;
		try {
			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();

			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");// yyyy-MM-dd'T'HH:mm:ss
			SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");

			LookupHandler lh = new LookupHandler();
			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			Font FONT = new Font(Font.HELVETICA, 32, Font.NORMAL,
					new GrayColor(0.75f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 297.5f,
					421, 45);

			Image image1 = Image.getInstance(imgpath);

			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);

			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f);

			doc.add(image1);
			doc.add(para);
			// PdfPCell cell = new PdfPCell();

			PdfPTable emptab1 = new PdfPTable(4);
			PdfPTable empleavetab = new PdfPTable(8);
			PdfPTable optab = new PdfPTable(2);
			PdfPTable clostab = new PdfPTable(1);
			PdfPTable headtab = new PdfPTable(7);
			PdfPTable notrantab = new PdfPTable(1);

			PdfPCell c1;

			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("Leave Ledger Report From " + Fdt
					+ " To " + TDT, new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			EmpSql = "select emp.*, t.acno, t.prj_code, t.desig from empmast emp, emptran t where t.empno = emp.empno and EMP.EMPNO IN ("
					+ list
					+ ")  AND "
					+ " t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 WHERE e2.empno = emp.empno and E2.EFFDATE <= '"
					+ Fdt + "')" + " and emp.status = 'A' order by emp.empno ";
			// System.out.println(EmpSql);

			st = con.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			rsemp = st.executeQuery(EmpSql);
			Rectangle rec = new Rectangle(100, 100);
			PdfPTable maintab = new PdfPTable(1);
			// PdfPTable Leavetab = new PdfPTable(1);

			maintab.setSpacingBefore(10);
			// Leavetab.setSpacingBefore(10);

			emptab1.setWidthPercentage(new float[] { 20, 10, 15, 55 }, rec);
			emptab1.setHorizontalAlignment(Element.ALIGN_LEFT);

			empleavetab.setWidthPercentage(new float[] { 10, 20, 20, 10, 10,
					10, 10, 10 }, rec);
			empleavetab.setHorizontalAlignment(Element.ALIGN_LEFT);

			while (rsemp.next()) {
				maintab = new PdfPTable(1);
				boolean flag = false;

				clbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"), 3, Fdt,
						"O", repBean);// 3 for cl
				slbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"), 2, Fdt,
						"O", repBean); // 2 for sl
				plbal = ReportDAO.get_leave_bal(rsemp.getInt("EMPNO"), 1, Fdt,
						"O", repBean);// 1 for pl

				maintab = new PdfPTable(1);
				maintab.setSpacingBefore(10);
				// Leavetab = new PdfPTable(1);

				emptab1 = new PdfPTable(4);
				emptab1.setWidthPercentage(new float[] { 20, 10, 15, 55 }, rec);
				emptab1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab = new PdfPTable(8);
				headtab.setWidthPercentage(new float[] { 10, 20, 20, 10, 10,
						10, 10, 10 }, rec);

				c1 = new PdfPCell(new Phrase("Employee Number", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("" + rsemp.getString("EMPNO"),
						new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Employee Name", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("" + rsemp.getString("FNAME")
						+ " " + rsemp.getString("LNAME"), new Font(
						FONT.TIMES_ROMAN, 8, Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Project Code ", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("" + rsemp.getString("prj_code"),
						new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase("Designation", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				emptab1.addCell(c1);
				c1 = new PdfPCell(new Phrase(""
						+ lh.getLKP_Desc("DESIG", rsemp.getInt("desig")),
						new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
				emptab1.addCell(c1);
				maintab.addCell(emptab1);
				// doc.add(maintab);

				c1 = new PdfPCell(new Phrase("App.Date", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("From Date", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("TO Date", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Purpose", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Tran Type", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Days", new Font(FONT.TIMES_ROMAN,
						8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Total CR ", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);
				c1 = new PdfPCell(new Phrase("Total DB ", new Font(
						FONT.TIMES_ROMAN, 8, Font.BOLD)));
				c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
				headtab.addCell(c1);

				String Str1 = "SELECT T.*,B.totcr,B.totdr FROM LEAVETRAN T, LEAVEBAL B WHERE T.empno=B.empno  AND T.leavecd = B.leavecd AND T.EMPNO ="
						+ rsemp.getInt("EMPNO")
						+ "  AND T.STATUS='SANCTION' AND T.frmdt >= '"
						+ Fdt
						+ "' and T.todt <= '"
						+ TDT
						+ "' AND B.baldt =(SELECT MAX(B1.BALDT) FROM LEAVEBAL B1 WHERE B1.BALDT <= T.TODT AND B1.LEAVECD = T.LEAVECD) order by T.LEAVECD";
				Statement st1 = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);

				trn = st1.executeQuery(Str1);

				if (!trn.next()) {
					// ReportDAO.println("NO ANY TRANSACTIONS FOUND FOR "+rsemp.getInt("EMPNO"),0
					// ,1,false,"BANK",repBean);
					notrantab = new PdfPTable(1);
					c1 = new PdfPCell(new Phrase(
							"NO ANY TRANSACTIONS FOUND FOR EMPLOYEE NUMBER "
									+ rsemp.getString("EMPNO"), new Font(
									FONT.TIMES_ROMAN, 8, Font.BOLD)));
					notrantab.addCell(c1);
					maintab.addCell(notrantab);

				} else {
					maintab.addCell(headtab);
				}
				trn.beforeFirst();
				int leavecd = 0;
				boolean clflag = false;
				boolean plflag = false;
				boolean slflag = false;
				int i = 2;
				int chkcd = 0;

				while (trn.next()) {
					empleavetab = new PdfPTable(8);
					empleavetab.setWidthPercentage(new float[] { 10, 20, 20,
							10, 10, 10, 10, 10 }, rec);
					nocl = 0;
					nopl = 0;
					nosl = 0;
					leavecd = trn.getInt("leavecd");

					if (i == 2) {
						if (leavecd == 3)// cl
							clflag = true;
						if (leavecd == 2)// sl
							slflag = true;
						if (leavecd == 1)// pl
							plflag = true;

						chkcd = leavecd;
					}
					i++;
					if (chkcd != leavecd) {
						clostab = new PdfPTable(1);

						if (chkcd == 3) {

							clbal = clbal + TCnocl - TDnocl;
							c1 = new PdfPCell(new Phrase(
									"CL Closing Balance => " + clbal, new Font(
											FONT.TIMES_ROMAN, 8, Font.BOLD)));

							clbal = 0;
						}
						if (chkcd == 2) {
							slbal = slbal + TCnosl - TDnosl;
							c1 = new PdfPCell(new Phrase(
									"SL Closing Balance => " + slbal, new Font(
											FONT.TIMES_ROMAN, 8, Font.BOLD)));
							slbal = 0;
						}
						if (chkcd == 1) {

							plbal = plbal + TCnopl - TDnopl;
							c1 = new PdfPCell(new Phrase(
									"PL Closing Balance => " + plbal, new Font(
											FONT.TIMES_ROMAN, 8, Font.BOLD)));

							plbal = 0;

						}
						TCnocl = 0;
						TDnopl = 0;
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						clostab.addCell(c1);
						maintab.addCell(clostab);
						chkcd = leavecd;
					}

					if (leavecd == 3 && clflag == true) {
						optab = new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Casual Leave", new Font(
								FONT.TIMES_ROMAN, 8, Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("CL Opening Balance => "
								+ clbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						clflag = false;
						plflag = true;
						slflag = true;
						maintab.addCell(optab);
					} else if (leavecd == 2 && slflag == true) {
						optab = new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Sick Leave", new Font(
								FONT.TIMES_ROMAN, 8, Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("SL Opening Balance => "
								+ slbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						plflag = true;
						clflag = true;
						slflag = false;

						maintab.addCell(optab);
					} else if (leavecd == 1 && plflag == true) {
						// System.out.println("plflag is "+plflag);
						optab = new PdfPTable(2);
						c1 = new PdfPCell(new Phrase("Paid Leave", new Font(
								FONT.TIMES_ROMAN, 8, Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_LEFT);
						c1.setBorder(0);
						optab.addCell(c1);

						c1 = new PdfPCell(new Phrase("PL Opening Balance = "
								+ plbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));
						c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
						c1.setPaddingRight(40);
						c1.setBorder(0);
						optab.addCell(c1);
						slflag = true;
						plflag = false;
						clflag = true;
						maintab.addCell(optab);
					}

					if (trn.getInt("leavecd") == 3) // CL
					{
						nocl = trn.getInt("DAYS");// dateDiff("D",trn.getDate("frmdt"),
													// trn.getDate("todt"));
						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnocl = TCnocl + nocl;
						} else {
							TDnocl = TDnocl + nocl;
						}

					} else if (trn.getInt("leavecd") == 1) // PL
					{
						nopl = trn.getInt("DAYS");// dateDiff("D",trn.getDate("frmdt"),
													// trn.getDate("todt"));
						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnopl = TCnopl + nopl;
						} else {
							TDnopl = TDnopl + nopl;
						}

					} else if (trn.getInt("leavecd") == 2) // SL
					{

						nosl = trn.getInt("DAYS");// dateDiff("D",trn.getDate("frmdt"),
													// trn.getDate("todt"));
						if (trn.getString("trntype").trim()
								.equalsIgnoreCase("C")) {
							TCnosl = TCnosl + nosl;
						} else {
							TDnosl = TDnosl + nosl;
						}
					}

					c1 = new PdfPCell(new Phrase(
							""
									+ output.format(sdf.parse(trn
											.getString("appldt"))), new Font(
									FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);

					// c1.setBorderWidthRight(1);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					empleavetab.addCell(c1);
					c1 = new PdfPCell(new Phrase(""
							+ output.format(sdf.parse(trn.getString("frmdt"))),
							new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					// c1.setBorderWidthRight(1);
					empleavetab.addCell(c1);

					c1 = new PdfPCell(new Phrase(""
							+ output.format(sdf.parse(trn.getString("todt"))),
							new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);
					c1.setHorizontalAlignment(Chunk.ALIGN_CENTER);
					empleavetab.addCell(c1);

					c1 = new PdfPCell(new Phrase(""
							+ trn.getString("LEAVEPURP"), new Font(
							FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);

					empleavetab.addCell(c1);

					c1 = new PdfPCell(new Phrase("" + trn.getString("trntype"),
							new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);

					empleavetab.addCell(c1);
					c1 = new PdfPCell(new Phrase("" + trn.getString("Days"),
							new Font(FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthLeft(0);
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c1.setBorderWidthRight(1);
					empleavetab.addCell(c1);
					PdfPCell c2 = new PdfPCell(new Phrase("0", new Font(
							FONT.TIMES_ROMAN, 8, Font.NORMAL)));
					c1.setBorderWidthBottom(0);
					c1.setBorderWidthTop(0);
					// c2.setBorderWidthRight(1);

					if (leavecd == 3) {
						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totcr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);

						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totdr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);

					} else if (leavecd == 2) {
						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totcr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totdr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);
					} else if (leavecd == 1) {
						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totcr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);

						empleavetab.addCell(c1);

						c1 = new PdfPCell(new Phrase(""
								+ trn.getString("totdr"), new Font(
								FONT.TIMES_ROMAN, 8, Font.NORMAL)));
						c1.setBorderWidthLeft(0);
						c1.setBorderWidthBottom(0);
						c1.setBorderWidthTop(0);
						c1.setBorderWidthRight(0);
						empleavetab.addCell(c1);
					}
					maintab.addCell(empleavetab);

					flag = true;
				}

				if (flag == true) {

					clostab = new PdfPTable(1);
					if (leavecd == 3) {
						clbal = clbal + TCnocl - TDnocl;
						c1 = new PdfPCell(new Phrase("CL Closing Balance => "
								+ clbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));

					}
					if (leavecd == 2) {
						slbal = slbal + TCnosl - TDnosl;
						c1 = new PdfPCell(new Phrase("SL Closing Balance => "
								+ slbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));

					}
					if (leavecd == 1) {

						plbal = plbal + TCnopl - TDnopl;
						c1 = new PdfPCell(new Phrase("PL Closing Balance => "
								+ plbal, new Font(FONT.TIMES_ROMAN, 8,
								Font.BOLD)));

					}
					c1.setHorizontalAlignment(Chunk.ALIGN_RIGHT);
					c1.setPaddingRight(40);
					c1.setBorder(0);
					clostab.addCell(c1);
					maintab.addCell(clostab);

				}

				// ReportDAO.println(SLINE, 0, 1,false,"BANK",repBean);
				// ReportDAO.println("Closing Bal->|       "+FixStr(""+clbal, 3,
				// 3)+" |      "+FixStr(""+plbal, 3,
				// 3)+"  |       "+FixStr(""+slbal, 3, 3), 31,
				// 1,false,"BANK",repBean);
				// println "Closing Bal->|      " & FixStr(Str(clbal), 3, 3) &
				// " |      " & FixStr(Str(plbal), 3, 3) & "  |       " &
				// FixStr(Str(slbal), 3, 3), 32, Fp, 1

				// ReportDAO.println(SLINE,0, 1, false,"BANK",repBean);
				clbal = 0;
				plbal = 0;
				slbal = 0;
				TCnocl = 0;
				TCnopl = 0;
				TCnosl = 0;
				TDnocl = 0;
				TDnopl = 0;
				TDnosl = 0;

				doc.add(maintab);

			}

			con.close();
			doc.close();

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void EMPLIST_with_edu(String rdt, String EMPBRN,
			String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;

		String SLINE = "";
		String dtrsql = "";
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int Pempno = 0;
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		String pBrcd1;
		int gross = 0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath, repBean);

		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("MM/dd/yyyy");

		if (EMPBRN == "B") {
			EmpSql = "select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name,EMP.DOB,EMP.DOJ,t.branch,s.brname,t.grade,t.acno,g.al";

			EmpSql = "select emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,q.*,l.lkp_disc,pl.lkp_disc pldisc,S.OPENDATE,t.effdate,t1.lkp_disc discs ,ISNULL(emp.sbond,'N') sbond1,ISNULL(emp.depamt,0) depamt1"
					+ " from empmast emp, emptran t , branch s , grade g , qual q ,lookup l ,lookup pl,lookup t1"
					+ " Where t1.lkp_code = 'DESIG' and t1.lkp_srno = t.desig and pl.lkp_code = 'CATE' and pl.lkp_srno = emp.categorycd and emp.empno = q.empno(+) and ( l.lkp_code = 'ED' and l.lkp_srno = ISNULL(q.degree,0) ) and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
					+ rdt
					+ "' ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by t.branch,emp.empno ";
			repBean.setHdg1("Branch Wise List For :-" + rdt.substring(3, 11));
		}
		SLINE = stringOfSize(80, '-');
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("No Any Reord Found");
				// ReportDAO.Fp.close();
				return;
			}
			alltot = 0;

			repBean.setHdg2("Empno   Name Of Employee                     Grade            CATEGORY ");
			repBean.setHdg3("      Appo.Date To the Branch      Designation     Security Bond /Deposit  ");
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",
					repBean);
			emp.beforeFirst();
			if (EMPBRN == "B") {
				while (emp.next()) {

					ReportDAO
							.println(
									"               Degree                        Institution ",
									0, 0, false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("", 0, 1, false, "BANK", repBean);
					ReportDAO
							.println("Branch :-", 0, 0, false, "BANK", repBean);
					ReportDAO.println(emp.getString("BRNAME"), 14, 0, false,
							"BANK", repBean);
					ReportDAO.println(outputFormat.format(inputFormat.parse(emp
							.getString("opendate"))), 40, 1, false, "BANK",
							repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					PBRCD = emp.getInt("BRANCH");
					Pempno = emp.getInt("BRANCH");
					while (PBRCD == emp.getInt("BRANCH")) {

						ReportDAO.println(emp.getString("EMPNO"), 0, 0, false,
								"BANK", repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1),
								12, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("ALFACD"), 10, 1), 49, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("pldisc"), 20, 1), 61, 1,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("effdate"))), 10,
										1), 12, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("sbond1") == "Y" ? "YES"
										: "NO", 3, 1), 47, 0, false, "BANK",
								repBean);
						ReportDAO.println(
								FixStr(emp.getString("depamt1"), 8, 1), 54, 1,
								false, "BANK", repBean);
						ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						gross = emp.getInt("empno");
						Pempno = emp.getInt("empno");
						while (PBRCD == emp.getInt("BRANCH")
								&& emp.getInt("empno") == Pempno) {
							ReportDAO
									.println(
											FixStr((emp.getString("lkp_disc") == null ? ""
													: emp.getString("lkp_disc")),
													30, 1)
													+ "|", 7, 0, false, "BANK",
											repBean);
							ReportDAO.println(
									(emp.getString("inst") == null ? "" : emp
											.getString("inst")), 39, 1, false,
									"BANK", repBean);
							if (!emp.next()) {
								break;
							}

						}
						ReportDAO.println("", 0, 1, false, "BANK", repBean);
						ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp), 42, 0,
							false, "BANK", repBean);

					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;
					if (!emp.next()) {
						break;
					}
					gross = 0;
					/*
					 * //If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 * PageNo = 0 println "", 0, Fp, 1 End If
					 */

				}
			} else {
				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK", repBean);
					ReportDAO.println("Grade  :- ", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(emp.getString("discs"), 14, 1, false,
							"BANK", repBean);
					ReportDAO.println(
							"---------------------------------------", 0, 1,
							false, "BANK", repBean);
					pBrcd1 = emp.getString("ALFACD");
					br_tot_no_emp = 0;
					while (pBrcd1 == emp.getString("ALFACD")) {
						ReportDAO.println(
								trans(emp.getInt("empno"), "99999", "", false,
										false), 0, 0, false, "BANK", repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1),
								7, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("ALFACD"), 10, 1), 45, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("dob"))), 10, 1),
								57, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(outputFormat.format(inputFormat
										.parse(emp.getString("doj"))), 10, 1),
								70, 0, false, "BANK", repBean);
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(String.valueOf(br_tot_no_emp), 42, 0,
							false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;
					if (!emp.next()) {
						break;
					}
					tot_no_emp = tot_no_emp + br_tot_no_emp;
					gross = 0;
					/*
					 * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 * PageNo = 0 println "", 0, Fp, 1 End If
					 */

				}

			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",
					repBean);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
			// System.out.println("Exception in EMPLIST_EDU "+e);
		}

	}

	public static void caste_cate_EMPLIST(String rdt, String EMPBRN,
			String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;

		String SLINE = "";
		String dtrsql = "";
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		String pBrcd1 = "";
		int gross = 0;
		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath, repBean);

		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		if (EMPBRN == "C") {
			EmpSql = "select S.BRCDCH,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,l.lkp_disc,ISNULL(emp.categorycd,0) categorycd,l1.lkp_disc DISC1,ISNULL(emp.caStcd,0) caStcd"
					+ " from empmast emp, emptran t , branch s , grade g ,lookup l ,lookup l1 "
					+ " Where  l1.lkp_code = 'CASTE' and l1.lkp_srno = ISNULL(emp.castcd,0) and l.lkp_code = 'CATE' and l.lkp_srno = ISNULL(emp.categorycd,0) and EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
					+ rdt
					+ "' ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by emp.categorycd,emp.empno";
			// System.out.println(EmpSql);
			repBean.setHdg1("Category Wise Employee List upto  :-"
					+ rdt.substring(3, 11));
			repBean.setHdg2("Empno Name Of Employee                         Grade    Branch     Cast      ");
		} else {
			EmpSql = " select s.brcdch,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name ,EMP.DOB,EMP.DOJ, t.branch ,s.brname ,t.grade,t.acno,g.alfacd,l.lkp_disc,ISNULL(emp.castcd,0) caste,l1.lkp_disc disc1,ISNULL(emp.categorycd,0) categorycd"
					+ " from empmast emp, emptran t , branch s , grade g ,lookup l,lookup l1  "
					+ " Where  l1.lkp_code = 'CATE' and l1.lkp_srno = ISNULL(emp.categorycd,0) and l.lkp_code = 'CASTE' and l.lkp_srno = ISNULL(emp.castcd,0) and  EMP.EMPNO = T.EMPNO AND g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
					+ rdt
					+ "' ) "
					+ " and emp.status = 'A' and s.brcd = t.branch "
					+ " order by emp.castcd,emp.empno";
			// System.out.println(EmpSql);
			repBean.setHdg1("Cast Wise Employee List upto  :-"
					+ rdt.substring(3, 11));
			repBean.setHdg2("Empno   Name Of Employee                       Grade    Branch     Cast      ");
		}
		SLINE = stringOfSize(80, '-');
		Statement st;
		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			// System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("No Any Reord Found");
				return;
			}
			alltot = 0;
			tot_no_emp = 0;
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",
					repBean);
			emp.beforeFirst();
			if (EMPBRN == "D") {

				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK", repBean);
					ReportDAO
							.println("Caste :- ", 0, 0, false, "BANK", repBean);
					ReportDAO.println(FixStr(emp.getString("caste"), 4, 1), 14,
							0, false, "BANK", repBean);
					ReportDAO.println(FixStr(emp.getString("lkp_disc"), 20, 1),
							20, 1, false, "BANK", repBean);
					ReportDAO.println(
							"----------------------------------------", 0, 1,
							false, "BANK", repBean);
					PBRCD = emp.getInt("caste");
					br_tot_no_emp = 0;
					while (PBRCD == emp.getInt("caste")) {

						ReportDAO.println(emp.getString("empno"), 0, 0, false,
								"BANK", repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1),
								7, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("ALFACD"), 10, 1), 45, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("BRCDCH"), 4, 1), 57, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("disc1"), 20, 1), 62, 1,
								false, "BANK", repBean);
						br_tot_no_emp = br_tot_no_emp + 1;
						tot_no_emp = tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}

						if (PBRCD != emp.getInt("caste")) {
							emp.previous();
							break;
						}

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println("" + br_tot_no_emp, 42, 0, false, "BANK",
							repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;

					gross = 0;
					/*
					 * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 * PageNo = 0 println "", 0, Fp, 1 End If
					 */

				}
			} else {
				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK", repBean);
					ReportDAO.println("Category :- ", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println(
							FixStr(emp.getString("categorycd"), 4, 1), 14, 0,
							false, "BANK", repBean);
					ReportDAO.println(FixStr(emp.getString("lkp_disc"), 20, 1),
							20, 1, false, "BANK", repBean);
					ReportDAO.println(
							"----------------------------------------", 0, 1,
							false, "BANK", repBean);
					PBRCD = emp.getInt("categorycd");
					br_tot_no_emp = 0;
					while (PBRCD == emp.getInt("categorycd")) {
						ReportDAO.println(emp.getString("empno"), 0, 0, false,
								"BANK", repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1),
								7, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("ALFACD"), 10, 1), 45, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("BRCDCH"), 4, 1), 57, 0,
								false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("disc1"), 20, 1), 62, 1,
								false, "BANK", repBean);
						br_tot_no_emp = br_tot_no_emp + 1;
						tot_no_emp = tot_no_emp + 1;

						if (!emp.next()) {
							break;
						}
						if (PBRCD != emp.getInt("categorycd")) {
							emp.previous();
							break;
						}

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp :", 0, 0, false, "BANK",
							repBean);
					ReportDAO.println("" + br_tot_no_emp, 42, 0, false, "BANK",
							repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;

					gross = 0;

					/*
					 * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 * PageNo = 0 println "", 0, Fp, 1 End If
					 */
				}
			}
			ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			ReportDAO.println("TOTAL NO OF EMPLOYEES = " + tot_no_emp, 10, 1,
					false, "BANK", repBean);
			ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			repBean.setLnCount(66);
			ReportDAO.println("Summary Of Caste/Category Report", 0, 2, false,
					"BANK", repBean);
			if (EMPBRN == "C") {
				EmpSql = "select l.lkp_disc  CATEGORY,count(*) no_of_employee "
						+ " from empmast ,lookup l where l.lkp_code = 'CATE' and l.lkp_srno = ISNULL(empmast.categorycd,0)"
						+ "  and empmast.status = 'A' group by categorycd,l.lkp_disc ";

			} else {
				EmpSql = " select l.lkp_disc  CASTCD ,count(*) no_of_employee "
						+ " from empmast ,lookup l where l.lkp_code = 'CASTE' and l.lkp_srno = ISNULL(empmast.caStcd,0)"
						+ "  and empmast.status = 'A' group by castcd,l.lkp_disc ";
			}
			tot_no_emp = 0;
			Statement st2 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			// System.out.println(EmpSql);
			emp = null;
			emp = st2.executeQuery(EmpSql);

			int cn = 1;
			if (emp.next()) {

				ReportDAO.println("---------------------------------------", 0,
						1, false, "BANK", repBean);
				ReportDAO.println(" Category /Caste              No.of.Emp  ",
						0, 1, false, "BANK", repBean);

				ReportDAO.println("---------------------------------------", 0,
						1, false, "BANK", repBean);
				emp.beforeFirst();

				while (emp.next()) {

					tot_no_emp = tot_no_emp + emp.getInt(2);
					ReportDAO.println(FixStr(emp.getString(1), 20, 1), 1, 0,
							false, "BANK", repBean);
					ReportDAO.println("" + emp.getInt(2), 23, 1, false, "BANK",
							repBean);
					cn++;
				}

				ReportDAO.println("---------------------------------------", 0,
						1, false, "BANK", repBean);
				ReportDAO.println("" + tot_no_emp, 23, 1, false, "BANK",
						repBean);
				ReportDAO.println("---------------------------------------", 0,
						4, false, "BANK", repBean);

			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 2, false, "BANK",
					repBean);
			// System.out.println(cn);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void OtherLIST(String rdt, int ptrancd, String ptrandisc,
			String EMPBRN, String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		FileWriter Fp;
		Connection Cn = null;

		String SLINE = "";
		String dtrsql = "";
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		int alltot = 0;
		int PBRCD = 0;
		int gross = 0;
		int brtot[][] = new int[401][2];

		ReportDAO.inithead(repBean);
		repBean.setLnCount(0);
		repBean.setPageNo(1);
		repBean.setLineLen(80);
		repBean.setPageLen(65);
		repBean.setBrnNo(999);
		ReportDAO.make_prn_file(filepath, repBean);

		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();

		if (EMPBRN == "B") {
			EmpSql = " select b.trncd,emp.empno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name , t.branch ,s.brname ,b.net_amt,t.grade,t.acno,g.alfacd"
					+ " from empmast emp, emptran t ,PAYTRAN b  , branch s , grade g "
					+ " Where t.empno = Emp.empno And g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
					+ rdt
					+ "' ) "
					+ " and emp.status = 'A' and b.empno = emp.empno and b.trncd = "
					+ ptrancd
					+ " and s.brcd = t.branch "
					+ " order by t.branch,emp.empno ";

			repBean.setHdg1("Branch Wise " + ptrandisc
					+ " List For The Month Of :-" + rdt.substring(3, 11));
		} else {
			EmpSql = " select b.trncd,emp.empno,rtrim(emp.lname) +' '+rtrim(emp.fname) +' '+rtrim(emp.mname) name , t.branch ,s.brname ,b.net_amt,t.grade,t.acno,g.alfacd"
					+ " from empmast emp, emptran t ,PAYTRAN b  , branch s , grade g "
					+ " Where t.empno = Emp.empno And g.postcd = t.grade and t.effdate = ( SELECT MAX(E2.EFFDATE)  FROM EMPTRAN E2 "
					+ " WHERE e2.empno = emp.empno and e2.EFFDATE <= '"
					+ rdt
					+ "' ) "
					+ " and emp.status = 'A' and b.empno = emp.empno and b.trncd = "
					+ ptrancd
					+ " and s.brcd = t.branch "
					+ " order by emp.empno ";
			repBean.setHdg1("Employee Wise " + ptrandisc
					+ " List For The Month Of :-" + rdt.substring(3, 11));
		}
		SLINE = stringOfSize(80, '-');
		Statement st;
		try {
			st = repBean.getCn().createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			// System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);
			if (!emp.next()) {
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			alltot = 0;
			for (int i = 0; i <= 400; i++) {
				brtot[i][0] = 0;
				brtot[i][1] = 0;

			}
			if (ptrancd == 999) {
				repBean.setHdg3("Empno Name Of Employee                        Desig        Amount     SB-A/C No");

			} else {
				repBean.setHdg3("Empno Name Of Employee                         Desig        Amount     ");
			}
			ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
					repBean.getHdg2(), repBean.getHdg3(), "", "", "", "",
					repBean);
			if (EMPBRN == "B") {
				emp.beforeFirst();
				while (emp.next()) {
					ReportDAO.println("", 0, 1, false, "BANK", repBean);
					ReportDAO.println("Branch :- ", 0, 1, false, "BANK",
							repBean);
					ReportDAO.println(emp.getString("BRNAME"), 14, 1, false,
							"BANK", repBean);
					ReportDAO.println("------------------------------", 0, 1,
							false, "BANK", repBean);
					PBRCD = emp.getInt("BRANCH");
					br_tot_no_emp = 0;

					while (PBRCD == emp.getInt("BRANCH")) {
						ReportDAO.println(emp.getString("empno"), 0, 0, false,
								"BANK", repBean);
						ReportDAO.println(FixStr(emp.getString("Name"), 35, 1),
								7, 0, false, "BANK", repBean);
						ReportDAO.println(
								FixStr(emp.getString("ALFACD"), 10, 1), 45, 0,
								false, "BANK", repBean);
						// System.out.println("alfacd....."+emp.getString("ALFACD"));
						if (emp.getInt("trncd") == 999) {
							ReportDAO.println(emp.getString("NET_AMT"), 58, 0,
									false, "BANK", repBean);

						} else {
							ReportDAO.println(emp.getString("NET_AMT"), 58, 1,
									false, "BANK", repBean);
						}
						gross = gross + emp.getInt("NET_AMT");
						if (emp.getInt("trncd") == 202) {
							brtot[emp.getInt("NET_AMT")][0] = brtot[emp
									.getInt("NET_AMT")][0] + 1;
							brtot[emp.getInt("NET_AMT")][1] = brtot[emp
									.getInt("NET_AMT")][1]
									+ emp.getInt("NET_AMT");
						}
						if (emp.getInt("trncd") == 999) {
							ReportDAO.println(emp.getString("acno"), 71, 1,
									false, "BANK", repBean);

						}
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!emp.next()) {
							break;
						}

						if (PBRCD != emp.getInt("BRANCH")) {
							emp.previous();
							break;
						}
					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp & Branch Total", 0, 0, false,
							"BANK", repBean);
					ReportDAO.println("" + br_tot_no_emp, 48, 0, false, "BANK",
							repBean);
					ReportDAO
							.println("" + gross, 55, 1, false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;
					tot_no_emp = tot_no_emp + br_tot_no_emp;
					gross = 0;
					/*
					 * If frmrpt.pgbrk.Value = vbChecked Then LnCount = 66
					 * PageNo = 0 println "", 0, Fp, 1 End If
					 */

				}
			} else {
				emp.beforeFirst();
				while (emp.next()) {
					ReportDAO.println(emp.getString("empno"), 0, 0, false,
							"BANK", repBean);
					ReportDAO.println(FixStr(emp.getString("Name"), 35, 1), 7,
							0, false, "BANK", repBean);
					ReportDAO.println(FixStr(emp.getString("ALFACD"), 10, 1),
							45, 0, false, "BANK", repBean);
					if (emp.getInt("trncd") == 999) {
						ReportDAO.println(emp.getString("NET_AMT"), 58, 0,
								false, "BANK", repBean);

					} else {
						ReportDAO.println(emp.getString("NET_AMT"), 58, 1,
								false, "BANK", repBean);
					}
					gross = gross + emp.getInt("NET_AMT");
					if (emp.getInt("trncd") == 202) {
						brtot[emp.getInt("NET_AMT")][0] = brtot[emp
								.getInt("NET_AMT")][0] + 1;
						brtot[emp.getInt("NET_AMT")][1] = brtot[emp
								.getInt("NET_AMT")][1] + emp.getInt("NET_AMT");
					}
					if (emp.getInt("trncd") == 999) {
						ReportDAO.println(emp.getString("acno"), 71, 1, false,
								"BANK", repBean);

					}
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					ReportDAO.println("No Of Emp & Branch Total", 0, 0, false,
							"BANK", repBean);
					ReportDAO.println("" + br_tot_no_emp, 55, 1, false, "BANK",
							repBean);
					ReportDAO
							.println("" + gross, 55, 1, false, "BANK", repBean);
					ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
					alltot = alltot + gross;
					tot_no_emp = tot_no_emp + br_tot_no_emp;
					gross = 0;

				}
			}
			ReportDAO.println(SLINE, 0, 1, false, "BANK", repBean);
			ReportDAO.println("Total No. Of Emp. & All Branch Total", 0, 0,
					false, "BANK", repBean);
			ReportDAO.println("" + tot_no_emp, 48, 0, false, "BANK", repBean);
			ReportDAO.println("" + alltot, 55, 1, false, "BANK", repBean);
			ReportDAO.println(SLINE, 0, 4, false, "BANK", repBean);
			gross = 0;
			if (ptrancd == 202) {

				ReportDAO.println(
						" ---------------------------------------------------",
						10, 1, false, "BANK", repBean);
				ReportDAO.println(
						" Slab Amount     No.Of. Employee       Tot Amount   ",
						10, 1, false, "BANK", repBean);
				ReportDAO.println(
						" ---------------------------------------------------",
						10, 1, false, "BANK", repBean);
				dtrsql = "select count(*) From EMPMAST  where empno in ( select empno from PAYTRAN where trncd = 101 "
						+ " minus     select empno from PAYTRAN where trncd = 202  ) ";
				Statement st1 = repBean.getCn().createStatement();
				DTR = st1.executeQuery(dtrsql);
				if (DTR.next()) {
					brtot[0][0] = DTR.getInt(1);
				}
				for (int i = 0; i < 400; i++) {
					if (brtot[i][0] != 0) {
						ReportDAO.println(FixStr("" + i, 7, 3), 10, 0, false,
								"BANK", repBean);
						ReportDAO.println(FixStr("" + brtot[i][0], 12, 3), 22,
								0, false, "BANK", repBean);
						ReportDAO.println("" + brtot[i][1], 40, 0, false,
								"BANK", repBean);
						gross = gross + 1;
					}
				}
				ReportDAO.println(
						" ---------------------------------------------------",
						10, 1, false, "BANK", repBean);
				ReportDAO.println(FixStr("" + gross, 12, 3), 40, 1, false,
						"BANK", repBean);

			}
			ReportDAO.println("AUTHORISED SIGNATORY", 55, 4, false, "BANK",
					repBean);
			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static ArrayList<PFExcelBean> PFExcel(String rdt)/* Hemant.... */
	{

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		// System.out.println("calling pfexcel method");
		PFExcelBean pfbean;
		ArrayList<PFExcelBean> pflist = new ArrayList<PFExcelBean>();
		RepoartBean repBean = new RepoartBean();
		String SLINE = "";
		int arrcal = 0;
		Connection Cn = null;
		// FileWriter Fp;
		ResultSet DTR = null;
		ResultSet emp = null;
		String EmpSql = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[8];
		int ALLbrtot[] = new int[8];
		int pfchk = 0;
		// ReportDAO.inithead(repBean);
		// repBean.setLnCount(0);
		// repBean.setPageNo(1);
		// repBean.setLineLen(132);
		// repBean.setPageLen(65);
		// repBean.setFoot_Fl(true);
		// ReportDAO.make_prn_file(filepath,repBean);
		// repBean.setBrnNo(999);
		// ReportDAO.println(String.valueOf((char)15), 1, 1, false,
		// "BANK",repBean);
		ReportDAO.OpenCon("", "", "", repBean);
		EmpSql = "select e.salute,e.empno,e.fname,e.mname,e.lname,e.pfno,p.prj_name,p.prj_srno, (select net_amt from paytran where trncd=101 and empno=e.empno and trndt<='"
				+ rdt
				+ "') basic,"
				+ "(select net_amt from paytran where trncd=201 and empno=e.empno and trndt<='"
				+ rdt
				+ "') as pf,"
				+ "(select net_amt from paytran where trncd=102 and empno=e.empno and trndt<='"
				+ rdt
				+ "') da,"
				+ "(select net_amt from paytran where trncd=199 and empno=e.empno and upddt<='"
				+ rdt
				+ "') ctc,"
				+ "(select arr_amt from paytran where trncd=201 and empno=e.empno and upddt<='"
				+ rdt
				+ "') arr_amt "
				+ "from empmast e, prj p,emptran t where e.status = 'A' and t.empno= e.empno and t.prj_srno=p.prj_srno order by p.prj_srno,e.empno";

		/*
		 * EmpSql =
		 * " select emp.empno,emp.pfno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name "
		 * +
		 * ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt , b.arr_amt , t1.net_amt basic,t2.net_amt+t3.net_amt+t4.net_amt  totda,t5.net_amt pf"
		 * +
		 * " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2,PAYTRAN t3,PAYTRAN t4 ,PAYTRAN t5 "
		 * +
		 * "  Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 "
		 * + " and t2.empno = emp.empno and t2.trncd = 102 " +
		 * " and t5.empno = emp.empno and t5.trncd = 201 " +
		 * " and t3.empno = emp.empno and t3.trncd = 113 " +
		 * " and t4.empno = emp.empno and t4.trncd = 114 " +
		 * " and t.effdate = ( SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 " +
		 * " WHERE e2.empno = emp.empno and  E2.EFFDATE <= '"+rdt+"' ) " +
		 * " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME = 2 "
		 * + " Union " +
		 * " select emp.empno,emp.pfno,rtrim(emp.lname)+' '+rtrim(emp.fname)+' '+rtrim(emp.mname) name"
		 * +
		 * ", t.branch,s.brname,t.grade,g.alfacd ,b.cal_amt,b.arr_amt, t1.net_amt basic,t2.net_amt  totda ,t3.net_amt pf"
		 * +
		 * " from empmast emp, emptran t ,PAYTRAN b  , branch s ,grade g,PAYTRAN t1,PAYTRAN t2 , PAYTRAN t3 "
		 * +
		 * " Where t.empno = Emp.empno And g.postcd = t.grade And t1.empno = Emp.empno And t1.trncd = 101 "
		 * + "  and t2.empno = emp.empno and t2.trncd = 102" +
		 * "  and t3.empno = emp.empno and t3.trncd = 201" +
		 * " and t.effdate = ( SELECT MAX(E2.EFFDATE)" + " FROM EMPTRAN E2 " +
		 * " wHERE e2.empno = emp.empno and " + " E2.EFFDATE <= '"+rdt+"'  ) " +
		 * " and emp.status = 'A' and b.empno = emp.empno and b.trncd = 201 and s.brcd = t.branch AND EMP.DA_SCHEME <> 2"
		 * + " order by branch,empno";
		 */

		// System.out.println(EmpSql);
		SLINE = stringOfSize(132, '-');
		Statement st;
		try {
			Cn = repBean.getCn();
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("No Any Record Found");

			}

			int i;
			for (i = 1; i <= 7; i++) {
				ALLbrtot[i] = 0;
			}
			emp.beforeFirst();
			while (emp.next()) {

				for (i = 1; i <= 7; i++) {
					brtot[i] = 0;
				}

				String brname = "";
				PBRCD = emp.getInt("PRJ_SRNO");
				while (PBRCD == emp.getInt("PRJ_SRNO")) {
					pfbean = new PFExcelBean();
					pfbean.setBRANCH(emp.getString("PRJ_NAME"));

					pfbean.setEMPNo(emp.getString("EMPNO"));
					pfbean.setPFNO(emp.getString("PFNO") == null ? "0" : emp
							.getString("PFNO"));
					String salute = new LookupHandler().getLKP_Desc("SALUTE",
							Integer.parseInt(emp.getString("SALUTE")));
					if (emp.getString("MNAME").equals(null)
							|| emp.getString("MNAME").equals("")) {
						pfbean.setEMPNAME(salute + emp.getString("FNAME") + " "
								+ emp.getString("MNAME") + " "
								+ emp.getString("LNAME"));
					} else {
						pfbean.setEMPNAME(salute + emp.getString("FNAME") + " "
								+ emp.getString("MNAME").charAt(0) + ". "
								+ emp.getString("LNAME"));

					}

					pfbean.setBASIC(emp.getString("BASIC") == null ? "0" : emp
							.getString("BASIC"));
					brtot[1] = brtot[1] + Math.round(emp.getInt("BASIC"));
					pfbean.setDA(emp.getString("DA"));
					brtot[2] = brtot[2] + Math.round(emp.getInt("DA"));
					gross = (emp.getString("BASIC") != null ? 0 : emp
							.getInt("BASIC"))
							+ (emp.getString("DA") != null ? 0 : emp
									.getInt("DA"));
					if (gross >= 6500) {
						gross = 6500;
					}
					brtot[3] = brtot[3] + gross;
					pfbean.setGROSS(String.valueOf(gross));
					pfbean.setPF(emp.getString("PF") == null ? "0" : emp
							.getString("PF"));

					brtot[4] = brtot[4] + emp.getInt("PF");
					pfchk = (int) (Math.round(gross * 0.0367) + Math
							.round(gross * 0.0833));
					if (pfchk < emp.getInt("PF")) {
						pfchk = emp.getInt("PF") - pfchk;
					} else if (emp.getInt("PF") < pfchk) {
						pfchk = emp.getInt("PF") - pfchk;
					} else
						pfchk = 0;
					pfbean.setGROSS8(String.valueOf((int) Math
							.round(gross * 0.0833) + pfchk));

					brtot[5] = (brtot[5] + (int) (Math.round(gross * 0.0833)) + pfchk);
					pfbean.setGROSS3(String.valueOf((int) Math
							.round(gross * 0.0367)));
					brtot[6] = brtot[6] + (int) (Math.round(gross * 0.0367));
					if (!(emp.getString("ARR_AMT") == null)) {
						if (emp.getInt("ARR_AMT") != 0) {

							brtot[4] = brtot[4] + emp.getInt("ARR_AMT");
							arrcal = (int) Math
									.round(emp.getInt("ARR_AMT") * 8.33 / 12);
							brtot[5] = brtot[5] + arrcal;
							arrcal = emp.getInt("ARR_AMT") - arrcal;

							brtot[6] = brtot[6] + arrcal;

						}
					}

					pflist.add(pfbean);
					if (!emp.next()) {
						pfbean = new PFExcelBean();
						pfbean.setBRANCHTOTAL("PROJECT TOTAL");
						pfbean.setBRANCH("other");
						brname = "other";
						pfbean.setBASICTOTAL(String.valueOf(brtot[1]));
						pfbean.setDATOTAL(String.valueOf(brtot[2]));
						pfbean.setGROSSTOTAL(String.valueOf(brtot[3]));
						pfbean.setPFTOTAL(String.valueOf(brtot[4]));
						pfbean.setGR8TOTAL(String.valueOf(brtot[5]));
						pfbean.setGR3TOTAL(String.valueOf(brtot[6]));
						pflist.add(pfbean);
						break;
					}

					brname = emp.getString("PRJ_NAME");

					if (PBRCD != emp.getInt("PRJ_SRNO")) {
						emp.previous();
						break;
					}

				}
				if (!brname.equalsIgnoreCase("other")) {
					pfbean = new PFExcelBean();
					pfbean.setBRANCHTOTAL("PROJECT TOTAL");
					pfbean.setBRANCH(brname);
					pfbean.setBASICTOTAL(String.valueOf(brtot[1]));
					pfbean.setDATOTAL(String.valueOf(brtot[2]));
					pfbean.setGROSSTOTAL(String.valueOf(brtot[3]));
					pfbean.setPFTOTAL(String.valueOf(brtot[4]));
					pfbean.setGR8TOTAL(String.valueOf(brtot[5]));
					pfbean.setGR3TOTAL(String.valueOf(brtot[6]));
					pflist.add(pfbean);
				}

				ALLbrtot[1] = ALLbrtot[1] + brtot[1];
				ALLbrtot[2] = ALLbrtot[2] + brtot[2];
				ALLbrtot[3] = ALLbrtot[3] + brtot[3];
				ALLbrtot[4] = ALLbrtot[4] + brtot[4];
				ALLbrtot[5] = ALLbrtot[5] + brtot[5];
				ALLbrtot[6] = ALLbrtot[6] + brtot[6];

			}

			Cn.close();

		} catch (Exception e) {

			// System.out.println("ERROR is "+e);
			e.printStackTrace();
		}
		return pflist;

	}

	public static void getChallanTaxStatment(String filePath, String date,
			String imagepath, String type, String states) throws IOException,
			SQLException, DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name = "";
		if (type.equalsIgnoreCase("before")) {
			table_name = "PAYTRAN";
		} else {
			table_name = "PAYTRAN_STAGE";
		}

		try {

			if (states.equalsIgnoreCase("MH")) {
				PdfWriter.getInstance(document, file);
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filePath));
				UtilityDAO dao = new UtilityDAO();
				UtilityDAO.lable1 = "Report date : ";
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ", "
						+ prop.getProperty("mailForReport") + " ", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement", new Font(
						Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ ""
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: " "), new Font(
										Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);

				/*
				 * PdfPTable table=new PdfPTable(5);
				 * table.setSpacingBefore(10.0f); table.setWidthPercentage(new
				 * float[]{6,12,40,19,19},new Rectangle(100,100)); PdfPCell
				 * cell1=new PdfPCell(new Phrase("Sr NO",new
				 * Font(Font.TIMES_ROMAN,10)));
				 * cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * table.addCell(cell1); PdfPCell cell2=new PdfPCell(new
				 * Phrase("Employee Code",new Font(Font.TIMES_ROMAN,10)));
				 * cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * table.addCell(cell2); PdfPCell cell3=new PdfPCell(new
				 * Phrase("Employee Name",new Font(Font.TIMES_ROMAN,10)));
				 * cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * table.addCell(cell3); PdfPCell cell4=new PdfPCell(new
				 * Phrase("Gross salary(Rs)",new Font(Font.TIMES_ROMAN,10)));
				 * cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * table.addCell(cell4); PdfPCell cell5=new PdfPCell(new
				 * Phrase("Tax Amount",new Font(Font.TIMES_ROMAN,10)));
				 * cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * table.addCell(cell5); table.setHeaderRows(1);
				 */
				/*
				 * select e.salute ,e.empno,e.fname,e.mname,e.lname,(select
				 * net_amt from ytdtran where trncd=999 and empno=e.empno and
				 * trndt between '2011-04-01' and '2011-04-30') as basic,
				 * (select net_amt from ytdtran where trncd=202 and
				 * empno=e.empno and trndt between '2011-04-01' and
				 * '2011-04-30') as pf from empmast e,emptran t where e.status =
				 * 'A' and t.empno= e.empno order by e.empno
				 */

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				/*
				 * String sql1/*=
				 * "select distinct e.salute,e.empno,e.fname,e.mname,e.lname," +
				 * " (select distinct net_amt from  "
				 * +table_name+" where trncd=199 and empno=e.empno and trndt " +
				 * " between '"
				 * +ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)
				 * +"') basic," + " (select distinct net_amt from "+table_name+
				 * " where trncd=202 and empno=e.empno " +
				 * " and trndt  between '"+ReportDAO.BOM(date
				 * )+"' and '"+ReportDAO.EOM(date)+"') pt " +
				 * " from empmast e,emptran t where e.status='A' and t.empno = e.empno  order by e.empno"
				 * ;
				 */

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ "  ) and sitemast.Site_State Like 'Mah%' "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "' )  order by e.EMPNO";
				;
				// System.out.println("query is--*****--"+sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
						/*
						 * PdfPCell cell1data=new PdfPCell(new
						 * Phrase(""+srno,new Font(Font.TIMES_ROMAN,10)));
						 * cell1data
						 * .setHorizontalAlignment(Element.ALIGN_CENTER);
						 * table.addCell(cell1data);
						 * 
						 * PdfPCell cell1data2=new PdfPCell(new
						 * Phrase(""+rspt.getInt("EMPNO"),new
						 * Font(Font.TIMES_ROMAN,10)));
						 * cell1data2.setHorizontalAlignment
						 * (Element.ALIGN_CENTER); table.addCell(cell1data2);
						 * 
						 * int cd=rspt.getInt("salute");
						 * 
						 * String
						 * empname=lkp.getLKP_Desc("SALUTE",cd)+""+rspt.getString
						 * (
						 * "fname")+" "+rspt.getString("mname")+" "+rspt.getString
						 * ("lname");
						 * 
						 * PdfPCell cell1data3=new PdfPCell(new
						 * Phrase(""+empname,new Font(Font.TIMES_ROMAN,10)));
						 * cell1data3
						 * .setHorizontalAlignment(Element.ALIGN_LEFT);
						 * table.addCell(cell1data3);
						 * 
						 * PdfPCell cell1data4=new PdfPCell(new
						 * Phrase(""+rspt.getInt("CTC"),new
						 * Font(Font.TIMES_ROMAN,10)));
						 * 
						 * cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT)
						 * ; table.addCell(cell1data4);
						 * 
						 * totatlpf=totatlpf + rspt.getInt("pt");
						 * 
						 * PdfPCell cell1data5=new PdfPCell(new
						 * Phrase(""+rspt.getInt("pt"),new
						 * Font(Font.TIMES_ROMAN,10)));
						 * cell1data5.setHorizontalAlignment
						 * (Element.ALIGN_RIGHT); table.addCell(cell1data5);
						 * 
						 * 
						 * PdfPCell totemp = new PdfPCell(new
						 * Phrase("Total Employee:",new
						 * Font(Font.TIMES_ROMAN,10)));
						 * totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * totemp.setColspan(2); table.addCell(totemp); PdfPCell
						 * totempdisp = new PdfPCell(new Phrase(""+i,new
						 * Font(Font.TIMES_ROMAN,10)));
						 * totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
						 * table.addCell(totempdisp); PdfPCell total=new
						 * PdfPCell(new Phrase("Total Profession Tax:",new
						 * Font(Font.TIMES_ROMAN,10)));
						 * total.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * //total.setColspan(2); table.addCell(total); PdfPCell
						 * totaldata=new PdfPCell(new Phrase(""+totatlpf,new
						 * Font(Font.TIMES_ROMAN,10)));
						 * totaldata.setHorizontalAlignment
						 * (Element.ALIGN_RIGHT); table.addCell(totaldata);
						 * document.add(table);
						 */
						// ////////////////////////////////
					}
				}
				para = new Paragraph(
						new Phrase(
								"Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase(
						"Callings and Employments-Taxes on Employments",
						new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades ,Callings and Employments-Taxes on Employments",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like 'Mah%'"
						+ "  and eran.SRNO=(select max(SRNO) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				// System.out.println("pt query is "+sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				PdfPCell celtotalhead = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1 = new PdfPCell(new Phrase(
						"Interest Amount", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2 = new PdfPCell(new Phrase(
						"Year/Quarter/Month ", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3 = new PdfPCell(new Phrase(
						"Net Amount Payable", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3 = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4 = new PdfPCell(new Phrase(
						"Profession Tax Registration Certificate No.",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4 = new PdfPCell(new Phrase("Period From ",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5 = new PdfPCell(new Phrase("Period To",
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);

				PdfPCell celtotalhead6 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7 = new PdfPCell(new Phrase(""
						+ ReportDAO.BOM(date), new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8 = new PdfPCell(new Phrase(""
						+ ReportDAO.EOM(date), new Font(Font.TIMES_ROMAN, 10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell = new PdfPCell(new Phrase(
						"Name and Address: " + prop.getProperty("companyName")
								+ "  " + prop.getProperty("reportAddress")
								+ "  ", new Font(Font.TIMES_ROMAN, 10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell = new PdfPCell(
						new Phrase(
								" The above statements are true to the best of my knowledge and belief.",
								new Font(Font.TIMES_ROMAN, 10)));
				newcell.setColspan(4);
				table1.addCell(newcell);

				PdfPTable tab = new PdfPTable(2);
				PdfPCell t1 = new PdfPCell(new Phrase("Date:", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t1);

				PdfPCell t2 = new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3 = new PdfPCell(new Phrase("Place:  ", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t3);

				PdfPCell t4 = new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5 = new PdfPCell(new Phrase(
						"Signature:& Designation", new Font(Font.TIMES_ROMAN,
								10)));
				tab.addCell(t5);

				PdfPCell t6 = new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7 = new PdfPCell(
						new Phrase(
								"1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",
								new Font(Font.TIMES_ROMAN, 10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8 = new PdfPCell(new Phrase(
						"For the Treasury Use Only", new Font(Font.TIMES_ROMAN,
								10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);

				/*
				 * PdfPCell newcell1=new PdfPCell(new Phrase(
				 * "Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only "
				 * ,new Font(Font.TIMES_ROMAN,10)));
				 */
				PdfPCell newcell1 = new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding(10.0f);
				table1.addCell(newcell1);

				PdfPCell newcell2 = new PdfPCell(new Phrase(
						"Received Rs. (in Words)", new Font(Font.TIMES_ROMAN,
								10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3 = new PdfPCell(new Phrase(
						"Rupees (in Figures)", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell3);

				PdfPCell newcell4 = new PdfPCell(new Phrase(""
						+ originalNumToLetter.getInWords("" + tax_amt),
						new Font(Font.TIMES_ROMAN, 10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5 = new PdfPCell(new Phrase("" + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell5);

				PdfPCell newcell6 = new PdfPCell(new Phrase("Date of Entry: ",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7 = new PdfPCell(new Phrase("Challan No:",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9 = new PdfPCell(new Phrase(
						"\n \n Treasurer.Officer  ", new Font(Font.TIMES_ROMAN,
								10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				// newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91 = new PdfPCell(new Phrase(
						"\n \n Accountant. ", new Font(Font.TIMES_ROMAN, 10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92 = new PdfPCell(new Phrase(
						"\n \n Treasury  Agent or Manager. ", new Font(
								Font.TIMES_ROMAN, 10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");
			}

			else if (states.equalsIgnoreCase("KT")) {

				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport") + ",", new Font(
								Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement", new Font(
						Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ ""
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: " "), new Font(
										Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ " ) and sitemast.Site_State Like 'Kar%' "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				;
				// System.out.println("query is--*****--"+sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;

					}
				}

				para = new Paragraph(
						new Phrase(
								"Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase(
						"Callings and Employments-Taxes on Employments",
						new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades ,Callings and Employments-Taxes on Employments",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like 'Kar%'"
						+ "  and eran.SRNO=(select max(SRNO) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				// System.out.println("pt query is "+sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				PdfPCell celtotalhead = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1 = new PdfPCell(new Phrase(
						"Interest Amount", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2 = new PdfPCell(new Phrase(
						"Year/Quarter/Month ", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3 = new PdfPCell(new Phrase(
						"Net Amount Payable", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3 = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4 = new PdfPCell(new Phrase(
						"Profession Tax Registration Certificate No.",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4 = new PdfPCell(new Phrase("Period From ",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5 = new PdfPCell(new Phrase("Period To",
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);

				PdfPCell celtotalhead6 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7 = new PdfPCell(new Phrase(""
						+ ReportDAO.BOM(date), new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8 = new PdfPCell(new Phrase(""
						+ ReportDAO.EOM(date), new Font(Font.TIMES_ROMAN, 10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell = new PdfPCell(
						new Phrase("Name and Address: "
								+ prop.getProperty("companyName") + " "
								+ prop.getProperty("reportAddress") + " ",
								new Font(Font.TIMES_ROMAN, 10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell = new PdfPCell(
						new Phrase(
								" The above statements are true to the best of my knowledge and belief.",
								new Font(Font.TIMES_ROMAN, 10)));
				newcell.setColspan(4);
				table1.addCell(newcell);

				PdfPTable tab = new PdfPTable(2);
				PdfPCell t1 = new PdfPCell(new Phrase("Date:", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t1);

				PdfPCell t2 = new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3 = new PdfPCell(new Phrase("Place:  ", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t3);

				PdfPCell t4 = new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5 = new PdfPCell(new Phrase(
						"Signature:& Designation", new Font(Font.TIMES_ROMAN,
								10)));
				tab.addCell(t5);

				PdfPCell t6 = new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7 = new PdfPCell(
						new Phrase(
								"1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",
								new Font(Font.TIMES_ROMAN, 10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8 = new PdfPCell(new Phrase(
						"For the Treasury Use Only", new Font(Font.TIMES_ROMAN,
								10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);

				/*
				 * PdfPCell newcell1=new PdfPCell(new Phrase(
				 * "Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only "
				 * ,new Font(Font.TIMES_ROMAN,10)));
				 */
				PdfPCell newcell1 = new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding(10.0f);
				table1.addCell(newcell1);

				PdfPCell newcell2 = new PdfPCell(new Phrase(
						"Received Rs. (in Words)", new Font(Font.TIMES_ROMAN,
								10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3 = new PdfPCell(new Phrase(
						"Rupees (in Figures)", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell3);

				PdfPCell newcell4 = new PdfPCell(new Phrase(""
						+ originalNumToLetter.getInWords("" + tax_amt),
						new Font(Font.TIMES_ROMAN, 10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5 = new PdfPCell(new Phrase("" + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell5);

				PdfPCell newcell6 = new PdfPCell(new Phrase("Date of Entry: ",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7 = new PdfPCell(new Phrase("Challan No:",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9 = new PdfPCell(new Phrase(
						"\n \n Treasurer.Officer  ", new Font(Font.TIMES_ROMAN,
								10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				// newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91 = new PdfPCell(new Phrase(
						"\n \n Accountant. ", new Font(Font.TIMES_ROMAN, 10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92 = new PdfPCell(new Phrase(
						"\n \n Treasury  Agent or Manager. ", new Font(
								Font.TIMES_ROMAN, 10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");

			}

			else if (states.equalsIgnoreCase("GA")) {

				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport") + ",", new Font(
								Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement", new Font(
						Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ ""
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: " "), new Font(
										Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' )"
						+ "  ) and sitemast.Site_State Like 'Goa%' "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				;
				// System.out.println("query is--*****--"+sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
					}
				}

				para = new Paragraph(
						new Phrase(
								"Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase(
						"Callings and Employments-Taxes on Employments",
						new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades ,Callings and Employments-Taxes on Employments",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like 'Goa%'"
						+ "  and eran.SRNO=(select max(SRNO) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				// System.out.println("pt query is "+sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				PdfPCell celtotalhead = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1 = new PdfPCell(new Phrase(
						"Interest Amount", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2 = new PdfPCell(new Phrase(
						"Year/Quarter/Month ", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3 = new PdfPCell(new Phrase(
						"Net Amount Payable", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3 = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4 = new PdfPCell(new Phrase(
						"Profession Tax Registration Certificate No.",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4 = new PdfPCell(new Phrase("Period From ",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5 = new PdfPCell(new Phrase("Period To",
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);

				PdfPCell celtotalhead6 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7 = new PdfPCell(new Phrase(""
						+ ReportDAO.BOM(date), new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8 = new PdfPCell(new Phrase(""
						+ ReportDAO.EOM(date), new Font(Font.TIMES_ROMAN, 10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell = new PdfPCell(new Phrase(
						"Name and Address: " + prop.getProperty("companyName")
								+ "  " + prop.getProperty("reportAddress")
								+ "  ", new Font(Font.TIMES_ROMAN, 10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell = new PdfPCell(
						new Phrase(
								" The above statements are true to the best of my knowledge and belief.",
								new Font(Font.TIMES_ROMAN, 10)));
				newcell.setColspan(4);
				table1.addCell(newcell);

				PdfPTable tab = new PdfPTable(2);
				PdfPCell t1 = new PdfPCell(new Phrase("Date:", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t1);

				PdfPCell t2 = new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3 = new PdfPCell(new Phrase("Place:  ", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t3);

				PdfPCell t4 = new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5 = new PdfPCell(new Phrase(
						"Signature:& Designation", new Font(Font.TIMES_ROMAN,
								10)));
				tab.addCell(t5);

				PdfPCell t6 = new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7 = new PdfPCell(
						new Phrase(
								"1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",
								new Font(Font.TIMES_ROMAN, 10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8 = new PdfPCell(new Phrase(
						"For the Treasury Use Only", new Font(Font.TIMES_ROMAN,
								10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);

				/*
				 * PdfPCell newcell1=new PdfPCell(new Phrase(
				 * "Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only "
				 * ,new Font(Font.TIMES_ROMAN,10)));
				 */
				PdfPCell newcell1 = new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding(10.0f);
				table1.addCell(newcell1);

				PdfPCell newcell2 = new PdfPCell(new Phrase(
						"Received Rs. (in Words)", new Font(Font.TIMES_ROMAN,
								10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3 = new PdfPCell(new Phrase(
						"Rupees (in Figures)", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell3);

				PdfPCell newcell4 = new PdfPCell(new Phrase(""
						+ originalNumToLetter.getInWords("" + tax_amt),
						new Font(Font.TIMES_ROMAN, 10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5 = new PdfPCell(new Phrase("" + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell5);

				PdfPCell newcell6 = new PdfPCell(new Phrase("Date of Entry: ",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7 = new PdfPCell(new Phrase("Challan No:",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9 = new PdfPCell(new Phrase(
						"\n \n Treasurer.Officer  ", new Font(Font.TIMES_ROMAN,
								10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				// newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91 = new PdfPCell(new Phrase(
						"\n \n Accountant. ", new Font(Font.TIMES_ROMAN, 10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92 = new PdfPCell(new Phrase(
						"\n \n Treasury  Agent or Manager. ", new Font(
								Font.TIMES_ROMAN, 10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");

			} else if (states.equalsIgnoreCase("ALL")) {

				PdfWriter.getInstance(document, file);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(""
						+ prop.getProperty("addressForReport") + ",", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Challan statement", new Font(
						Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ ""
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: " "), new Font(
										Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' )"
						+ " )  "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				;
				// System.out.println("query is--*****--"+sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;

					}
				}

				para = new Paragraph(
						new Phrase(
								"Return-cum-Chalan B.S.T.R.C. No., if any,The Maharashtra State Tax on Professions,",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(10.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades, Callings And Employments, Act, 1975 AND Rule 11,11-A, 11-B, 11-C",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"0028, Other Taxes on Income and ExpenditureTaxes on Professions, Trades ",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);

				para = new Paragraph(new Phrase(
						"Callings and Employments-Taxes on Employments",
						new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"Trades ,Callings and Employments-Taxes on Employments",
								new Font(Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  "
						+ "  and eran.SRNO=(select max(SRNO) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				// System.out.println("pt query is "+sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				PdfPCell celtotalhead = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead);
				PdfPCell celtotal = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal.setColspan(3);
				table1.addCell(celtotal);

				PdfPCell celtotalhead1 = new PdfPCell(new Phrase(
						"Interest Amount", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead1);
				PdfPCell celtotal1 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal1.setColspan(3);
				table1.addCell(celtotal1);
				PdfPCell celtotalhead2 = new PdfPCell(new Phrase(
						"Year/Quarter/Month ", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead2);
				PdfPCell celtotal2 = new PdfPCell(new Phrase("Rs.", new Font(
						Font.TIMES_ROMAN, 10)));
				celtotal2.setColspan(3);
				table1.addCell(celtotal2);

				PdfPCell celtotalhead3 = new PdfPCell(new Phrase(
						"Net Amount Payable", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead3);
				PdfPCell celtotal3 = new PdfPCell(new Phrase("Rs." + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal3.setColspan(3);
				table1.addCell(celtotal3);

				PdfPCell celtotalhead4 = new PdfPCell(new Phrase(
						"Profession Tax Registration Certificate No.",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead4);
				PdfPCell celtotal4 = new PdfPCell(new Phrase("Period From ",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal4);
				PdfPCell celtotal5 = new PdfPCell(new Phrase("Period To",
						new Font(Font.TIMES_ROMAN, 10)));
				celtotal5.setColspan(2);
				table1.addCell(celtotal5);

				PdfPCell celtotalhead6 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotalhead6);
				PdfPCell celtotal7 = new PdfPCell(new Phrase(""
						+ ReportDAO.BOM(date), new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(celtotal7);
				PdfPCell celtotal8 = new PdfPCell(new Phrase(""
						+ ReportDAO.EOM(date), new Font(Font.TIMES_ROMAN, 10)));
				celtotal8.setColspan(2);
				table1.addCell(celtotal8);
				PdfPCell namecell = new PdfPCell(new Phrase(
						"Name and Address: " + prop.getProperty("companyName")
								+ "  " + prop.getProperty("reportAddress")
								+ "  ", new Font(Font.TIMES_ROMAN, 10)));
				namecell.setColspan(4);
				table1.addCell(namecell);

				PdfPCell newcell = new PdfPCell(
						new Phrase(
								" The above statements are true to the best of my knowledge and belief.",
								new Font(Font.TIMES_ROMAN, 10)));
				newcell.setColspan(4);
				table1.addCell(newcell);

				PdfPTable tab = new PdfPTable(2);
				PdfPCell t1 = new PdfPCell(new Phrase("Date:", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t1);

				PdfPCell t2 = new PdfPCell(new Phrase(" "));
				tab.addCell(t2);

				PdfPCell t3 = new PdfPCell(new Phrase("Place:  ", new Font(
						Font.TIMES_ROMAN, 10)));
				tab.addCell(t3);

				PdfPCell t4 = new PdfPCell(new Phrase(" "));
				tab.addCell(t4);
				PdfPCell t5 = new PdfPCell(new Phrase(
						"Signature:& Designation", new Font(Font.TIMES_ROMAN,
								10)));
				tab.addCell(t5);

				PdfPCell t6 = new PdfPCell(new Phrase(" "));
				tab.addCell(t6);
				PdfPCell t7 = new PdfPCell(
						new Phrase(
								"1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3 dated 11-10-2000, w.e.f. 1.4.2000. ",
								new Font(Font.TIMES_ROMAN, 10)));
				t7.setColspan(2);
				tab.addCell(t7);
				PdfPCell t8 = new PdfPCell(new Phrase(
						"For the Treasury Use Only", new Font(Font.TIMES_ROMAN,
								10)));
				t8.setColspan(2);
				t8.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(t8);

				/*
				 * PdfPCell newcell1=new PdfPCell(new Phrase(
				 * "Date:                         Place:                                  Signature:& Designation                                                                                   1. Form III was substituted by G.N. No. TFT-1100/CR-57/Taxation-3          dated 11-10-2000, w.e.f. 1.4.2000.                   For the Treasury Use Only "
				 * ,new Font(Font.TIMES_ROMAN,10)));
				 */
				PdfPCell newcell1 = new PdfPCell(tab);
				newcell1.setColspan(4);
				newcell1.setPadding(10.0f);
				table1.addCell(newcell1);

				PdfPCell newcell2 = new PdfPCell(new Phrase(
						"Received Rs. (in Words)", new Font(Font.TIMES_ROMAN,
								10)));
				newcell2.setColspan(3);
				table1.addCell(newcell2);

				PdfPCell newcell3 = new PdfPCell(new Phrase(
						"Rupees (in Figures)", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell3);

				PdfPCell newcell4 = new PdfPCell(new Phrase(""
						+ originalNumToLetter.getInWords("" + tax_amt),
						new Font(Font.TIMES_ROMAN, 10)));
				newcell4.setColspan(3);
				table1.addCell(newcell4);

				PdfPCell newcell5 = new PdfPCell(new Phrase("" + tax_amt,
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(newcell5);

				PdfPCell newcell6 = new PdfPCell(new Phrase("Date of Entry: ",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell6.setColspan(2);
				newcell6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table1.addCell(newcell6);
				PdfPCell newcell7 = new PdfPCell(new Phrase("Challan No:",
						new Font(Font.TIMES_ROMAN, 10)));
				newcell7.setHorizontalAlignment(Element.ALIGN_LEFT);
				newcell7.setColspan(2);
				table1.addCell(newcell7);

				PdfPCell newcell9 = new PdfPCell(new Phrase(
						"\n \n Treasurer.Officer  ", new Font(Font.TIMES_ROMAN,
								10)));
				newcell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				// newcell9.setColspan(2);
				table1.addCell(newcell9);

				PdfPCell newcell91 = new PdfPCell(new Phrase(
						"\n \n Accountant. ", new Font(Font.TIMES_ROMAN, 10)));
				newcell91.setHorizontalAlignment(Element.ALIGN_CENTER);

				table1.addCell(newcell91);
				PdfPCell newcell92 = new PdfPCell(new Phrase(
						"\n \n Treasury  Agent or Manager. ", new Font(
								Font.TIMES_ROMAN, 10)));
				newcell92.setColspan(2);
				newcell92.setHorizontalAlignment(Element.ALIGN_CENTER);
				table1.addCell(newcell92);

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();
				// System.out.println("pdf Generated Successfully");

			}

		} catch (Exception e) {

			e.printStackTrace();
		}
		document.open();

	}

	public static void getProfessionTaxStatment(String filePath, String date,
			String imagepath, String type, String state) throws IOException,
			SQLException, DocumentException

	{

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name = "";
		lable1 = "Report date : ";
		if (type.equalsIgnoreCase("before")) {
			table_name = "PAYTRAN";
		} else {
			table_name = "PAYTRAN_STAGE";
		}

		try {
			if (state.equalsIgnoreCase("M")) {
				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(""
						+ prop.getProperty("addressForReport") + ",", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ " "
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: "(After Finalize)"),
								new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table = new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[] { 6, 12, 40, 19, 19 },
						new Rectangle(100, 100));
				PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
						Font.TIMES_ROMAN, 10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code",
						new Font(Font.TIMES_ROMAN, 10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name",
						new Font(Font.TIMES_ROMAN, 10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
						new Font(Font.TIMES_ROMAN, 10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);
				/*
				 * select e.salute ,e.empno,e.fname,e.mname,e.lname,(select
				 * net_amt from ytdtran where trncd=999 and empno=e.empno and
				 * trndt between '2011-04-01' and '2011-04-30') as basic,
				 * (select net_amt from ytdtran where trncd=202 and
				 * empno=e.empno and trndt between '2011-04-01' and
				 * '2011-04-30') as pf from empmast e,emptran t where e.status =
				 * 'A' and t.empno= e.empno order by e.empno
				 */

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;
				/*
				 * String sql1 =
				 * "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
				 * + "  y1.cal_amt as CTC," + "  y2.cal_amt as pt " +
				 * "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
				 * +
				 * " left join [HPM].[dbo].[Project_Sites] sitemast"
				 * + " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join " +
				 * table_name + " y1 on e.EMPNO = y1.EMPNO " + "  join " +
				 * table_name + " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
				 * + "  and y1.TRNDT between '" + ReportDAO.BOM(date) +
				 * "' and '" + ReportDAO.EOM(date) + "' and y2.TRNCD = 202 " +
				 * "  and y2.TRNDT  between '" + ReportDAO.BOM(date) + "' and '"
				 * + ReportDAO.EOM(date) + "'" + " and e.doj <='" +
				 * ReportDAO.EOM(date) + "'" +
				 * "  and e.EMPNO in(select distinct EMPNO from " + table_name +
				 * "  where TRNCD=202 and TRNDT  between '" +
				 * ReportDAO.BOM(date) + "' and '" + ReportDAO.EOM(date) + "')"
				 * + "  ) and sitemast.Site_State Like 'Mah%' " +
				 * "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
				 * + ReportDAO.EOM(date) + "') order by e.EMPNO";
				 */
				String sql1 = "select  e.empcode,e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ "  ) and sitemast.Site_State Like 'Mah%' "
						+ "  and eran.srno = (SELECT Max(SRNO) FROM   emptran WHERE  empno = e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') order by convert(int,e.empcode)";
				System.out.println("query is----" + sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				double totalsalary = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
						PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
								new Font(Font.TIMES_ROMAN, 10)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);

						PdfPCell cell1data2 = new PdfPCell(new Phrase(""
								+ rspt.getString("empcode"), new Font(
								Font.TIMES_ROMAN, 10)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data2);

						int cd = rspt.getInt("salute");

						String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
								+ rspt.getString("fname") + " "
								+ rspt.getString("mname") + " "
								+ rspt.getString("lname");

						PdfPCell cell1data3 = new PdfPCell(new Phrase(""
								+ empname, new Font(Font.TIMES_ROMAN, 10)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);
						
						/**********************************************************/
						totalsalary = totalsalary + rspt.getInt("CTC");
						/**********************************************************/

						PdfPCell cell1data4 = new PdfPCell(new Phrase(""
								+ rspt.getInt("CTC"), new Font(
								Font.TIMES_ROMAN, 10)));

						cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data4);

						totatlpf = totatlpf + rspt.getInt("pt");

						PdfPCell cell1data5 = new PdfPCell(new Phrase(""
								+ rspt.getInt("pt"), new Font(Font.TIMES_ROMAN,
								10)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data5);
					}
				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
						new Font(Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				
				PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
						Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				
				/*PdfPCell total = new PdfPCell(
						new Phrase("Total Profession Tax:", new Font(
								Font.TIMES_ROMAN, 10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				// total.setColspan(2);
				table.addCell(total);*/
				
				PdfPCell total = new PdfPCell(
						new Phrase("Salary :     "+totalsalary, new Font(
								Font.TIMES_ROMAN, 10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(total);
				
				PdfPCell totaldata = new PdfPCell(new Phrase("Tax :     " + totatlpf,
						new Font(Font.TIMES_ROMAN, 10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like 'Mah%'"
						+ "  and eran.srno=(select max(srno) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "')  "
						+ " GROUP BY cal_amt order by PT";

				System.out.println("pt query is " + sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();
			}

			else if (state.equalsIgnoreCase("K")) {

				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(""
						+ prop.getProperty("addressForReport") + ",", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ " "
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: "(After Finalize)"),
								new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table = new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[] { 6, 12, 40, 19, 19 },
						new Rectangle(100, 100));
				PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
						Font.TIMES_ROMAN, 10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code",
						new Font(Font.TIMES_ROMAN, 10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name",
						new Font(Font.TIMES_ROMAN, 10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
						new Font(Font.TIMES_ROMAN, 10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ "  ) and sitemast.Site_State Like 'Karn%' "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				System.out.println("query is----" + sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
						PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
								new Font(Font.TIMES_ROMAN, 10)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);

						PdfPCell cell1data2 = new PdfPCell(new Phrase(""
								+ rspt.getInt("EMPNO"), new Font(
								Font.TIMES_ROMAN, 10)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data2);

						int cd = rspt.getInt("salute");

						String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
								+ rspt.getString("fname") + " "
								+ rspt.getString("mname") + " "
								+ rspt.getString("lname");

						PdfPCell cell1data3 = new PdfPCell(new Phrase(""
								+ empname, new Font(Font.TIMES_ROMAN, 10)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);

						PdfPCell cell1data4 = new PdfPCell(new Phrase(""
								+ rspt.getInt("CTC"), new Font(
								Font.TIMES_ROMAN, 10)));

						cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data4);

						totatlpf = totatlpf + rspt.getInt("pt");

						PdfPCell cell1data5 = new PdfPCell(new Phrase(""
								+ rspt.getInt("pt"), new Font(Font.TIMES_ROMAN,
								10)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data5);

					}
				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
						new Font(Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
						Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total = new PdfPCell(
						new Phrase("Total Profession Tax:", new Font(
								Font.TIMES_ROMAN, 10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				// total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata = new PdfPCell(new Phrase("" + totatlpf,
						new Font(Font.TIMES_ROMAN, 10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like 'Karn%' "
						+ " and eran.SRNO=(select max(SRNO) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				System.out.println("pt query is " + sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();

			}

			else if (state.equalsIgnoreCase("G")) {

				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(""
						+ prop.getProperty("addressForReport") + ",", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ " "
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: "(After Finalize)"),
								new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table = new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[] { 6, 12, 40, 19, 19 },
						new Rectangle(100, 100));
				PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
						Font.TIMES_ROMAN, 10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code",
						new Font(Font.TIMES_ROMAN, 10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name",
						new Font(Font.TIMES_ROMAN, 10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
						new Font(Font.TIMES_ROMAN, 10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ " ) and sitemast.Site_State Like 'Goa%' "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				System.out.println("query is----" + sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {
					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
						PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
								new Font(Font.TIMES_ROMAN, 10)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);

						PdfPCell cell1data2 = new PdfPCell(new Phrase(""
								+ rspt.getInt("EMPNO"), new Font(
								Font.TIMES_ROMAN, 10)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data2);

						int cd = rspt.getInt("salute");

						String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
								+ rspt.getString("fname") + " "
								+ rspt.getString("mname") + " "
								+ rspt.getString("lname");

						PdfPCell cell1data3 = new PdfPCell(new Phrase(""
								+ empname, new Font(Font.TIMES_ROMAN, 10)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);

						PdfPCell cell1data4 = new PdfPCell(new Phrase(""
								+ rspt.getInt("CTC"), new Font(
								Font.TIMES_ROMAN, 10)));

						cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data4);

						totatlpf = totatlpf + rspt.getInt("pt");

						PdfPCell cell1data5 = new PdfPCell(new Phrase(""
								+ rspt.getInt("pt"), new Font(Font.TIMES_ROMAN,
								10)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data5);
					}
				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
						new Font(Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
						Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total = new PdfPCell(
						new Phrase("Total Profession Tax:", new Font(
								Font.TIMES_ROMAN, 10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				// total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata = new PdfPCell(new Phrase("" + totatlpf,
						new Font(Font.TIMES_ROMAN, 10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);
				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'  and sitemast.Site_State Like'Goa%' "
						+ " and eran.srno=(select max(srno) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				System.out.println("pt query is " + sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();

			} else if (state.equalsIgnoreCase("ALL")) {

				UtilityDAO dao = new UtilityDAO();
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filePath));

				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				document.open();
				Image image1 = Image.getInstance(imagepath);
				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);
				document.add(image1);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				document.add(para);

				para = new Paragraph(new Phrase(""
						+ prop.getProperty("addressForReport") + ",", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(""
						+ prop.getProperty("contactForReport") + ","
						+ prop.getProperty("mailForReport") + "", new Font(
						Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase("Profession Tax statement",
						new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				para = new Paragraph(
						new Phrase(
								"For The Month Of "
										+ date.substring(3, 11)
										+ " "
										+ (type.equalsIgnoreCase("before") ? " (Before Finalize)"
												: "(After Finalize)"),
								new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
				para.setAlignment(Element.ALIGN_CENTER);
				// para.setSpacingBefore(30.0f);
				para.setSpacingAfter(0);
				document.add(para);
				PdfPTable table = new PdfPTable(5);
				table.setSpacingBefore(10.0f);
				table.setWidthPercentage(new float[] { 6, 12, 40, 19, 19 },
						new Rectangle(100, 100));
				PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
						Font.TIMES_ROMAN, 10)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1);
				PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code",
						new Font(Font.TIMES_ROMAN, 10)));
				cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name",
						new Font(Font.TIMES_ROMAN, 10)));
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell3);
				PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
						new Font(Font.TIMES_ROMAN, 10)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell4);
				PdfPCell cell5 = new PdfPCell(new Phrase("Tax Amount",
						new Font(Font.TIMES_ROMAN, 10)));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell5);
				table.setHeaderRows(1);

				Connection con = null;
				con = ConnectionManager.getConnection();
				Statement stmt = con.createStatement();
				ResultSet rspt = null;

				String sql1 = "select distinct e.dol,e.salute,e.empno,e.fname,e.mname,e.lname,"
						+ "  y1.cal_amt as CTC,"
						+ "  y2.cal_amt as pt "
						+ "  from  EMPMAST e  left join EMPTRAN eran on e.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ " on sitemast.Site_ID=eran.PRJ_SRNO" + "  join "
						+ table_name
						+ " y1 on e.EMPNO = y1.EMPNO "
						+ "  join "
						+ table_name
						+ " y2 on (e.EMPNO = y2.EMPNO and y1.TRNCD = 199 "
						+ "  and y1.TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "' and y2.TRNCD = 202 "
						+ "  and y2.TRNDT  between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "'"
						+ " and e.doj <='"
						+ ReportDAO.EOM(date)
						+ "'"
						+ "  and e.EMPNO in(select distinct EMPNO from "
						+ table_name
						+ "  where TRNCD=202 and TRNDT between '"
						+ ReportDAO.BOM(date)
						+ "' and '"
						+ ReportDAO.EOM(date)
						+ "')"
						+ "  ) "
						+ "  and eran.EFFDATE=(select max(effdate) from emptran where empno=e.empno and EFFDATE<='"
						+ ReportDAO.EOM(date) + "')  order by e.EMPNO";
				System.out.println("query is----" + sql1);

				rspt = stmt.executeQuery(sql1);
				int srno = 0;
				double totatlpf = 0;
				LookupHandler lkp = new LookupHandler();
				int i = 0;
				while (rspt.next()) {

					if (rspt.getInt("pt") > 0) {
						i++;

						srno++;
						PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
								new Font(Font.TIMES_ROMAN, 10)));
						cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data);

						PdfPCell cell1data2 = new PdfPCell(new Phrase(""
								+ rspt.getInt("EMPNO"), new Font(
								Font.TIMES_ROMAN, 10)));
						cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
						table.addCell(cell1data2);

						int cd = rspt.getInt("salute");

						String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
								+ rspt.getString("fname") + " "
								+ rspt.getString("mname") + " "
								+ rspt.getString("lname");

						PdfPCell cell1data3 = new PdfPCell(new Phrase(""
								+ empname, new Font(Font.TIMES_ROMAN, 10)));
						cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
						table.addCell(cell1data3);

						PdfPCell cell1data4 = new PdfPCell(new Phrase(""
								+ rspt.getInt("CTC"), new Font(
								Font.TIMES_ROMAN, 10)));

						cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data4);

						totatlpf = totatlpf + rspt.getInt("pt");

						PdfPCell cell1data5 = new PdfPCell(new Phrase(""
								+ rspt.getInt("pt"), new Font(Font.TIMES_ROMAN,
								10)));
						cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						table.addCell(cell1data5);

					}
				}
				PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
						new Font(Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totemp.setColspan(2);
				table.addCell(totemp);
				PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
						Font.TIMES_ROMAN, 10)));
				totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(totempdisp);
				PdfPCell total = new PdfPCell(
						new Phrase("Total Profession Tax:", new Font(
								Font.TIMES_ROMAN, 10)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				// total.setColspan(2);
				table.addCell(total);
				PdfPCell totaldata = new PdfPCell(new Phrase("" + totatlpf,
						new Font(Font.TIMES_ROMAN, 10)));
				totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(totaldata);
				document.add(table);

				document.add(para);

				PdfPTable table1 = new PdfPTable(4);
				table1.setSpacingBefore(10.0f);
				table1.setWidthPercentage(new float[] { 40, 20, 20, 20 },
						new Rectangle(100, 100));

				PdfPCell cellhead1 = new PdfPCell(new Phrase(
						"Employees whose monthly,Salaries, Wages", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead1);
				PdfPCell cellhead2 = new PdfPCell(
						new Phrase("Rate of Tax per Month", new Font(
								Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead2);
				PdfPCell cellhead3 = new PdfPCell(new Phrase(
						"No. of Employees", new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead3);
				PdfPCell cellhead4 = new PdfPCell(new Phrase(
						"Amount Of Tax Deducted",
						new Font(Font.TIMES_ROMAN, 10)));
				table1.addCell(cellhead4);

				String sqlquery = "select DISTINCT(p.cal_amt) as pt, sum(p.cal_amt) as tot_amt, COUNT(p.empno) as tot_emp"
						+ " from "
						+ table_name
						+ " p left join EMPTRAN eran on p.EMPNO=eran.EMPNO"
						+ " left join [HPM].[dbo].[Project_Sites] sitemast"
						+ "  on sitemast.Site_ID=eran.PRJ_SRNO where p.trncd =  202 and "
						+ " p.trndt  between '"
						+ ReportDAO.BOM(date)
						+ "'"
						+ " and '"
						+ ReportDAO.EOM(date)
						+ "'   "
						+ " and eran.srno=(select max(srno) from emptran where empno=p.empno and EFFDATE<='"
						+ ReportDAO.EOM(date)
						+ "') "
						+ " GROUP BY cal_amt order by PT";

				System.out.println("pt query is111 " + sqlquery);
				Statement stmnt2 = con.createStatement();
				ResultSet reslt = null;
				reslt = stmnt2.executeQuery(sqlquery);
				// first row
				int tax_amt = 0;

				while (reslt.next()) {

					if (reslt.getInt("pt") == 0) {
						PdfPCell cellhdata1 = new PdfPCell(new Phrase(
								"Do not exceed Rs.", new Font(Font.TIMES_ROMAN,
										10)));
						table1.addCell(cellhdata1);
						PdfPCell cellhdata2 = new PdfPCell(new Phrase("NIL",
								new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata2);
						PdfPCell cellhdata3 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata3);
						PdfPCell cellhdata4 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata4);
					} else if (reslt.getInt("pt") == 30) {
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata01 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 2,000 but do not exceed Rs. 2,500",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata01);
						PdfPCell cellhdata02 = new PdfPCell(new Phrase(
								"Rs. 30 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata02);
						PdfPCell cellhdata03 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata03);
						PdfPCell cellhdata04 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata04);
					} else if (reslt.getInt("pt") == 60) {
						// System.out.println("now in pt 60");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(new Phrase(
								"Exceed Rs. 2,500 but do not exceed Rs. 3,500",
								new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								"Rs. 60 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 120) {
						// System.out.println("now in pt 120");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						PdfPCell cellhdata011 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 3,500 but do not exceed Rs. 5,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata011);
						PdfPCell cellhdata012 = new PdfPCell(new Phrase(
								" Rs. 120 ", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata012);
						PdfPCell cellhdata013 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata013);
						PdfPCell cellhdata014 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata014);
					} else if (reslt.getInt("pt") == 175.00) {
						// System.out.println("now in pt 175");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						System.out.println("totamt in 175"
								+ reslt.getInt("tot_amt"));
						PdfPCell cellhdata021 = new PdfPCell(
								new Phrase(
										" Exceed Rs. 5,000 but do not exceed Rs. 10,000",
										new Font(Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata021);
						PdfPCell cellhdata022 = new PdfPCell(new Phrase(
								"Rs. 175", new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata022);
						PdfPCell cellhdata023 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata023);
						PdfPCell cellhdata024 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata024);

					} else if (reslt.getInt("pt") == 200.00
							|| reslt.getInt("pt") == 300.00) {
						// System.out.println("now in pt 200");
						tax_amt = tax_amt + reslt.getInt("tot_amt");
						// System.out.println(""+tax_amt);
						// System.out.println("totamt in 200"+reslt.getInt("tot_amt")+reslt.getInt("tot_emp"));
						PdfPCell cellhdata031 = new PdfPCell(new Phrase(
								"Exceeds Rs. 10,000", new Font(
										Font.TIMES_ROMAN, 10)));
						table1.addCell(cellhdata031);
						PdfPCell cellhdata032 = new PdfPCell(
								new Phrase(
										" Rs.2,500 per annum \n to be paid in the Follwing manner: \n a)Rs.200 per month exceptin the month of february \n b)Rs.300 per month of february",
										new Font(Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata032);
						PdfPCell cellhdata033 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_emp"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata033);
						PdfPCell cellhdata034 = new PdfPCell(new Phrase(""
								+ reslt.getInt("tot_amt"), new Font(
								Font.TIMES_ROMAN, 9)));
						table1.addCell(cellhdata034);

					}
				}

				document.add(table1);
				document.newPage(); // Opened new page
				document.close();
				file.close();
				con.close();

			}

		} catch (Exception e) {

			e.printStackTrace();
		}
		document.open();
	}

	public static void getForm10(String filePath, String date, String date1,
			String imagepath) throws IOException, SQLException,
			DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		try {
			Connection con = null;
			con = ConnectionManager.getConnection();
			Statement stmt = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			ResultSet rspt = null;
			LookupHandler lkp = new LookupHandler();
			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filePath));

			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);

			Phrase title = new Phrase("FORM-10", new Font(Font.TIMES_ROMAN, 9,
					Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);

			doc.add(para);

			para = new Paragraph(
					new Phrase(
							"THE EMPLOYEE'S PROVIDENT FUNDS SCHEME, 1952 [Paragraph 36 (2) (a) & (b)]",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			para = new Paragraph(new Phrase(
					"AND THE EMPLOYEE'S PENSION SCHEME, 1995 [Para - 20 (2)]",
					new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			para = new Paragraph(new Phrase(
					"Return of the members leaving service during the month of : "
							+ date.substring(3, 11), new Font(Font.TIMES_ROMAN,
							9)));
			para.setAlignment(Element.ALIGN_LEFT);

			para.setSpacingAfter(5);
			doc.add(para);

			para = new Paragraph(new Phrase(
					"Name and address of the Factory/Estt : "
							+ prop.getProperty("companyName")
							+ ",                         CODE NO:_________",
					new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable table = new PdfPTable(7);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[] { 5, 13, 15, 15, 9, 16, 10 },
					new Rectangle(80, 100));
			PdfPCell cell1 = new PdfPCell(new Phrase("SR NO", new Font(
					Font.TIMES_ROMAN, 10)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2 = new PdfPCell(new Phrase("Account No.", new Font(
					Font.TIMES_ROMAN, 10)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3 = new PdfPCell(new Phrase(
					"Name of Member (in block letters)", new Font(
							Font.TIMES_ROMAN, 10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4 = new PdfPCell(
					new Phrase(
							"Father's Name (or husband's name in case of married women)",
							new Font(Font.TIMES_ROMAN, 10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5 = new PdfPCell(new Phrase("Date of Leaving",
					new Font(Font.TIMES_ROMAN, 10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6 = new PdfPCell(new Phrase(
					"Reason for leaving Service",
					new Font(Font.TIMES_ROMAN, 10)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7 = new PdfPCell(new Phrase("Remarks", new Font(
					Font.TIMES_ROMAN, 10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);
			table.setHeaderRows(1);

			String sql = "SELECT e.EMPNO, e.SALUTE, e.FNAME, e.MNAME, e.LNAME, e.DOL, t.ACNO,isnull(r.REASON,'') as reason  FROM EMPMAST e, EMPTRAN t,RELIEVEINFO r "
					+ "WHERE DOL BETWEEN '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date1)
					+ "' AND e.EMPNO = t.EMPNO and e.empno=r.empno "
					+ "AND e.STATUS='N' and t.srno=(select max(srno) from emptran where empno=e.EMPNO) ORDER BY e.EMPNO";
			System.out.println("********" + sql);
			rspt = stmt.executeQuery(sql);
			int srno = 1;
			String re = null;
			if (!rspt.next()) {
				PdfPCell cell1data1 = new PdfPCell(new Phrase(
						" No Records Found For The Month "
								+ ReportDAO.BOM(date) + " To "
								+ ReportDAO.EOM(date1), new Font(
								Font.TIMES_ROMAN, 10)));
				cell1data1.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell1data1.setFixedHeight(18.0f);
				cell1data1.setColspan(7);
				table.addCell(cell1data1);
			}

			rspt.beforeFirst();

			while (rspt.next()) {

				PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2 = new PdfPCell(new Phrase(""
						+ rspt.getString("ACNO"),
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);

				String EmpName = lkp.getLKP_Desc("SALUTE",
						rspt.getInt("salute"))
						+ " "
						+ rspt.getString("fname")
						+ " "
						+ rspt.getString("mname")
						+ " "
						+ rspt.getString("lname");
				PdfPCell cell1data3 = new PdfPCell(new Phrase("" + EmpName,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				String MName = lkp.getLKP_Desc("SALUTE", rspt.getInt("salute"))
						+ " " + rspt.getString("mname") + " "
						+ rspt.getString("lname");
				PdfPCell cell1data4 = new PdfPCell(new Phrase("" + MName,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data4);

				PdfPCell cell1data5 = new PdfPCell(
						new Phrase("" + rspt.getString("DOL"), new Font(
								Font.TIMES_ROMAN, 10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data5);
				re = rspt.getString("reason");
				PdfPCell cell1data6 = new PdfPCell(new Phrase("" + re,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data6);

				PdfPCell cell1data7 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 10)));
				cell1data7.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data7);
				srno++;
			}

			table.setSpacingAfter(50.0f);
			doc.add(table);

			para = new Paragraph(new Phrase(
					"Signature of the Employer or other authorised officer",
					new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(10);
			doc.add(para);

			para = new Paragraph(
					new Phrase(
							"Date :______________                                                           "
									+ "                                                                          Stamp of the Factory/Estt",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(15);
			doc.add(para);

			para = new Paragraph(
					new Phrase(
							"*Please state whether the member is (a) retiring according to para (69) (1) (a) or (b) of the scheme (b) leaving India for "
									+ "permanent settlement abroad (c) retrenchment (d) Pt. & total disablement due to employment injury (e) discharged (f) "
									+ "resigning from or leaving service (g) taking up employment elsewhere (The name & address of the Employers should be "
									+ "stated) (h) death. (i) atained the age of 58 years.",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			doc.add(para);

			para = new Paragraph(
					new Phrase(
							"*Certified that the member mentioned at Serial No_________Shri_______________________________________________________was "
									+ "paid/not paid retrenchment compensation of Rs_________________________________________under the industrial Dispute Act. 1947.",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(50);
			doc.add(para);

			para = new Paragraph(new Phrase(
					"Signature of the Employer                       ",
					new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(0);
			doc.add(para);

			doc.close();

			stmt.close();
			con.close();
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void getESICLIST(String filePath, String date,
			String imagepath, String type) throws IOException, SQLException,
			DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name = "";
		lable1 = "Report date : ";
		if (type.equalsIgnoreCase("before")) {
			table_name = "PAYTRAN";
		} else {
			table_name = "PAYTRAN_STAGE";
		}
		try {
			// PdfWriter.getInstance(document, file);
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f);
			document.add(image1);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase(""
					+ prop.getProperty("addressForReport") + ",", new Font(
					Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(""
					+ prop.getProperty("contactForReport") + ","
					+ prop.getProperty("mailForReport") + "", new Font(
					Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("E.S.I.C List "
					+ (type.equalsIgnoreCase("before") ? "" : ""), new Font(
					Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Month Of "
					+ date.substring(3), new Font(Font.TIMES_ROMAN, 9,
					Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			PdfPTable table = new PdfPTable(6);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[] { 6, 12, 40, 14, 14, 14 },
					new Rectangle(100, 100));
			PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
					Font.TIMES_ROMAN, 10)));
			cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell1);
			PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code", new Font(
					Font.TIMES_ROMAN, 10)));
			cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell2);
			PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name", new Font(
					Font.TIMES_ROMAN, 10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell6 = new PdfPCell(new Phrase("Payble Days", new Font(
					Font.TIMES_ROMAN, 10)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
					new Font(Font.TIMES_ROMAN, 10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5 = new PdfPCell(new Phrase("Esic Amount", new Font(
					Font.TIMES_ROMAN, 10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			table.setHeaderRows(1);

			Connection con = null;
			con = ConnectionManager.getConnection();
			Statement stmt = con.createStatement();
			ResultSet rspt = null;

			/*
			 * String
			 * sql1="select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,"
			 * +
			 * " (select distinct net_amt from ytdtran where trncd=199 and empno=e.empno and trndt "
			 * + " between '"+ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+
			 * "') basic," +
			 * " (select distinct net_amt from ytdtran where trncd=221 and empno=e.empno "
			 * + " and trndt  between '"+ReportDAO.BOM(date
			 * )+"' and '"+ReportDAO.EOM(date)+"') esic " +
			 * " from empmast e,emptran t where e.status='A' and t.empno = e.empno  order by e.empno"
			 * ;
			 */
			String sql1 = "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join PAYTRAN y1 on e.EMPNO = y1.EMPNO join PAYTRAN y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 198 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and y2.cal_amt>0  "
					+ " UNION "
					+ "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join PAYTRAN_STAGE y1 on e.EMPNO = y1.EMPNO join PAYTRAN_STAGE y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 198 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and y2.cal_amt>0  "
					+ " UNION "
					+ "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic from EMPMAST e join YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 198 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and y2.cal_amt>0  order by empcode ";

			System.out.println("query is" + sql1);

			rspt = stmt.executeQuery(sql1);
			int srno = 0;
			double totatlesic = 0;
			LookupHandler lkp = new LookupHandler();
			int i = 0;
			while (rspt.next()) {

				float nodays = Calculate.getDays(date);

				ResultSet rs7 = null;
				Statement statement = con.createStatement();
				rs7 = statement.executeQuery("select "
						+ Calculate.getDays(date)
						+ " - DAY(DOJ)+1 from empmast where empno ="
						+ rspt.getInt("EMPNO") + " and doj between cast('"
						+ ReportDAO.BOM(date) + "' as DATE) and cast('"
						+ ReportDAO.EOM(date) + "' as DATE)");
				if (rs7.next()) {
					nodays = rs7.getFloat(1);
				}
				// === For Date of Leaving in same Month
				rs7 = statement.executeQuery("select " + nodays
						+ " - (DAY(cast('" + ReportDAO.EOM(date)
						+ "' as DATE))- DAY(DOL)) from empmast where empno ="
						+ rspt.getInt("EMPNO") + " and dol between cast('"
						+ ReportDAO.BOM(date) + "' as DATE) and cast('"
						+ ReportDAO.EOM(date) + "' as DATE)");
				if (rs7.next()) {
					/*
					 * int day = rs7.getInt(1); paiddays = day;
					 */
					nodays = rs7.getFloat(1);
				}

				System.out.println("-------------" + nodays);

				if (rspt.getInt("esic") > 0) {
					i++;
				}
				srno++;
				PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2 = new PdfPCell(new Phrase(""
						+ rspt.getString("EMPCODE"), new Font(Font.TIMES_ROMAN,
						10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data2);

				int cd = rspt.getInt("salute");

				String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
						+ rspt.getString("fname") + " "
						+ rspt.getString("mname") + " "
						+ rspt.getString("lname");

				PdfPCell cell1data3 = new PdfPCell(new Phrase("" + empname,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				PdfPCell cell1data6 = new PdfPCell(new Phrase("" + nodays,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data6);

				PdfPCell cell1data4 = new PdfPCell(new Phrase(""
						+ rspt.getInt("basic"), new Font(Font.TIMES_ROMAN, 10)));

				cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data4);

				totatlesic = totatlesic + rspt.getInt("esic");

				PdfPCell cell1data5 = new PdfPCell(new Phrase(""
						+ rspt.getInt("esic"), new Font(Font.TIMES_ROMAN, 10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data5);

			}
			PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
					new Font(Font.TIMES_ROMAN, 10)));
			totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totemp.setColspan(2);
			table.addCell(totemp);
			PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
					Font.TIMES_ROMAN, 10)));
			totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(totempdisp);
			PdfPCell total = new PdfPCell(new Phrase("Total E.S.I.C:",
					new Font(Font.TIMES_ROMAN, 10)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			total.setColspan(2);
			table.addCell(total);
			PdfPCell totaldata = new PdfPCell(new Phrase("" + totatlesic,
					new Font(Font.TIMES_ROMAN, 10)));
			totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
			table.addCell(totaldata);
			document.add(table);
			document.close();
			file.close();
			con.close();
			// System.out.println("pdf Generated Successfully");

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void getESICLISTNEW(String filePath, String date,
			String imagepath, String type) throws IOException, SQLException,
			DocumentException {
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant properties Manager " + e);
		}

		// System.out.println("in new ECISLIST generate");

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;
		int Srno = 0;
		float nodays = 0.0f;
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totalAmount = 0.0f;
		try {

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			Document doc = new Document(new Rectangle(2384, 3370));
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filePath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 1300f,
					1830f, 45);
			Image image1 = Image.getInstance(imagepath);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			Font f = new Font(Font.HELVETICA, 30);
			Font f1 = new Font(Font.HELVETICA, 22);
			Font f2 = new Font(Font.HELVETICA, 32);

			para = new Paragraph(new Phrase("For The Month Of "
					+ date.substring(3), new Font(Font.TIMES_ROMAN, 25,
					Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			doc.add(para);

			Rectangle rec = new Rectangle(100, 100);

			float Gross = 0.0f;
			float ESIC = 0.0f;

			/*
			 * String sql1 =
			 * "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic ,T.PRJ_SRNO as PRJ_SRNO from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join PAYTRAN y1 on e.EMPNO = y1.EMPNO join PAYTRAN y2 on e.EMPNO = y2.EMPNO "
			 * +
			 * "and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+
			 * "' and '"+ReportDAO.EOM(date)+"' " +
			 * "and y2.TRNCD = 221 and y2.TRNDT between '"
			 * +ReportDAO.BOM(date)+"' and '"
			 * +ReportDAO.EOM(date)+"'   and y2.cal_amt>0  " +
			 * "and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
			 * +ReportDAO.EOM(date)+"')"+ " UNION "+
			 * "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic ,T.PRJ_SRNO as PRJ_SRNO from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join PAYTRAN_STAGE y1 on e.EMPNO = y1.EMPNO join PAYTRAN_STAGE y2 on e.EMPNO = y2.EMPNO "
			 * +
			 * "and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+
			 * "' and '"+ReportDAO.EOM(date)+"' " +
			 * "and y2.TRNCD = 221 and y2.TRNDT between '"
			 * +ReportDAO.BOM(date)+"' and '"
			 * +ReportDAO.EOM(date)+"'   and y2.cal_amt>0  "+
			 * "and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
			 * +ReportDAO.EOM(date)+"')"+ " UNION "+
			 * "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,y1.cal_amt as basic,y2.cal_amt as esic,T.PRJ_SRNO as PRJ_SRNO from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO "
			 * +
			 * "and y1.TRNCD = 198 and y1.TRNDT between '"+ReportDAO.BOM(date)+
			 * "' and '"+ReportDAO.EOM(date)+"' " +
			 * "and y2.TRNCD = 221 and y2.TRNDT between '"
			 * +ReportDAO.BOM(date)+"' and '"
			 * +ReportDAO.EOM(date)+"'   and y2.cal_amt>0 " +
			 * "and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
			 * +ReportDAO.EOM(date)+"')"+ " order by PRJ_SRNO, empcode ";
			 */
			// ////////////////////////////cre3ated c by akshay

			String sql1 = "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.DOB,e.DOJ,e.ESICNO,e.AADHAARNUM,T.ACNO,y1.cal_amt as basic, "
					+ "y2.cal_amt as esic,T.PRJ_SRNO as PRJ_SRNO , "
					+ "case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "then (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "else (SELECT '' AS ifsc) END AS 'ifsc', "
					+ "case when exists (select telno from EMPAUX where EMPNO=e.empno) "
					+ "then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno and "
					+ "id=(select MAX(id) from EMPAUX  where EMPNO=e.empno)) "
					+ "else (SELECT 0 AS telno) END AS 'telno' "
					+ "from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join "
					+ "paytran y1 on e.EMPNO = y1.EMPNO join paytran y2 on e.EMPNO = y2.EMPNO and y1.TRNCD = 198 and y1.TRNDT "
					+ "between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and "
					+ "y2.cal_amt>0 and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(date)
					+ "') "
					+

					"union "
					+ "select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.DOB,e.DOJ,e.ESICNO,e.AADHAARNUM,T.ACNO,y1.cal_amt as basic, "
					+ "y2.cal_amt as esic,T.PRJ_SRNO as PRJ_SRNO , "
					+ "case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "then (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "else (SELECT '' AS ifsc) END AS 'ifsc', "
					+ "case when exists (select telno from EMPAUX where EMPNO=e.empno) "
					+ "then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno and "
					+ "id=(select MAX(id) from EMPAUX  where EMPNO=e.empno)) "
					+ "else (SELECT 0 AS telno) END AS 'telno' "
					+ "from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join "
					+ "paytran_stage y1 on e.EMPNO = y1.EMPNO join paytran_stage y2 on e.EMPNO = y2.EMPNO and y1.TRNCD = 198 and y1.TRNDT "
					+ "between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and "
					+ "y2.cal_amt>0 and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(date)
					+ "') "
					+

					"union "
					+ "  select e.salute,e.empno,CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.DOB,e.DOJ,e.ESICNO,e.AADHAARNUM,T.ACNO,y1.cal_amt as basic, "
					+ "y2.cal_amt as esic,T.PRJ_SRNO as PRJ_SRNO , "
					+ "case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "then (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "else (SELECT '' AS ifsc) END AS 'ifsc', "
					+ "case when exists (select telno from EMPAUX where EMPNO=e.empno) "
					+ "then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno and "
					+ "id=(select MAX(id) from EMPAUX  where EMPNO=e.empno)) "
					+ "else (SELECT 0 AS telno) END AS 'telno' "
					+ "from EMPMAST e join EMPTRAN T on  e.EMPNO = T.EMPNO join "
					+ "YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO and y1.TRNCD = 198 and y1.TRNDT "
					+ "between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' and y2.TRNCD = 221 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'   and "
					+ "y2.cal_amt>0 and T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
					+ ReportDAO.EOM(date)
					+ "')  "
					+ "order by PRJ_SRNO, empcode";

			System.out.println("query is" + sql1);

			LookupHandler lkp = new LookupHandler();

			ResultSet rs = st.executeQuery(sql1);
			int i = 0;
			while (rs.next()) {

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
						+ rs.getString("PRJ_SRNO") + "'";
				// System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if (prj.next()) {
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;
				para = new Paragraph(new Phrase(
						"Employee's ESIC List For Project Site : " + prj_name
								+ " (" + prj_code + ")", f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				doc.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(13);
				main.setSpacingBefore(10);
				// main.setWidthPercentage(new float[]{6,12,40,14,14,14f}, rec);

				PdfPCell maincell;
				// PdfPTable tab = new PdfPTable(15);
				// tab.setSpacingBefore(10);

				/*
				 * Font f = new Font(Font.HELVETICA,22); Font f1 = new
				 * Font(Font.HELVETICA,20); Font fbold = new
				 * Font(Font.HELVETICA,22,Font.BOLD); Font f2 = new
				 * Font(Font.HELVETICA,22);
				 */
				main.setWidthPercentage(new float[] { 3.5f, 15.5f, 9.3f, 6.8f,
						6.8f, 8.6f, 8.3f, 8.3f, 8.3f, 6.3f, 6.3f, 8.3f, 4.3f },
						rec);
				// main.setHorizontalAlignment(Element.ALIGN_CENTER);
				// PdfPCell maincell ;
				maincell = new PdfPCell(new Phrase("SR NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setFixedHeight(24);
				// maincell.disableBorderSide(rec.BOTTOM);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPNAME", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				// maincell.disableBorderSide(rec.BOTTOM);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("FATHER/HUSBAND'S NAME", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("DOB", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("DOJ", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("ESIC INSURANCE NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("P.F No",f1));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */
				maincell = new PdfPCell(new Phrase("ADHAAR CARD NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("PAN CARD NO",f1));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("BANK A/C NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("IFSC NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("MOBILE NO", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("PRESENT DAYS", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("GORSS AMT", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("ESIC DED.AMT", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				// main.setHeaderRows(1);
				// /////////////////////////////////////
				/*
				 * maincell = new PdfPCell(new Phrase("Sr No",f1));
				 * maincell.setFixedHeight(50);
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("EMP CODE",f1));
				 * maincell.setFixedHeight(50);
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("EMPLOYEE NAME",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("Payable Days",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("Gross Salary (Rs)",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("Esic Amount",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				// doc.add(main);

				nodays = Calculate.getDays(date);
				System.out.println("No of ..." + nodays);
				while (pBrcd1.equalsIgnoreCase(rs.getString("PRJ_SRNO"))) {
					Connection con1 = null;
					con1 = ConnectionManager.getConnection();
					ResultSet rs7 = null;
					Statement statement1 = con1.createStatement();
					String q = "select " + Calculate.getDays(date)
							+ " - DAY(DOJ)+1 from empmast where empno ="
							+ rs.getInt("EMPNO") + " and doj between cast('"
							+ ReportDAO.BOM(date) + "' as DATE) and cast('"
							+ ReportDAO.EOM(date) + "' as DATE)";
					rs7 = statement1.executeQuery(q);

					if (rs7.next()) {
						nodays = rs7.getFloat(1);

					} else {
						nodays = Calculate.getDays(date);
					}

					// === For Date of Leaving in same Month
					rs7 = statement1
							.executeQuery("select "
									+ nodays
									+ " - (DAY(cast('"
									+ ReportDAO.EOM(date)
									+ "' as DATE))- DAY(DOL)) from empmast where empno ="
									+ rs.getInt("EMPNO")
									+ " and dol between cast('"
									+ ReportDAO.BOM(date)
									+ "' as DATE) and cast('"
									+ ReportDAO.EOM(date) + "' as DATE)");

					if (rs7.next()) {
						/*
						 * int day = rs7.getInt(1); paiddays = day;
						 */
						nodays = rs7.getFloat(1);
						if (rs.getInt("EMPNO") == 895) {

							System.out
									.println("No of presentdays-leavedays...."
											+ nodays);

						}
					} else {
						nodays = Calculate.getDays(date);
					}

					statement1.close();

					if (rs.getInt("esic") > 0) {
						i++;
					}

					Srno++;
					SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");
					// float date=Calculate.getDays(PAYREGDT);
					datatab = new PdfPTable(13);

					datatab.setWidthPercentage(new float[] { 3.5f, 15.5f, 9.3f,
							6.8f, 6.8f, 8.6f, 8.3f, 8.3f, 8.3f, 6.3f, 6.3f,
							8.3f, 4.3f }, rec);

					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
					PdfPCell cell0;
					cell0 = new PdfPCell(new Phrase("" + Srno, f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell0.setFixedHeight(50);
					datatab.addCell(cell0);
					datatab.addCell(new Phrase(""
							+ FixStr(
									rs.getString("FNAME") + " "
											+ rs.getString("MNAME") + " "
											+ rs.getString("LNAME"), 30, 1), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase(""
							+ FixStr(
									rs.getString("MNAME") + " "
											+ rs.getString("LNAME"), 30, 1), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase(""
							+ output.format(rs.getDate("DOB")), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase(""
							+ output.format(rs.getDate("DOJ")), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase("" + rs.getString("ESICNO"), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase("" + rs.getString("AADHAARNUM"),
							f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					datatab.addCell(new Phrase("" + rs.getString("ACNO"), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					String ifsc = "" + rs.getString("ifsc");/*
															 * !=null?""+rs.
															 * getString
															 * ("ifsc"):"";
															 */
					if (ifsc.equalsIgnoreCase("null")) {
						// System.out.println("ifsc Record Found    "+ifsc);
						datatab.addCell(new Phrase("", f1));
						cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					} else {
						datatab.addCell(new Phrase("" + ifsc, f1));

						cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					}
					String mob = "" + rs.getString("TELNO");/*
															 * !=null?""+rs.
															 * getString
															 * ("ifsc"):"";
															 */
					if (mob.equalsIgnoreCase("null"))

					{
						// System.out.println("mob Record Found    "+ifsc);
						datatab.addCell(new Phrase("", f1));
						cell0.setHorizontalAlignment(Element.ALIGN_CENTER);

					} else {
						datatab.addCell(new Phrase("" + mob, f1));

						cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					}

					/*
					 * PdfPCell cell1 = new PdfPCell(new
					 * Phrase(""+rs.getString("EMPCODE"),f1));
					 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * cell1.setFixedHeight(50); datatab.addCell(cell1); int
					 * cd=rs.getInt("salute"); String
					 * empname=lkp.getLKP_Desc("SALUTE"
					 * ,cd)+""+rs.getString("fname"
					 * )+" "+rs.getString("mname")+" "+rs.getString("lname");
					 * 
					 * PdfPCell cell2 = new PdfPCell(new Phrase(""+empname,f1));
					 * cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					 * datatab.addCell(cell2);
					 */
					// by harshal
					float absentDays = 0;
					int empno = rs.getInt("EMPNO");

					absentDays = getAbsentDays(date, empno);

					float result = nodays - absentDays;
					cell0 = new PdfPCell(new Phrase("" + Math.abs(result), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell0);

					Gross = Gross + rs.getInt("basic");
					cell0 = new PdfPCell(
							new Phrase("" + rs.getInt("basic"), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell0);

					ESIC = ESIC + rs.getInt("esic");
					cell0 = new PdfPCell(new Phrase("" + rs.getInt("esic"), f1));
					cell0.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell0);

					totalAmount = totalAmount + rs.getInt("esic");

					/*
					 * PdfPCell cell9 = new PdfPCell(new Phrase("",f1));
					 * cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * datatab.addCell(cell9);
					 */

					doc.add(datatab);

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					con1.close();
					if (!rs.next()) {
						break;
					}
					if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						rs.previous();
						break;
					}

				}

				datatot = new PdfPTable(13);
				datatot.setWidthPercentage(new float[] { 3.5f, 15.5f, 9.3f,
						6.8f, 6.8f, 8.6f, 8.3f, 8.3f, 8.3f, 6.3f, 6.3f, 8.3f,
						4.3f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
				cell1.setColspan(3);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell1);

				PdfPCell cell2 = new PdfPCell(new Phrase("", f1));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell2);

				PdfPCell cell7 = new PdfPCell(new Phrase("", f1));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell7);
				PdfPCell cell8 = new PdfPCell(new Phrase("", f1));
				cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell8);
				PdfPCell cell9 = new PdfPCell(new Phrase("", f1));
				cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell9);
				PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
				cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell10);
				PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
				cell13.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell13);
				PdfPCell cell11 = new PdfPCell(new Phrase("", f1));
				cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell11);
				PdfPCell cell12 = new PdfPCell(new Phrase("", f1));
				cell12.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell12);

				PdfPCell cell4 = new PdfPCell(new Phrase("" + Gross, f1));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell4);
				Gross = 0.0f;

				PdfPCell cell5 = new PdfPCell(new Phrase("" + ESIC, f1));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell5);
				ESIC = 0.0f;

				doc.add(datatot);

				para = new Paragraph(new Phrase("No Of Employees :- "
						+ br_tot_no_emp, f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(50);
				doc.add(para);

			}

			para = new Paragraph(new Phrase("Total No Of Employees :- "
					+ tot_no_emp, f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			para = new Paragraph(new Phrase("Total ESIC Amount:- "
					+ totalAmount, f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			// System.out.println("Total No Of Employees :- " + tot_no_emp);

			st.close();
			con.close();
			doc.close();

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	/*
	 * public PdfPCell createcell(String str, String align) { PdfPCell
	 * pdcell=new PdfPCell(new Phrase(""+str,new Font()));
	 * 
	 * return null; }
	 */
	public static void PFLISTPDF(String rdt, String filepath, String type) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		RepoartBean repBean = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		ResultSet empPF = null;
		String EmpSql = "";
		String EmpSqlPF = "";
		int PBRCD = 0;
		int gross = 0;
		int brtot[] = new int[15];
		int ALLbrtot[] = new int[15];
		String table_name = "";
		SimpleDateFormat output = new SimpleDateFormat("dd/MM/yyyy");
		// Rectangle r1= new Rectangle(2384,3370);
		Document doc = new Document();

		if (type.equalsIgnoreCase("before")) {
			table_name = "PAYTRAN";
		} else {
			table_name = "PAYTRAN_STAGE";
		}

		try {

			// Document doc = new Document(new Rectangle(2834,4008));

			/*
			 * doc.left(100f); doc.top(100f); doc.bottom(100f); doc.right(100f);
			 */

			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);
			// Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL, new
			// GrayColor(0.85f));
			/*
			 * PdfWriter writer =PdfWriter.getInstance(doc, new
			 * FileOutputStream(filepath)); HeaderAndFooter haf = new
			 * HeaderAndFooter(lable1,label2); writer.setPageEvent(haf);
			 * doc.open(); Font FONT = new Font(Font.HELVETICA,190, Font.NORMAL,
			 * new GrayColor(0.85f));
			 * ColumnText.showTextAligned(writer.getDirectContentUnder(),
			 * Element.ALIGN_CENTER, new
			 * Phrase(prop.getProperty("watermark"),FONT), 1300f, 1830f, 45);
			 * Image image1 = Image.getInstance(imgpath);
			 */

			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(Font.TIMES_ROMAN, 8, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			// image1.scaleAbsolute(310f, 120f);

			// chaange possition of image
			/* image1.setAbsolutePosition(60f, 2750f); */
			// image1.setAbsolutePosition(60f, 3200f);
			// doc.add(image1);
			doc.add(para);

			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 8)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			// PdfPTable tab = new PdfPTable(8);

			// tab.setWidthPercentage(new float[]{6,16,30,10,10,8,10,10}, new
			// Rectangle(100, 100));
			// tab.setSpacingBefore(5);
			// tab.setHorizontalAlignment(Element.ALIGN_CENTER);
			Rectangle rec = new Rectangle(100, 100);

			PdfPTable tab = new PdfPTable(15);
			tab.setSpacingBefore(10);

			Font f = new Font(Font.HELVETICA, 22);
			Font f1 = new Font(Font.HELVETICA, 22);
			Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
			Font f2 = new Font(Font.HELVETICA, 22);

			tab.setWidthPercentage(
					new float[] { 3.5f, 15.5f, 9.3f, 6.8f, 6.8f, 8.6f, 8.3f,
							8.3f, 8.3f, 6.3f, 6.3f, 8.3f, 4.3f, 6.3f, 5.55f },
					rec);
			tab.setHorizontalAlignment(Element.ALIGN_CENTER);
			PdfPCell ddCell;
			ddCell = new PdfPCell(new Phrase("SR NO", new Font(Font.HELVETICA,
					6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			ddCell.setFixedHeight(24);
			// ddCell.disableBorderSide(rec.BOTTOM);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("EMPNAME", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			// ddCell.disableBorderSide(rec.BOTTOM);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("FATHER/HUSBAND'S NAME", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("DOB", new Font(Font.HELVETICA, 6,
					Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("DOJ", new Font(Font.HELVETICA, 6,
					Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("UAN NO", new Font(Font.HELVETICA,
					6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("P.F No", new Font(Font.HELVETICA,
					6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("ADHAAR CARD NO", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("PAN CARD NO", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("BANK A/C  NO", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("IFSC   CODE NO", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("MOBILE NO", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("NCP DAYS", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("BASIC +DA", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);

			ddCell = new PdfPCell(new Phrase("PF DED. AMT", new Font(
					Font.HELVETICA, 6, Font.BOLD)));
			ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(ddCell);
			// doc.add(tab);
			tab.setHeaderRows(1);
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();
			
			
			EmpSql = "select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, e.DOJ, "
					+ "e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) then  "
					+ "(select f3 from OTHERDETAIL where EMPNO=e.empno) else (SELECT '' AS ifsc) END AS 'ifsc', case when exists  "
					+ "(select telno from EMPAUX where EMPNO=e.empno) then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno "
					+ "and id= (select MAX(id) from EMPAUX  where EMPNO=e.empno)) else (SELECT 0 AS telno) END AS 'telno', CASE WHEN  "
					+ "EXISTS(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   	THEN	(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN "
					+ " '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', (SELECT (NET_AMT) "
					+ "FROM   paytran WHERE TRNCD in (201) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) AS PF , "
					+ " CASE WHEN EXISTS(SELECT (NET_AMT) FROM   paytran WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ " AND EMPNO = e.EMPNO)  	THEN	(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' "
					+ "and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) "
					+ "ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO "
					+ "join paytran p on p.EMPNO=e.empno and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' and "
					+ "p.TRNCD=201  and p.NET_AMT>0 and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ "group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
					+ "union "
					+ "select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, e.DOJ, "
					+ "e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) then "
					+ "(select f3 from OTHERDETAIL where EMPNO=e.empno) else (SELECT '' AS ifsc) END AS 'ifsc', case when exists "
					+ "(select telno from EMPAUX where EMPNO=e.empno) then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno "
					+ "and id= (select MAX(id) from EMPAUX  where EMPNO=e.empno)) else (SELECT 0 AS telno) END AS 'telno', CASE WHEN "
					+ "EXISTS(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   	THEN	(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN "
					+ " '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', "
					+ "(SELECT (NET_AMT) FROM   paytran_stage WHERE TRNCD in (201) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) AS PF , "
					+ "CASE WHEN EXISTS(SELECT (NET_AMT) FROM   paytran_stage WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ " AND EMPNO = e.EMPNO)  	THEN	(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' "
					+ " and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) "
					+ " ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO "
					+ " join paytran_stage p on p.EMPNO=e.empno and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' and "
					+ " p.TRNCD=201  and p.NET_AMT>0 and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ " group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
					+ "union "
					+

					"select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) "
					+ "as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, "
					+ "e.DOJ,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, "
					+ "case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "then (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "else (SELECT '' AS ifsc) END AS 'ifsc', "
					+ "case when exists (select telno from EMPAUX where EMPNO=e.empno) "
					+ "then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno and "
					+ "id= "
					+ "(select MAX(id) from EMPAUX  where EMPNO=e.empno)) "
					+ "else (SELECT 0 AS telno) END AS 'telno', "
					+ "CASE WHEN EXISTS(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in ( 101, 102, 130 ) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   "
					+ "	THEN	(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in ( 101, 102, 130 ) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', "
					+ "(SELECT (NET_AMT)  FROM   ytdtran WHERE TRNCD in (201) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) AS PF , "
					+ "CASE WHEN EXISTS(SELECT (NET_AMT) FROM   ytdtran WHERE TRNCD in (301) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)  "
					+ "	THEN	(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in (301) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' "
					+ "from EMPMAST e "
					+ "join EMPTRAN t "
					+ "on e.EMPNO=t.EMPNO "
					+ "join ytdtran p "
					+ "on p.EMPNO=e.empno "
					+ "and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "and p.TRNCD=201  and p.NET_AMT>0 "
					+ "and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ "group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
					+ "order by empcode ";
			
			/*-----------------------------------Prasad Start-----------------------------------------------------------*/
			
			EmpSqlPF = "select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, e.DOJ, "
					+ "e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) then  "
					+ "(select f3 from OTHERDETAIL where EMPNO=e.empno) else (SELECT '' AS ifsc) END AS 'ifsc', case when exists  "
					+ "(select telno from EMPAUX where EMPNO=e.empno) then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno "
					+ "and id= (select MAX(id) from EMPAUX  where EMPNO=e.empno)) else (SELECT 0 AS telno) END AS 'telno', CASE WHEN  "
					+ "EXISTS(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   	THEN	(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN "
					+ " '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', (SELECT (NET_AMT) "
					+ "FROM   paytran WHERE TRNCD in (201) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) AS PF , "
					+ " CASE WHEN EXISTS(SELECT (NET_AMT) FROM   paytran WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ " AND EMPNO = e.EMPNO)  	THEN	(SELECT sum(NET_AMT) FROM   paytran WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' "
					+ "and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) "
					+ "ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO "
					+ "join paytran p on p.EMPNO=e.empno and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' and "
					+ "p.TRNCD=201  and p.NET_AMT>0 and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ "group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
					+ "union "
					+ "select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, e.DOJ, "
					+ "e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) then "
					+ "(select f3 from OTHERDETAIL where EMPNO=e.empno) else (SELECT '' AS ifsc) END AS 'ifsc', case when exists "
					+ "(select telno from EMPAUX where EMPNO=e.empno) then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno "
					+ "and id= (select MAX(id) from EMPAUX  where EMPNO=e.empno)) else (SELECT 0 AS telno) END AS 'telno', CASE WHEN "
					+ "EXISTS(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   	THEN	(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in ( 101, 102, 130 ) AND TRNDT BETWEEN "
					+ " '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', "
					+ "(SELECT (NET_AMT) FROM   paytran_stage WHERE TRNCD in (201) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) AS PF , "
					+ "CASE WHEN EXISTS(SELECT (NET_AMT) FROM   paytran_stage WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ " AND EMPNO = e.EMPNO)  	THEN	(SELECT sum(NET_AMT) FROM   paytran_stage WHERE TRNCD in (301) AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' "
					+ " and '"
					+ ReportDAO.EOM(rdt)
					+ "' AND EMPNO = e.EMPNO) "
					+ " ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' from EMPMAST e join EMPTRAN t on e.EMPNO=t.EMPNO "
					+ " join paytran_stage p on p.EMPNO=e.empno and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' and "
					+ " p.TRNCD=201  and p.NET_AMT=0 and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ " group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
				
					+ "union "
					+

					"select e.salute ,e.dob, e.empno, CONVERT(INT, e.empcode) "
					+ "as empcode,e.fname,e.mname,e.lname,e.pfno,e.uanno, "
					+ "e.DOJ,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO, "
					+ "case when exists (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "then (select f3 from OTHERDETAIL where EMPNO=e.empno) "
					+ "else (SELECT '' AS ifsc) END AS 'ifsc', "
					+ "case when exists (select telno from EMPAUX where EMPNO=e.empno) "
					+ "then (select aux.telno from EMPAUX aux where aux.EMPNO=e.empno and "
					+ "id= "
					+ "(select MAX(id) from EMPAUX  where EMPNO=e.empno)) "
					+ "else (SELECT 0 AS telno) END AS 'telno', "
					+ "CASE WHEN EXISTS(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in ( 101, 102, 130 ) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)   "
					+ "	THEN	(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in ( 101, 102, 130 ) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS BASIC_DA) END AS 'BASIC_DA', "
					+ "(SELECT (NET_AMT)  FROM   ytdtran WHERE TRNCD in (201) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) AS PF , "
					+ "CASE WHEN EXISTS(SELECT (NET_AMT) FROM   ytdtran WHERE TRNCD in (301) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO)  "
					+ "	THEN	(SELECT sum(NET_AMT) FROM   ytdtran WHERE TRNCD in (301) "
					+ "AND TRNDT BETWEEN '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "AND EMPNO = e.EMPNO) ELSE	(SELECT 0 AS absentDays) END AS 'absentDays' "
					+ "from EMPMAST e "
					+ "join EMPTRAN t "
					+ "on e.EMPNO=t.EMPNO "
					+ "join ytdtran p "
					+ "on p.EMPNO=e.empno "
					+ "and p.TRNDT between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "and p.TRNCD=201  and p.NET_AMT=0 "
					+ "and t.SRNO=(select max(srno) from EMPTRAN where EMPNO=t.EMPNO) "
					+ "group by e.SALUTE ,e.dob, e.empno,  e.empcode,e.fname,e.mname,e.lname,e.pfno,e.DOJ,e.UANNO,e.AADHAARNUM,e.PANNO,t.ACNO,t.PRJ_SRNO "
					+ "order by empcode ";
			
			Statement stPF;
			stPF = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			empPF = stPF.executeQuery(EmpSqlPF);

			/*-----------------------------------Prasad End-----------------------------------------------------------*/
			
			Statement st;
			System.out.println("into order byyyyyyyyyyy" + EmpSql);
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st.executeQuery(EmpSql);

			int k = 0;
			int l = 0;

			if (!emp.next()) {
				System.out.println("No Any Record Found");
				doc.add(tab);
				doc.close();
				Cn.close();
				System.out.println("No Any Record Found");
				return;
			} else {
				int i;
				for (i = 1; i <= 14; i++) {
					ALLbrtot[i] = 0;
				}
				int count = 1;
				emp.previous();
				for (i = 1; i <= 2; i++) {
					brtot[i] = 0;
				}

				while (emp.next()) {

					PBRCD = emp.getInt("prj_srno");
					while (PBRCD == emp.getInt("prj_srno")) {
						if (emp.getInt("PF") > 0)
							k++;
						int eps = 0;
						int epf = 0;

						tab.addCell(new Phrase("" + count++, new Font(
								Font.HELVETICA, 6)));
						/*
						 * if(emp.getInt("EMPNO")<10) { tab.addCell(new
						 * Phrase("0"+emp.getInt("EMPNO"),new
						 * Font(Font.TIMES_ROMAN,8))); } else { tab.addCell(new
						 * Phrase(""+emp.getInt("EMPNO"),new
						 * Font(Font.TIMES_ROMAN,8))); }
						 */
						/*
						 * tab.addCell(new Phrase(emp.getString("EMPCODE"),new
						 * Font(Font.TIMES_ROMAN,9)));
						 */
						tab.addCell(new Phrase(
								""
										+ FixStr(emp.getString("FNAME") + " "
												+ emp.getString("MNAME") + " "
												+ emp.getString("LNAME"), 30, 1),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(
								""
										+ FixStr(emp.getString("MNAME") + " "
												+ emp.getString("LNAME"), 30, 1),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(""
								+ output.format(emp.getDate("DOB")), new Font(
								Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(""
								+ output.format(emp.getDate("DOJ")), new Font(
								Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase("" + emp.getString("UANNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase("" + emp.getString("PFNO"),
								new Font(Font.HELVETICA, 6)));

						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(
								"" + emp.getString("AADHAARNUM"), new Font(
										Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + emp.getString("PANNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + emp.getString("ACNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						String ifsc = "" + emp.getString("ifsc");/*
																 * !=null?""+emp.
																 * getString
																 * ("ifsc"):"";
																 */
						if (ifsc.equalsIgnoreCase("null")) {
							// System.out.println("ifsc Record Found    "+ifsc);
							tab.addCell(new Phrase("", new Font(Font.HELVETICA,
									6)));
							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						} else {
							tab.addCell(new Phrase("" + ifsc, new Font(
									Font.HELVETICA, 6)));

							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						}
						String mob = "" + emp.getString("TELNO");/*
																 * !=null?""+emp.
																 * getString
																 * ("ifsc"):"";
																 */
						if (mob.equalsIgnoreCase("null"))

						{
							// System.out.println("mob Record Found    "+ifsc);
							tab.addCell(new Phrase("", new Font(Font.HELVETICA,
									6)));
							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						} else {
							tab.addCell(new Phrase("" + mob, new Font(
									Font.HELVETICA, 6)));

							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						}
						/*
						 * tab.addCell(new Phrase(""+emp.getString("TELNO"),new
						 * Font(Font.HELVETICA,6)));
						 * ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						 */
						tab.addCell(new Phrase(
								"" + emp.getString("absentDays"), new Font(
										Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + emp.getString("BASIC_DA"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						brtot[1] = brtot[1]
								+ Math.round(emp.getInt("BASIC_DA"));
						gross = (emp.getString("BASIC_DA") != null ? emp
								.getInt("BASIC_DA") : 0);

						tab.addCell(new Phrase("" + emp.getString("PF"),
								new Font(Font.HELVETICA, 6)));

						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						brtot[2] = brtot[2] + Math.round(emp.getInt("PF"));

						
						if (!emp.next()) {
							break;
						}
						if (PBRCD != emp.getInt("prj_srno")) {
							emp.previous();
							break;
						}
					}
				}

				
				/*-----------------------------------------Prasad Start---------------------------------------------------------------*/
				
				PdfPCell tot = new PdfPCell(new Phrase("Total Employee : " + k,
						new Font(Font.HELVETICA, 6)));
				tot.setHorizontalAlignment(Element.ALIGN_CENTER);
				tot.setColspan(12);
				tab.addCell(tot);

				/*tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
*/
				PdfPCell total = new PdfPCell(new Phrase("Total :", new Font(
						Font.HELVETICA, 6)));
				total.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(total);

				tab.addCell(new Phrase("" + trans(brtot[1], "", "", true, true),
						new Font(Font.HELVETICA, 6)));
				tab.addCell(new Phrase("" + trans(brtot[2], "", "", true, true),
						new Font(Font.HELVETICA, 6)));


				
		
				
				while (empPF.next()) {

					PBRCD = empPF.getInt("prj_srno");
					while (PBRCD == empPF.getInt("prj_srno")) {
						if (empPF.getInt("PF") > 0)
							k++;
						
						int eps = 0;
						int epf = 0;

						tab.addCell(new Phrase("" + count++, new Font(
								Font.HELVETICA, 6)));
						
						tab.addCell(new Phrase(
								""
										+ FixStr(empPF.getString("FNAME") + " "
												+ empPF.getString("MNAME") + " "
												+ empPF.getString("LNAME"), 30, 1),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(
								""
										+ FixStr(empPF.getString("MNAME") + " "
												+ empPF.getString("LNAME"), 30, 1),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(""
								+ output.format(empPF.getDate("DOB")), new Font(
								Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(""
								+ output.format(empPF.getDate("DOJ")), new Font(
								Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase("" + empPF.getString("UANNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase("" + empPF.getString("PFNO"),
								new Font(Font.HELVETICA, 6)));

						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						tab.addCell(new Phrase(
								"" + empPF.getString("AADHAARNUM"), new Font(
										Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + empPF.getString("PANNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + empPF.getString("ACNO"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						String ifsc = "" + empPF.getString("ifsc");
						if (ifsc.equalsIgnoreCase("null")) {

							tab.addCell(new Phrase("", new Font(Font.HELVETICA,
									6)));
							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						} else {
							tab.addCell(new Phrase("" + ifsc, new Font(
									Font.HELVETICA, 6)));

							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						}
						String mob = "" + empPF.getString("TELNO");
						if (mob.equalsIgnoreCase("null"))

						{
							tab.addCell(new Phrase("", new Font(Font.HELVETICA,
									6)));
							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						} else {
							tab.addCell(new Phrase("" + mob, new Font(
									Font.HELVETICA, 6)));
							ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						}
						tab.addCell(new Phrase(
								"" + empPF.getString("absentDays"), new Font(
										Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						tab.addCell(new Phrase("" + empPF.getString("BASIC_DA"),
								new Font(Font.HELVETICA, 6)));
						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);

						brtot[1] = brtot[1]
								+ Math.round(empPF.getInt("BASIC_DA"));
						gross = (empPF.getString("BASIC_DA") != null ? empPF
								.getInt("BASIC_DA") : 0);

						tab.addCell(new Phrase("" + empPF.getString("PF"),
								new Font(Font.HELVETICA, 6)));

						ddCell.setHorizontalAlignment(Element.ALIGN_CENTER);
						brtot[2] = brtot[2] + Math.round(empPF.getInt("PF"));

						
						if (!empPF.next()) {
							break;
						}
						if (PBRCD != empPF.getInt("prj_srno")) {
							empPF.previous();
							break;
						}
					}
				}

			
				
				/*-----------------------------------------Prasad End---------------------------------------------------------------*/
				
				
			}

			//PdfPCell tot = new PdfPCell(new Phrase("Total Employee : " + k, new Font(Font.HELVETICA, 6)));
			PdfPCell tot = new PdfPCell(new Phrase(""));
			tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
			tot.setColspan(12);
			tab.addCell(tot);

/*			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("", new Font(Font.HELVETICA, 6)));
*/
			/*
			 * PdfPCell totdisp = new PdfPCell(new Phrase("Total :",new
			 * Font(Font.HELVETICA,6)));
			 * tot.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * tab.addCell(totdisp);
			 */

			PdfPCell total = new PdfPCell(new Phrase("Total :", new Font(
					Font.HELVETICA, 6)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			tab.addCell(total);

			tab.addCell(new Phrase("" + trans(brtot[1], "", "", true, true),
					new Font(Font.HELVETICA, 6)));
			tab.addCell(new Phrase("" + trans(brtot[2], "", "", true, true),
					new Font(Font.HELVETICA, 6)));

			/*
			 * tab.addCell(new Phrase(""+trans(brtot[3],"","",true,true),new
			 * Font(Font.HELVETICA,6))); tab.addCell(new
			 * Phrase(""+trans(brtot[4],"","",true,true),new
			 * Font(Font.HELVETICA,6)));
			 */
			doc.add(tab);
			doc.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void EcrReport(String rdt, String filepath, String table_name) {

		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		String[] date = rdt.split("-");
		Connection Cn = null;
		ResultSet emp = null;
		String EmpSql = "";
		int epf_total = 0;
		int eps_total = 0;
		int epf_due_total = 0;
		int eps_due_total = 0;
		int diff_due_total = 0;
		int ncp_total = 0;
		int refund_total = 0;
		SimpleDateFormat sdf1 = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat output = new SimpleDateFormat("MM/yyyy");
		table_name = table_name.equalsIgnoreCase("after") ? "PAYTRAN_STAGE"
				: "PAYTRAN";

		try {

			Document doc = new Document();
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			doc.setPageSize(PageSize.A4);
			Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
					new GrayColor(0.75f));
			Calendar currentMonth = Calendar.getInstance();
			currentMonth.setTime(sdf1.parse(rdt));
			currentMonth.add(Calendar.MONTH, 1);

			Phrase title = new Phrase(
					"EMPLOYEE'S PROVIDENT FUND ORGANISATION, NASHIK", new Font(
							FONT.TIMES_ROMAN, 8, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			doc.add(para);
			para = new Paragraph(new Phrase(
					"ELECTRONIC CHALLAN CUM RETURN (ECR)", new Font(
							Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase("FOR THE WAGE MONTH OF ("
					+ output.format(sdf1.parse(rdt)) + ") AND RETURN MONTH ("
					+ output.format(currentMonth.getTime()) + ")", new Font(
					Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(5);

			doc.add(para);
			para = new Paragraph(new Phrase(
					"ESTABLISHMENT ID                : KDNSK0051492000",
					new Font(Font.TIMES_ROMAN, 7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(
					new Phrase("NAME OF ESTABLISHMENT  : "
							+ prop.getProperty("companyName")
							+ " 'BUILDER - CONTRACT OR'", new Font(
							Font.TIMES_ROMAN, 7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(
					new Phrase(
							"TRRN                                           : 3141501006505",
							new Font(Font.TIMES_ROMAN, 7)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(8);

			doc.add(para);
			para = new Paragraph(new Phrase("PART A-MEMBER'S WAGE DETAILS",
					new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(5);

			doc.add(para);

			PdfPCell cell;

			PdfPTable tab = new PdfPTable(13);

			tab.setWidthPercentage(new float[] { 4, 6, 17, 7, 7, 8, 8, 8, 8, 8,
					8, 4, 7 }, new Rectangle(100, 100));
			tab.setSpacingBefore(5);
			tab.setHorizontalAlignment(Element.ALIGN_CENTER);

			cell = new PdfPCell(new Phrase("Sr No", new Font(Font.TIMES_ROMAN,
					8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);

			cell = new PdfPCell(new Phrase("Member Id", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Member Name", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPF Wages", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Wages", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPF Contribution (EE Share) due",
					new Font(Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase(
					"EPF Contribution (EE Share) being remitted", new Font(
							Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Contribution due", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("EPS Contribution being remitted",
					new Font(Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase(
					"Diff EPF and EPS Contribution (ER Share) due", new Font(
							Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase(
					"Diff EPF and EPS Contribution (ER Share) being remitted",
					new Font(Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("NCP Days", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);
			cell = new PdfPCell(new Phrase("Refund of Advances", new Font(
					Font.TIMES_ROMAN, 8)));
			cell.setHorizontalAlignment(Element.ALIGN_CENTER);
			tab.addCell(cell);

			tab.setHeaderRows(1);
			ReportDAO.OpenCon("", "", "", repBean);
			Cn = repBean.getCn();

			EmpSql = "select e.salute ,e.doj,e.pfno, e.empno,e.empcode,e.fname,e.mname,e.lname, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=136 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') basic,"
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=137 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EPSWAGES,"
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=102 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') da, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=201 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') PF, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=231 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EEPF, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=232 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EEPS, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=233 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EDLI, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=234 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EEPFADMIN, "
					+ "(select cal_amt from "
					+ table_name
					+ " where trncd=235 and empno=e.empno and trndt between '"
					+ ReportDAO.BOM(rdt)
					+ "' and '"
					+ ReportDAO.EOM(rdt)
					+ "') EDLIADMIN "
					+ "from empmast e ,SAL_DETAILS s where s.EMPNO = e.EMPNO  and s.SAL_MONTH = '"
					+ date[1]
					+ "-"
					+ date[2]
					+ "' and e.doj <='"
					+ ReportDAO.EOM(rdt)
					+ "' "
					+ "and  e.EMPNO in(select distinct EMPNO from "
					+ table_name + " where TRNCD=201) order by e.empno";
			Statement st;
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			System.out.println(EmpSql);
			emp = st.executeQuery(EmpSql);

			if (!emp.next()) {
				cell = new PdfPCell(new Phrase(
						"Salary hasn't been finalized for the month " + date[1]
								+ "-" + date[2], new Font(Font.TIMES_ROMAN, 12,
								Font.BOLD)));
				cell.setColspan(13);
				cell.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab.addCell(cell);
				doc.add(tab);
			} else {

				int count = 1;
				emp.previous();
				float ac22 = 0, ac21 = 0, ac10 = 0, ac02 = 0;
				while (emp.next()) {
					if (emp.getInt("basic") <= 0) {
						emp.next();
					}
					int epf_wages = emp.getInt("basic") + emp.getInt("da");
					int eps_wages = Math.round(emp.getFloat("EPSWAGES"));
					ac02 += Math.round(emp.getFloat("EEPFADMIN"));
					ac10 += Math.round(emp.getFloat("EEPS"));
					ac22 += Math.round(emp.getFloat("EDLIADMIN"));
					ac21 += Math.round(emp.getFloat("EDLI"));

					String[] pfno = null;
					tab.addCell(new Phrase("" + count++, new Font(
							Font.TIMES_ROMAN, 8)));
					if (!emp.getString("pfno").equals("")) {
						pfno = emp.getString("pfno").split("/");
						System.out.println("here is the pf no " + pfno[3]);
						tab.addCell(new Phrase("000" + pfno[3], new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						tab.addCell(new Phrase("",
								new Font(Font.TIMES_ROMAN, 8)));
					}
					if (emp.getString("MNAME").equals(null)
							|| emp.getString("MNAME").equals("")) {
						tab.addCell(new Phrase(
								""
										+ FixStr(emp.getString("FNAME") + " "
												+ emp.getString("MNAME") + " "
												+ emp.getString("LNAME"), 30, 1),
								new Font(Font.TIMES_ROMAN, 8)));
					} else {
						tab.addCell(new Phrase(
								""
										+ FixStr(emp.getString("FNAME") + " "
												+ emp.getString("MNAME") + " "
												+ emp.getString("LNAME"), 30, 1),
								new Font(Font.TIMES_ROMAN, 8)));
					}

					cell = new PdfPCell(new Phrase("" + epf_wages, new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					epf_total += Math.round(epf_wages);

					float eps_cont = 0;
					float epf_cont = 0;

					eps_cont = Math.round(emp.getFloat("EEPS"));

					// eps_cont = epf_wages <=
					// 15000?Math.round(emp.getFloat("EEPS")):
					// Math.round(15000/100*8.33);
					epf_cont = Math.round(emp.getFloat("PF"));

					cell = new PdfPCell(new Phrase("" + eps_wages, new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					eps_total += eps_wages;

					epf_due_total += epf_cont;
					cell = new PdfPCell(new Phrase("" + (int) epf_cont,
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase("" + (int) epf_cont,
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);

					eps_due_total += eps_cont;
					cell = new PdfPCell(new Phrase("" + (int) eps_cont,
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase("" + (int) eps_cont,
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);

					diff_due_total += epf_cont - eps_cont;
					cell = new PdfPCell(new Phrase(""
							+ (int) (epf_cont - eps_cont), new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase(""
							+ (int) (epf_cont - eps_cont), new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);

					cell = new PdfPCell(new Phrase("0", new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
					cell = new PdfPCell(new Phrase("0", new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab.addCell(cell);
				}

				PdfPCell tot = new PdfPCell(new Phrase("Grand Total", new Font(
						Font.TIMES_ROMAN, 8, Font.BOLD)));
				tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tot.setColspan(3);
				tab.addCell(tot);
				cell = new PdfPCell(new Phrase("" + epf_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + eps_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + epf_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + epf_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + eps_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + eps_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + diff_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + diff_due_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + ncp_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				cell = new PdfPCell(new Phrase("" + refund_total, new Font(
						Font.TIMES_ROMAN, 8)));
				cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab.addCell(cell);
				doc.add(tab);

				PdfPTable tab1 = new PdfPTable(8);
				PdfPCell cell1;
				tab1.setWidthPercentage(
						new float[] { 28, 22, 8, 6, 6, 6, 6, 6 },
						new Rectangle(100, 100));
				tab1.setSpacingBefore(20);
				tab1.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell1 = new PdfPCell(new Phrase("", new Font(Font.TIMES_ROMAN,
						8)));
				cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase(
						"A/C 01 EE + Refund of Advance", new Font(
								Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 01 ER", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 02", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 10", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 21", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("A/C 22", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);
				cell1 = new PdfPCell(new Phrase("TOTAL", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
				tab1.addCell(cell1);

				for (int i = 0; i < 2; i++) {
					float total = 0;
					if (i == 0) {
						cell1 = new PdfPCell(new Phrase(
								"TOTAL DUES AS PER ECR", new Font(
										Font.TIMES_ROMAN, 8, Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
						tab1.addCell(cell1);
					} else {
						cell1 = new PdfPCell(new Phrase(
								"TOTAL AMOUNT BEING REMITTED", new Font(
										Font.TIMES_ROMAN, 8, Font.BOLD)));
						cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
						tab1.addCell(cell1);
					}
					cell1 = new PdfPCell(new Phrase("" + epf_due_total,
							new Font(Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					cell1 = new PdfPCell(new Phrase("" + diff_due_total,
							new Font(Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					// ac02 = Math.round(epf_total*1.1/100);//epfadmin chrg
					cell1 = new PdfPCell(new Phrase("" + (int) ac02, new Font(
							Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					cell1 = new PdfPCell(new Phrase("" + (int) ac10, new Font(
							Font.TIMES_ROMAN, 8))); // EPS
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					// ac21 = Math.round(eps_total*0.50/100); //edli
					cell1 = new PdfPCell(new Phrase("" + (int) ac21, new Font(
							Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					// ac22 = Math.round(eps_total*0.01/100);// edli admin
					if (ac22 < 200) {
						ac22 = 200;
					}
					cell1 = new PdfPCell(new Phrase("" + (int) ac22, new Font(
							Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
					total = epf_due_total + diff_due_total + ac02
							+ eps_due_total + ac21 + ac22;
					cell1 = new PdfPCell(new Phrase("" + (int) total, new Font(
							Font.TIMES_ROMAN, 8)));
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab1.addCell(cell1);
				}
				doc.add(tab1);
				para = new Paragraph(new Phrase("PART B-NEW MEMBER'S DETAILS",
						new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab2 = new PdfPTable(9);
				PdfPCell cell2;
				tab2.setWidthPercentage(new float[] { 4, 7, 20, 14, 15, 10, 8,
						11, 11 }, new Rectangle(100, 100));
				tab2.setSpacingAfter(20);
				tab2.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell2 = new PdfPCell(new Phrase("Sr No", new Font(
						Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Member Id", new Font(
						Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Member Name", new Font(
						Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Father's/Spouse Name",
						new Font(Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Relationship with the Member",
						new Font(Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Birth", new Font(
						Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Gender", new Font(
						Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Joining EPF",
						new Font(Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				cell2 = new PdfPCell(new Phrase("Date of Joining EPS",
						new Font(Font.TIMES_ROMAN, 8)));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab2.addCell(cell2);
				tab2.setHeaderRows(1);

				String EmpSql1 = "select e.salute ,e.dob,e.gender,e.pfno, e.empno,e.empcode,e.fname,e.mname,e.lname "
						+ "from empmast e where e.status = 'A' and e.doj between '"
						+ ReportDAO.BOM(rdt)
						+ "' and '"
						+ ReportDAO.EOM(rdt)
						+ "' order by e.empno";
				Statement st1;
				st1 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				ResultSet emp1 = st1.executeQuery(EmpSql1);
				if (!emp1.next()) {
					cell = new PdfPCell(new Phrase(" -- NIL -- ", new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setColspan(9);
					cell.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab2.addCell(cell);
				}
				SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
				SimpleDateFormat sdf2 = new SimpleDateFormat("dd-MMM-yyyy");
				SimpleDateFormat format = new SimpleDateFormat("dd-MM-yyyy");
				int count1 = 1;
				emp1.previous();

				while (emp1.next()) {

					tab2.addCell(new Phrase("" + count1++, new Font(
							Font.TIMES_ROMAN, 8)));
					String[] pfno = null;
					if (!emp1.getString("pfno").equals("")) {
						pfno = emp1.getString("pfno").split("/");
						tab2.addCell(new Phrase("000" + pfno[3], new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						tab2.addCell(new Phrase("", new Font(Font.TIMES_ROMAN,
								8)));
					}

					if (emp1.getString("MNAME").equals(null)
							|| emp1.getString("MNAME").equals("")) {
						tab2.addCell(new Phrase(""
								+ FixStr(
										emp1.getString("FNAME") + " "
												+ emp1.getString("MNAME") + " "
												+ emp1.getString("LNAME"), 30,
										1), new Font(Font.TIMES_ROMAN, 8)));
					} else {
						tab2.addCell(new Phrase(""
								+ FixStr(
										emp1.getString("FNAME") + " "
												+ emp1.getString("MNAME") + " "
												+ emp1.getString("LNAME"), 30,
										1), new Font(Font.TIMES_ROMAN, 8)));
					}

					cell = new PdfPCell(new Phrase(
							"" + emp1.getString("MNAME"), new Font(
									Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					if (!emp1.getString("MNAME").equals("")) {
						cell = new PdfPCell(new Phrase("Father", new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						cell = new PdfPCell(new Phrase("", new Font(
								Font.TIMES_ROMAN, 8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					Date dob = sdf.parse(emp1.getString("dob"));
					cell = new PdfPCell(new Phrase("" + format.format(dob),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					if (emp1.getString("gender").contains("M")) {
						cell = new PdfPCell(new Phrase("Male", new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						cell = new PdfPCell(new Phrase("Female", new Font(
								Font.TIMES_ROMAN, 8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					cell = new PdfPCell(new Phrase(""
							+ format.format(sdf2.parse(ReportDAO.BOM(rdt))),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);
					cell = new PdfPCell(new Phrase(""
							+ format.format(sdf2.parse(ReportDAO.BOM(rdt))),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab2.addCell(cell);

				}
				doc.add(tab2);

				para = new Paragraph(new Phrase(
						"PART C-EXITING MEMBER'S DETAILS", new Font(
								Font.TIMES_ROMAN, 8, Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab4 = new PdfPTable(10);
				PdfPCell cell4;
				tab4.setWidthPercentage(new float[] { 4, 6, 19, 13, 12, 9, 7,
						9, 9, 12 }, new Rectangle(100, 100));
				tab4.setSpacingAfter(20);
				tab4.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell4 = new PdfPCell(new Phrase("Sr No", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Member Id", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Member Name", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Father's/Spouse Name",
						new Font(Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Relationship with the Member",
						new Font(Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Birth", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Gender", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Exit from EPF",
						new Font(Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Date of Exit from EPS",
						new Font(Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				cell4 = new PdfPCell(new Phrase("Reason for leaving", new Font(
						Font.TIMES_ROMAN, 8)));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab4.addCell(cell4);
				tab4.setHeaderRows(1);

				String EmpSql2 = "select e.salute ,e.dob,e.pfno,e.dol,e.gender, e.empno,e.empcode,e.fname,e.mname,e.lname "
						+ "from empmast e where e.dol between '"
						+ ReportDAO.BOM(rdt)
						+ "' and '"
						+ ReportDAO.EOM(rdt)
						+ "' order by e.empno";
				Statement st2;
				st2 = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				ResultSet emp2 = st2.executeQuery(EmpSql2);
				if (!emp2.next()) {
					cell = new PdfPCell(new Phrase(" -- NIL -- ", new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setColspan(10);
					cell.setHorizontalAlignment(Element.ALIGN_CENTER);
					tab4.addCell(cell);
				}
				int count2 = 1;
				emp2.previous();

				while (emp2.next()) {

					tab4.addCell(new Phrase("" + count2++, new Font(
							Font.TIMES_ROMAN, 8)));
					String[] pfno = null;
					if (!emp2.getString("pfno").equals("")) {
						pfno = emp2.getString("pfno").split("/");
						tab4.addCell(new Phrase("000" + pfno[3], new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						tab4.addCell(new Phrase("", new Font(Font.TIMES_ROMAN,
								8)));
					}
					if (emp2.getString("MNAME").equals(null)
							|| emp2.getString("MNAME").equals("")) {
						tab4.addCell(new Phrase(""
								+ FixStr(
										emp2.getString("FNAME") + " "
												+ emp2.getString("MNAME") + " "
												+ emp2.getString("LNAME"), 30,
										1), new Font(Font.TIMES_ROMAN, 8)));
					} else {
						tab4.addCell(new Phrase(""
								+ FixStr(
										emp2.getString("FNAME") + " "
												+ emp2.getString("MNAME") + " "
												+ emp2.getString("LNAME"), 30,
										1), new Font(Font.TIMES_ROMAN, 8)));
					}

					cell = new PdfPCell(new Phrase(
							"" + emp2.getString("MNAME"), new Font(
									Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					if (!emp2.getString("MNAME").equals("")) {
						cell = new PdfPCell(new Phrase("Father", new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						cell = new PdfPCell(new Phrase("", new Font(
								Font.TIMES_ROMAN, 8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					Date dob = sdf.parse(emp2.getString("dob"));
					cell = new PdfPCell(new Phrase("" + format.format(dob),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					if (emp2.getString("gender").contains("M")) {
						cell = new PdfPCell(new Phrase("Male", new Font(
								Font.TIMES_ROMAN, 8)));
					} else {
						cell = new PdfPCell(new Phrase("Female", new Font(
								Font.TIMES_ROMAN, 8)));
					}
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					Date dol = sdf.parse(emp2.getString("dol"));
					cell = new PdfPCell(new Phrase("" + format.format(dol),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					cell = new PdfPCell(new Phrase("" + format.format(dol),
							new Font(Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);
					cell = new PdfPCell(new Phrase("", new Font(
							Font.TIMES_ROMAN, 8)));
					cell.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tab4.addCell(cell);

				}
				doc.add(tab4);

				para = new Paragraph(new Phrase(
						"PART D-MEMBER'S ARREAR DETAILS", new Font(
								Font.TIMES_ROMAN, 8, Font.BOLD)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingBefore(15);
				para.setSpacingAfter(10);
				doc.add(para);

				PdfPTable tab3 = new PdfPTable(8);
				PdfPCell cell3;
				tab3.setWidthPercentage(
						new float[] { 28, 22, 8, 6, 6, 6, 6, 6 },
						new Rectangle(100, 100));
				tab3.setHorizontalAlignment(Element.ALIGN_LEFT);

				cell3 = new PdfPCell(new Phrase(" -- NIL -- ", new Font(
						Font.TIMES_ROMAN, 8)));
				cell3.setColspan(8);
				cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				tab3.addCell(cell3);
				doc.add(tab3);
			}
			doc.close();
			Cn.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void BankStatement(String dt, String imgpath,
			String filepath, int batchNumber, String type, int fromRange,
			int toRange) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		Connection con = null;
		try {
			if (type.equalsIgnoreCase("B")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();

				SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
				Date date = sdf.parse(dt);
				String stmntdt = dt;

				Document doc = new Document();
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				UtilityDAO dao = new UtilityDAO();
				UtilityDAO.lable1 = "Report date : ";
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						"Banks Statement For The Month of - "
								+ stmntdt.substring(3), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				if (fromRange == 0 && toRange == 0) {

					doc.add(para);
					para = new Paragraph(new Phrase(
							"Bank Statement for All Salary Range ", new Font(
									Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

				} else {

					doc.add(para);
					para = new Paragraph(new Phrase(
							"Bank Statement for Salary Range From :"
									+ fromRange + " To:   " + toRange,
							new Font(Font.TIMES_ROMAN, 10)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);

				}

				doc.add(para);
				Rectangle rec = new Rectangle(100, 100);
				// PdfPTable maintab = new PdfPTable(1);
				// maintab.setSpacingBefore(10);
				PdfPCell cell = new PdfPCell();

				PdfPTable headtab = new PdfPTable(5);
				headtab.setSpacingBefore(10);
				headtab.setWidthPercentage(new float[] { 7, 35, 20, 20, 18 },
						rec);
				headtab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell c1 = new PdfPCell(new Phrase("Sr.No", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c1);
				PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c2);
				PdfPCell c3 = new PdfPCell(new Phrase("Account No.", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c3);
				PdfPCell c4 = new PdfPCell(new Phrase("I.F.S.C Code.",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c4);
				PdfPCell c5 = new PdfPCell(new Phrase("Payable Amount",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c5);

				doc.add(headtab);
				// cell.addElement(headtab);
				// maintab.addCell(cell);

				/*
				 * sdf=new SimpleDateFormat("yyyy-MM-dd"); dt=sdf.format(date);
				 */

				PdfPCell subcell2;
				ArrayList<BankStmntBean> bslist = new ArrayList<BankStmntBean>();
				bslist = BankStmntHandler.getBankStmntlist(dt, con,
						batchNumber, type);
				LookupHandler lkh = new LookupHandler();
				int i = 2;
				String bname = "";
				int j = 0;
				float total = 0;
				boolean flag = false;
				float bnks_total = 0;
				for (BankStmntBean bsb : bslist) {

					PdfPCell datacell = new PdfPCell();

					if (i == 2) {
						j = 1;
						PdfPCell datacell1 = new PdfPCell();
						bname = bsb.getBANK_NAME();

						PdfPTable banktab = new PdfPTable(5);
						banktab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

						subcell2 = new PdfPCell(new Phrase(""
								+ lkh.getLKP_Desc("BANK",
										Integer.parseInt(bsb.getBANK_NAME())),
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
						subcell2.setColspan(5);
						banktab.addCell(subcell2);
						doc.add(banktab);
						// datacell1.addElement(banktab);

						// maintab.addCell(datacell1);

					}
					if (bname.equalsIgnoreCase(bsb.getBANK_NAME())) {
						bname = bsb.getBANK_NAME();
						PdfPTable datatab = new PdfPTable(5);

						datatab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						ResultSet rs_sal = null;
						Statement rs_st = con.createStatement();
						String sql = "select net_amt  from PAYTRAN p where p.empno = "
								+ bsb.getEMPNO()
								+ " and trncd=199 "
								+ "  and p.TRNDT between '"
								+ ReportDAO.BOM(dt)
								+ "' and '"
								+ ReportDAO.EOM(dt)
								+ "' "
								+ " UNION select net_amt  from PAYTRAN_STAGE p where p.empno = "
								+ bsb.getEMPNO()
								+ " and trncd=199  "
								+ " and p.TRNDT between '"
								+ ReportDAO.BOM(dt)
								+ "' and '" + ReportDAO.EOM(dt) + "'  ";

						rs_sal = rs_st.executeQuery(sql);
						int ctc = 0;
						while (rs_sal.next()) {
							ctc = rs_sal.getInt("net_amt");

						}
						if (ctc > fromRange && ctc <= toRange) {

							PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""
									+ bsb.getEMPNAME(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(""
									+ bsb.getACCNO(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""
									+ bsb.getIFSCCODE(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell4);
							PdfPCell cell5 = new PdfPCell(new Phrase(""
									+ (int) Float.parseFloat(bsb.getNETPAY()),
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell5);
							doc.add(datatab);
							total = total + Float.parseFloat(bsb.getNETPAY());
						}

						if (fromRange == 0 && toRange == 0) {
							PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""
									+ bsb.getEMPNAME(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(""
									+ bsb.getACCNO(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""
									+ bsb.getIFSCCODE(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell4);
							PdfPCell cell5 = new PdfPCell(new Phrase(""
									+ (int) Float.parseFloat(bsb.getNETPAY()),
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell5);
							doc.add(datatab);
							total = total + Float.parseFloat(bsb.getNETPAY());
						}
						// datacell.addElement(datatab);

						j++;

					} else {

						PdfPTable totaltab = new PdfPTable(5);
						totaltab.setWidthPercentage(new float[] { 7, 35, 20,
								20, 18 }, rec);
						PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
								FONT.TIMES_ROMAN, 9, Font.BOLD)));
						totaltab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(
								new Phrase(lkh.getLKP_Desc("BANK",
										Integer.parseInt(bname))
										+ " Total (Rs.)=>", new Font(
										FONT.TIMES_ROMAN, 9, Font.BOLD)));
						cell2.setColspan(3);
						cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
						totaltab.addCell(cell2);
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ trans((int) total, "", "", false, false),
								new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
						totaltab.addCell(cell3);
						doc.add(totaltab);
						// datacell.addElement(totaltab);

						bnks_total = bnks_total + total;

						PdfPTable banktab = new PdfPTable(5);
						banktab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

						subcell2 = new PdfPCell(new Phrase(""
								+ lkh.getLKP_Desc("BANK",
										Integer.parseInt(bsb.getBANK_NAME())),
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
						subcell2.setColspan(5);
						banktab.addCell(subcell2);
						doc.add(banktab);

						// datacell.addElement(banktab);
						flag = true;

						total = 0;
						// bname = bsb.getBANK_NAME();
					}
					if (!(bname.equalsIgnoreCase(bsb.getBANK_NAME()))) {
						j = 1;
						PdfPTable datatab = new PdfPTable(5);

						datatab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						ResultSet rs_sal = null;
						Statement rs_st = con.createStatement();
						String sql = "select net_amt  from PAYTRAN p where p.empno = "
								+ bsb.getEMPNO()
								+ " and trncd=199 "
								+ "  and p.TRNDT between '"
								+ ReportDAO.BOM(dt)
								+ "' and '"
								+ ReportDAO.EOM(dt)
								+ "' "
								+ " UNION select net_amt  from PAYTRAN_STAGE p where p.empno = "
								+ bsb.getEMPNO()
								+ " and trncd=199  "
								+ " and p.TRNDT between '"
								+ ReportDAO.BOM(dt)
								+ "' and '" + ReportDAO.EOM(dt) + "'  ";

						rs_sal = rs_st.executeQuery(sql);
						int ctc = 0;
						while (rs_sal.next()) {
							ctc = rs_sal.getInt("net_amt");
						}
						if (ctc > fromRange && ctc <= toRange) {
							PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""
									+ bsb.getEMPNAME(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(""
									+ bsb.getACCNO(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""
									+ bsb.getIFSCCODE(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell4);
							PdfPCell cell5 = new PdfPCell(new Phrase(""
									+ (int) Float.parseFloat(bsb.getNETPAY()),
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell5);
							doc.add(datatab);
							total = total + Float.parseFloat(bsb.getNETPAY());
						}

						if (fromRange == 0 && toRange == 0) {
							PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell1);
							PdfPCell cell2 = new PdfPCell(new Phrase(""
									+ bsb.getEMPNAME(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell2);
							PdfPCell cell3 = new PdfPCell(new Phrase(""
									+ bsb.getACCNO(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell3);
							PdfPCell cell4 = new PdfPCell(new Phrase(""
									+ bsb.getIFSCCODE(), new Font(
									FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell4);
							PdfPCell cell5 = new PdfPCell(new Phrase(""
									+ (int) Float.parseFloat(bsb.getNETPAY()),
									new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
							datatab.addCell(cell5);
							doc.add(datatab);
							total = total + Float.parseFloat(bsb.getNETPAY());
						}
						// datacell.addElement(datatab);

						// flag=true;
						bname = bsb.getBANK_NAME();
						j++;
					}

					i++;

					// maintab.addCell(datacell);

				}
				if (flag == true) {
					PdfPCell datacell = new PdfPCell();
					PdfPTable totaltab = new PdfPTable(5);
					totaltab.setWidthPercentage(
							new float[] { 7, 35, 20, 20, 18 }, rec);
					PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
							FONT.TIMES_ROMAN, 8, Font.BOLD)));
					totaltab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(
							lkh.getLKP_Desc("BANK", Integer.parseInt(bname))
									+ " Total (Rs.)=>", new Font(
									FONT.TIMES_ROMAN, 9, Font.BOLD)));
					cell2.setColspan(3);
					cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					totaltab.addCell(cell2);
					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ trans((int) total, "", "", false, false),
							new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
					totaltab.addCell(cell3);
					doc.add(totaltab);
					// datacell.addElement(totaltab);

					bnks_total = bnks_total + total;
					total = 0;
					// total=total+Float.parseFloat(bsb.getNETPAY());
					// maintab.addCell(datacell);
				}
				PdfPCell datacell = new PdfPCell();
				PdfPTable totaltab = new PdfPTable(5);
				totaltab.setWidthPercentage(new float[] { 7, 35, 20, 20, 18 },
						rec);
				PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				totaltab.addCell(cell1);

				bnks_total = bnks_total + total;
				PdfPCell cell2 = new PdfPCell(new Phrase(
						" All BANKS Total  (Rs.)=>", new Font(FONT.TIMES_ROMAN,
								9, Font.BOLD)));
				cell2.setColspan(3);
				cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totaltab.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase(""
						+ trans((int) bnks_total, "", "", false, false),
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				totaltab.addCell(cell3);
				doc.add(totaltab);
				// datacell.addElement(totaltab);

				// total=total+Float.parseFloat(bsb.getNETPAY());
				// maintab.addCell(datacell);

				// doc.add(maintab);

				con.close();
				doc.close();
			}

			else if (type.equalsIgnoreCase("A")) {

				System.out
						.println("inside utility dao after release//////////////////////////////////////////////////////////////////////////");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();

				SimpleDateFormat sdf = new SimpleDateFormat("dd-MMM-yyyy");
				Date date = sdf.parse(dt);
				String stmntdt = dt;

				Document doc = new Document();
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(80f, 80f);
				image1.setAbsolutePosition(40f, 730f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						"Banks Statement For The Month of - "
								+ stmntdt.substring(3), new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				Rectangle rec = new Rectangle(100, 100);
				// PdfPTable maintab = new PdfPTable(1);
				// maintab.setSpacingBefore(10);
				PdfPCell cell = new PdfPCell();

				PdfPTable headtab = new PdfPTable(5);
				headtab.setSpacingBefore(10);
				headtab.setWidthPercentage(new float[] { 7, 35, 20, 20, 18 },
						rec);
				headtab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell c1 = new PdfPCell(new Phrase("Sr.No", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c1);
				PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c2);
				PdfPCell c3 = new PdfPCell(new Phrase("Account No.", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c3);
				PdfPCell c4 = new PdfPCell(new Phrase("I.F.S.C Code.",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c4);
				PdfPCell c5 = new PdfPCell(new Phrase("Payable Amount",
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				headtab.addCell(c5);

				doc.add(headtab);
				// cell.addElement(headtab);
				// maintab.addCell(cell);

				/*
				 * sdf=new SimpleDateFormat("yyyy-MM-dd"); dt=sdf.format(date);
				 */

				PdfPCell subcell2;
				ArrayList<BankStmntBean> bslist = new ArrayList<BankStmntBean>();
				bslist = BankStmntHandler.getBankStmntlist(dt, con,
						batchNumber, type);
				LookupHandler lkh = new LookupHandler();
				int i = 2;
				String bname = "";
				int j = 0;
				float total = 0;
				boolean flag = false;
				float bnks_total = 0;
				for (BankStmntBean bsb : bslist) {

					PdfPCell datacell = new PdfPCell();

					if (i == 2) {
						j = 1;
						PdfPCell datacell1 = new PdfPCell();
						bname = bsb.getBANK_NAME();

						PdfPTable banktab = new PdfPTable(5);
						banktab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

						subcell2 = new PdfPCell(new Phrase(""
								+ lkh.getLKP_Desc("BANK",
										Integer.parseInt(bsb.getBANK_NAME())),
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
						subcell2.setColspan(5);
						banktab.addCell(subcell2);
						doc.add(banktab);
						// datacell1.addElement(banktab);

						// maintab.addCell(datacell1);

					}
					if (bname.equalsIgnoreCase(bsb.getBANK_NAME())) {
						bname = bsb.getBANK_NAME();
						PdfPTable datatab = new PdfPTable(5);

						datatab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
								new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
						datatab.addCell(cell1);
						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ bsb.getEMPNAME(), new Font(FONT.TIMES_ROMAN,
								9, Font.NORMAL)));
						datatab.addCell(cell2);
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ bsb.getACCNO(), new Font(FONT.TIMES_ROMAN, 9,
								Font.NORMAL)));
						datatab.addCell(cell3);
						PdfPCell cell4 = new PdfPCell(new Phrase(""
								+ bsb.getIFSCCODE(), new Font(FONT.TIMES_ROMAN,
								9, Font.NORMAL)));
						datatab.addCell(cell4);
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ (int) Float.parseFloat(bsb.getNETPAY()),
								new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
						datatab.addCell(cell5);
						doc.add(datatab);
						// datacell.addElement(datatab);
						total = total + Float.parseFloat(bsb.getNETPAY());

						j++;

					} else {

						PdfPTable totaltab = new PdfPTable(5);
						totaltab.setWidthPercentage(new float[] { 7, 35, 20,
								20, 18 }, rec);
						PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
								FONT.TIMES_ROMAN, 9, Font.BOLD)));
						totaltab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(
								new Phrase(lkh.getLKP_Desc("BANK",
										Integer.parseInt(bname))
										+ " Total (Rs.)=>", new Font(
										FONT.TIMES_ROMAN, 9, Font.BOLD)));
						cell2.setColspan(3);
						cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
						totaltab.addCell(cell2);
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ trans((int) total, "", "", false, false),
								new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
						totaltab.addCell(cell3);
						doc.add(totaltab);
						// datacell.addElement(totaltab);

						bnks_total = bnks_total + total;

						PdfPTable banktab = new PdfPTable(5);
						banktab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						banktab.setHorizontalAlignment(Element.ALIGN_LEFT);

						subcell2 = new PdfPCell(new Phrase(""
								+ lkh.getLKP_Desc("BANK",
										Integer.parseInt(bsb.getBANK_NAME())),
								new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
						subcell2.setHorizontalAlignment(Element.ALIGN_LEFT);
						subcell2.setColspan(5);
						banktab.addCell(subcell2);
						doc.add(banktab);

						// datacell.addElement(banktab);
						flag = true;

						total = 0;
						// bname = bsb.getBANK_NAME();
					}
					if (!(bname.equalsIgnoreCase(bsb.getBANK_NAME()))) {
						j = 1;
						PdfPTable datatab = new PdfPTable(5);

						datatab.setWidthPercentage(new float[] { 7, 35, 20, 20,
								18 }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase("" + j,
								new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
						datatab.addCell(cell1);
						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ bsb.getEMPNAME(), new Font(FONT.TIMES_ROMAN,
								9, Font.NORMAL)));
						datatab.addCell(cell2);
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ bsb.getACCNO(), new Font(FONT.TIMES_ROMAN, 9,
								Font.NORMAL)));
						datatab.addCell(cell3);
						PdfPCell cell4 = new PdfPCell(new Phrase(""
								+ bsb.getIFSCCODE(), new Font(FONT.TIMES_ROMAN,
								9, Font.NORMAL)));
						datatab.addCell(cell4);
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ (int) Float.parseFloat(bsb.getNETPAY()),
								new Font(FONT.TIMES_ROMAN, 9, Font.NORMAL)));
						datatab.addCell(cell5);

						doc.add(datatab);
						// datacell.addElement(datatab);
						total = total + Float.parseFloat(bsb.getNETPAY());
						// flag=true;
						bname = bsb.getBANK_NAME();
						j++;
					}

					i++;

					// maintab.addCell(datacell);

				}
				if (flag == true) {
					PdfPCell datacell = new PdfPCell();
					PdfPTable totaltab = new PdfPTable(5);
					totaltab.setWidthPercentage(
							new float[] { 7, 35, 20, 20, 18 }, rec);
					PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
							FONT.TIMES_ROMAN, 8, Font.BOLD)));
					totaltab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(
							lkh.getLKP_Desc("BANK", Integer.parseInt(bname))
									+ " Total (Rs.)=>", new Font(
									FONT.TIMES_ROMAN, 9, Font.BOLD)));
					cell2.setColspan(3);
					cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					totaltab.addCell(cell2);
					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ trans((int) total, "", "", false, false),
							new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
					totaltab.addCell(cell3);
					doc.add(totaltab);
					// datacell.addElement(totaltab);

					bnks_total = bnks_total + total;
					total = 0;
					// total=total+Float.parseFloat(bsb.getNETPAY());
					// maintab.addCell(datacell);
				}
				PdfPCell datacell = new PdfPCell();
				PdfPTable totaltab = new PdfPTable(5);
				totaltab.setWidthPercentage(new float[] { 7, 35, 20, 20, 18 },
						rec);
				PdfPCell cell1 = new PdfPCell(new Phrase("", new Font(
						FONT.TIMES_ROMAN, 9, Font.BOLD)));
				totaltab.addCell(cell1);

				bnks_total = bnks_total + total;
				PdfPCell cell2 = new PdfPCell(new Phrase(
						" All BANKS Total  (Rs.)=>", new Font(FONT.TIMES_ROMAN,
								9, Font.BOLD)));
				cell2.setColspan(3);
				cell2.setHorizontalAlignment(Element.ALIGN_RIGHT);
				totaltab.addCell(cell2);
				PdfPCell cell3 = new PdfPCell(new Phrase(""
						+ trans((int) bnks_total, "", "", false, false),
						new Font(FONT.TIMES_ROMAN, 9, Font.BOLD)));
				totaltab.addCell(cell3);
				doc.add(totaltab);
				// datacell.addElement(totaltab);

				// total=total+Float.parseFloat(bsb.getNETPAY());
				// maintab.addCell(datacell);

				// doc.add(maintab);

				con.close();
				doc.close();

			}
		}

		catch (Exception e) {
			e.printStackTrace();
		} finally {

		}
	}

	public static void newpayreg(String PAYREGDT, String imgpath,
			String filepath, String type) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		System.out.println("in new pay regdao");

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;
		// String dt = PAYREGDT;
		String table_name = null;
		/*
		 * if(TName.equals("before") ) { table_name = "PAYTRAN";
		 * lable1="Before Finalize"; } else if(TName.equals("after") ) {
		 * table_name="YTDTRAN"; lable1="Final After Release"; } else {
		 * table_name="PAYTRAN_STAGE"; lable1="Pending for Release"; }
		 */
		// System.out.println(dt);
		lastdat = (int) Calculate.getDays(PAYREGDT);
		System.out.println("maxdt" + lastdat);
		BomDt = ReportDAO.BOM(PAYREGDT);
		// System.out.println("bomdt "+BomDt);
		EomDt = ReportDAO.EOM(PAYREGDT);
		// System.out.println("eomdt"+EomDt);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {

			if (type.equalsIgnoreCase("G")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement();

				Document doc = new Document(new Rectangle(900, 500));

				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();

				Font FONT = new Font(Font.HELVETICA, 30, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 450f,
						230, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(90f, 50f);
				image1.setAbsolutePosition(50f, 405f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 8);
				Font f1 = new Font(Font.HELVETICA, 7);

				para = new Paragraph(new Phrase(
						"Salary Sheet For The Month Of :- " + temp, new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Rectangle rec = new Rectangle(650, 100);

				PdfPTable main = new PdfPTable(11);
				main.setSpacingBefore(10);
				// main.setWidthPercentage(new
				// float[]{35,57,40,30,23,20,25,25,25,30,25,20,20,30,30,30,30,170},
				// rec);
				main.setWidthPercentage(new float[] { 30, 99, 59, 59, 59, 59,
						59, 59, 49, 49, 60 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Emp code", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Emp Name", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("C.T.C", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.O.P Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 1", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 2", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Given", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TDS", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("NET PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				main.setHeaderRows(1);

				// EmpSql =
				// "select distinct p.empno,e.empcode from "+table_name+" p right join EMPMAST e on e.EMPNO = p.EMPNO where TRNDT BETWEEN '"
				// + BomDt + "' AND '" + EomDt + "' order by p.EMPNO";
				EmpSql = "select distinct p.empno,CONVERT(INT, e.empcode) as empcode,t.PRJ_SRNO,t.PRJ_CODE from paytran p right join EMPMAST e on e.EMPNO = p.EMPNO join EMPTRAN t on p.EMPNO = t.EMPNO where TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' and e.STATUS = 'A'"
						+ "and T.EFFDATE = (SELECT E2.EFFDATE FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "' and E2.srno=(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "')) order by t.PRJ_CODE,empcode";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);

				List<Integer> results = new ArrayList<Integer>();

				while (emp.next()) {

					results.add(emp.getInt("empno"));
					// System.out.println(emp.getInt("empno"));
				}

				for (int empp : results) {

					EmpSql = "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from  paytran  where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from  paytran  where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from  paytran  where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from  paytran  where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from  paytran  where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from  paytran  where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from  paytran  where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from  paytran  where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from  paytran  where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t,paytran p1  where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ "  and p1.trndt  BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and p1.empno="
							+ empp
							+ " "
							+ "  UNION  "
							+ "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from   paytran_stage   where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from   paytran_stage   where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from   paytran_stage   where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from   paytran_stage   where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from   paytran_stage   where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from   paytran_stage   where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from   paytran_stage   where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from   paytran_stage   where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from   paytran_stage   where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t ,paytran_stage p1 where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ " and p1.trndt   BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt + "' and p1.empno=" + empp + "";
					System.out.println(EmpSql);
					// System.out.println(empp);
					emp = st.executeQuery(EmpSql);

					while (emp.next()) {
						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("empcode"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("name"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						float mthsal = 0.0f;
						float absent = 0.0f;

						/*
						 * EmpSql="select inp_AMT from "+table_name+
						 * " where trncd = 199 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql);
						 * //System.out.println(EmpSql); while(emp.next()){
						 * mthsal = emp.getFloat("inp_AMT");
						 * 
						 * //System.out.println("mth salary "+emp.getString(
						 * "inp_AMT")); }
						 */
						mthsal = emp.getFloat("ctc");
						if (mthsal == 0) {
							mthsal = 0;

							// mthsal = 0.0f;
						} else {

							totmthsal1 = totmthsal1 + mthsal;
						}
						// ctc
						maincell = new PdfPCell(new Phrase("" + mthsal, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						/*
						 * EmpSql = "select cal_amt from "+table_name+
						 * " where trncd = 301 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql); if(emp.next()){
						 * 
						 * absent = emp.getFloat("cal_AMT"); }
						 */
						absent = emp.getFloat("abs_cnt");
						// L.O.P days
						maincell = new PdfPCell(new Phrase("" + absent, f));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);

						float ear1 = 0.0f;
						/*
						 * EmpSql="select net_amt as earning1 from "+table_name+
						 * " where trncd = 130 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ ear1 =
						 * emp.getFloat("earning1");
						 * 
						 * //System.out.println("earning1"+emp.getString("earning1"
						 * )); }
						 */
						ear1 = emp.getFloat("earning1");
						if (ear1 == 0.0) {
							ear1 = 0;

						} else {
							// earning1 = ear1;
							totearning1 = totearning1 + ear1;
						}

						// earning 1
						maincell = new PdfPCell(new Phrase("" + ear1, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float ear2 = 0.0f;
						/*
						 * EmpSql="select net_amt as earning2 from "+table_name+
						 * " where trncd = 131 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ ear2 =
						 * emp.getFloat("earning2");
						 * 
						 * //System.out.println("earning2"+emp.getString("earning2"
						 * )); }
						 */
						ear2 = emp.getFloat("earning2");
						if (ear2 == 0.0) {
							ear2 = 0;

						} else {

							totearning2 = totearning2 + ear2;
						}

						// earning 2
						maincell = new PdfPCell(new Phrase("" + ear2, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float mobded = 0.0f;
						/*
						 * EmpSql="select net_amt as mobded from "+table_name+
						 * " where trncd = 223 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ mobded =
						 * emp.getFloat("mobded");
						 * 
						 * //System.out.println("mobded"+emp.getString("mobded"))
						 * ; }
						 */
						mobded = emp.getFloat("mobded");
						if (mobded == 0.0) {
							mobded = 0;

						} else {

							totmobded = totmobded + mobded;
						}

						// mobile ded
						maincell = new PdfPCell(new Phrase("" + mobded, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float advanc = 0.0f;
						/*
						 * EmpSql="select net_amt as added from "+table_name+
						 * " where trncd = 225 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ advanc =
						 * emp.getFloat("added");
						 * 
						 * //System.out.println("advance"+emp.getString("added"))
						 * ; }
						 */
						advanc = emp.getFloat("added");
						if (advanc == 0.0) {
							advanc = 0;

						} else {

							totadvanc = totadvanc + advanc;
						}

						// advance given
						maincell = new PdfPCell(new Phrase("" + advanc, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float loan = 0.0f;
						/*
						 * EmpSql="select net_amt as loan from "+table_name+
						 * " where trncd = 227 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ loan =
						 * emp.getFloat("loan");
						 * 
						 * //System.out.println("loan "+emp.getString("loan"));
						 * }
						 */
						loan = emp.getFloat("loan");
						if (loan == 0.0) {
							loan = 0;

						} else {

							totloan = totloan + loan;
						}

						// loan
						maincell = new PdfPCell(new Phrase("" + loan, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float tds = 0.0f;
						/*
						 * EmpSql="select net_amt as tds from "+table_name+
						 * " where trncd = 228 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ tds =
						 * emp.getFloat("tds");
						 * 
						 * //System.out.println("tds "+emp.getString("tds")); }
						 */
						tds = emp.getFloat("tds");
						if (tds == 0.0) {
							tds = 0;

						} else {

							tottds = tottds + tds;
						}

						// tds
						maincell = new PdfPCell(new Phrase("" + tds, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						int payable = 0;
						/*
						 * EmpSql="select net_amt as payable from "+table_name+
						 * " where trncd = 999 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql);
						 * //System.out.println(""+EmpSql); while(emp.next()){
						 * payable = emp.getInt("payable");
						 * 
						 * //System.out.println("payable "+emp.getString("payable"
						 * )); }
						 */
						payable = emp.getInt("payable");
						if (payable == 0) {
							payable = 0;
						} else {

							totactualpay = totactualpay + payable;

						}
						// actual pay
						maincell = new PdfPCell(new Phrase("" + payable, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

					}

				}

				NumberFormat format = com.ibm.icu.text.NumberFormat
						.getCurrencyInstance(new Locale("en", "in"));
				String totpay = format.format(totmthsal1).substring(4);
				String eard1 = format.format(totearning1).substring(4);
				String eard2 = format.format(totearning2).substring(4);
				String totnetpay = format.format(totactualpay).substring(4);
				String tomobded = format.format(totmobded).substring(4);
				String toadv = format.format(totadvanc).substring(4);
				String toloan = format.format(totloan).substring(4);
				String totds = format.format(tottds).substring(4);

				maincell = new PdfPCell(new Phrase("TOTAL PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				maincell.setColspan(2);
				main.addCell(maincell);
				// totctc
				maincell = new PdfPCell(new Phrase("" + totpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totlop
				maincell = new PdfPCell(new Phrase("", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear1
				maincell = new PdfPCell(new Phrase("" + eard1, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear2
				maincell = new PdfPCell(new Phrase("" + eard2, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totmobileded
				maincell = new PdfPCell(new Phrase("" + tomobded, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totadvancegiven
				maincell = new PdfPCell(new Phrase("" + toadv, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totloan
				maincell = new PdfPCell(new Phrase("" + toloan, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// tottds
				maincell = new PdfPCell(new Phrase("" + totds, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totnetpay
				maincell = new PdfPCell(new Phrase("" + totnetpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				st.close();
				con.close();
				doc.close();
			}

			else if (type.equalsIgnoreCase("I")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);

				System.out.println("in income head");
				Document doc = new Document(new Rectangle(2384, 3370));
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer1 ftr = dao.new Footer1(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f,
						1830f, 45);
				Image image1 = Image.getInstance(imgpath);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3200f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 23);
				Font f1 = new Font(Font.HELVETICA, 20);
				/*
				 * if(TName.equalsIgnoreCase("after")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp,new Font(Font.TIMES_ROMAN,25))); else
				 * if(TName.equalsIgnoreCase("before")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
				 * else
				 */para = new Paragraph(new Phrase(
						"Salary Sheet For The Income Heads for the Month Of :- "
								+ temp + " (Pending for Release)", new Font(
								Font.TIMES_ROMAN, 25)));

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				doc.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float currda_total = 0.0f;
				float lstcurrda_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float washingall_total = 0.0f;
				float lstwashingall_total = 0.0f;
				float bonus_total = 0.0f;
				float lstbonus_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				EmpSql = "select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from  PAYTRAN where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ " PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO "
						+ "join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO "
						+ "join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO "
						+ "join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO "
						+ "join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO "
						+ "join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO "
						+ "join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "') "
						+

						" UNION  select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from   paytran_stage  where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ "  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join   paytran_stage  p2 on empmast.EMPNO = p2.EMPNO "
						+ "join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO "
						+ "join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO "
						+ "join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO "
						+ "join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO "
						+ "join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO "
						+ "join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "') " +

						"order by t.PRJ_SRNO,EMPCODE";
				System.out.println(EmpSql);
				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;
					Connection conn = ConnectionManager.getConnectionTech();
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
					ResultSet prj = stmt.executeQuery(prjquery);
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					doc.add(para);
					prj.close();
					stmt.close();
					conn.close();
					PdfPTable datatab;
					PdfPTable datatot;
					PdfPTable main = new PdfPTable(18);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5,
							5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f }, rec);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("EMP CODE", f1));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Current D.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Washing All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Bonus", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Insurance", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add less Amt", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					// maincell = new PdfPCell(new Phrase("Special",f));
					// maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					// main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot deduction", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net pay", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					doc.add(main);
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						datatab = new PdfPTable(18);
						datatab.setWidthPercentage(new float[] { 3, 12, 5, 5,
								5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
								5.5f, 5.5f, 5.5f, 5.5f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f1));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						if (rs.getFloat("curda") == 0.0) {
							PdfPCell cell4 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell4);
						} else {
							float curda = rs.getFloat("curda");
							currda_total = currda_total + curda;
							PdfPCell cell4 = new PdfPCell(new Phrase(
									"" + curda, f1));
							cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell4);
						}

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						medical_total = medical_total = rs.getFloat("medical");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						edu_total = edu_total = rs.getFloat("education");
						PdfPCell cell7 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell8 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell8);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell8 = new PdfPCell(new Phrase(""
									+ rs.getFloat("splall"), f1));
							cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell8);
						}

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("washall") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell10);
						} else {
							float washing = rs.getFloat("washall");
							washingall_total = washingall_total = rs
									.getFloat("washall");
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ washing, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("bonusall") == 0.0) {
							PdfPCell cell11 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell11);
						} else {
							float bonus = rs.getFloat("bonusall");
							bonus_total = bonus_total + rs.getFloat("bonusall");
							PdfPCell cell11 = new PdfPCell(new Phrase(""
									+ bonus, f1));
							cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell11);
						}

						minins_total = minins_total + +rs.getFloat("min_ins");
						PdfPCell cell12 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);

						if (rs.getFloat("addless") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell13);
						} else {
							float addless = rs.getFloat("addless");
							addlss_total = addlss_total + addless;
							PdfPCell cell13 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell14 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);

						/*
						 * if(rs.getFloat("special")==0.0){ PdfPCell cell15 =
						 * new PdfPCell(new Phrase("",f1));
						 * datatab.addCell(cell15); } else{ float spcl =
						 * rs.getFloat("special"); special_total = special_total
						 * + spcl; PdfPCell cell15 = new PdfPCell(new
						 * Phrase(""+spcl,f1));
						 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell15); }
						 */
						if (rs.getFloat("addinc") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell16);
						} else {
							float add_inc = rs.getFloat("addinc");
							addinc_total = addinc_total + add_inc;
							PdfPCell cell16 = new PdfPCell(new Phrase(""
									+ add_inc, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell17 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totear"), f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell18 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totded"), f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);

						netpay_total = netpay_total + rs.getFloat("payable");
						PdfPCell cell19 = new PdfPCell(new Phrase(""
								+ rs.getFloat("payable"), f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);

						doc.add(datatab);

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5,
							5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f, 5.5f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
					cell1.setColspan(2);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(new Phrase("" + currda_total,
							f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstcurrda_total = lstcurrda_total + currda_total;
					currda_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstsplall_total = lstsplall_total = splall_total;
					splall_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstconvall_total = lstconvall_total = convall_total;
					convall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(""
							+ washingall_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstwashingall_total = lstwashingall_total
							+ washingall_total;
					washingall_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + bonus_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstbonus_total = lstbonus_total + bonus_total;
					bonus_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(
							"" + minins_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					/*
					 * PdfPCell cell15 = new PdfPCell(new
					 * Phrase(""+special_total,f1));
					 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell15); lstspecial_total =
					 * lstspecial_total + special_total ; special_total = 0.0f;
					 */

					PdfPCell cell16 = new PdfPCell(new Phrase(
							"" + addinc_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase(
							"" + totinc_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase(
							"" + totded_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttotded_total = lsttotded_total + totded_total;
					totded_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase(
							"" + netpay_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstnetpay_total = lstnetpay_total + netpay_total;
					netpay_total = 0.0f;

					doc.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);

				}
				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				PdfPTable main = new PdfPTable(18);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 5, 6, 5, 5.5f, 5.5f,
						5.5f, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
						5.5f, 6, 6, 6 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Summury", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Current D.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Washing All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Officiating All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Insurance", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add less Amt", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("Special",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("Add income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net pay", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Gross Total:--", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcurrda_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsthra_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstedu_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstwashingall_total), "", "", false,
								false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbonus_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcol_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstspecial_total), "", "", false,
				 * false),f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetpay_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);

				/*
				 * System.out.println("last basic = "+lstbasic_total);
				 * System.out.println("last current da = "+lstcurrda_total);
				 * System.out.println("last hra = "+lsthra_total);
				 * System.out.println("last medical = "+lstmedical_total);
				 * System.out.println("last education = "+lstedu_total);
				 * System.out.println("last splall = "+lstsplall_total);
				 * System.out.println("last convall = "+lstconvall_total);
				 * System.out.println("last washing = "+lstwashingall_total);
				 * System.out.println("last bonus = "+lstbonus_total);
				 * System.out.println("last minins = "+lstminins_total);
				 * System.out.println("last addless = "+lstaddlss_total);
				 * System.out.println("last col = "+lstcol_total);
				 * //System.out.println("last special = "+lstspecial_total);
				 * System.out.println("last addinc = "+lstaddinc_total);
				 * System.out.println("last totinc = "+lsttotinc_total);
				 * System.out.println("last totded = "+lsttotded_total);
				 * System.out.println("last totnetpay = "+lstnetpay_total);
				 */

				st.close();
				con.close();
				doc.close();

			}

			else if (type.equalsIgnoreCase("ID")) {
				System.out.println("helooo am in iDDDDDDDD");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = con.createStatement();
				Statement stmtTrnct = con.createStatement();

		

				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");
				Document document = new Document(
						new Rectangle(2900, 3608).rotate(), 10, 10, 20, 20);
				// Document doc = new Document(new Rectangle(2834,4008));
				document.left(100f);
				document.top(100f);
				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filepath));
				HeaderAndFooter haf = new HeaderAndFooter(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				// ColumnText.showTextAligned(writer.getDirectContentUnder(),
				// Element.ALIGN_CENTER, new
				// Phrase(prop.getProperty("watermark"),FONT), 1000f, 1230f,
				// 25);
				Image image1 = Image.getInstance(imgpath);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 2750f);
				document.add(image1);
				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);

				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font f2 = new Font(Font.HELVETICA, 22);
			
				para = new Paragraph(new Phrase(
						"Salary Sheet For The Income & Deduction  Heads for the Month Of :- "
								+ temp + " (Pending for Release)", new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				document.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float lic_total = 0.0f;
				float lstlic_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float pf_total = 0.0f;
				float lstpf_total = 0.0f;
				float pt_total = 0.0f;
				float lstpt_total = 0.0f;
				float mlwf_total = 0.0f;
				float lstmlwf_total = 0.0f;
				float esic_total = 0.0f;
				float lstesic_total = 0.0f;
				float mob_total = 0.0f;
				float lstmob_total = 0.0f;
				float adv_total = 0.0f;
				float lstadv_total = 0.0f;
				float tds_total = 0.0f;
				float lsttds_total = 0.0f;
				float relif_total = 0.0f;
				float lstrelif_total = 0.0f;
				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float addded_total = 0.0f;
				float lstaddded_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				
				EmpSql = "         SELECT CONVERT(INT, EMPMAST.EMPCODE) AS EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)   "
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',            CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+ "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS lic  FROM   PAYTRAN WHERE TRNCD = 205 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS lic) END AS 'lic',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+ "	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,108,126,128,107,130,131)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,108,126,128,107,130,131)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as addded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS addded) END AS 'addded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+

						"    UNION "
						+ "         SELECT CONVERT(INT, EMPMAST.EMPCODE) AS EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',            CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+ "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS lic  FROM   PAYTRAN_STAGE WHERE TRNCD = 205 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS lic) END AS 'lic',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+ "	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,108,126,128,107,130,131)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,108,126,128,107,130,131)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as addded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS addded) END AS 'addded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empcode  ";

				System.out.println(EmpSql);

				// to truncate the TABLE PRINT_PAY_REG

				String Truncate = "TRUNCATE TABLE PRINTPAYREG ";
				st.execute(Truncate);

				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;
					Connection conn = ConnectionManager.getConnectionTech();
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
					ResultSet prj = stmt.executeQuery(prjquery);
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					document.add(para);
					prj.close();
					stmt.close();
					conn.close();
					PdfPTable datatab;
					PdfPTable datatot;
					PdfPTable main = new PdfPTable(27);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 2, 12.5f, 3.5f, 3.5f,
							3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f,
							3.5f, 3.5f, 3.5f, 3f, 3f, 3.5f, 3.5f, 3.5f, 3.25f,
							3, 2.5f, 3.5f, 3.5f, 3.5f, 3.5f }, rec);
					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("CODE", f1));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.setFixedHeight(70);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Ins.", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 1", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 2", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("P.F", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("E.S.I.C", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("P.T", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("T.D.S", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Advance", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Loan Ded", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Mobile Ded", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net Charges", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("L.I.C", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Relif Fund", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("MLWF", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot Ded.", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net Pay", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					document.add(main);
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						datatab = new PdfPTable(27);
						datatab.setTableEvent(app.new DottedCells());
						datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
						datatab.setWidthPercentage(new float[] { 2, 12.5f,
								3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f,
								3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3f, 3f, 3.5f,
								3.5f, 3.5f, 3.25f, 3, 2.5f, 3.5f, 3.5f, 3.5f,
								3.5f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setCellEvent(app.new DottedCell());
						cell1.setFixedHeight(60);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f1));
						cell2.setCellEvent(app.new DottedCell());
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setCellEvent(app.new DottedCell());
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell4 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell4.setCellEvent(app.new DottedCell());
						cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell4);

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell11 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell11.setCellEvent(app.new DottedCell());
						cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell11);

						medical_total = medical_total + rs.getFloat("medical");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell5.setCellEvent(app.new DottedCell());
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell8 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell8.setCellEvent(app.new DottedCell());
						cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell8);

						edu_total = edu_total + rs.getFloat("education");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell6.setCellEvent(app.new DottedCell());
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						minins_total = minins_total + +rs.getFloat("min_ins");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell9.setCellEvent(app.new DottedCell());
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell7 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell7);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell7 = new PdfPCell(new Phrase(""
									+ splall1, f1));
							cell7.setCellEvent(app.new DottedCell());
							cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell7);
						}

						if (rs.getFloat("er1") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell10);
						} else {
							float addless = rs.getFloat("er1");
							addlss_total = addlss_total + addless;
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("er2") == 0.0) {
							PdfPCell cell12 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell12);
						} else {
							float spcl = rs.getFloat("er2");
							special_total = special_total + spcl;
							PdfPCell cell12 = new PdfPCell(new Phrase(
									"" + spcl, f1));
							cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell12);
						}

						if (rs.getFloat("addinc") == 0.0) {
							PdfPCell cell23 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell23);
						} else {
							float add_inc = rs.getFloat("addinc");
							addinc_total = addinc_total + add_inc;
							PdfPCell cell23 = new PdfPCell(new Phrase(""
									+ add_inc, f1));
							cell23.setCellEvent(app.new DottedCell());
							cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell23);
						}

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell25 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totear"), f1));
						cell25.setCellEvent(app.new DottedCell());
						cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell25);

						if (rs.getFloat("pf") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell13);
						} else {
							float pf = rs.getFloat("pf");
							pf_total = pf_total + pf;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + pf,
									f1));
							cell13.setCellEvent(app.new DottedCell());
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						if (rs.getFloat("esic") == 0.0f) {
							PdfPCell cell17 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell17);
						} else {
							float esic = rs.getFloat("esic");
							esic_total = esic_total + esic;
							PdfPCell cell17 = new PdfPCell(new Phrase(
									"" + esic, f1));
							cell17.setCellEvent(app.new DottedCell());
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						}

						if (rs.getFloat("pt") == 0.0) {
							PdfPCell cell14 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell14);
						} else {
							float pt = rs.getFloat("pt");
							pt_total = pt_total + pt;
							PdfPCell cell14 = new PdfPCell(new Phrase("" + pt,
									f1));
							cell14.setCellEvent(app.new DottedCell());
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						}

						if (rs.getFloat("tds") == 0.0f) {
							PdfPCell cell22 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell22);
						} else {
							float tds = rs.getFloat("tds");
							tds_total = tds_total + tds;
							PdfPCell cell22 = new PdfPCell(new Phrase("" + tds,
									f1));
							cell22.setCellEvent(app.new DottedCell());
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						}

						if (rs.getFloat("adv") == 0.0f) {
							PdfPCell cell19 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell19);
						} else {
							float adv = rs.getFloat("adv");
							adv_total = adv_total + adv;
							PdfPCell cell19 = new PdfPCell(new Phrase("" + adv,
									f1));
							cell19.setCellEvent(app.new DottedCell());
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						}

						if (rs.getFloat("loan") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell16);
						} else {
							float mlwf = rs.getFloat("loan");
							mlwf_total = mlwf_total + mlwf;
							PdfPCell cell16 = new PdfPCell(new Phrase(
									"" + mlwf, f1));
							cell16.setCellEvent(app.new DottedCell());
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						if (rs.getFloat("mob") == 0.0f) {
							PdfPCell cell18 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell18);
						} else {
							float mob = rs.getFloat("mob");
							mob_total = mob_total + mob;
							PdfPCell cell18 = new PdfPCell(new Phrase("" + mob,
									f1));
							cell18.setCellEvent(app.new DottedCell());
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						}

						if (rs.getFloat("netc") == 0.0f) {
							PdfPCell cell21 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell21);
						} else {
							float netc = rs.getFloat("netc");
							netc_total = netc_total + netc;
							PdfPCell cell21 = new PdfPCell(new Phrase(
									"" + netc, f1));
							cell21.setCellEvent(app.new DottedCell());
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						}

						if (rs.getFloat("lic") == 0.0) {
							PdfPCell cell15 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell15);
						} else {
							float lic = rs.getFloat("lic");
							lic_total = lic_total + lic;
							PdfPCell cell15 = new PdfPCell(new Phrase("" + lic,
									f1));
							cell15.setCellEvent(app.new DottedCell());
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						}

						if (rs.getFloat("relif") == 0.0f) {
							PdfPCell cell20 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell20);
						} else {
							float relif = rs.getFloat("relif");
							relif_total = relif_total + relif;
							PdfPCell cell20 = new PdfPCell(new Phrase(""
									+ relif, f1));
							cell20.setCellEvent(app.new DottedCell());
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						}

						if (rs.getFloat("addded") == 0.0) {
							PdfPCell cell24 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell24);
						} else {
							float add_ded = rs.getFloat("addded");
							addded_total = addded_total + add_ded;
							PdfPCell cell24 = new PdfPCell(new Phrase(""
									+ add_ded, f1));
							cell24.setCellEvent(app.new DottedCell());
							cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell24);
						}

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell26 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totded"), f1));
						cell26.setCellEvent(app.new DottedCell());
						cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell26);

						netpay_total = netpay_total + rs.getFloat("payable");
						PdfPCell cell27 = new PdfPCell(new Phrase(""
								+ rs.getFloat("payable"), f1));
						cell27.setCellEvent(app.new DottedCell());
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell27);

						document.add(datatab);

						// to add data in PRINT_PAY_REG TABLE

						String sql = (" Insert Into PRINTPAYREG (EMP_CODE, PRJ_SRNO, Report_Date, EMPNAME, Basic, HRA, Col, Medical, "
								+ " Conv_All, Education, Min_Ins, Spl_all, Earn1, Earn2, Add_Income, Tot_income, PF, ESIC, PT, TDS, Advance, Loan_Ded,"
								+ " Mobile_Ded, Net_Charges, LIC, Relif_Fund, Add_Ded, Tot_Ded, Net_Pay )"
								+ " values( '"
								+ rs.getString("EMPCODE")
								+ "' , '"
								+ rs.getString("PRJ_SRNO")
								+ "' , '"
								+ PAYREGDT
								+ "',  '"
								+ rs.getString("name")
								+ "' , "
								+ rs.getFloat("basic")
								+ ","
								+ "  "
								+ rs.getFloat("hra")
								+ " , "
								+ rs.getFloat("col")
								+ ", "
								+ rs.getFloat("medical")
								+ " , "
								+ rs.getFloat("convall")
								+ ", "
								+ "  "
								+ rs.getFloat("education")
								+ ", "
								+ rs.getFloat("min_ins")
								+ ", "
								+ rs.getFloat("splall")
								+ ", "
								+ rs.getFloat("er1")
								+ ","
								+ "  "
								+ rs.getFloat("er2")
								+ ", "
								+ rs.getFloat("addinc")
								+ " , "
								+ rs.getFloat("totear")
								+ ", "
								+ rs.getFloat("pf")
								+ ", "
								+ rs.getFloat("esic")
								+ ","
								+ "  "
								+ rs.getFloat("pt")
								+ " , "
								+ rs.getFloat("tds")
								+ " , "
								+ rs.getFloat("adv")
								+ " , "
								+ rs.getFloat("loan")
								+ ", "
								+ rs.getFloat("mob")
								+ ","
								+ "  "
								+ rs.getFloat("netc")
								+ ", "
								+ rs.getFloat("lic")
								+ ", "
								+ rs.getFloat("relif")
								+ " , "
								+ rs.getFloat("addded")
								+ " ,"
								+ rs.getFloat("totded")
								+ " ,"
								+ "  "
								+ rs.getFloat("payable") + " )  ");

						// System.out.println(sql);

						stmtInsert.executeUpdate(sql);

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(27);
					datatot.setWidthPercentage(new float[] { 2, 12.5f, 3.5f,
							3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f, 3.5f,
							3.5f, 3.5f, 3.5f, 3.5f, 3f, 3f, 3.5f, 3.5f, 3.5f,
							3.25f, 3, 2.5f, 3.5f, 3.5f, 3.5f, 3.5f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstconvall_total = lstconvall_total + convall_total;
					convall_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase("" + minins_total,
							f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstsplall_total = lstsplall_total + splall_total;
					splall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(""
							+ special_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstspecial_total = lstspecial_total + special_total;
					special_total = 0.0f;

					PdfPCell cell23 = new PdfPCell(new Phrase(
							"" + addinc_total, f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell23);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell25 = new PdfPCell(new Phrase(
							"" + totinc_total, f1));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);
					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(
							new Phrase("" + pf_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstpf_total = lstpf_total + pf_total;
					pf_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase("" + esic_total,
							f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lstesic_total = lstesic_total + esic_total;
					esic_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(
							new Phrase("" + pt_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstpt_total = lstpt_total + pt_total;
					pt_total = 0.0f;

					PdfPCell cell20 = new PdfPCell(new Phrase("" + tds_total,
							f1));
					cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell20);
					lsttds_total = lsttds_total + tds_total;
					tds_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase("" + adv_total,
							f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstadv_total = lstadv_total + adv_total;
					adv_total = 0.0f;

					PdfPCell cell16 = new PdfPCell(new Phrase("" + mlwf_total,
							f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstmlwf_total = lstmlwf_total + mlwf_total;
					mlwf_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase("" + mob_total,
							f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lstmob_total = lstmob_total + mob_total;
					mob_total = 0.0f;

					PdfPCell cell22 = new PdfPCell(new Phrase("" + netc_total,
							f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell22);
					lstnetc_total = lstnetc_total + netc_total;
					netc_total = 0.0f;

					PdfPCell cell15 = new PdfPCell(new Phrase("" + lic_total,
							f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstlic_total = lstlic_total + lic_total;
					lic_total = 0.0f;

					PdfPCell cell21 = new PdfPCell(new Phrase("" + relif_total,
							f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell21);
					lstrelif_total = lstrelif_total + relif_total;
					relif_total = 0.0f;

					PdfPCell cell24 = new PdfPCell(new Phrase(
							"" + addded_total, f1));
					cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell24);
					lstaddded_total = lstaddded_total + addded_total;
					addded_total = 0.0f;

					PdfPCell cell26 = new PdfPCell(new Phrase(
							"" + totded_total, f1));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;
					totded_total = 0.0f;

					PdfPCell cell27 = new PdfPCell(new Phrase(
							"" + netpay_total, f1));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;
					netpay_total = 0.0f;

					document.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					document.add(para);

				}
				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

								para = new Paragraph(new Phrase("-:Summary :- ", new Font(
						Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 10, 10, 10, 10, 10, 10,
						10, 10, 10, 10 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Basic Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsthra_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstcol_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstedu_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Ins. Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 1 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 2 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstspecial_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add Income Total:-", f));
				maincell.setFixedHeight(50);
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("P.F Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("E.S.I.C Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstesic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("P.T Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpt_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("T.D.S Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsttds_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstadv_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstmlwf_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstmob_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net Chrgs Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.I.C Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstlic_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Relief Fund Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstrelif_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("MLWF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddded_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot Ded. Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net Pay Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				float tttt = 0;
				ResultSet rsss;
				try {
					// System.out.println("date===="+date);
					Statement sttt = con.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT) + "'  and trncd=999 ");

					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (tttt), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);
				document.add(main);

				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);

				/* if(TName.equalsIgnoreCase("after")) { */
				para = new Paragraph(
						new Phrase(
								"Prepared By                         Checked By                        Approved By                 ",
								new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				document.add(para);
				/* } */

				
				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();

			}

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void IncDedRpt(String rdt, String filepath, String imagepath,
			String code, String table) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		Connection Cn = null;
		ResultSet emp = null;
		String EmpSql = "";
		float totincded = 0.0f;
		float totincded1 = 0.0f;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		Statement st;

		SimpleDateFormat outputFormat = new SimpleDateFormat("dd/MM/yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd");

		try {
			st = Cn.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			try {
				Document doc = new Document();
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				UtilityDAO dao = new UtilityDAO();
				UtilityDAO.lable1 = "Report date : ";
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				doc.setPageSize(PageSize.A4);

				Font FONT = new Font(Font.HELVETICA, 52, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT),
						297.5f, 421, 45);
				Image image1 = Image.getInstance(imagepath);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(60f, 50f);
				image1.setAbsolutePosition(40f, 750f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				if (table.equalsIgnoreCase("paytran")) {
					para = new Paragraph(new Phrase(
							"(Before Finalize Of Salary)", new Font(
									Font.TIMES_ROMAN, 5)));
					para.setAlignment(Element.ALIGN_CENTER);
					para.setSpacingAfter(0);
					doc.add(para);
				}

				String phara = "SELECT LKP_DISC,LKP_SRNO FROM LOOKUP WHERE LKP_CODE='CDTYPE' AND LKP_SRNO!=0 and LKP_SRNO = (select CDTYPE from CDMAST where TRNCD = "
						+ code + ") order by LKP_SRNO";
				Statement pa = Cn.createStatement();
				ResultSet par = pa.executeQuery(phara);
				String disp = "";
				int srno = 0;
				if (par.next()) {
					disp = par.getString(1);
					srno = par.getInt(2);
				}
				if (srno != 1)
					disp = "DEDUCTION";
				para = new Paragraph(new Phrase(
						CodeMasterHandler.getCDesc(Integer.parseInt(code))
								+ " " + disp + " Report For Month :"
								+ rdt.substring(3, 11), new Font(
								Font.TIMES_ROMAN, 9)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);
				doc.add(para);

				Rectangle rec = new Rectangle(100, 100);
				PdfPTable headtab = null;

				headtab = new PdfPTable(4);
				headtab.setSpacingBefore(3);
				headtab.setWidthPercentage(new float[] { 15, 45, 20, 20 }, rec);
				headtab.setHorizontalAlignment(Element.ALIGN_LEFT);
				headtab.setSpacingBefore(10);

				/*
				 * EmpSql =
				 * "SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,emp.SALUTE,"
				 * +
				 * "(SELECT INP_AMT FROM PAYTRAN WHERE TRNCD = 135 AND TRNDT BETWEEN '"
				 * +ReportDAO.BOM(rdt)+"'and '"+ReportDAO.EOM(rdt)+
				 * "' AND EMPNO = emp.EMPNO)as bonus " +
				 * "FROM EMPMAST emp,EMPTRAN t WHERE t.EMPNO = emp.EMPNO AND t.EFFDATE = (SELECT MAX(E2.EFFDATE) FROM EMPTRAN E2 "
				 * + " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"+rdt+
				 * "') and emp.STATUS = 'A' ORDER BY emp.EMPNO";
				 */
				EmpSql = "SELECT emp.EMPNO,emp.EMPCODE ,rtrim(emp.fname)+' '+rtrim(emp.lname)as name,emp.SALUTE,p.Net_AMT as amt,p.INP_AMT as inp"
						+ " FROM EMPMAST emp join "
						+ table
						+ " p on emp.EMPNO = p.EMPNO,EMPTRAN t WHERE t.EMPNO = emp.EMPNO AND t.srno = (SELECT MAX(E2.srno) FROM EMPTRAN E2 "
						+ " WHERE E2.EMPNO = emp.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(rdt)
						+ "') and p.TRNCD ="
						+ code
						+ " and p.TRNDT BETWEEN '"
						+ ReportDAO.BOM(rdt)
						+ "'and '"
						+ ReportDAO.EOM(rdt)
						+ "' ORDER BY emp.EMPNO";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);
				LookupHandler lkhp = new LookupHandler();
				int tot_no_emp = 0;
				if (emp.next()) {
					emp.beforeFirst();
					PdfPCell c1 = new PdfPCell(new Phrase("Emp Code", new Font(
							Font.TIMES_ROMAN, 9, Font.BOLD)));
					headtab.addCell(c1);
					PdfPCell c2 = new PdfPCell(new Phrase("Employee Name",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
					headtab.addCell(c2);
					PdfPCell c3 = new PdfPCell(new Phrase("Input Amount",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
					headtab.addCell(c3);
					PdfPCell c4 = new PdfPCell(new Phrase("Calc Amount",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
					headtab.addCell(c4);
					headtab.setHeaderRows(1);

					PdfPTable datatab;
					while (emp.next()) {
						float incded = 0.0f;
						incded = emp.getFloat("amt");

						float incded1 = 0.0f;
						incded1 = emp.getFloat("inp");

						PdfPCell c5 = new PdfPCell(new Phrase(""
								+ emp.getString("EMPCODE"), new Font(
								Font.TIMES_ROMAN, 8)));
						headtab.addCell(c5);
						PdfPCell c6 = new PdfPCell(new Phrase(""
								+ lkhp.getLKP_Desc("SALUTE",
										emp.getInt("SALUTE")) + " "
								+ emp.getString("name"), new Font(
								Font.TIMES_ROMAN, 8)));
						headtab.addCell(c6);
						totincded1 = totincded1 + incded1;
						PdfPCell c7 = new PdfPCell(new Phrase("" + incded1,
								new Font(Font.TIMES_ROMAN, 8)));
						headtab.addCell(c7);
						totincded = totincded + incded;
						PdfPCell c8 = new PdfPCell(new Phrase("" + incded,
								new Font(Font.TIMES_ROMAN, 8)));
						headtab.addCell(c8);
						tot_no_emp = tot_no_emp + 1;

					}
					PdfPCell tot = new PdfPCell(new Phrase("Total:", new Font(
							Font.TIMES_ROMAN, 8)));
					tot.setHorizontalAlignment(Element.ALIGN_RIGHT);
					tot.setColspan(3);
					headtab.addCell(tot);
					PdfPCell tot1 = new PdfPCell(new Phrase(""
							+ trans((int) (totincded), "", "", false, false),
							new Font(Font.TIMES_ROMAN, 8)));
					headtab.addCell(tot1);

				} else {
					System.out.println("no record found");
					PdfPCell c1 = new PdfPCell(new Phrase(
							"Record Not found for the Month "
									+ rdt.substring(3), new Font(
									Font.TIMES_ROMAN, 10, Font.BOLD)));
					c1.setColspan(3);
					headtab.setSpacingBefore(40);
					headtab.addCell(c1);
				}
				doc.add(headtab);
				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, new Font(Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);
				doc.close();
				Cn.close();
				System.out.println("Completed");
			} catch (Exception e) {
				e.printStackTrace();
			}

		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public static void getMlwfchallan(String filePath, String date,
			String imagepath, String table_name) throws IOException,
			SQLException, DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		lable1 = "Report date : ";
		try {
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();

			Phrase title = new Phrase("MLWF Challan", new Font(
					Font.TIMES_ROMAN, 10, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(20);
			document.add(para);

			para = new Paragraph(new Phrase("MAHARASHTRA LABOUR WELFARE BOARD",
					new Font(Font.TIMES_ROMAN, 10, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(10);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"Mumbai Girni Kamgar Kreeda Bhavan, S. B. Marg, Elphistone, Mum: 13",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("Tel. # 2422 77 58 / 2430 67 17.",
					new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("Form A-1 Cum Return", new Font(
					Font.TIMES_ROMAN, 10, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("(Wide Rule 3-A)", new Font(
					Font.TIMES_ROMAN, 10, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(30);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"NOTE: 1) This form-cum-return to be submitted by every Employer alongwith the payment of Employees' & Employer's",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(
					new Phrase(
							"Six-Monthly contribution made by him in respect of all employees whose names stand on the register of his establishment as on 30th June/31st D",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"2) Section 2(2) (b) of Bombay Labour Welfare Fund Act, 1953 'Supervisor' means-who, being employed in a supervisory capacity,",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"draws wages exceeding tow thousand five hundred rupee per mensem or ecercise, either by the nature of the duties attached to the",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"3) EEC = Employees' contribution, ERC = Employer's contribution.",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"4) Total number of employees whose names stood on the establishment registed as on December 2010",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase("a. Manager", new Font(
					Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"b. Employees working in supervisory capacity drawing wages Rs. 2500/- per month",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"c. Employees drawing wages exceeding Rs.3000/- Per Month. (EEC@ Rs. 12/- Per Employee & ERC@ Rs.36/- Per Employee",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"d. Employees drawing wages upto & inclusiove of Rs. 3000/- Per Month. (EEC@ Rs. 6/- Per Employee & ERC@ Rs.18/- Per Employee",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"5) Total Amount of contribution paid along with this Form A-1-Cum-Return",
							new Font(Font.TIMES_ROMAN, 8, Font.BOLD)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase(" For Month of : "
					+ date.substring(3, 11), new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_LEFT);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(30);
			document.add(para);

			para = new Paragraph(new Phrase(
					"Name and address of the Factory/Estt : "
							+ prop.getProperty("companyName")
							+ ",                         CODE NO:_________",
					new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(40);
			document.add(para);

			PdfPTable table = new PdfPTable(7);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(
					new float[] { 15, 15, 15, 15, 15, 10, 15, }, new Rectangle(
							100, 100));

			PdfPCell cell1 = new PdfPCell(new Phrase("No of Employees",
					new Font(Font.TIMES_ROMAN, 11)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);

			PdfPCell cell2 = new PdfPCell(new Phrase("No of employee @ 6",
					new Font(Font.TIMES_ROMAN, 11)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);

			PdfPCell cell3 = new PdfPCell(new Phrase("No of employee @ 12",
					new Font(Font.TIMES_ROMAN, 11)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);

			PdfPCell cell4 = new PdfPCell(new Phrase(
					"EEC (Employee's Contribution)", new Font(Font.TIMES_ROMAN,
							11)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5 = new PdfPCell(new Phrase(
					"EER (Employer's Contribution)", new Font(Font.TIMES_ROMAN,
							11)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6 = new PdfPCell(new Phrase("Penel Interest",
					new Font(Font.TIMES_ROMAN, 11)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7 = new PdfPCell(new Phrase("Total (Rs)", new Font(
					Font.TIMES_ROMAN, 11)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);

			table.setHeaderRows(1);

			table_name = table_name.equalsIgnoreCase("before") ? "PAYTRAN"
					: "PAYTRAN_STAGE";

			Connection con = null;
			con = ConnectionManager.getConnection();
			Statement stmt = con.createStatement();
			ResultSet rspt = null;
			float emp_mlwf = 0;
			float empr_mlwf = 0;
			int total_emp = 0;
			int empsix = 0;
			int emptwl = 0;
			float empsamt = 0;

			String sql = "select Count(Distinct(empno)) from " + table_name
					+ " where trncd=211 and trndt between '"
					+ ReportDAO.BOM(date) + "' and '" + ReportDAO.EOM(date)
					+ "' and cal_amt>0";

			rspt = stmt.executeQuery(sql);

			while (rspt.next()) {
				total_emp = rspt.getInt(1);
			}

			rspt = stmt
					.executeQuery("select Count(Distinct(empno)),cal_amt,sum(cal_amt) from "
							+ table_name
							+ " where  trncd=211 and  trndt between '"
							+ ReportDAO.BOM(date)
							+ "'"
							+ " and '"
							+ ReportDAO.EOM(date) + "'  group by cal_amt  ");

			while (rspt.next()) {

				if (rspt.getInt("cal_amt") == 6) {
					empsix = rspt.getInt(1);
				}

				if (rspt.getInt("cal_amt") == 12) {
					emptwl = rspt.getInt(1);
				}

				empsamt = rspt.getInt(3);
			}

			rspt = stmt.executeQuery("select trncd,Sum(cal_amt) from "
					+ table_name
					+ " where trncd in(211,237) and trndt between '"
					+ ReportDAO.BOM(date) + "'" + " and '"
					+ ReportDAO.EOM(date) + "'   and empno in("
					+ "select Distinct(empno) from " + table_name + " "
					+ "where trncd in (211) and trndt between '"
					+ ReportDAO.BOM(date) + "'" + " and '"
					+ ReportDAO.EOM(date) + "'  " + " and cal_amt>0) "
					+ "group by TRNCD ");

			while (rspt.next()) {

				if (rspt.getInt("trncd") == 211) {
					emp_mlwf = (int) rspt.getFloat(2);
				}

				if (rspt.getInt("trncd") == 237) {
					empr_mlwf = (int) rspt.getFloat(2);
				}

			}

			PdfPCell cell1data1 = new PdfPCell(new Phrase(" " + total_emp,
					new Font(Font.TIMES_ROMAN, 12)));
			cell1data1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data1);

			PdfPCell cell1data2 = new PdfPCell(new Phrase(" " + empsix,
					new Font(Font.TIMES_ROMAN, 12)));
			cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data2);

			PdfPCell cell1data3 = new PdfPCell(new Phrase(" " + emptwl,
					new Font(Font.TIMES_ROMAN, 12)));
			cell1data3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data3);

			PdfPCell cell1data4 = new PdfPCell(new Phrase(" " + emp_mlwf,
					new Font(Font.TIMES_ROMAN, 12)));
			cell1data4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data4);

			PdfPCell cell1data5 = new PdfPCell(new Phrase(" " + empr_mlwf,
					new Font(Font.TIMES_ROMAN, 12)));
			cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data5);

			PdfPCell cell1data6 = new PdfPCell(new Phrase(" " + 0, new Font(
					Font.TIMES_ROMAN, 12)));
			cell1data6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data6);

			PdfPCell cell1data7 = new PdfPCell(new Phrase(""
					+ (emp_mlwf + empr_mlwf), new Font(Font.TIMES_ROMAN, 12)));
			cell1data7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1data7);

			table.setSpacingAfter(50.0f);
			document.add(table);

			para = new Paragraph(
					new Phrase(
							"Certified that the information / particular furnished above is / are true to the best of my knowledge and belief",
							new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(50);
			document.add(para);

			para = new Paragraph(new Phrase(
					"Signature of the Employer or other authorised officer",
					new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"Date :______________                                                           "
									+ "                                                        Stamp of the Factory/Estt",
							new Font(Font.TIMES_ROMAN, 10)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(40);
			document.add(para);

			para = new Paragraph(new Phrase("IMPORTANT:", new Font(
					Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"1) Cheque/DD should be drawn to each Estt, Code Number seperately & in favour of Maharashtra Labour Welfare Fund.",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"2) Cash payment will be accepted from 10.30 am to 3.00 pm.",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"3) Code No. of the Establishment alloted to you should be quoted at the appropriate place in this form.",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase(
					"4) DD should be payable at BOMBAY only.", new Font(
							Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"5) Please write Establishment code number on the back side of the Cheque/DD",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(10);
			document.add(para);

			document.close();
			file.close();

			stmt.close();
			con.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		document.open();
	}

	public static void newAttendSheet(String PAYREGDT, String imgpath,
			String filepath) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		System.out.println("in new attendSheet generate");

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;
		// String dt = PAYREGDT;
		String table_name = null;

		// System.out.println(dt);
		lastdat = (int) Calculate.getDays(PAYREGDT);
		System.out.println("maxdt" + lastdat);
		BomDt = ReportDAO.BOM(PAYREGDT);
		// System.out.println("bomdt "+BomDt);
		EomDt = ReportDAO.EOM(PAYREGDT);
		// System.out.println("eomdt"+EomDt);

		String temp = PAYREGDT.substring(3);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			System.out.println("in attendence sheet");
			Document doc = new Document(new Rectangle(2384, 3370));
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 1300f,
					1830f, 45);
			Image image1 = Image.getInstance(imgpath);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			Font f = new Font(Font.HELVETICA, 30);
			Font f1 = new Font(Font.HELVETICA, 25);
			Font f2 = new Font(Font.HELVETICA, 32);

			para = new Paragraph(new Phrase(
					"Attendence Sheet for the Month Of :- " + temp + " ",
					new Font(Font.TIMES_ROMAN, 25, Font.BOLD)));

			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			doc.add(para);

			Rectangle rec = new Rectangle(100, 100);

			float present = 0.0f;
			float absent = 0.0f;
			float leave = 0.0f;
			float halfdays = 0.0f;
			float weekoffdays = 0.0f;
			float holidays = 0.0f;
			float workdays = 0.0f;
			// float tworkdays = 0.0f;
			float present2 = 0.0f;
			float absent2 = 0.0f;
			float leave2 = 0.0f;
			float half = 0.0f;
			float hold = 0.0f;
			float wo = 0.0f;
			float wd = 0.0f;

			/*
			 * EmpSql =
			 * "SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  name, eat1.site_id as PRJ_SRNO, count (case ATTD_VAL when 'P' then 1 else null end ) as present_days,"
			 * +
			 * " count (case ATTD_VAL  when 'A' then 1 else null end ) as absent_days,"
			 * +
			 * " count (case ATTD_VAL  when 'L' then 1 else null end ) as Leave_days,"
			 * +
			 * " count (case ATTD_VAL  when 'H' then 1 else null end ) as Half_days, "
			 * +
			 * " count (case ATTD_VAL  when 'HD' then 1 else null end ) as Holidays, "
			 * +
			 * " count (case ATTD_VAL  when 'WO' then 1 else null end ) as WeekOffDays "
			 * +
			 * " FROM EMP_ATTENDANCE eat1, EMPMAST e where eat1.ATTD_DATE BETWEEN '"
			 * +BomDt+"'and '"+EomDt+"' " +
			 * " and e.EMPNO = eat1.empno  group by e.empno,e.fname,e.mname,e.lname,eat1.site_id,e.EMPCODE order by eat1.site_id "
			 * ;
			 */
			EmpSql = "SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  name, t.PRJ_SRNO as PRJ_SRNO,"
					+ " (select isnull(count  (CASE WHEN ATTD_VAL='P' THEN 1 else null end ),0) from  EMP_ATTENDANCE a1 "
					+ "where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  ) as present_days, "
					+ "(select isnull( count (case ATTD_VAL  when 'A' then 1 else null end) ,0) from  EMP_ATTENDANCE a1 "
					+ "where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  ) as absent_days,"
					+ " (select isnull(count (case ATTD_VAL  when 'L' then 1 else null end) ,0) from  EMP_ATTENDANCE a1"
					+ " where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  ) as Leave_days,"
					+ " (select isnull( count (case ATTD_VAL  when 'H' then 1 else null end) ,0) from  EMP_ATTENDANCE a1 "
					+ "where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  ) as Half_days, "
					+ "(select isnull( count (case ATTD_VAL  when 'HD' then 1 else null end ),0) from  EMP_ATTENDANCE a1 "
					+ "where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  ) as Holidays, "
					+ " (select isnull(count (case ATTD_VAL  when 'WO' then 1 else null end ),0) from  EMP_ATTENDANCE a1"
					+ " where a1.empno=e.EMPNO and a1.ATTD_DATE BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "'  )  as WeekOffDays "
					+ " FROM   EMPMAST e left join   EMPTRAN t on (e.EMPNO=t.EMPNO )"
					+ "  where e.STATUS='A'   and DOJ <= '"
					+ EomDt
					+ "'  AND T.SRNO=(SELECT MAX(ET.SRNO) FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO)"
					+ "  order by t.PRJ_SRNO,e.EMPNO";

			System.out.println(EmpSql);
			ResultSet rs = st.executeQuery(EmpSql);

			while (rs.next()) {

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
						+ rs.getString("PRJ_SRNO") + "'";
				System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if (prj.next()) {
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;
				para = new Paragraph(new Phrase(
						"Employee's Attendance sheet List For Project Site : "
								+ prj_name + " (" + prj_code + ")", f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				doc.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(9);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 8, 20, 9, 8, 8, 7, 7, 9,
						7f }, rec);

				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("EMP CODE", f1));
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPLOYEE NAME", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Present Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Absent Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Leave Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Half Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Holidays", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("WeekOff Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Work Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);
				while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
					float tpresent = 0.0f;
					float tabsent = 0.0f;
					float tleave = 0.0f;
					float thalfdays = 0.0f;
					float tweekoffdays = 0.0f;
					float tholidays = 0.0f;
					float tworkdays = 0.0f;
					float date = Calculate.getDays(PAYREGDT);
					datatab = new PdfPTable(9);

					datatab.setWidthPercentage(new float[] { 8, 20, 9, 8, 8, 7,
							7, 9, 7f }, rec);

					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell1 = new PdfPCell(new Phrase(""
							+ rs.getString("EMPCODE"), f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f1));
					cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
					datatab.addCell(cell2);
					tpresent = rs.getFloat("present_days");
					present = present + tpresent;
					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ rs.getFloat("present_days"), f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);

					tabsent = rs.getFloat("absent_days");
					absent = absent + tabsent;
					PdfPCell cell4 = new PdfPCell(new Phrase(""
							+ rs.getFloat("absent_days"), f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);
					tleave = rs.getFloat("Leave_days");
					leave = leave + tleave;
					PdfPCell cell5 = new PdfPCell(new Phrase(""
							+ rs.getFloat("Leave_days"), f1));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell5);
					thalfdays = rs.getFloat("Half_days");
					halfdays = halfdays + thalfdays;
					PdfPCell cell6 = new PdfPCell(new Phrase(""
							+ rs.getFloat("Half_days"), f1));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell6);

					tholidays = rs.getFloat("Holidays");
					holidays = holidays + tholidays;
					PdfPCell cell7 = new PdfPCell(new Phrase(""
							+ rs.getFloat("Holidays"), f1));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell7);
					tweekoffdays = rs.getFloat("WeekOffDays");
					weekoffdays = weekoffdays + tweekoffdays;
					PdfPCell cell8 = new PdfPCell(new Phrase(""
							+ rs.getFloat("WeekOffDays"), f1));
					cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell8);

					tworkdays = tpresent + tweekoffdays + tholidays + thalfdays
							+ tleave + tabsent;
					workdays = workdays + tworkdays;
					// float date2=Calculate.getDays(PAYREGDT);
					PdfPCell cell9 = new PdfPCell(
							new Phrase("" + tworkdays, f1));
					cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell9);

					doc.add(datatab);
					tpresent = 0.0f;
					tabsent = 0.0f;
					tleave = 0.0f;
					thalfdays = 0.0f;
					tweekoffdays = 0.0f;
					tholidays = 0.0f;
					tworkdays = 0.0f;
					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						rs.previous();
						break;
					}
				}

				datatot = new PdfPTable(9);
				datatot.setWidthPercentage(new float[] { 8, 20, 9, 8, 8, 7, 7,
						9, 7f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
				cell1.setColspan(2);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell1);

				PdfPCell cell2 = new PdfPCell(new Phrase("" + present, f1));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell2);
				present2 = present2 + present;
				present = 0.0f;

				PdfPCell cell4 = new PdfPCell(new Phrase("" + absent, f1));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell4);
				absent2 = absent2 + absent;
				absent = 0.0f;

				PdfPCell cell5 = new PdfPCell(new Phrase("" + leave, f1));
				cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell5);
				leave2 = leave2 + leave;
				leave = 0.0f;

				PdfPCell cell6 = new PdfPCell(new Phrase("" + halfdays, f1));
				cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell6);
				half = half + halfdays;
				halfdays = 0.0f;

				PdfPCell cell7 = new PdfPCell(new Phrase("" + holidays, f1));
				cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell7);
				hold = hold + holidays;
				holidays = 0.0f;

				PdfPCell cell8 = new PdfPCell(new Phrase("" + weekoffdays, f1));
				cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell8);
				wo = wo + weekoffdays;
				weekoffdays = 0.0f;

				PdfPCell cell9 = new PdfPCell(new Phrase("" + workdays, f1));
				cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell9);
				wd = wd + workdays;
				workdays = 0.0f;
				doc.add(datatot);

				para = new Paragraph(new Phrase("No Of Employee :- "
						+ br_tot_no_emp, f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(50);
				doc.add(para);

			}

			para = new Paragraph(new Phrase("Total No Of Employee :- "
					+ tot_no_emp, f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			System.out.println("Total No Of Employee :- " + tot_no_emp);

			para = new Paragraph(new Phrase("-:Summary :- ", new Font(
					Font.HELVETICA, 40, Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable main = new PdfPTable(4);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[] { 10, 10, 10, 10 }, rec);
			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase("Present Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + ((int) (present2)), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Absent Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (absent2), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Leave Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (leave2), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Halfdays Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (half), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Holidays Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) ((hold)), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Weekoffdays Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (wo), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Workdays Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (wd), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			doc.add(main);

			st.close();
			con.close();
			doc.close();

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void getRelif_Fund(String filePath, String date,
			String imagepath, String type) throws IOException, SQLException,
			DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();
		String table_name = "";
		lable1 = "Report date : ";
		if (type.equalsIgnoreCase("before")) {
			table_name = "PAYTRAN";
		} else {
			table_name = "PAYTRAN_STAGE";
		}
		try {
			// PdfWriter.getInstance(document, file);
			UtilityDAO dao = new UtilityDAO();
			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filePath));

			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			Image image1 = Image.getInstance(imagepath);
			image1.scaleAbsolute(80f, 80f);
			image1.setAbsolutePosition(40f, 730f);
			document.add(image1);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(Font.TIMES_ROMAN, 9, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(new Phrase(""
					+ prop.getProperty("addressForReport") + ",", new Font(
					Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(""
					+ prop.getProperty("contactForReport") + ","
					+ prop.getProperty("mailForReport") + "", new Font(
					Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase("Relif Fund  "
					+ (type.equalsIgnoreCase("before") ? "" : ""), new Font(
					Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase("For The Month Of "
					+ date.substring(3, 11), new Font(Font.TIMES_ROMAN, 9,
					Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(0);
			document.add(para);
			PdfPTable table = new PdfPTable(5);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[] { 6, 12, 40, 19, 19 },
					new Rectangle(100, 100));
			PdfPCell cell1 = new PdfPCell(new Phrase("Sr NO", new Font(
					Font.TIMES_ROMAN, 10)));
			cell1.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell1);
			PdfPCell cell2 = new PdfPCell(new Phrase("Employee Code", new Font(
					Font.TIMES_ROMAN, 10)));
			cell2.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(cell2);
			PdfPCell cell3 = new PdfPCell(new Phrase("Employee Name", new Font(
					Font.TIMES_ROMAN, 10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4 = new PdfPCell(new Phrase("Gross salary(Rs)",
					new Font(Font.TIMES_ROMAN, 10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5 = new PdfPCell(new Phrase("Relif Fund Amount",
					new Font(Font.TIMES_ROMAN, 10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			table.setHeaderRows(1);

			Connection con = null;
			con = ConnectionManager.getConnection();
			Statement stmt = con.createStatement();
			ResultSet rspt = null;

			String sql1 = "select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join PAYTRAN y1 on e.EMPNO = y1.EMPNO join PAYTRAN y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 199 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 229 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'  "
					+ " UNION "
					+ "select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join PAYTRAN_STAGE y1 on e.EMPNO = y1.EMPNO join PAYTRAN_STAGE y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 199 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 229 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'  "
					+ " UNION "
					+ "select e.salute,e.empno,e.empcode,e.fname,e.mname,e.lname,y1.cal_amt as Gross,y2.cal_amt as Relif_fund from EMPMAST e join YTDTRAN y1 on e.EMPNO = y1.EMPNO join YTDTRAN y2 on e.EMPNO = y2.EMPNO "
					+ "and y1.TRNCD = 199 and y1.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' "
					+ "and y2.TRNCD = 229 and y2.TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "'  ";

			// System.out.println("query is"+sql1);

			rspt = stmt.executeQuery(sql1);
			int srno = 0;
			double totatlrelif = 0;
			LookupHandler lkp = new LookupHandler();
			int i = 0;
			while (rspt.next()) {
				if (rspt.getInt("Relif_fund") > 0) {
					i++;
				}
				srno++;
				PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2 = new PdfPCell(new Phrase(""
						+ rspt.getString("EMPCODE"), new Font(Font.TIMES_ROMAN,
						10)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data2);

				int cd = rspt.getInt("salute");

				String empname = lkp.getLKP_Desc("SALUTE", cd) + ""
						+ rspt.getString("fname") + " "
						+ rspt.getString("mname") + " "
						+ rspt.getString("lname");

				PdfPCell cell1data3 = new PdfPCell(new Phrase("" + empname,
						new Font(Font.TIMES_ROMAN, 10)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				PdfPCell cell1data4 = new PdfPCell(new Phrase(""
						+ rspt.getInt("Gross"), new Font(Font.TIMES_ROMAN, 10)));

				cell1data4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data4);

				totatlrelif = totatlrelif + rspt.getInt("Relif_fund");

				PdfPCell cell1data5 = new PdfPCell(new Phrase(""
						+ rspt.getInt("Relif_fund"), new Font(Font.TIMES_ROMAN,
						10)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				table.addCell(cell1data5);

			}
			PdfPCell totemp = new PdfPCell(new Phrase("Total Employee:",
					new Font(Font.TIMES_ROMAN, 10)));
			totemp.setHorizontalAlignment(Element.ALIGN_RIGHT);
			totemp.setColspan(2);
			table.addCell(totemp);
			PdfPCell totempdisp = new PdfPCell(new Phrase("" + i, new Font(
					Font.TIMES_ROMAN, 10)));
			totemp.setHorizontalAlignment(Element.ALIGN_LEFT);
			table.addCell(totempdisp);
			PdfPCell total = new PdfPCell(new Phrase("Relif Fund Total :",
					new Font(Font.TIMES_ROMAN, 10)));
			total.setHorizontalAlignment(Element.ALIGN_RIGHT);
			// total.setColspan(2);
			table.addCell(total);
			PdfPCell totaldata = new PdfPCell(new Phrase("" + totatlrelif,
					new Font(Font.TIMES_ROMAN, 10)));
			totaldata.setHorizontalAlignment(Element.ALIGN_RIGHT);
			table.addCell(totaldata);
			document.add(table);
			document.close();
			file.close();
			con.close();
			// System.out.println("pdf Generated Successfully");

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void getForm5(String filePath, String date, String imagepath)
			throws IOException, SQLException, DocumentException {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		OutputStream file = new FileOutputStream(new File(filePath));
		Document document = new Document();

		try {
			PdfWriter.getInstance(document, file);
			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filePath));
			UtilityDAO dao = new UtilityDAO();
			UtilityDAO.lable1 = "Report date : ";
			Footer ftr = dao.new Footer(lable1);
			writer.setPageEvent(ftr);
			document.open();
			// Image image1 = Image.getInstance(imagepath);
			// image1.scaleAbsolute(80f, 80f);
			// image1.setAbsolutePosition(40f, 730f);
			// document.add(image1);

			Phrase title = new Phrase("FORM-5", new Font(Font.TIMES_ROMAN, 9,
					Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"THE EMPLOYEE'S PROVIDENT FUNDS SCHEME, 1952 [Paragraph 36 (2) (A)]",
							new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			document.add(para);

			para = new Paragraph(new Phrase(
					"AND THE EMPLOYEE'S PENSION SCHEME, 1995 [Para - 20 (4)]",
					new Font(Font.TIMES_ROMAN, 9, Font.BOLD)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							"Return of employees qualifying for membership of the employees provident found, ",
							new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(5);
			document.add(para);

			para = new Paragraph(
					new Phrase(
							" employee's pension fund & employee's deposit linked insurance fund for the First time during the month of : "
									+ date.substring(3, 11), new Font(
									Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(5);
			document.add(para);

			para = new Paragraph(new Phrase(
					"(To be sent to the commissioner with form 2 (EPF & EPS)",
					new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			// para.setSpacingBefore(30.0f);
			para.setSpacingAfter(10);
			document.add(para);

			para = new Paragraph(new Phrase(
					"Name and address of the Factory/Estt : "
							+ prop.getProperty("companyName")
							+ ",                         CODE NO:MH / 51492",
					new Font(Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(0);
			document.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 9)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
			SimpleDateFormat format = new SimpleDateFormat("dd-MMM-yyyy");
			SimpleDateFormat format1 = new SimpleDateFormat("dd-MM-yyyy");
			SimpleDateFormat fromformat = new SimpleDateFormat("MM/yyyy");
			PdfPTable table = new PdfPTable(9);
			table.setSpacingBefore(10.0f);
			table.setWidthPercentage(new float[] { 5, 15, 16, 16, 10, 6, 10,
					14, 8 }, new Rectangle(100, 100));
			PdfPCell cell1 = new PdfPCell(new Phrase("SR NO", new Font(
					Font.TIMES_ROMAN, 10)));
			cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell1);
			PdfPCell cell2 = new PdfPCell(new Phrase("Account No.", new Font(
					Font.TIMES_ROMAN, 10)));
			cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell2);
			PdfPCell cell3 = new PdfPCell(new Phrase("Name of Member",
					new Font(Font.TIMES_ROMAN, 10)));
			cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell3);
			PdfPCell cell4 = new PdfPCell(new Phrase(
					"Father's Name or husband's name", new Font(
							Font.TIMES_ROMAN, 10)));
			cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell4);
			PdfPCell cell5 = new PdfPCell(new Phrase("Date of Birth", new Font(
					Font.TIMES_ROMAN, 10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell5);
			PdfPCell cell6 = new PdfPCell(new Phrase("Sex", new Font(
					Font.TIMES_ROMAN, 10)));
			cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell6);
			PdfPCell cell7 = new PdfPCell(new Phrase("Date of Joining Fund",
					new Font(Font.TIMES_ROMAN, 10)));
			cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell7);
			PdfPCell cell8 = new PdfPCell(
					new Phrase(
							"Total period of previous service as on date of joining the fund ",
							new Font(Font.TIMES_ROMAN, 10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell8);
			PdfPCell cell9 = new PdfPCell(new Phrase("Remarks", new Font(
					Font.TIMES_ROMAN, 10)));
			cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			table.addCell(cell9);
			table.setHeaderRows(1);

			Connection con = null;
			con = ConnectionManager.getConnection();
			Statement stmt = con.createStatement();
			ResultSet rspt = null;
			LookupHandler lkp = new LookupHandler();

			String sql = "SELECT e.EMPNO, e.SALUTE, e.FNAME, e.MNAME, e.LNAME, e.DOB,e.GENDER, t.ACNO,e.DOJ FROM EMPMAST e, EMPTRAN t "
					+ " WHERE DOJ BETWEEN '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' AND e.EMPNO = t.EMPNO "
					+ " AND e.STATUS='A' and t.srno=(select max(srno) from emptran where empno=e.EMPNO) ORDER BY e.EMPNO";
			// System.out.println("********"+sql);
			rspt = stmt.executeQuery(sql);
			int srno = 1;

			int count = 0;
			while (rspt.next()) {
				count++;
				PdfPCell cell1data = new PdfPCell(new Phrase("" + srno,
						new Font(Font.TIMES_ROMAN, 8)));
				cell1data.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data);

				PdfPCell cell1data2 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1data2.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data2);

				PdfPCell cell1data3 = new PdfPCell(new Phrase(" "
						+ rspt.getString("fname") + " "
						+ rspt.getString("lname"),
						new Font(Font.TIMES_ROMAN, 7)));
				cell1data3.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data3);

				PdfPCell cell1data4 = new PdfPCell(new Phrase(""
						+ rspt.getString("mname"),
						new Font(Font.TIMES_ROMAN, 7)));
				cell1data4.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data4);

				/* Date DOb = sdf.parse(rspt.getString("DOB")); */
				PdfPCell cell1data5 = new PdfPCell(new Phrase(""
						+ format.format(rspt.getDate("DOB")), new Font(
						Font.TIMES_ROMAN, 8)));
				cell1data5.setHorizontalAlignment(Element.ALIGN_CENTER);
				table.addCell(cell1data5);

				if (rspt.getString("GENDER").contains("M")) {
					PdfPCell cell1data6 = new PdfPCell(new Phrase("" + "Male",
							new Font(Font.TIMES_ROMAN, 7)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
				} else {
					PdfPCell cell1data6 = new PdfPCell(new Phrase(
							"" + "Female", new Font(Font.TIMES_ROMAN, 7)));
					cell1data6.setHorizontalAlignment(Element.ALIGN_LEFT);
					table.addCell(cell1data6);
				}

				/* Date DOj = sdf.parse(rspt.getString("DOJ")); */
				PdfPCell cell1data7 = new PdfPCell(new Phrase(""
						+ format.format(rspt.getDate("DOJ")), new Font(
						Font.TIMES_ROMAN, 8)));
				cell1data7.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data7);

				PdfPCell cell1data8 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1data8.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data8);

				PdfPCell cell1data9 = new PdfPCell(new Phrase("", new Font(
						Font.TIMES_ROMAN, 8)));
				cell1data9.setHorizontalAlignment(Element.ALIGN_LEFT);
				table.addCell(cell1data9);
				srno++;
			}

			if (count <= 0) {
				para = new Paragraph(new Phrase("No records Found. ", new Font(
						Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(0);
				document.add(para);
			}

			table.setSpacingAfter(50.0f);
			document.add(table);

			document.close();
			file.close();

			stmt.close();
			con.close();
		} catch (Exception e) {
			e.printStackTrace();
		}
		document.open();
	}

	public static void payregWithBranchTotal(String PAYREGDT, String Desgn,
			String filepath) {
		System.out.println("frfrre.rerlvrellrerl.vrl.cvl.rl.vcl.r ");

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		ResultSet arrrec = null;

		float Days = Calculate.getDays(PAYREGDT);
		LookupHandler lkp = new LookupHandler();

		FileWriter Fp;
		int aCtr = 0;
		int lCtr = 0;
		int ctr = 0;
		int printBasic = 0;
		int printNet = 0;
		int printGross = 0;
		int printTotDed = 0;
		int LOPDays = 0;
		String BomDt = "";
		String EomDt = "";
		boolean DtrFind = false;
		String lBomDt = "";
		String lEomDt = "";
		int i = 0;
		int j = 0;
		String dtrsql = "";
		String CdmSql = "";
		String EmpSql = "";
		String[] pdet = new String[7];
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		int Str2Ctr = 0;
		int Str4Ctr = 0;
		int Str1Ctr = 0;
		int Arr1Ctr = 0;
		int Arr2Ctr = 0;
		int count = 1;
		int countTotal = 1;
		String sLOPDTr = "";
		ResultSet LOPDTr = null;
		ReportDAO.inithead(repBean);
		// Initvar *****already variable are initialised not need of initvar
		ReportDAO.make_prn_file(filepath, repBean);

		Connection Cn = null;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		int Hdg6Ctr = 0;
		int Hdg4Ctr = 0;
		int HdgArr1 = 0;
		int HdgArr2 = 0;
		boolean Barr1 = false;
		boolean Barr2 = false;
		boolean fnd = false;
		String Arr1 = "";
		String Arr2 = "";
		String nm = "";
		String pBranch = "";
		String SLINE = "";
		String prj_name = "";
		int page = 0;

		// total as per branch incomes ,deduction

		int totalGross = 0;
		int totalDed = 0;
		int totalNet = 0;
		int totalBasic = 0;
		int gross = 0;
		int ded = 0;
		int net = 0;
		int originalbasic = 0;

		// total as per branch incomes related
		int empTotalBasic = 0;
		int empCurrentDa = 0;
		int empVda = 0;
		int empHra = 0;
		int empOcash = 0;
		int empConve = 0;
		int empMininsurance = 0;
		int empCol = 0;
		int empSpecial = 0;
		int empEdu = 0;
		int empMed = 0;
		int empArrears = 0;
		int empCLSG = 0;
		int empAREABDV = 0;
		int empEarning1 = 0;
		int empearning2 = 0;
		int empAREAALL = 0;
		int empGROSS = 0;

		// total as per branch deduction related

		int empPF = 0;
		int empPT = 0;

		int empmobile = 0;
		int empArrPF = 0;
		int empESIC = 0;
		int empAdv = 0;

		int empOther = 0;
		int empTDS = 0;
		int empRF = 0;
		int empNET = 0;

		int empGRPINSU = 0;
		int empOTHERLOAN = 0;
		int empSOCDED = 0;
		int empUNIONSUB = 0;
		int empLWPAamount = 0;
		int empMLWFDED = 0;

		int empHSGLOANINST = 0;
		int empVEHLOANINST = 0;
		int empFESTLOANINST = 0;
		int empADVANCEINST = 0;
		int empBANKINST = 0;
		int empOTHERINST = 0;
		int empSTAMP = 0;
		int empLICINST = 0;

		repBean.setbCode(0);
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd"); // Added
																			// by
																			// nakul
																			// for
																			// campareDate
																			// fun()

		for (i = 1; i <= 26; i++) {
			repBean.setIcode(0, i);
			repBean.setEcode(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 100; i <= 200; i++) {
				repBean.setbInc(0, j, i);
			}
		}
		for (i = 100; i <= 199; i++) {
			repBean.setInc(0, i);
		}
		for (i = 200; i <= 300; i++) {
			repBean.setDed(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 200; i <= 300; i++) {
				repBean.setbDed(0, j, i);
			}
		}
		for (i = 1; i <= 4; i++) {
			repBean.setTotBngd(0, i);
			repBean.setRepTotBNGD(0, i);
		}
		for (i = 1; i <= 20; i++) {
			for (j = 1; j <= 4; j++) {
				repBean.setBtotBngd(0, i, j);
			}
		}

		repBean.setLnCount(0);
		repBean.setPayrep(true);
		repBean.setPageNo(1);
		repBean.setLineLen(231);
		repBean.setPageLen(65);
		repBean.setLineSpace(10);
		BomDt = ReportDAO.BOM(PAYREGDT);
		repBean.setFoot_Fl(true);

		EomDt = ReportDAO.EOM(PAYREGDT);
		lBomDt = ReportDAO.BOM(ReportDAO.DateAdd('m', -1, PAYREGDT));
		lEomDt = ReportDAO.EOM(lBomDt);
		ReportDAO.make_prn_file(filepath, repBean);
		String temp = PAYREGDT.substring(3);

		repBean.setHdg1("Salary Sheet For The Month Of :- " + temp);

		SLINE = stringOfSize(231, '-');
		String str2 = "";

		if (!Desgn.equalsIgnoreCase("0")) {
			Str2 = "AND T.DESIG = " + Desgn;
		}

		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
				+ "' AND '" + EomDt + "'";
		try {
			Statement st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			} else {
				DtrFind = true;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
				dtrsql = dtrsql
						+ "UNION SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			}

			// -----CHanged By PHP Sir

			CdmSql = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
					+ BomDt + "' AND '" + EomDt + "') ORDER BY   TRNCD ";
			EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"
					+ (ReportDAO.EOM(PAYREGDT))
					+ "') AND   "
					+ " (( EMP.STATUS='A' AND	EMP.DOJ <= '"
					+ ReportDAO.EOM(PAYREGDT)
					+ "') or "
					+ " (EMP.STATUS ='N' And EMP.DOL>='"
					+ ReportDAO.BOM(PAYREGDT)
					+ "')) "
					+ Str2
					+ " "
					+ " ORDER BY T.PRJ_SRNO, EMP.EMPNO , EMP.EMPCODE";

			System.out.println(EmpSql);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					System.out.println("Transactions not found");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}

			}
			Barr1 = false;
			Barr2 = false;
			DTR.beforeFirst();
			while (DTR.next()) {
				if (DTR.getInt("TRNCD") <= 200) {
					if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
							.getInt("ARR_AMT")) != 0) {
						Barr1 = true;
					}

				} else {
					if (DTR.getInt("TRNCD") >= 201
							&& DTR.getInt("TRNCD") <= 293) {
						if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
								.getInt("ARR_AMT")) != 0) {
							Barr2 = true;
						}

					}
				}
			}
			// System.out.println("code selection 111---"+CdmSql);
			CDM = st.executeQuery(CdmSql);
			if (!CDM.next()) {
				CdmSql = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT (TRNCD) FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt
						+ "' AND '"
						+ EomDt
						+ "')  and PSLIPYN='Y'  ORDER BY   TRNCD";
				CDM = st.executeQuery(CdmSql);
				if (!CDM.next()) {
					System.out.println("No any Code to print");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			repBean.setHdg2("EmpCode| Employee Name      |P-Day | Allowances:->|");
			repBean.setHdg3("       |                                Arrears:->|");
			repBean.setHdg4("       | SB.A/c No.         |Desg.                |");
			repBean.setHdg5("Sr.No. | Original Basic     LOP Days Deductions:->|");
			repBean.setHdg6("       |                                Arrears:->|");
			repBean.setHdg7("       | Gross Pay.     Total Ded.   Net Pay      |");

			while (CDM.next()) {
				if (CDM.getInt("TRNCD") <= 200) {
					aCtr = aCtr + 1;
					if (aCtr <= 12) {
						repBean.setHdg2(repBean.getHdg2()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
					} else {
						repBean.setHdg4(repBean.getHdg4()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
						Hdg4Ctr = Hdg4Ctr + 1;
					}
				} else {
					lCtr = lCtr + 1;
					if (lCtr <= 12) {
						repBean.setHdg5(repBean.getHdg5()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
					} else {
						repBean.setHdg7(repBean.getHdg7()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
						Hdg6Ctr = Hdg6Ctr + 1;
					}
				}
			}

			for (i = 1; i <= 12; i++) {
				repBean.setHdg3(repBean.getHdg3() + ReportDAO.addSpaces("", 14)
						+ "|");
				repBean.setHdg6(repBean.getHdg6() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (i = Hdg4Ctr + 1; i <= 12; i++) {
				repBean.setHdg4(repBean.getHdg4() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (j = Hdg6Ctr + 1; j <= 12; j++) {
				repBean.setHdg7(repBean.getHdg7() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			Statement st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("Employee Recordset is Empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			// pBranch = "";
			emp.beforeFirst();
			while (emp.next()) {
				if (!DtrFind) {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY  C.TRNCD ";

				} else {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'";
					dtrsql = dtrsql
							+ " UNION SELECT * FROM PAYTRAN Y ,CDMAST C WHERE ( Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD ";
				}

				Str1 = "";
				Str2 = "";
				Str3 = "";
				Str4 = "";
				Arr1 = "";
				Arr2 = "";
				nm = "";
				aCtr = 0;
				Str2Ctr = 0;
				Str1Ctr = 0;
				Arr1Ctr = 0;
				Arr2Ctr = 0;
				lCtr = 0;
				LOPDays = 0;

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD  ";

					DTR = st.executeQuery(dtrsql);
					if (!DTR.next()) {
						// System.out.println("Transaction not found for this Employee "+emp.getInt("EMPNO"));
						// System.out.println("Branch name is thissss"+emp.getString("BRANCH"));
					}

				}

				// System.out.println(dtrsql);

				// ReportDAO.println(String.valueOf((char)15), 0, 0, false,
				// "",repBean);
				if (DTR.next()) {

					ctr = ctr + 1;

					DTR.beforeFirst();

					while (DTR.next()) {

						// System.out.println("pbranch "+pBranch+" database emp branch "+emp.getString("PRJ_SRNO"));

						if (!pBranch
								.equalsIgnoreCase(emp.getString("PRJ_SRNO"))) {
							repBean.setBrnNo(emp.getInt("PRJ_SRNO"));

							// if(!repBean.isPayrep())
							{
								Connection conn = ConnectionManager
										.getConnectionTech();
								Statement stmt = conn.createStatement();

								// Branch_footer function

								String prjquery = "select Site_Name from Project_Sites where SITE_ID = '"
										+ emp.getString("PRJ_SRNO") + "'";
								ResultSet prj = stmt.executeQuery(prjquery);
								if (prj.next()) {
									prj_name = prj.getString("Site_Name");
									// prj_code = prj.getString("Project_Code");
								}
								prj.close();
								stmt.close();
								conn.close();

								if (page == 0) {
									ReportDAO.println(
											String.valueOf((char) 15), 0, 0,
											false, "", repBean);

									ReportDAO.println(
											prop.getProperty("companyName"),
											105, 2, false, "", repBean);
									ReportDAO.println(SLINE, 10, 1, false,
											"BANK", repBean);
								}

								else {

									ReportDAO.println(SLINE, 10, 1, false, "",
											repBean);

									// String ToPrintOriginalbasic="";
									String ToPrintEmpTotalIncome = "";

									String TotalDeduction = "";
									String TotalDeduction1 = "";

									// String ToPrintOriginalbasic ="";
									// ToPrintOriginalbasic =
									// ToPrintOriginalbasic +
									// FixStr(trans(totalBasic, "999,99,999.99",
									// "", false, false), 14, 3) + "|";

									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empTotalBasic,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empHra,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMed,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEdu,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empOcash,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empConve,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMininsurance,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empCol,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEarning1,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empearning2,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									// ToPrintEmpTotalIncome
									// =ToPrintEmpTotalIncome +
									// FixStr(trans(empAREAALL, "999,99,999.99",
									// "", false, false), 14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empGROSS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPT,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empMLWFDED,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOther,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empArrPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empESIC,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empmobile,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empAdv,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOTHERLOAN,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empTDS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empRF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empNET,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empADVANCEINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empBANKINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empOTHERINST,
									// "999,99,999.99", "", false, false), 14,
									// 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empSTAMP, "999,99,999.99",
									// "", false, false), 14, 3) + "|";
									// TotalDeduction1 =TotalDeduction1 +
									// FixStr(trans(empLICINST, "999,99,999.99",
									// "", false, false), 14, 3) + "|";

									String TotalIncome = "Total:-|"
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|"
											+ ToPrintEmpTotalIncome;
									// String TotalIncome1= "       |" +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) +
									// FixStr(transString("", "99,99,999.99",
									// "", false, false), 14, 3) + "|" ;

									String Deduction = "       |"
											+ FixStr(
													trans(totalBasic,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction;
									String Deduction1 = FixStr(
											String.valueOf(count - 1), 7, 1)
											+ "|"
											+ FixStr(
													trans(totalGross,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalDed,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalNet,
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction1;

									ReportDAO.println(TotalIncome, 10, 1,
											false, "BANK", repBean);

									// ReportDAO.println(TotalIncome1, 10, 1,
									// false, "BANK",repBean);
									PrintBlankLine(repBean);
									ReportDAO.println(Deduction, 10, 1, false,
											"BANK", repBean);
									ReportDAO.println(Deduction1, 10, 1, false,
											"BANK", repBean);

									count = 1;
									// income set to zero
									totalGross = 0;
									totalDed = 0;
									totalNet = 0;
									totalBasic = 0;
									printBasic = 0;
									printNet = 0;
									printGross = 0;
									printTotDed = 0;

									originalbasic = 0;
									empTotalBasic = 0;
									empCurrentDa = 0;
									empVda = 0;
									empHra = 0;
									empSpecial = 0;
									empEdu = 0;
									empMed = 0;
									empArrears = 0;
									empCLSG = 0;
									empAREABDV = 0;
									empAREAALL = 0;
									empGROSS = 0;

									empOcash = 0;
									empConve = 0;
									empMininsurance = 0;
									empCol = 0;
									empearning2 = 0;
									empEarning1 = 0;

									// deduction set to zero
									empPF = 0;
									empPT = 0;
									empGRPINSU = 0;
									empOTHERLOAN = 0;
									empSOCDED = 0;
									empUNIONSUB = 0;
									empLWPAamount = 0;
									empMLWFDED = 0;
									empTDS = 0;
									empHSGLOANINST = 0;
									empVEHLOANINST = 0;
									empFESTLOANINST = 0;
									empADVANCEINST = 0;
									empBANKINST = 0;
									empOTHERINST = 0;
									empSTAMP = 0;
									empLICINST = 0;

									empmobile = 0;
									empArrPF = 0;
									empESIC = 0;
									empAdv = 0;

									empOther = 0;
									empTDS = 0;
									empRF = 0;
									empNET = 0;

									// ReportDAO.println(String.valueOf((char)15),
									// 0, 0, false, "BANK",repBean);

									ReportDAO.println(SLINE, 10, 1, true, "",
											repBean);
									ReportDAO.println("", 10, 5, false, "",
											repBean);

								}

								ReportDAO.println("BRANCH NAME :- " + prj_name
										+ "", 17, 1, false, "BANK", repBean);
								ReportDAO.println(SLINE, 10, 1, false, "BANK",
										repBean);
							}
							repBean.setNoEmp(0);
							ctr = 1;

							// ReportDAO.println(String.valueOf((char)15), 0, 0,
							// false, "BANK",repBean);
							// ReportDAO.println("", 0, 1, false,
							// "BANK",repBean);

							// ReportDAO.println(SLINE, 0, 1, false,
							// "BANK",repBean);
							// ReportDAO.println("Branch Name :- add branch name here",
							// 10, 2, false, "BANK",repBean);
							// ReportDAO.println(SLINE, 0, 1, false,
							// "BANK",repBean);

							repBean.setPayrep(false);
							repBean.setBar1(Barr1);
							repBean.setBar2(Barr2);

							if (Barr1 && Barr2) {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										repBean.getHdg3(), repBean.getHdg4(),
										repBean.getHdg5(), repBean.getHdg6(),
										repBean.getHdg7(), repBean);

							} else {
								if (Barr1) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(),
											repBean.getHdg3(),
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								} else if (Barr2) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(),
											repBean.getHdg6(),
											repBean.getHdg7(), repBean);
								} else {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								}
							}
							// pBranch = emp.getString("PRJ_SRNO");
							// page++;
						} else {
							// ReportDAO.println(String.valueOf((char)15), 0, 0,
							// true, "BANK",repBean);
							// ReportDAO.println("", 0, 1, true,
							// "BANK",repBean);
						}

						pBranch = emp.getString("PRJ_SRNO");
						page++;

						if (compareDate(outputFormat.format(inputFormat
								.parse(DTR.getString("TRNDT"))), lBomDt)
								&& compareDate(lEomDt,
										outputFormat.format(inputFormat
												.parse(DTR.getString("TRNDT"))))) // Changed
						{
							if (DTR.getInt("TRNCD") <= 200) {

								repBean.setPInc(
										repBean.getPInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotINC(
										repBean.getPRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else if (DTR.getInt("TRNCD") >= 201
									&& DTR.getInt("TRNCD") <= 293) {
								repBean.setPDed(
										repBean.getPDed(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotDED(
										repBean.getPRepTotDED(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							}
							if (DTR.getInt("TRNCD") == 101) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(1)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 1);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(1)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										1);
							}
							if (DTR.getInt("TRNCD") == 999) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(2)
										+ (DTR.getString("NET_AMT") == null ? 0
												: DTR.getInt("NET_AMT")), 2);
								repBean.setPTotBNGD(repBean.getPTotBNGD(3)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 3);
								repBean.setPTotBNGD(repBean.getPTotBNGD(4)
										+ (DTR.getString("CAL_AMT") == null ? 0
												: DTR.getInt("CAL_AMT")), 4);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(2)
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT")),
										2);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(3)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										3);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(4)
												+ (DTR.getString("CAL_AMT") == null ? 0
														: DTR.getInt("CAL_AMT")),
										4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");

							}
						} else {
							if (DTR.getInt("TRNCD") <= 200) {
								aCtr = aCtr + 1;
								if (aCtr <= 12) {
									if (repBean.getIcode(aCtr) != DTR
											.getInt("TRNCD")) {
										while (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											if (aCtr <= 12) {
												Str1 = Str1
														+ ReportDAO.addSpaces(
																"", 14) + "|";
											} else {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
											}
											aCtr = aCtr + 1;
											if (aCtr > 24) {
												break;
											}
										}
										if (aCtr > 12) {
											Str2 = Str2
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Str2Ctr = Str2Ctr + 1;
										}
									}
									if (aCtr <= 12) {
										// for printing the income
										if (DTR.getInt("TRNCD") == 101) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empTotalBasic = empTotalBasic
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 102) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCurrentDa = empCurrentDa
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 138) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empVda = empVda
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 103) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empHra = empHra
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 129) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empSpecial = empSpecial
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 105) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEdu = empEdu
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 104) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMed = empMed
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 107) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empOcash = empOcash
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 108) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empConve = empConve
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 126) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMininsurance = empMininsurance
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 128) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCol = empCol
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 130) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEarning1 = empEarning1
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 131) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empearning2 = empearning2
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 142) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empArrears = empArrears
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 139) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCLSG = empCLSG
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 141) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREAALL = empAREAALL
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 199) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empGROSS = empGROSS
													+ DTR.getInt("NET_AMT");
										}

										Str1 = Str1
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";

										if ((DTR.getString("ARR_AMT") == null ? 0
												: DTR.getInt("ARR_AMT")) != 0) {
											Arr1 = Arr1
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Arr1Ctr = Arr1Ctr + 1;
										}
									}
								} else {
									if (aCtr < 24) {
										// System.out.println("Trncd is "+DTR.getInt("TRNCD"));
										if (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getIcode(aCtr) != DTR
													.getInt("TRNCD")) {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
												aCtr = aCtr + 1;
												if (aCtr > 24)// Added by nakul
																// patil for
																// arrayindexofboundsexception
												{
													break;
												}
											}
										}
									}
									Str2 = Str2
											+ FixStr(
													trans((DTR
															.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT")),
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									Str2Ctr = Str2Ctr + 1;

								}
								repBean.setInc(
										repBean.getInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setRepTotINC(
										repBean.getRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else {
								if (DTR.getInt("TRNCD") >= 201
										&& DTR.getInt("TRNCD") <= 293) {

									if (DTR.getInt("TRNCD") == 201) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPF = empPF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 202) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPT = empPT + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 212) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOther = empOther
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 226) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOTHERLOAN = empOTHERLOAN
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 217) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empArrPF = empArrPF
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 221) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empESIC = empESIC
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 223) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empmobile = empmobile
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 211) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empMLWFDED = empMLWFDED
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 228) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empTDS = empTDS + DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 225) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empAdv = empAdv + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 229) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empRF = empRF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 230) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empNET = empNET + DTR.getInt("NET_AMT");
									}

									lCtr = lCtr + 1;
									if (lCtr <= 12) {
										if (repBean.getEcode(lCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												if (lCtr <= 12) {
													Str3 = Str3
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
												} else {
													Str4 = Str4
															+ FixStr(
																	trans((DTR
																			.getString("NET_AMT") == null ? 0
																			: DTR.getInt("NET_AMT")),
																			"999,99,999.99",
																			"",
																			false,
																			false),
																	14, 3)
															+ "|";
													Str4Ctr = Str4Ctr + 1;

												}
												lCtr = lCtr + 1;
												if (lCtr > 24) {
													break;
												}

											}
											if (lCtr > 12) {
												Str4 = Str4
														+ FixStr(
																trans((DTR
																		.getString("NET_AMT") == null ? 0
																		: DTR.getInt("NET_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Str4Ctr = Str4Ctr + 1;
											}

										}
										if (lCtr <= 12) {
											Str3 = Str3
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";

											if ((DTR.getString("ARR_AMT") == null ? 0
													: DTR.getInt("ARR_AMT")) != 0) {
												Arr2 = Arr2
														+ FixStr(
																trans((DTR
																		.getString("ARR_AMT") == null ? 0
																		: DTR.getInt("ARR_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Arr2Ctr = Arr2Ctr + 1;
											}
										}
									} else {
										if (lCtr < 24) {
											if (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												while (repBean.getEcode(lCtr) != DTR
														.getInt("TRNCD")) {
													Str4 = Str4
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
													lCtr = lCtr + 1;
													if (lCtr > 24) {
														break;
													}
												}
											}
										}
										Str4 = Str4
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";
										Str4Ctr = Str4Ctr + 1;

									}
									repBean.setDed(
											repBean.getDed(DTR.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
									repBean.setRepTotDED(
											repBean.getRepTotDED(DTR
													.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
								}
							}

							if (DTR.getInt("TRNCD") == 101) {
								printBasic = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								repBean.setTotBngd(repBean.getTotBngd(1)
										+ printBasic, 1);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(1)
										+ printBasic, 1);

								originalbasic = originalbasic
										+ DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");

							}
							if (DTR.getInt("TRNCD") == 999) {
								printNet = DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								printGross = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								printTotDed = DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
								repBean.setTotBngd(repBean.getTotBngd(2)
										+ printNet, 2);
								repBean.setTotBngd(repBean.getTotBngd(3)
										+ printGross, 3);
								repBean.setTotBngd(repBean.getTotBngd(4)
										+ printTotDed, 4);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(2)
										+ printNet, 2);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(3)
										+ printGross, 3);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(4)
										+ printTotDed, 4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");

								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
							}
							if (DTR.getInt("TRNCD") == 301) {
								LOPDays = DTR.getInt("INP_AMT");
							}
						}
					}
					for (i = Arr1Ctr + 1; i <= 12; i++) {
						Arr1 = Arr1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Arr2Ctr + 1; i <= 12; i++) {
						Arr2 = Arr2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = aCtr + 1; i <= 12; i++) {
						Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = lCtr + 1; j <= 12; j++) {
						Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Str2Ctr + 1; i <= 12; i++) {
						Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = Str4Ctr + 1; j <= 12; j++) {
						Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
					}

					nm = ltrim(FixStr(" " + emp.getString("LNAME").trim()
							+ "  " + emp.getString("FNAME").trim() + "  "
							+ emp.getString("MNAME").trim() + " | " + Days, 42,
							1));
					Str1 = FixStr(String.valueOf(emp.getInt("EMPCODE")), 7, 1)
							.substring(0, 7) + "|" + nm + "|" + Str1;
					Str2 = "|"
							+ FixStr(String.valueOf(emp.getString("ACNO")), 16,
									1)
							+ FixStr(
									String.valueOf(lkp.getLKP_Desc("DESIG",
											emp.getInt("DESIG"))), 26, 1) + "|"
							+ Str2;
					Str3 = FixStr(String.valueOf(count++), 7, 1)
							+ "|"
							+ FixStr(
									trans(printBasic, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(trans(LOPDays, "999", "", false, false),
									14, 3) + ReportDAO.addSpaces("", 14) + "|"
							+ Str3;
					Str4 = "|"
							+ FixStr(
									trans(printGross, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printTotDed, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printNet, "99,99,999.99", "", false,
											false), 14, 3) + "|" + Str4;

					countTotal++;

					totalGross = totalGross + gross;
					totalDed = totalDed + ded;
					totalNet = totalNet + net;
					totalBasic = totalBasic + originalbasic;

					/*
					 * if(printNet < 0) { System.out.println(
					 * "THIS EMPLOYEE SALARY GOES -VE PLEASE CHECK IT AND PROCESS PAYCAL AGAIN"
					 * ); return; }
					 */
					Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr1;
					Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr2;
					ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

					ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
					if (Barr1) {
						ReportDAO.println(Arr1, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str2, 17, 1, false, "BANK", repBean);
					ReportDAO.println(Str3, 10, 1, false, "BANK", repBean);
					if (Barr2) {
						ReportDAO.println(Arr2, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str4, 17, 1, false, "BANK", repBean);
					// PrintBlankLine(repBean);

				}

				repBean.setNoEmp(repBean.getNoEmp() + 1);
				// repBean.setNoEmp(countTotal - 1);
				repBean.setBNoEmp(repBean.getBNoEmp() + 1);

			}

			// only for the last branch
			if (!repBean.isPayrep()) {
				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

				String ToPrintEmpTotalIncome = "";

				String TotalDeduction = "";
				String TotalDeduction1 = "";

				// String ToPrintOriginalbasic ="";
				// ToPrintOriginalbasic = ToPrintOriginalbasic +
				// FixStr(trans(totalBasic, "999,99,999.99", "", false, false),
				// 14, 3) + "|";

				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empTotalBasic, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empHra, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMed, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEdu, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empOcash, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empConve, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMininsurance, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empCol, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEarning1, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empearning2, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				// ToPrintEmpTotalIncome =ToPrintEmpTotalIncome +
				// FixStr(trans(empAREAALL, "999,99,999.99", "", false, false),
				// 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empGROSS, "999,99,999.99", "", false,
										false), 14, 3) + "|";

				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPT, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empMLWFDED, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOther, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empArrPF, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empESIC, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empmobile, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empAdv, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOTHERLOAN, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empTDS, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empRF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empNET, "999,99,999.99", "", false, false),
								14, 3) + "|";

				// TotalDeduction1 =TotalDeduction1 +
				// FixStr(trans(empADVANCEINST, "999,99,999.99", "", false,
				// false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empBANKINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empOTHERINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empSTAMP,
				// "999,99,999.99", "", false, false), 14, 3) + "|";
				// TotalDeduction1 =TotalDeduction1 + FixStr(trans(empLICINST,
				// "999,99,999.99", "", false, false), 14, 3) + "|";

				String TotalIncome = "Total:-|"
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|"
						+ ToPrintEmpTotalIncome;
				// String TotalIncome1= "       |" + FixStr(transString("",
				// "99,99,999.99", "", false, false), 14, 3) +
				// FixStr(transString("", "99,99,999.99", "", false, false), 14,
				// 3) + FixStr(transString("", "99,99,999.99", "", false,
				// false), 14, 3) + "|" ;

				String Deduction = "       |"
						+ FixStr(
								trans(totalBasic, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction;
				String Deduction1 = FixStr(String.valueOf(count - 1), 7, 1)
						+ "|"
						+ FixStr(
								trans(totalGross, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalDed, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalNet, "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction1;

				ReportDAO.println(TotalIncome, 10, 1, false, "BANK", repBean);

				// ReportDAO.println(TotalIncome1, 10, 1, false,
				// "BANK",repBean);
				PrintBlankLine(repBean);
				ReportDAO.println(Deduction, 10, 1, false, "BANK", repBean);
				ReportDAO.println(Deduction1, 10, 1, false, "BANK", repBean);

				// BrachFooter remaining
				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);
			}

			// repBean.setNoEmp(repBean.getBNoEmp());
			repBean.setNoEmp(countTotal - 1);
			for (i = 100; i <= 200; i++) {
				repBean.setBRepTotINC(repBean.getRepTotINC(i), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setBRepTotDED(repBean.getRepTotDED(i), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setBRepTotBNGD(repBean.getRepTotBNGD(i), i);
			}
			// FOR BRANCH TOTAL FOOTER

			ReportDAO.println(SLINE, 10, 7, true, "", repBean);

			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);
			// System.out.println("total   : "+countTotal);
			PrintFootLines(repBean.getObjPRepTotINC(),
					repBean.getObjPRepTotDED(), repBean.getObjPRepTotBNGD(),
					"       " + "|"
							+ " Grand Total ALL BRANCHES Previous Month :"
							+ "|", repBean);

			for (i = 100; i <= 200; i++) {
				repBean.setRepTotINC(
						Math.abs(repBean.getRepTotINC(i)
								- repBean.getPRepTotINC(i)), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setRepTotDED(
						Math.abs(repBean.getRepTotDED(i)
								- repBean.getPRepTotDED(i)), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setRepTotBNGD(
						Math.abs(repBean.getRepTotBNGD(i)
								- repBean.getPRepTotBNGD(i)), i);
			}
			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"       " + "|"
							+ " Variance In SAL. OF ALL BRANCHES     :-> "
							+ "|", repBean);
			// PrintFootLines RepTotINC, RepTotDED, RepTotBNGD, "       " & "|"
			// & " Variance In Sal. Of ALL BRANCHES      :-> " & "|"
			ReportDAO.println(SLINE, 10, 4, false, "BANK", repBean);
			// ReportDAO.println("Passed For Payment", 206, 2, false,
			// "BANK",repBean);
			// ReportDAO.println("The Nasik Merchant's Co-Op. Bank Ltd. , Nashik",
			// 193, 2, false, "BANK",repBean);

			// ReportDAO.println(String.valueOf((char)15), 10, 4, false,
			// "BANK",repBean); //***********Remain CHr()

			/*
			 * ReportDAO.println("C.E.O. / GENERAL MANAGER / MANAGER", 200, 2,
			 * false, "BANK",repBean); ReportDAO.println(
			 * "Note: Net Salary will be credited to Dhan Br. SB A/C on "
			 * +ReportDAO.EOM(PAYREGDT)+" ", 17, 2, false, "BANK",repBean);
			 * ReportDAO
			 * .println("Please Check PL/HO voucher entries in ABBPTR batch ",
			 * 17, 2, false, "BANK",repBean);
			 */

			// Print #fp Chr(12)
			// Print #fp Chr(18)
			repBean.setLnCount(0);
			repBean.setBrnNo(999);
			repBean.setPageNo(1);
			ReportDAO.println(String.valueOf((char) 15), 10, 4, false, "",
					repBean); // ***********Remain CHr()
			temp = PAYREGDT.substring(3);
			repBean.setHdg1("Summary Of Salary Sheet For The Month Of :- "
					+ temp);
			ReportDAO.println("", 10, 1, false, "", repBean);
			repBean.setPayrep(false);
			if (Barr1 && Barr2) {
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(),
						repBean.getHdg4(), repBean.getHdg5(),
						repBean.getHdg6(), repBean.getHdg7(), repBean);
			} else {
				if (Barr1) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), repBean.getHdg3(),
							repBean.getHdg4(), repBean.getHdg5(), "",
							repBean.getHdg7(), repBean);
				} else if (Barr2) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), repBean.getHdg6(),
							repBean.getHdg7(), repBean);
				} else {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), "", repBean.getHdg7(), repBean);
				}
			}

			for (int Kk = 1; Kk <= repBean.getbCode(); Kk++) {
				PaySummary(Kk, repBean);
			}
			ReportDAO.println(SLINE, 10, 1, false, "", repBean);
			PrintFootLines(repBean.getObjBRepTotINC(),
					repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);

			ReportDAO.println(SLINE, 10, 1, false, "", repBean);

			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	}
	
	
	/*******************************************Prasad Start***********************************************************************************/
	
	public static void payregWithBranchTotalPF(String PAYREGDT, String Desgn,
			String filepath) {
		System.out.println("frfrre.rerlvrellrerl.vrl.cvl.rl.vcl.r ");

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		RepoartBean repBean = new RepoartBean();
		ResultSet CDM = null;
		ResultSet DTR = null;
		ResultSet emp = null;
		ResultSet arrrec = null;

		float Days = Calculate.getDays(PAYREGDT);
		LookupHandler lkp = new LookupHandler();

		FileWriter Fp;
		int aCtr = 0;
		int lCtr = 0;
		int ctr = 0;
		int printBasic = 0;
		int printNet = 0;
		int printGross = 0;
		int printTotDed = 0;
		int LOPDays = 0;
		String BomDt = "";
		String EomDt = "";
		boolean DtrFind = false;
		String lBomDt = "";
		String lEomDt = "";
		int i = 0;
		int j = 0;
		String dtrsql = "";
		String CdmSql = "";
		String EmpSql = "";
		String[] pdet = new String[7];
		String Str1 = "";
		String Str2 = "";
		String Str3 = "";
		String Str4 = "";
		int Str2Ctr = 0;
		int Str4Ctr = 0;
		int Str1Ctr = 0;
		int Arr1Ctr = 0;
		int Arr2Ctr = 0;
		int count = 1;
		int countTotal = 1;
		String sLOPDTr = "";
		ResultSet LOPDTr = null;
		ReportDAO.inithead(repBean);
		// Initvar *****already variable are initialised not need of initvar
		ReportDAO.make_prn_file(filepath, repBean);

		Connection Cn = null;
		ReportDAO.OpenCon("", "", "", repBean);
		Cn = repBean.getCn();
		int Hdg6Ctr = 0;
		int Hdg4Ctr = 0;
		int HdgArr1 = 0;
		int HdgArr2 = 0;
		boolean Barr1 = false;
		boolean Barr2 = false;
		boolean fnd = false;
		String Arr1 = "";
		String Arr2 = "";
		String nm = "";
		String pBranch = "";
		String SLINE = "";
		String prj_name = "";
		int page = 0;

		// total as per branch incomes ,deduction

		int totalGross = 0;
		int totalDed = 0;
		int totalNet = 0;
		int totalBasic = 0;
		int gross = 0;
		int ded = 0;
		int net = 0;
		int originalbasic = 0;

		// total as per branch incomes related
		int empTotalBasic = 0;
		int empCurrentDa = 0;
		int empVda = 0;
		int empHra = 0;
		int empOcash = 0;
		int empConve = 0;
		int empMininsurance = 0;
		int empCol = 0;
		int empSpecial = 0;
		int empEdu = 0;
		int empMed = 0;
		int empArrears = 0;
		int empCLSG = 0;
		int empAREABDV = 0;
		int empEarning1 = 0;
		int empearning2 = 0;
		int empAREAALL = 0;
		int empGROSS = 0;

		// total as per branch deduction related

		int empPF = 0;
		int empPT = 0;

		int empmobile = 0;
		int empArrPF = 0;
		int empESIC = 0;
		int empAdv = 0;

		int empOther = 0;
		int empTDS = 0;
		int empRF = 0;
		int empNET = 0;

		int empGRPINSU = 0;
		int empOTHERLOAN = 0;
		int empSOCDED = 0;
		int empUNIONSUB = 0;
		int empLWPAamount = 0;
		int empMLWFDED = 0;

		int empHSGLOANINST = 0;
		int empVEHLOANINST = 0;
		int empFESTLOANINST = 0;
		int empADVANCEINST = 0;
		int empBANKINST = 0;
		int empOTHERINST = 0;
		int empSTAMP = 0;
		int empLICINST = 0;

		repBean.setbCode(0);
		SimpleDateFormat outputFormat = new SimpleDateFormat("dd-MMM-yyyy");
		SimpleDateFormat inputFormat = new SimpleDateFormat("yyyy-MM-dd"); // Added
																			// by
																			// nakul
																			// for
																			// campareDate
																			// fun()

		for (i = 1; i <= 26; i++) {
			repBean.setIcode(0, i);
			repBean.setEcode(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 100; i <= 200; i++) {
				repBean.setbInc(0, j, i);
			}
		}
		for (i = 100; i <= 199; i++) {
			repBean.setInc(0, i);
		}
		for (i = 200; i <= 300; i++) {
			repBean.setDed(0, i);
		}
		for (j = 1; j <= 20; j++) {
			for (i = 200; i <= 300; i++) {
				repBean.setbDed(0, j, i);
			}
		}
		for (i = 1; i <= 4; i++) {
			repBean.setTotBngd(0, i);
			repBean.setRepTotBNGD(0, i);
		}
		for (i = 1; i <= 20; i++) {
			for (j = 1; j <= 4; j++) {
				repBean.setBtotBngd(0, i, j);
			}
		}

		repBean.setLnCount(0);
		repBean.setPayrep(true);
		repBean.setPageNo(1);
		repBean.setLineLen(231);
		repBean.setPageLen(65);
		repBean.setLineSpace(10);
		BomDt = ReportDAO.BOM(PAYREGDT);
		repBean.setFoot_Fl(true);

		EomDt = ReportDAO.EOM(PAYREGDT);
		lBomDt = ReportDAO.BOM(ReportDAO.DateAdd('m', -1, PAYREGDT));
		lEomDt = ReportDAO.EOM(lBomDt);
		ReportDAO.make_prn_file(filepath, repBean);
		String temp = PAYREGDT.substring(3);

		repBean.setHdg1("Salary Sheet For The Month Of :- " + temp);

		SLINE = stringOfSize(231, '-');
		String str2 = "";

		if (!Desgn.equalsIgnoreCase("0")) {
			Str2 = "AND T.DESIG = " + Desgn;
		}

		dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + BomDt
				+ "' AND '" + EomDt + "'";
		try {
			Statement st = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			} else {
				DtrFind = true;
				dtrsql = "SELECT * FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
				dtrsql = dtrsql
						+ "UNION SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt + "' AND '" + lEomDt + "'";
			}

			// -----CHanged By PHP Sir

			CdmSql = "SELECT * FROM CDMAST WHERE PSLIPYN = 'Y' AND TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT(TRNCD) FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
					+ BomDt + "' AND '" + EomDt + "') ORDER BY   TRNCD ";
			EmpSql = "SELECT EMP.*, T.ACNO, T.PRJ_SRNO, T.DESIG FROM EMPMAST EMP, EMPTRAN T WHERE T.EMPNO = EMP.EMPNO AND T.SRNO = (SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = EMP.EMPNO AND E2.EFFDATE <= '"
					+ (ReportDAO.EOM(PAYREGDT))
					+ "') AND   "
					+ " (( EMP.STATUS='A' AND	EMP.DOJ <= '"
					+ ReportDAO.EOM(PAYREGDT)
					+ "') or "
					+ " (EMP.STATUS ='N' And EMP.DOL>='"
					+ ReportDAO.BOM(PAYREGDT)
					+ "')) "
					+ Str2
					+ " "
					+ " ORDER BY T.PRJ_SRNO, EMP.EMPNO , EMP.EMPCODE";

			System.out.println(EmpSql);

			DTR = st.executeQuery(dtrsql);
			if (!DTR.next()) {
				dtrsql = "SELECT * FROM PAYTRAN WHERE TRNDT BETWEEN '" + lBomDt
						+ "' AND '" + EomDt + "'";

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					System.out.println("Transactions not found");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}

			}
			Barr1 = false;
			Barr2 = false;
			DTR.beforeFirst();
			while (DTR.next()) {
				if (DTR.getInt("TRNCD") <= 200) {
					if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
							.getInt("ARR_AMT")) != 0) {
						Barr1 = true;
					}

				} else {
					if (DTR.getInt("TRNCD") >= 201
							&& DTR.getInt("TRNCD") <= 293) {
						if ((DTR.getString("ARR_AMT") == null ? 0 : DTR
								.getInt("ARR_AMT")) != 0) {
							Barr2 = true;
						}

					}
				}
			}
			// System.out.println("code selection 111---"+CdmSql);
			CDM = st.executeQuery(CdmSql);
			if (!CDM.next()) {
				CdmSql = "SELECT * FROM CDMAST WHERE TRNCD <= 293 AND TRNCD IN (SELECT TRNCD FROM CDMAST INTERSECT SELECT DISTINCT (TRNCD) FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ lBomDt
						+ "' AND '"
						+ EomDt
						+ "')  and PSLIPYN='Y'  ORDER BY   TRNCD";
				CDM = st.executeQuery(CdmSql);
				if (!CDM.next()) {
					System.out.println("No any Code to print");
					Fp = repBean.getFp();
					Fp.close();
					return;
				}
			}
			CDM.beforeFirst();
			repBean.setHdg2("EmpCode| Employee Name      |P-Day | Allowances:->|");
			repBean.setHdg3("       |                                Arrears:->|");
			repBean.setHdg4("       | SB.A/c No.         |Desg.                |");
			repBean.setHdg5("Sr.No. | Original Basic     LOP Days Deductions:->|");
			repBean.setHdg6("       |                                Arrears:->|");
			repBean.setHdg7("       | Gross Pay.     Total Ded.   Net Pay      |");

			while (CDM.next()) {
				if (CDM.getInt("TRNCD") <= 200) {
					aCtr = aCtr + 1;
					if (aCtr <= 12) {
						repBean.setHdg2(repBean.getHdg2()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
					} else {
						repBean.setHdg4(repBean.getHdg4()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setIcode(CDM.getInt("TRNCD"), aCtr);
						Hdg4Ctr = Hdg4Ctr + 1;
					}
				} else {
					lCtr = lCtr + 1;
					if (lCtr <= 12) {
						repBean.setHdg5(repBean.getHdg5()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
					} else {
						repBean.setHdg7(repBean.getHdg7()
								+ FixStr(CDM.getString("SDESC"), 14, 2) + "|");
						repBean.setEcode(CDM.getInt("TRNCD"), lCtr);
						Hdg6Ctr = Hdg6Ctr + 1;
					}
				}
			}

			for (i = 1; i <= 12; i++) {
				repBean.setHdg3(repBean.getHdg3() + ReportDAO.addSpaces("", 14)
						+ "|");
				repBean.setHdg6(repBean.getHdg6() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (i = Hdg4Ctr + 1; i <= 12; i++) {
				repBean.setHdg4(repBean.getHdg4() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			for (j = Hdg6Ctr + 1; j <= 12; j++) {
				repBean.setHdg7(repBean.getHdg7() + ReportDAO.addSpaces("", 14)
						+ "|");
			}
			Statement st1 = Cn.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			emp = st1.executeQuery(EmpSql);

			if (!emp.next()) {
				System.out.println("Employee Recordset is Empty");
				Fp = repBean.getFp();
				Fp.close();
				return;
			}
			// pBranch = "";
			emp.beforeFirst();
			while (emp.next()) {
				if (!DtrFind) {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y' ORDER BY  C.TRNCD ";

				} else {
					dtrsql = "SELECT * FROM PAYTRAN_STAGE Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'";
					dtrsql = dtrsql
							+ " UNION SELECT * FROM PAYTRAN Y ,CDMAST C WHERE ( Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD ";
				}

				Str1 = "";
				Str2 = "";
				Str3 = "";
				Str4 = "";
				Arr1 = "";
				Arr2 = "";
				nm = "";
				aCtr = 0;
				Str2Ctr = 0;
				Str1Ctr = 0;
				Arr1Ctr = 0;
				Arr2Ctr = 0;
				lCtr = 0;
				LOPDays = 0;

				DTR = st.executeQuery(dtrsql);
				if (!DTR.next()) {
					dtrsql = "SELECT * FROM PAYTRAN Y,CDMAST C WHERE (Y.TRNCD = 999 OR Y.TRNCD = 301 OR Y.TRNCD <= 293 ) AND Y.EMPNO = '"
							+ emp.getInt("EMPNO")
							+ "' AND Y.TRNDT BETWEEN '"
							+ lBomDt
							+ "' AND '"
							+ EomDt
							+ "' AND C.TRNCD = Y.TRNCD AND C.PSLIPYN = 'Y'  ORDER BY  C.TRNCD  ";

					DTR = st.executeQuery(dtrsql);
					if (!DTR.next()) {
						// System.out.println("Transaction not found for this Employee "+emp.getInt("EMPNO"));
						// System.out.println("Branch name is thissss"+emp.getString("BRANCH"));
					}

				}

				// System.out.println(dtrsql);

				// ReportDAO.println(String.valueOf((char)15), 0, 0, false,
				// "",repBean);
				if (DTR.next()) {

					ctr = ctr + 1;

					DTR.beforeFirst();

					while (DTR.next()) {

						// System.out.println("pbranch "+pBranch+" database emp branch "+emp.getString("PRJ_SRNO"));

						if (!pBranch
								.equalsIgnoreCase(emp.getString("PRJ_SRNO"))) {
							repBean.setBrnNo(emp.getInt("PRJ_SRNO"));

							// if(!repBean.isPayrep())
							{
								Connection conn = ConnectionManager
										.getConnectionTech();
								Statement stmt = conn.createStatement();

								// Branch_footer function

								String prjquery = "select Site_Name from Project_Sites where SITE_ID = '"
										+ emp.getString("PRJ_SRNO") + "'";
								ResultSet prj = stmt.executeQuery(prjquery);
								if (prj.next()) {
									prj_name = prj.getString("Site_Name");
									// prj_code = prj.getString("Project_Code");
								}
								prj.close();
								stmt.close();
								conn.close();

								if (page == 0) {
									ReportDAO.println(
											String.valueOf((char) 15), 0, 0,
											false, "", repBean);

									ReportDAO.println(
											prop.getProperty("companyName"),
											105, 2, false, "", repBean);
									ReportDAO.println(SLINE, 10, 1, false,
											"BANK", repBean);
								}

								else {

									ReportDAO.println(SLINE, 10, 1, false, "",
											repBean);

									// String ToPrintOriginalbasic="";
									String ToPrintEmpTotalIncome = "";

									String TotalDeduction = "";
									String TotalDeduction1 = "";

									// String ToPrintOriginalbasic ="";
									// ToPrintOriginalbasic =
									// ToPrintOriginalbasic +
									// FixStr(trans(totalBasic, "999,99,999.99",
									// "", false, false), 14, 3) + "|";

									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empTotalBasic,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empHra,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMed,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEdu,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empOcash,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empConve,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empMininsurance,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empCol,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empEarning1,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empearning2,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									// ToPrintEmpTotalIncome
									// =ToPrintEmpTotalIncome +
									// FixStr(trans(empAREAALL, "999,99,999.99",
									// "", false, false), 14, 3) + "|";
									ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
											+ FixStr(
													trans(empGROSS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empPT,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empMLWFDED,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOther,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empArrPF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empESIC,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empmobile,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empAdv,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empOTHERLOAN,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empTDS,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empRF,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									TotalDeduction = TotalDeduction
											+ FixStr(
													trans(empNET,
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";

								
									String TotalIncome = "Total:-|"
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|"
											+ ToPrintEmpTotalIncome;
									
									String Deduction = "       |"
											+ FixStr(
													trans(totalBasic,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													transString("",
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction;
									String Deduction1 = FixStr(
											String.valueOf(count - 1), 7, 1)
											+ "|"
											+ FixStr(
													trans(totalGross,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalDed,
															"99,99,999.99", "",
															false, false), 14,
													3)
											+ FixStr(
													trans(totalNet,
															"99,99,999.99", "",
															false, false), 14,
													3) + "|" + TotalDeduction1;

									ReportDAO.println(TotalIncome, 10, 1,
											false, "BANK", repBean);

									// ReportDAO.println(TotalIncome1, 10, 1,
									// false, "BANK",repBean);
									PrintBlankLine(repBean);
									ReportDAO.println(Deduction, 10, 1, false,
											"BANK", repBean);
									ReportDAO.println(Deduction1, 10, 1, false,
											"BANK", repBean);

									count = 1;
									// income set to zero
									totalGross = 0;
									totalDed = 0;
									totalNet = 0;
									totalBasic = 0;
									printBasic = 0;
									printNet = 0;
									printGross = 0;
									printTotDed = 0;

									originalbasic = 0;
									empTotalBasic = 0;
									empCurrentDa = 0;
									empVda = 0;
									empHra = 0;
									empSpecial = 0;
									empEdu = 0;
									empMed = 0;
									empArrears = 0;
									empCLSG = 0;
									empAREABDV = 0;
									empAREAALL = 0;
									empGROSS = 0;

									empOcash = 0;
									empConve = 0;
									empMininsurance = 0;
									empCol = 0;
									empearning2 = 0;
									empEarning1 = 0;

									// deduction set to zero
									empPF = 0;
									empPT = 0;
									empGRPINSU = 0;
									empOTHERLOAN = 0;
									empSOCDED = 0;
									empUNIONSUB = 0;
									empLWPAamount = 0;
									empMLWFDED = 0;
									empTDS = 0;
									empHSGLOANINST = 0;
									empVEHLOANINST = 0;
									empFESTLOANINST = 0;
									empADVANCEINST = 0;
									empBANKINST = 0;
									empOTHERINST = 0;
									empSTAMP = 0;
									empLICINST = 0;

									empmobile = 0;
									empArrPF = 0;
									empESIC = 0;
									empAdv = 0;

									empOther = 0;
									empTDS = 0;
									empRF = 0;
									empNET = 0;

									ReportDAO.println(SLINE, 10, 1, true, "",
											repBean);
									ReportDAO.println("", 10, 5, false, "",
											repBean);

								}

								ReportDAO.println("BRANCH NAME :- " + prj_name
										+ "", 17, 1, false, "BANK", repBean);
								ReportDAO.println(SLINE, 10, 1, false, "BANK",
										repBean);
							}
							repBean.setNoEmp(0);
							ctr = 1;

							repBean.setPayrep(false);
							repBean.setBar1(Barr1);
							repBean.setBar2(Barr2);

							if (Barr1 && Barr2) {
								ReportDAO.page_head(repBean.getBrnNo(),
										repBean.getHdg1(), repBean.getHdg2(),
										repBean.getHdg3(), repBean.getHdg4(),
										repBean.getHdg5(), repBean.getHdg6(),
										repBean.getHdg7(), repBean);

							} else {
								if (Barr1) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(),
											repBean.getHdg3(),
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								} else if (Barr2) {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(),
											repBean.getHdg6(),
											repBean.getHdg7(), repBean);
								} else {
									ReportDAO.page_head(repBean.getBrnNo(),
											repBean.getHdg1(),
											repBean.getHdg2(), "",
											repBean.getHdg4(),
											repBean.getHdg5(), "",
											repBean.getHdg7(), repBean);
								}
							}
						} else {
						}

						pBranch = emp.getString("PRJ_SRNO");
						page++;

						if (compareDate(outputFormat.format(inputFormat
								.parse(DTR.getString("TRNDT"))), lBomDt)
								&& compareDate(lEomDt,
										outputFormat.format(inputFormat
												.parse(DTR.getString("TRNDT"))))) // Changed
						{
							if (DTR.getInt("TRNCD") <= 200) {

								repBean.setPInc(
										repBean.getPInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotINC(
										repBean.getPRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else if (DTR.getInt("TRNCD") >= 201
									&& DTR.getInt("TRNCD") <= 293) {
								repBean.setPDed(
										repBean.getPDed(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setPRepTotDED(
										repBean.getPRepTotDED(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							}
							if (DTR.getInt("TRNCD") == 101) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(1)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 1);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(1)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										1);
							}
							if (DTR.getInt("TRNCD") == 999) {
								repBean.setPTotBNGD(repBean.getPTotBNGD(2)
										+ (DTR.getString("NET_AMT") == null ? 0
												: DTR.getInt("NET_AMT")), 2);
								repBean.setPTotBNGD(repBean.getPTotBNGD(3)
										+ (DTR.getString("INP_AMT") == null ? 0
												: DTR.getInt("INP_AMT")), 3);
								repBean.setPTotBNGD(repBean.getPTotBNGD(4)
										+ (DTR.getString("CAL_AMT") == null ? 0
												: DTR.getInt("CAL_AMT")), 4);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(2)
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT")),
										2);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(3)
												+ (DTR.getString("INP_AMT") == null ? 0
														: DTR.getInt("INP_AMT")),
										3);
								repBean.setPRepTotBNGD(
										repBean.getPRepTotBNGD(4)
												+ (DTR.getString("CAL_AMT") == null ? 0
														: DTR.getInt("CAL_AMT")),
										4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");

							}
						} else {
							if (DTR.getInt("TRNCD") <= 200) {
								aCtr = aCtr + 1;
								if (aCtr <= 12) {
									if (repBean.getIcode(aCtr) != DTR
											.getInt("TRNCD")) {
										while (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											if (aCtr <= 12) {
												Str1 = Str1
														+ ReportDAO.addSpaces(
																"", 14) + "|";
											} else {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
											}
											aCtr = aCtr + 1;
											if (aCtr > 24) {
												break;
											}
										}
										if (aCtr > 12) {
											Str2 = Str2
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Str2Ctr = Str2Ctr + 1;
										}
									}
									if (aCtr <= 12) {
										// for printing the income
										if (DTR.getInt("TRNCD") == 101) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empTotalBasic = empTotalBasic
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 102) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCurrentDa = empCurrentDa
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 138) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empVda = empVda
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 103) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empHra = empHra
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 129) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empSpecial = empSpecial
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 105) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEdu = empEdu
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 104) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMed = empMed
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 107) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empOcash = empOcash
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 108) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empConve = empConve
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 126) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empMininsurance = empMininsurance
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 128) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCol = empCol
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 130) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empEarning1 = empEarning1
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 131) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empearning2 = empearning2
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 142) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empArrears = empArrears
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 139) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empCLSG = empCLSG
													+ DTR.getInt("NET_AMT");
										}
										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 140) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREABDV = empAREABDV
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 141) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empAREAALL = empAREAALL
													+ DTR.getInt("NET_AMT");
										}

										if (DTR.getInt("TRNCD") == 199) {
											// System.out.println("basic value "+DTR.getString("NET_AMT"));
											empGROSS = empGROSS
													+ DTR.getInt("NET_AMT");
										}

										Str1 = Str1
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";

										if ((DTR.getString("ARR_AMT") == null ? 0
												: DTR.getInt("ARR_AMT")) != 0) {
											Arr1 = Arr1
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";
											Arr1Ctr = Arr1Ctr + 1;
										}
									}
								} else {
									if (aCtr < 24) {
										// System.out.println("Trncd is "+DTR.getInt("TRNCD"));
										if (repBean.getIcode(aCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getIcode(aCtr) != DTR
													.getInt("TRNCD")) {
												Str2 = Str2
														+ ReportDAO.addSpaces(
																"", 14) + "|";
												Str2Ctr = Str2Ctr + 1;
												aCtr = aCtr + 1;
												if (aCtr > 24)// Added by nakul
																// patil for
																// arrayindexofboundsexception
												{
													break;
												}
											}
										}
									}
									Str2 = Str2
											+ FixStr(
													trans((DTR
															.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT")),
															"999,99,999.99",
															"", false, false),
													14, 3) + "|";
									Str2Ctr = Str2Ctr + 1;

								}
								repBean.setInc(
										repBean.getInc(DTR.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));
								repBean.setRepTotINC(
										repBean.getRepTotINC(DTR
												.getInt("TRNCD"))
												+ (DTR.getString("NET_AMT") == null ? 0
														: DTR.getInt("NET_AMT"))
												+ (DTR.getString("ARR_AMT") == null ? 0
														: DTR.getInt("ARR_AMT")),
										DTR.getInt("TRNCD"));

							} else {
								if (DTR.getInt("TRNCD") >= 201
										&& DTR.getInt("TRNCD") <= 293) {

									if (DTR.getInt("TRNCD") == 201) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPF = empPF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 202) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empPT = empPT + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 212) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOther = empOther
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 226) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empOTHERLOAN = empOTHERLOAN
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 217) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empArrPF = empArrPF
												+ DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 221) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empESIC = empESIC
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 223) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empmobile = empmobile
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 211) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empMLWFDED = empMLWFDED
												+ DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 228) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empTDS = empTDS + DTR.getInt("NET_AMT");
									}
									if (DTR.getInt("TRNCD") == 225) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empAdv = empAdv + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 229) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empRF = empRF + DTR.getInt("NET_AMT");
									}

									if (DTR.getInt("TRNCD") == 230) {
										// System.out.println("basic value "+DTR.getString("NET_AMT"));
										empNET = empNET + DTR.getInt("NET_AMT");
									}

									lCtr = lCtr + 1;
									if (lCtr <= 12) {
										if (repBean.getEcode(lCtr) != DTR
												.getInt("TRNCD")) {
											while (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												if (lCtr <= 12) {
													Str3 = Str3
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
												} else {
													Str4 = Str4
															+ FixStr(
																	trans((DTR
																			.getString("NET_AMT") == null ? 0
																			: DTR.getInt("NET_AMT")),
																			"999,99,999.99",
																			"",
																			false,
																			false),
																	14, 3)
															+ "|";
													Str4Ctr = Str4Ctr + 1;

												}
												lCtr = lCtr + 1;
												if (lCtr > 24) {
													break;
												}

											}
											if (lCtr > 12) {
												Str4 = Str4
														+ FixStr(
																trans((DTR
																		.getString("NET_AMT") == null ? 0
																		: DTR.getInt("NET_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Str4Ctr = Str4Ctr + 1;
											}

										}
										if (lCtr <= 12) {
											Str3 = Str3
													+ FixStr(
															trans((DTR
																	.getString("NET_AMT") == null ? 0
																	: DTR.getInt("NET_AMT")),
																	"999,99,999.99",
																	"", false,
																	false), 14,
															3) + "|";

											if ((DTR.getString("ARR_AMT") == null ? 0
													: DTR.getInt("ARR_AMT")) != 0) {
												Arr2 = Arr2
														+ FixStr(
																trans((DTR
																		.getString("ARR_AMT") == null ? 0
																		: DTR.getInt("ARR_AMT")),
																		"999,99,999.99",
																		"",
																		false,
																		false),
																14, 3) + "|";
												Arr2Ctr = Arr2Ctr + 1;
											}
										}
									} else {
										if (lCtr < 24) {
											if (repBean.getEcode(lCtr) != DTR
													.getInt("TRNCD")) {
												while (repBean.getEcode(lCtr) != DTR
														.getInt("TRNCD")) {
													Str4 = Str4
															+ ReportDAO
																	.addSpaces(
																			"",
																			14)
															+ "|";
													lCtr = lCtr + 1;
													if (lCtr > 24) {
														break;
													}
												}
											}
										}
										Str4 = Str4
												+ FixStr(
														trans((DTR
																.getString("NET_AMT") == null ? 0
																: DTR.getInt("NET_AMT")),
																"999,99,999.99",
																"", false,
																false), 14, 3)
												+ "|";
										Str4Ctr = Str4Ctr + 1;

									}
									repBean.setDed(
											repBean.getDed(DTR.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
									repBean.setRepTotDED(
											repBean.getRepTotDED(DTR
													.getInt("TRNCD"))
													+ (DTR.getString("NET_AMT") == null ? 0
															: DTR.getInt("NET_AMT"))
													+ (DTR.getString("ARR_AMT") == null ? 0
															: DTR.getInt("ARR_AMT")),
											DTR.getInt("TRNCD"));
								}
							}

							if (DTR.getInt("TRNCD") == 101) {
								printBasic = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								repBean.setTotBngd(repBean.getTotBngd(1)
										+ printBasic, 1);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(1)
										+ printBasic, 1);

								originalbasic = originalbasic
										+ DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");

							}
							if (DTR.getInt("TRNCD") == 999) {
								printNet = DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");
								printGross = DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								printTotDed = DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
								repBean.setTotBngd(repBean.getTotBngd(2)
										+ printNet, 2);
								repBean.setTotBngd(repBean.getTotBngd(3)
										+ printGross, 3);
								repBean.setTotBngd(repBean.getTotBngd(4)
										+ printTotDed, 4);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(2)
										+ printNet, 2);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(3)
										+ printGross, 3);
								repBean.setRepTotBNGD(repBean.getRepTotBNGD(4)
										+ printTotDed, 4);

								net = net + DTR.getString("NET_AMT") == null ? 0
										: DTR.getInt("NET_AMT");

								gross = gross + DTR.getString("INP_AMT") == null ? 0
										: DTR.getInt("INP_AMT");
								ded = ded + DTR.getString("CAL_AMT") == null ? 0
										: DTR.getInt("CAL_AMT");
							}
							if (DTR.getInt("TRNCD") == 301) {
								LOPDays = DTR.getInt("INP_AMT");
							}
						}
					}
					for (i = Arr1Ctr + 1; i <= 12; i++) {
						Arr1 = Arr1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Arr2Ctr + 1; i <= 12; i++) {
						Arr2 = Arr2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = aCtr + 1; i <= 12; i++) {
						Str1 = Str1 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = lCtr + 1; j <= 12; j++) {
						Str3 = Str3 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (i = Str2Ctr + 1; i <= 12; i++) {
						Str2 = Str2 + ReportDAO.addSpaces("", 14) + "|";
					}
					for (j = Str4Ctr + 1; j <= 12; j++) {
						Str4 = Str4 + ReportDAO.addSpaces("", 14) + "|";
					}

					nm = ltrim(FixStr(" " + emp.getString("LNAME").trim()
							+ "  " + emp.getString("FNAME").trim() + "  "
							+ emp.getString("MNAME").trim() + " | " + Days, 42,
							1));
					Str1 = FixStr(String.valueOf(emp.getInt("EMPCODE")), 7, 1)
							.substring(0, 7) + "|" + nm + "|" + Str1;
					Str2 = "|"
							+ FixStr(String.valueOf(emp.getString("ACNO")), 16,
									1)
							+ FixStr(
									String.valueOf(lkp.getLKP_Desc("DESIG",
											emp.getInt("DESIG"))), 26, 1) + "|"
							+ Str2;
					Str3 = FixStr(String.valueOf(count++), 7, 1)
							+ "|"
							+ FixStr(
									trans(printBasic, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(trans(LOPDays, "999", "", false, false),
									14, 3) + ReportDAO.addSpaces("", 14) + "|"
							+ Str3;
					Str4 = "|"
							+ FixStr(
									trans(printGross, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printTotDed, "99,99,999.99", "",
											false, false), 14, 3)
							+ FixStr(
									trans(printNet, "99,99,999.99", "", false,
											false), 14, 3) + "|" + Str4;

					countTotal++;

					totalGross = totalGross + gross;
					totalDed = totalDed + ded;
					totalNet = totalNet + net;
					totalBasic = totalBasic + originalbasic;

					/*
					 * if(printNet < 0) { System.out.println(
					 * "THIS EMPLOYEE SALARY GOES -VE PLEASE CHECK IT AND PROCESS PAYCAL AGAIN"
					 * ); return; }
					 */
					Arr1 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr1;
					Arr2 = "|" + ReportDAO.addSpaces("", 42) + "|" + Arr2;
					ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

					ReportDAO.println(Str1, 10, 1, false, "BANK", repBean);
					if (Barr1) {
						ReportDAO.println(Arr1, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str2, 17, 1, false, "BANK", repBean);
					ReportDAO.println(Str3, 10, 1, false, "BANK", repBean);
					if (Barr2) {
						ReportDAO.println(Arr2, 17, 1, false, "BANK", repBean);
					}
					ReportDAO.println(Str4, 17, 1, false, "BANK", repBean);
					// PrintBlankLine(repBean);

				}

				repBean.setNoEmp(repBean.getNoEmp() + 1);
				// repBean.setNoEmp(countTotal - 1);
				repBean.setBNoEmp(repBean.getBNoEmp() + 1);

			}

			// only for the last branch
			if (!repBean.isPayrep()) {
				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);

				String ToPrintEmpTotalIncome = "";

				String TotalDeduction = "";
				String TotalDeduction1 = "";

				// String ToPrintOriginalbasic ="";
				// ToPrintOriginalbasic = ToPrintOriginalbasic +
				// FixStr(trans(totalBasic, "999,99,999.99", "", false, false),
				// 14, 3) + "|";

				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empTotalBasic, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empHra, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMed, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEdu, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empOcash, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empConve, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empMininsurance, "999,99,999.99", "",
										false, false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empCol, "999,99,999.99", "", false, false),
								14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empEarning1, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empearning2, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				ToPrintEmpTotalIncome = ToPrintEmpTotalIncome
						+ FixStr(
								trans(empGROSS, "999,99,999.99", "", false,
										false), 14, 3) + "|";

				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empPT, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empMLWFDED, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOther, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empArrPF, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empESIC, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empmobile, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empAdv, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empOTHERLOAN, "999,99,999.99", "", false,
										false), 14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empTDS, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empRF, "999,99,999.99", "", false, false),
								14, 3) + "|";
				TotalDeduction = TotalDeduction
						+ FixStr(
								trans(empNET, "999,99,999.99", "", false, false),
								14, 3) + "|";

				
				String TotalIncome = "Total:-|"
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|"
						+ ToPrintEmpTotalIncome;
			
				String Deduction = "       |"
						+ FixStr(
								trans(totalBasic, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								transString("", "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction;
				String Deduction1 = FixStr(String.valueOf(count - 1), 7, 1)
						+ "|"
						+ FixStr(
								trans(totalGross, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalDed, "99,99,999.99", "", false,
										false), 14, 3)
						+ FixStr(
								trans(totalNet, "99,99,999.99", "", false,
										false), 14, 3) + "|" + TotalDeduction1;

				ReportDAO.println(TotalIncome, 10, 1, false, "BANK", repBean);

				PrintBlankLine(repBean);
				ReportDAO.println(Deduction, 10, 1, false, "BANK", repBean);
				ReportDAO.println(Deduction1, 10, 1, false, "BANK", repBean);

				ReportDAO.println(SLINE, 10, 1, false, "BANK", repBean);
			}

			repBean.setNoEmp(countTotal - 1);
			for (i = 100; i <= 200; i++) {
				repBean.setBRepTotINC(repBean.getRepTotINC(i), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setBRepTotDED(repBean.getRepTotDED(i), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setBRepTotBNGD(repBean.getRepTotBNGD(i), i);
			}
			// FOR BRANCH TOTAL FOOTER

			ReportDAO.println(SLINE, 10, 7, true, "", repBean);

			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);
			// System.out.println("total   : "+countTotal);
			PrintFootLines(repBean.getObjPRepTotINC(),
					repBean.getObjPRepTotDED(), repBean.getObjPRepTotBNGD(),
					"       " + "|"
							+ " Grand Total ALL BRANCHES Previous Month :"
							+ "|", repBean);

			for (i = 100; i <= 200; i++) {
				repBean.setRepTotINC(
						Math.abs(repBean.getRepTotINC(i)
								- repBean.getPRepTotINC(i)), i);
			}
			for (i = 200; i <= 300; i++) {
				repBean.setRepTotDED(
						Math.abs(repBean.getRepTotDED(i)
								- repBean.getPRepTotDED(i)), i);
			}
			for (i = 1; i <= 4; i++) {
				repBean.setRepTotBNGD(
						Math.abs(repBean.getRepTotBNGD(i)
								- repBean.getPRepTotBNGD(i)), i);
			}
			PrintFootLines(repBean.getObjRepTotINC(),
					repBean.getObjRepTotDED(), repBean.getObjRepTotBNGD(),
					"       " + "|"
							+ " Variance In SAL. OF ALL BRANCHES     :-> "
							+ "|", repBean);
			ReportDAO.println(SLINE, 10, 4, false, "BANK", repBean);
			
			repBean.setLnCount(0);
			repBean.setBrnNo(999);
			repBean.setPageNo(1);
			ReportDAO.println(String.valueOf((char) 15), 10, 4, false, "",
					repBean); // ***********Remain CHr()
			temp = PAYREGDT.substring(3);
			repBean.setHdg1("Summary Of Salary Sheet For The Month Of :- "
					+ temp);
			ReportDAO.println("", 10, 1, false, "", repBean);
			repBean.setPayrep(false);
			if (Barr1 && Barr2) {
				ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
						repBean.getHdg2(), repBean.getHdg3(),
						repBean.getHdg4(), repBean.getHdg5(),
						repBean.getHdg6(), repBean.getHdg7(), repBean);
			} else {
				if (Barr1) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), repBean.getHdg3(),
							repBean.getHdg4(), repBean.getHdg5(), "",
							repBean.getHdg7(), repBean);
				} else if (Barr2) {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), repBean.getHdg6(),
							repBean.getHdg7(), repBean);
				} else {
					ReportDAO.page_head(repBean.getBrnNo(), repBean.getHdg1(),
							repBean.getHdg2(), "", repBean.getHdg4(),
							repBean.getHdg5(), "", repBean.getHdg7(), repBean);
				}
			}

			for (int Kk = 1; Kk <= repBean.getbCode(); Kk++) {
				PaySummary(Kk, repBean);
			}
			ReportDAO.println(SLINE, 10, 1, false, "", repBean);
			PrintFootLines(repBean.getObjBRepTotINC(),
					repBean.getObjBRepTotDED(), repBean.getObjBRepTotBNGD(),
					"TOTAL->" + "|"
							+ " Grand Total ALL BRANCHES Current Month : "
							+ "|", repBean);

			ReportDAO.println(SLINE, 10, 1, false, "", repBean);

			Fp = repBean.getFp();
			Fp.close();
			Cn.close();
			return;
		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	
	/*******************************************Prasad End*************************************************************************************/

	public static void Fianlizedpayreg(String PAYREGDT, String imgpath,
			String filepath, String todate) {

		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}
		System.out.println("in new Fianlizedpayreg regdao");

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);
		System.out.println("maxdt" + lastdat);
		BomDt = ReportDAO.BOM(PAYREGDT);

		EomDt = ReportDAO.EOM(todate);

		String temp = PAYREGDT.substring(2);
		String temp2 = todate.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			Statement stmtInsert = con.createStatement();
			Statement stmtTrnct = con.createStatement();

			DottedLineCell app = new DottedLineCell();
			System.out.println("in income & Deduction head for finalized");
			Document document = new Document(new Rectangle(2384, 3370));

			document.left(100f);
			document.top(100f);
			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filepath));

			document.open();
			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));

			Image image1 = Image.getInstance(imgpath);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 25, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			document.add(image1);
			document.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 22)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 22)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 22)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);

			Font f = new Font(Font.HELVETICA, 22);
			Font f1 = new Font(Font.HELVETICA, 22);
			Font f2 = new Font(Font.HELVETICA, 22);
			para = new Paragraph(new Phrase(
					"List and salary of Employees which is on hold for period  :- "
							+ temp + " To " + temp2 + "", new Font(
							Font.TIMES_ROMAN, 20)));

			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			document.add(para);

			Rectangle rec = new Rectangle(100, 100);

			float basic_total = 0.0f;
			float lstbasic_total = 0.0f;
			float lic_total = 0.0f;
			float lstlic_total = 0.0f;
			float hra_total = 0.0f;
			float lsthra_total = 0.0f;
			float medical_total = 0.0f;
			float lstmedical_total = 0.0f;
			float edu_total = 0.0f;
			float lstedu_total = 0.0f;
			float splall_total = 0.0f;
			float lstsplall_total = 0.0f;
			float convall_total = 0.0f;
			float lstconvall_total = 0.0f;
			float pf_total = 0.0f;
			float lstpf_total = 0.0f;
			float pt_total = 0.0f;
			float lstpt_total = 0.0f;
			float mlwf_total = 0.0f;
			float lstmlwf_total = 0.0f;
			float esic_total = 0.0f;
			float lstesic_total = 0.0f;
			float mob_total = 0.0f;
			float lstmob_total = 0.0f;
			float adv_total = 0.0f;
			float lstadv_total = 0.0f;
			float tds_total = 0.0f;
			float lsttds_total = 0.0f;
			float relif_total = 0.0f;
			float lstrelif_total = 0.0f;
			float netc_total = 0.0f;
			float lstnetc_total = 0.0f;
			float minins_total = 0.0f;
			float lstminins_total = 0.0f;
			float addlss_total = 0.0f;
			float lstaddlss_total = 0.0f;
			float col_total = 0.0f;
			float lstcol_total = 0.0f;
			float special_total = 0.0f;
			float lstspecial_total = 0.0f;
			float addinc_total = 0.0f;
			float lstaddinc_total = 0.0f;
			float totinc_total = 0.0f;
			float lsttotinc_total = 0.0f;
			float addded_total = 0.0f;
			float lstaddded_total = 0.0f;
			float totded_total = 0.0f;
			float lsttotded_total = 0.0f;
			float netpay_total = 0.0f;
			float lstnetpay_total = 0.0f;

			EmpSql = "      SELECT CONVERT(INT, EMPMAST.EMPCODE) AS EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+'  "
					+ "'+RTRIM(EMPMAST.LNAME)AS NAME,EMPMAST.EMPNO,replace(right(convert(varchar, p.TRNDT, 106), 8), ' ', '-')  as date,   "
					+ "T.PRJ_SRNO ,p.INp_amt as totear ,p.cal_amt as totded ,p.net_amt as PAYABLE"
					+ " from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO  "
					+ "join PAYTRAN_STAGE p on p.EMPNO=t.empno  "
					+ "where   p.TRNCD=999 and TRNDT between '"
					+ BomDt
					+ "'  and '"
					+ EomDt
					+ "'   "
					+ "and p.STATUS='F'  and   T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND  "
					+ " E2.EFFDATE <= '"
					+ EomDt
					+ "'   and (( empmast.STATUS='A' AND  "
					+ "empmast.DOJ <= '"
					+ EomDt
					+ "') or  (empmast.STATUS ='N' And empmast.DOL>= '"
					+ BomDt
					+ "' )) )  "
					+ "AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE  STATUS='F' AND TRNDT "
					+ " BETWEEN  '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "')      order by  p.TRNDT, " + " t.PRJ_SRNO,empcode   ";

			System.out.println("we are here " + EmpSql);

			ResultSet rs = st.executeQuery(EmpSql);

			while (rs.next()) {

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
						+ rs.getString("PRJ_SRNO") + "'";

				ResultSet prj = stmt.executeQuery(prjquery);
				if (prj.next()) {
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;

				para = new Paragraph(new Phrase("For Month : "
						+ rs.getString("date"), f2));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				document.add(para);
				para = new Paragraph(new Phrase(
						"Employee's Salary List For Project Site : " + prj_name
								+ " (" + prj_code + ")", f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				document.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(5);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 8, 25.5f, 8.5f, 8.5f,
						8.5f }, rec);
				main.setHorizontalAlignment(Element.ALIGN_CENTER);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("CODE", f1));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setFixedHeight(70);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPNAME", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot Ded.", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net Pay", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				document.add(main);
				while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
					datatab = new PdfPTable(5);
					datatab.setTableEvent(app.new DottedCells());
					datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
					datatab.setWidthPercentage(new float[] { 8, 25.5f, 8.5f,
							8.5f, 8.5f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell1 = new PdfPCell(new Phrase(""
							+ rs.getString("EMPCODE"), f1));
					cell1.setCellEvent(app.new DottedCell());
					cell1.setFixedHeight(60);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f1));
					cell2.setCellEvent(app.new DottedCell());
					datatab.addCell(cell2);

					totinc_total = totinc_total + rs.getFloat("totear");
					PdfPCell cell25 = new PdfPCell(new Phrase(""
							+ rs.getFloat("totear"), f1));
					cell25.setCellEvent(app.new DottedCell());
					cell25.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell25);

					totded_total = totded_total + rs.getFloat("totded");
					PdfPCell cell26 = new PdfPCell(new Phrase(""
							+ rs.getFloat("totded"), f1));
					cell26.setCellEvent(app.new DottedCell());
					cell26.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell26);

					netpay_total = netpay_total + rs.getFloat("payable");
					PdfPCell cell27 = new PdfPCell(new Phrase(""
							+ rs.getFloat("payable"), f1));
					cell27.setCellEvent(app.new DottedCell());
					cell27.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell27);

					document.add(datatab);

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						rs.previous();
						break;
					}
				}

				datatot = new PdfPTable(5);
				datatot.setWidthPercentage(new float[] { 8, 25.5f, 8.5f, 8.5f,
						8.5f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
				cell1.setColspan(2);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell1);

				PdfPCell cell25 = new PdfPCell(
						new Phrase("" + totinc_total, f1));
				cell25.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell25);
				lsttotinc_total = lsttotinc_total + totinc_total;
				totinc_total = 0.0f;

				PdfPCell cell26 = new PdfPCell(
						new Phrase("" + totded_total, f1));
				cell26.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell26);
				lsttotded_total = lsttotded_total + totded_total;
				totded_total = 0.0f;

				PdfPCell cell27 = new PdfPCell(
						new Phrase("" + netpay_total, f1));
				cell27.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell27);
				lstnetpay_total = lstnetpay_total + netpay_total;
				netpay_total = 0.0f;

				document.add(datatot);

				para = new Paragraph(new Phrase("No Of Employees :- "
						+ br_tot_no_emp, f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

			}
			para = new Paragraph(new Phrase("Total No Of Employees :- "
					+ tot_no_emp, f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(40);
			document.add(para);

			System.out.println("Total No Of Employee :- " + tot_no_emp);

			para = new Paragraph(new Phrase("-:Summary :- ", new Font(
					Font.HELVETICA, 40, Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			PdfPTable main = new PdfPTable(6);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[] { 10, 10, 10, 10, 10, 10 }, rec);
			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase("Tot income Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsttotinc_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Tot Ded. Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsttotded_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Net Pay Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstnetpay_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			document.add(main);

			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);

			/* if(TName.equalsIgnoreCase("after")) { */
			para = new Paragraph(
					new Phrase(
							"Prepared By                         Checked By                        Approved By                 ",
							new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
			para.setAlignment(Element.ALIGN_RIGHT);
			document.add(para);
			/* } */

			stmtInsert.close();
			stmtTrnct.close();
			st.close();
			con.close();
			document.close();

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static String transString(String p_num, String p_pic, String p_lzc,
			boolean p_sgn, boolean blankif0) {
		NumberFormat format = NumberFormat.getCurrencyInstance(new Locale("en",
				"in"));
		String result = "                                          ";

		return result;
	}

	public static void tdsList(String year, String endyear, String imgpath,
			String filepath) {
		Properties prop = new Properties();
		try {

			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {

			System.out.println("Error in constant properties Manager " + e);
		}

		System.out.println("in new tdsList generate" + year + " " + endyear);

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";

		BomDt = ReportDAO.BOM(year);

		EomDt = ReportDAO.EOM(endyear);

		String temp = year.substring(3);
		String temp2 = endyear.substring(3);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;

		try {

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);

			System.out.println("in tdslist sheet");
			Document doc = new Document(new Rectangle(2384, 3370));
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();
			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 1300f,
					1830f, 45);
			Image image1 = Image.getInstance(imgpath);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			doc.add(para);

			Font f = new Font(Font.HELVETICA, 30);
			Font f1 = new Font(Font.HELVETICA, 25);
			Font f2 = new Font(Font.HELVETICA, 32);

			para = new Paragraph(new Phrase(
					"TDS-list Sheet for the Month Of :- " + temp + "- To "
							+ temp2, new Font(Font.TIMES_ROMAN, 25, Font.BOLD)));

			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			doc.add(para);

			Rectangle rec = new Rectangle(100, 100);

			long salary = 0;
			long yearlySalary = 0;
			long tax = 0;
			long taxValue = 0;

			long salary2 = 0;
			long tax2 = 0;

			/*
			 * EmpSql=
			 * "select * from (SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as"
			 * + "    name, t.PRJ_SRNO as PRJ_SRNO,"+
			 * 
			 * "	(select sum (inp_amt)*12 from  CTCDISPLAY a1 " +
			 * "	where a1.empno=e.EMPNO	)  as YEARLY" +
			 * "   FROM   EMPMAST e left join   EMPTRAN t" +
			 * "   on (e.EMPNO=t.EMPNO )  where e.STATUS='A'   and DOJ <= '"
			 * +EomDt+"'" + "  	AND T.SRNO=(SELECT MAX(ET.SRNO)" +
			 * "   FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO) )s" +
			 * "	where s.YEARLY > 250000 order by s.PRJ_SRNO,s.EMPNO";
			 */

			EmpSql = "select * from (SELECT e.EMPCODE ,e.empno ,rtrim(e.fname)+' '+rtrim(e.mname)+' '+rtrim(e.lname)as  "
					+ "  name, t.PRJ_SRNO as PRJ_SRNO, "
					+ "   case (select COUNT(*) from PAYTRAN_STAGE where TRNDT between "
					+ "   '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and trncd=199 and EMPNO=e.empno) when 12 then "
					+ "	 (select sum (p.NET_AMT) from  PAYTRAN_STAGE p,CDMAST c	 where p.empno=e.EMPNO  and p.TRNDT between "
					+ " '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and p.trncd between 101 and 199 and p.trncd=c.TRNCD and c.TAXABLE='Y') "
					+ "  else (select sum (inp_amt)*12 from  CTCDISPLAY a1 	where a1.empno=e.EMPNO	)  end as YEARLY "
					+ "	   FROM   EMPMAST e left join   EMPTRAN t   on (e.EMPNO=t.EMPNO )  "
					+ "	  where e.STATUS='A'   and DOJ <= '"
					+ EomDt
					+ "'  	AND T.SRNO=(SELECT MAX(ET.SRNO) "
					+ "	    FROM EMPTRAN ET WHERE ET.EMPNO=E.EMPNO) )s	"
					+ "where s.YEARLY > 250000 order by s.PRJ_SRNO,s.EMPNO";

			System.out.println(EmpSql);
			ResultSet rs = st.executeQuery(EmpSql);
			int srno = 1;
			while (rs.next()) {

				String prj_name = null;
				String prj_code = null;
				Connection conn = ConnectionManager.getConnectionTech();
				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
						+ rs.getString("PRJ_SRNO") + "'";
				System.out.println(prjquery);
				ResultSet prj = stmt.executeQuery(prjquery);
				if (prj.next()) {
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}
				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;
				para = new Paragraph(new Phrase(
						"Employee's TDS List For Project Site : " + prj_name
								+ " (" + prj_code + ")", f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(4);
				doc.add(para);
				prj.close();
				stmt.close();
				conn.close();
				PdfPTable datatab;
				PdfPTable datatot;
				PdfPTable main = new PdfPTable(5);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 8, 8, 20, 15, 9f }, rec);

				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("SRNO", f));
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMP CODE", f));
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPLOYEE NAME", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("YEARLY INCOME", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TAX", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);

				while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {

					datatab = new PdfPTable(5);

					datatab.setWidthPercentage(
							new float[] { 8, 8, 20, 15, 9f }, rec);

					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell111 = new PdfPCell(new Phrase("" + srno, f1));
					cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell111.setFixedHeight(50);
					datatab.addCell(cell111);

					PdfPCell cell1 = new PdfPCell(new Phrase(""
							+ rs.getString("EMPCODE"), f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f1));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell2);

					salary = salary + rs.getLong("yearly");
					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ rs.getLong("YEARLY"), f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);

					yearlySalary = rs.getLong("yearly");
					yearlySalary = yearlySalary - 2500;
					taxValue = ((yearlySalary - 250000) > 0 ? ((yearlySalary - 250000) > 250000 ? 25000
							: (yearlySalary - 250000) / 10)
							: 0)
							+ ((yearlySalary - 500000) > 500000 ? 100000
									: (yearlySalary - 500000 > 0 ? (yearlySalary - 500000) / 5
											: 0))
							+ ((yearlySalary - 1000000) > 0 ? ((yearlySalary - 1000000) * 3 / 10)
									: 0);

					tax = tax + taxValue;
					PdfPCell cell4 = new PdfPCell(new Phrase("" + taxValue, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);

					srno++;
					doc.add(datatab);

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						rs.previous();
						break;
					}
				}

				datatot = new PdfPTable(5);
				datatot.setWidthPercentage(new float[] { 8, 8, 20, 15, 9f },
						rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
				cell1.setColspan(3);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell1);

				PdfPCell cell2 = new PdfPCell(new Phrase("" + salary, f1));
				cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell2);
				salary2 = salary2 + salary;
				salary = 0;

				PdfPCell cell4 = new PdfPCell(new Phrase("" + tax, f1));
				cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell4);
				tax2 = tax2 + tax;
				tax = 0;

				doc.add(datatot);

				para = new Paragraph(new Phrase("Number Of Employees :- "
						+ br_tot_no_emp, f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(50);
				doc.add(para);

			}

			para = new Paragraph(new Phrase("Total Number Of Employees :- "
					+ tot_no_emp, f));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			System.out.println("Total No Of Employee :- " + tot_no_emp);

			para = new Paragraph(new Phrase("-:Summary :- ", new Font(
					Font.HELVETICA, 40, Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			doc.add(para);

			PdfPTable main = new PdfPTable(4);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[] { 10, 10, 10, 10 }, rec);
			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase("Salary Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + ((int) (salary2)), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("TAX Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("" + (int) (tax2), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			doc.add(main);

			st.close();
			con.close();
			doc.close();

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void newpayregwithNewFormat(String PAYREGDT, String imgpath,
			String filepath, String type,String reptype) {
		String hname="";
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant Properties " + e);
		}
		
		if(reptype.equalsIgnoreCase("paytran"))
		{
			hname="Pre-Finalize";
		}
		else if(reptype.equalsIgnoreCase("paytran_stage"))
		{
			hname="Finalize";
		}
		else
		{
			hname="Release";
		}
		System.out.println("in new pay regdao..........aniket");
		System.out.println("in new pay regdao");
		System.out.println("type selected...." + type);
		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);

		BomDt = ReportDAO.BOM(PAYREGDT);
		EomDt = ReportDAO.EOM(PAYREGDT);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {
			if (type.equalsIgnoreCase("G")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement();

				Document doc = new Document(new Rectangle(900, 500));

				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();

				Font FONT = new Font(Font.HELVETICA, 30, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 450f,
						230, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(90f, 50f);
				image1.setAbsolutePosition(50f, 405f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 8);
				Font f1 = new Font(Font.HELVETICA, 7);

				para = new Paragraph(new Phrase(
						"Salary Sheet For The Month Of :- " + temp, new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Rectangle rec = new Rectangle(650, 100);

				PdfPTable main = new PdfPTable(11);
				main.setSpacingBefore(10);
				// main.setWidthPercentage(new
				// float[]{35,57,40,30,23,20,25,25,25,30,25,20,20,30,30,30,30,170},
				// rec);
				main.setWidthPercentage(new float[] { 30, 99, 59, 59, 59, 59,
						59, 59, 49, 49, 60 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Emp code", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Emp Name", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("C.T.C", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.O.P Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 1", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 2", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Given", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TDS", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("NET PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				main.setHeaderRows(1);

				// EmpSql =
				// "select distinct p.empno,e.empcode from "+table_name+" p right join EMPMAST e on e.EMPNO = p.EMPNO where TRNDT BETWEEN '"
				// + BomDt + "' AND '" + EomDt + "' order by p.EMPNO";
				EmpSql = "select distinct p.empno,CONVERT(INT, e.empcode) as empcode,t.PRJ_SRNO,t.PRJ_CODE from paytran p right join EMPMAST e on e.EMPNO = p.EMPNO join EMPTRAN t on p.EMPNO = t.EMPNO where TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' and e.STATUS = 'A'"
						+ "and T.EFFDATE = (SELECT E2.EFFDATE FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "' and E2.srno=(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "')) order by t.PRJ_CODE,empcode";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);

				List<Integer> results = new ArrayList<Integer>();

				while (emp.next()) {

					results.add(emp.getInt("empno"));
					// System.out.println(emp.getInt("empno"));
				}

				for (int empp : results) {

					EmpSql = "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from  paytran  where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from  paytran  where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from  paytran  where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from  paytran  where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from  paytran  where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from  paytran  where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from  paytran  where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from  paytran  where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from  paytran  where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t,paytran p1  where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ "  and p1.trndt  BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and p1.empno="
							+ empp
							+ " "
							+ "  UNION  "
							+ "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from   paytran_stage   where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from   paytran_stage   where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from   paytran_stage   where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from   paytran_stage   where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from   paytran_stage   where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from   paytran_stage   where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from   paytran_stage   where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from   paytran_stage   where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from   paytran_stage   where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t ,paytran_stage p1 where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ " and p1.trndt   BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt + "' and p1.empno=" + empp + "";
					System.out.println(EmpSql);
					// System.out.println(empp);
					emp = st.executeQuery(EmpSql);

					while (emp.next()) {
						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("empcode"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("name"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						float mthsal = 0.0f;
						float absent = 0.0f;

						mthsal = emp.getFloat("ctc");
						if (mthsal == 0) {
							mthsal = 0;

						} else {

							totmthsal1 = totmthsal1 + mthsal;
						}
						// ctc
						maincell = new PdfPCell(new Phrase("" + mthsal, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						absent = emp.getFloat("abs_cnt");
						// L.O.P days
						maincell = new PdfPCell(new Phrase("" + absent, f));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);

						float ear1 = 0.0f;
						ear1 = emp.getFloat("earning1");
						if (ear1 == 0.0) {
							ear1 = 0;

						} else {
							// earning1 = ear1;
							totearning1 = totearning1 + ear1;
						}

						// earning 1
						maincell = new PdfPCell(new Phrase("" + ear1, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float ear2 = 0.0f;

						ear2 = emp.getFloat("earning2");
						if (ear2 == 0.0) {
							ear2 = 0;

						} else {

							totearning2 = totearning2 + ear2;
						}

						// earning 2
						maincell = new PdfPCell(new Phrase("" + ear2, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float mobded = 0.0f;

						mobded = emp.getFloat("mobded");
						if (mobded == 0.0) {
							mobded = 0;

						} else {

							totmobded = totmobded + mobded;
						}

						// mobile ded
						maincell = new PdfPCell(new Phrase("" + mobded, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float advanc = 0.0f;

						advanc = emp.getFloat("added");
						if (advanc == 0.0) {
							advanc = 0;

						} else {

							totadvanc = totadvanc + advanc;
						}

						// advance given
						maincell = new PdfPCell(new Phrase("" + advanc, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float loan = 0.0f;
						/*
						 * EmpSql="select net_amt as loan from "+table_name+
						 * " where trncd = 227 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ loan =
						 * emp.getFloat("loan");
						 * 
						 * //System.out.println("loan "+emp.getString("loan"));
						 * }
						 */
						loan = emp.getFloat("loan");
						if (loan == 0.0) {
							loan = 0;

						} else {

							totloan = totloan + loan;
						}

						// loan
						maincell = new PdfPCell(new Phrase("" + loan, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float tds = 0.0f;
						/*
						 * EmpSql="select net_amt as tds from "+table_name+
						 * " where trncd = 228 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ tds =
						 * emp.getFloat("tds");
						 * 
						 * //System.out.println("tds "+emp.getString("tds")); }
						 */
						tds = emp.getFloat("tds");
						if (tds == 0.0) {
							tds = 0;

						} else {

							tottds = tottds + tds;
						}

						// tds
						maincell = new PdfPCell(new Phrase("" + tds, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						int payable = 0;
						/*
						 * EmpSql="select net_amt as payable from "+table_name+
						 * " where trncd = 999 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql);
						 * //System.out.println(""+EmpSql); while(emp.next()){
						 * payable = emp.getInt("payable");
						 * 
						 * //System.out.println("payable "+emp.getString("payable"
						 * )); }
						 */
						payable = emp.getInt("payable");
						if (payable == 0) {
							payable = 0;
						} else {

							totactualpay = totactualpay + payable;

						}
						// actual pay
						maincell = new PdfPCell(new Phrase("" + payable, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

					}

				}

				NumberFormat format = com.ibm.icu.text.NumberFormat
						.getCurrencyInstance(new Locale("en", "in"));
				String totpay = format.format(totmthsal1).substring(4);
				String eard1 = format.format(totearning1).substring(4);
				String eard2 = format.format(totearning2).substring(4);
				String totnetpay = format.format(totactualpay).substring(4);
				String tomobded = format.format(totmobded).substring(4);
				String toadv = format.format(totadvanc).substring(4);
				String toloan = format.format(totloan).substring(4);
				String totds = format.format(tottds).substring(4);

				maincell = new PdfPCell(new Phrase("TOTAL PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				maincell.setColspan(2);
				main.addCell(maincell);
				// totctc
				maincell = new PdfPCell(new Phrase("" + totpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totlop
				maincell = new PdfPCell(new Phrase("", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear1
				maincell = new PdfPCell(new Phrase("" + eard1, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear2
				maincell = new PdfPCell(new Phrase("" + eard2, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totmobileded
				maincell = new PdfPCell(new Phrase("" + tomobded, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totadvancegiven
				maincell = new PdfPCell(new Phrase("" + toadv, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totloan
				maincell = new PdfPCell(new Phrase("" + toloan, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// tottds
				maincell = new PdfPCell(new Phrase("" + totds, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totnetpay
				maincell = new PdfPCell(new Phrase("" + totnetpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				st.close();
				con.close();
				doc.close();
			}

			else if (type.equals("I")) {

				System.out.println("hello am in IIIIIIIIII");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);

				System.out.println("in income head");
				Document doc = new Document(new Rectangle(2384, 3370));
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer1 ftr = dao.new Footer1(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f,
						1830f, 45);
				Image image1 = Image.getInstance(imgpath);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3200f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 23);
				Font f1 = new Font(Font.HELVETICA, 20);
				/*
				 * if(TName.equalsIgnoreCase("after")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp,new Font(Font.TIMES_ROMAN,25))); else
				 * if(TName.equalsIgnoreCase("before")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
				 * else
				 */para = new Paragraph(new Phrase(
						"Salary Sheet For The Income Heads for the Month Of :- "
								+ temp + " (" + hname + ")", new Font(
								Font.TIMES_ROMAN, 25)));

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				doc.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float currda_total = 0.0f;
				float lstcurrda_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float washingall_total = 0.0f;
				float lstwashingall_total = 0.0f;
				float bonus_total = 0.0f;
				float lstbonus_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				EmpSql = "select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from  PAYTRAN where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ " PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO "
						+ "join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO "
						+ "join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO "
						+ "join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO "
						+ "join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO "
						+ "join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO "
						+ "join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "') "
						+

						" UNION  select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from   paytran_stage  where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ "  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join   paytran_stage  p2 on empmast.EMPNO = p2.EMPNO "
						+ "join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO "
						+ "join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO "
						+ "join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO "
						+ "join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO "
						+ "join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO "
						+ "join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "') " +

						"order by t.PRJ_SRNO,EMPCODE";
				System.out.println(EmpSql);
				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;
					Connection conn = ConnectionManager.getConnectionTech();
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
					ResultSet prj = stmt.executeQuery(prjquery);
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					doc.add(para);
					prj.close();
					stmt.close();
					conn.close();
					PdfPTable datatab;
					PdfPTable datatot;
					PdfPTable main = new PdfPTable(18);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5,
							5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f }, rec);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("EMP CODE", f1));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Current D.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Washing All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Bonus", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Insurance", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add less Amt", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					// maincell = new PdfPCell(new Phrase("Special",f));
					// maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					// main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot deduction", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net pay", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					doc.add(main);
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						datatab = new PdfPTable(18);
						datatab.setWidthPercentage(new float[] { 3, 12, 5, 5,
								5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
								5.5f, 5.5f, 5.5f, 5.5f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f1));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						if (rs.getFloat("curda") == 0.0) {
							PdfPCell cell4 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell4);
						} else {
							float curda = rs.getFloat("curda");
							currda_total = currda_total + curda;
							PdfPCell cell4 = new PdfPCell(new Phrase(
									"" + curda, f1));
							cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell4);
						}

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						medical_total = medical_total = rs.getFloat("medical");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						edu_total = edu_total = rs.getFloat("education");
						PdfPCell cell7 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell8 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell8);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell8 = new PdfPCell(new Phrase(""
									+ rs.getFloat("splall"), f1));
							cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell8);
						}

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("washall") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell10);
						} else {
							float washing = rs.getFloat("washall");
							washingall_total = washingall_total = rs
									.getFloat("washall");
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ washing, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("bonusall") == 0.0) {
							PdfPCell cell11 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell11);
						} else {
							float bonus = rs.getFloat("bonusall");
							bonus_total = bonus_total + rs.getFloat("bonusall");
							PdfPCell cell11 = new PdfPCell(new Phrase(""
									+ bonus, f1));
							cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell11);
						}

						minins_total = minins_total + +rs.getFloat("min_ins");
						PdfPCell cell12 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);

						if (rs.getFloat("addless") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell13);
						} else {
							float addless = rs.getFloat("addless");
							addlss_total = addlss_total + addless;
							PdfPCell cell13 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell14 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);

						/*
						 * if(rs.getFloat("special")==0.0){ PdfPCell cell15 =
						 * new PdfPCell(new Phrase("",f1));
						 * datatab.addCell(cell15); } else{ float spcl =
						 * rs.getFloat("special"); special_total = special_total
						 * + spcl; PdfPCell cell15 = new PdfPCell(new
						 * Phrase(""+spcl,f1));
						 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell15); }
						 */
						if (rs.getFloat("addinc") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell16);
						} else {
							float add_inc = rs.getFloat("addinc");
							addinc_total = addinc_total + add_inc;
							PdfPCell cell16 = new PdfPCell(new Phrase(""
									+ add_inc, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell17 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totear"), f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell18 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totded"), f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);

						netpay_total = netpay_total + rs.getFloat("payable");
						PdfPCell cell19 = new PdfPCell(new Phrase(""
								+ rs.getFloat("payable"), f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);

						doc.add(datatab);

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5,
							5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f, 5.5f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
					cell1.setColspan(2);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(new Phrase("" + currda_total,
							f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstcurrda_total = lstcurrda_total + currda_total;
					currda_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstsplall_total = lstsplall_total = splall_total;
					splall_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstconvall_total = lstconvall_total = convall_total;
					convall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(""
							+ washingall_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstwashingall_total = lstwashingall_total
							+ washingall_total;
					washingall_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + bonus_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstbonus_total = lstbonus_total + bonus_total;
					bonus_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(
							"" + minins_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					/*
					 * PdfPCell cell15 = new PdfPCell(new
					 * Phrase(""+special_total,f1));
					 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell15); lstspecial_total =
					 * lstspecial_total + special_total ; special_total = 0.0f;
					 */

					PdfPCell cell16 = new PdfPCell(new Phrase(
							"" + addinc_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase(
							"" + totinc_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase(
							"" + totded_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttotded_total = lsttotded_total + totded_total;
					totded_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase(
							"" + netpay_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstnetpay_total = lstnetpay_total + netpay_total;
					netpay_total = 0.0f;

					doc.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);

				}
				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				PdfPTable main = new PdfPTable(18);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 5, 6, 5, 5.5f, 5.5f,
						5.5f, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
						5.5f, 6, 6, 6 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Summury", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Current D.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Washing All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Officiating All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Insurance", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add less Amt", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("Special",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("Add income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net pay", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Gross Total:--", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcurrda_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsthra_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstedu_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstwashingall_total), "", "", false,
								false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbonus_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcol_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstspecial_total), "", "", false,
				 * false),f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetpay_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);

				/*
				 * System.out.println("last basic = "+lstbasic_total);
				 * System.out.println("last current da = "+lstcurrda_total);
				 * System.out.println("last hra = "+lsthra_total);
				 * System.out.println("last medical = "+lstmedical_total);
				 * System.out.println("last education = "+lstedu_total);
				 * System.out.println("last splall = "+lstsplall_total);
				 * System.out.println("last convall = "+lstconvall_total);
				 * System.out.println("last washing = "+lstwashingall_total);
				 * System.out.println("last bonus = "+lstbonus_total);
				 * System.out.println("last minins = "+lstminins_total);
				 * System.out.println("last addless = "+lstaddlss_total);
				 * System.out.println("last col = "+lstcol_total);
				 * //System.out.println("last special = "+lstspecial_total);
				 * System.out.println("last addinc = "+lstaddinc_total);
				 * System.out.println("last totinc = "+lsttotinc_total);
				 * System.out.println("last totded = "+lsttotded_total);
				 * System.out.println("last totnetpay = "+lstnetpay_total);
				 */

				st.close();
				con.close();
				doc.close();

			}

			else if (type.equals("ID")) {
				System.out.println("hello am in IDDDDD");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = con.createStatement();
				Statement stmtTrnct = con.createStatement();

				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");

				// A4 size pdf....
				Document document = new Document(new Rectangle(2384, 3370));
				
				
				// Document doc = new Document(new Rectangle(2834,4008));

				document.left(100f);
				document.top(100f);
				document.bottom(100f);
				document.right(100f);

				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filepath));
				HeaderAndFooter haf = new HeaderAndFooter(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f,
						1830f, 45);
				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);

				// chaange possition of image
				/* image1.setAbsolutePosition(60f, 2750f); */
				image1.setAbsolutePosition(60f, 3200f);
				document.add(image1);
				document.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				document.add(para);

				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
				Font f2 = new Font(Font.HELVETICA, 22);

				para = new Paragraph(new Phrase(
						"Salary Sheet For The Income Heads for the Month Of :- "
								+ temp + " (" + hname + ")", new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(30);

				document.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f, lstbasic_total = 0.0f, lic_total = 0.0f, lstlic_total = 0.0f, hra_total = 0.0f, lsthra_total = 0.0f, medical_total = 0.0f;
				float lstmedical_total = 0.0f;

				float leave_TC = 0.0f, lstleave_total = 0.0f;

				float any_total = 0.0f, lstany_total = 0.0f;

				float edu_total = 0.0f, lstedu_total = 0.0f, splall_total = 0.0f, lstsplall_total = 0.0f, convall_total = 0.0f, lstconvall_total = 0.0f;
				float pf_total = 0.0f, lstpf_total = 0.0f, pt_total = 0.0f, lstpt_total = 0.0f;

				float mlwf_total = 0.0f, lstmlwf_total = 0.0f;
				float other_total = 0.0f, med_total = 0.0f, ERP_total = 0.0f, istotmed_total = 0.0f, istotERPDED_total = 0.0f, lstother_total = 0.0f;

				float esic_total = 0.0f;
				float lstesic_total = 0.0f;
				float mob_total = 0.0f;
				float lstmob_total = 0.0f;
				float adv_total = 0.0f;
				float lstadv_total = 0.0f;
				float tds_total = 0.0f;
				float lsttds_total = 0.0f;
				float relif_total = 0.0f;
				float lstrelif_total = 0.0f;
				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;

				float loan_total = 0.0f, lstloan_total = 0.0f;

				// float addded_total = 0.0f;
				// float lstaddded_total = 0.0f;

				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;
				
				if(reptype.equalsIgnoreCase("paytran")){
				EmpSql = "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)   "
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC', "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',           "
						+

						" CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+

						"    UNION "
						+ "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,  EMPMAST.DOL, EMPMAST.STATUS, T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
				      System.out.println("newpayregwithNewFormat ID :"+ EmpSql);
				}
				
				
				else if(reptype.equalsIgnoreCase("ytdtran")){
				EmpSql =  "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   ytdtran WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   ytdtran WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   ytdtran WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   ytdtran WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   ytdtran WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   ytdtran WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   ytdtran WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   ytdtran WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   ytdtran WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   ytdtran WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   ytdtran WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   ytdtran WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   ytdtran WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   ytdtran WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   ytdtran WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   ytdtran WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   ytdtran  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM ytdtran WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
				     System.out.println("newpayregwithNewFormat ytdtran :" +EmpSql);
				}
				
				else if(reptype.equalsIgnoreCase("paytran_stage")){
				EmpSql =  "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO, EMPMAST.DOL, EMPMAST.STATUS,  T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
						System.out.println("newpayregwithNewFormat paytran_stage :"+ EmpSql);
					}

				ResultSet rs = st.executeQuery(EmpSql);
				
				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;

					Connection conn = ConnectionManager.getConnectionTech();

					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);

					ResultSet prj = stmt.executeQuery(prjquery);

					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}

					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;

					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);

					document.add(para);

					prj.close();
					stmt.close();
					conn.close();

					PdfPTable datatab;
					PdfPTable datatot;

					//PdfPTable main = new PdfPTable(18);
					/*------------------Prasad----------------------------*/
					PdfPTable main = new PdfPTable(19);
					main.setSpacingBefore(10);

					/*main.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
							4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
							5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);*/
					
					/*----------------Prasad-------------------------*/
					main.setWidthPercentage(new float[] { 4, 13.5f, 5.3f, 5.3f,
							4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
							4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f }, rec);
					
					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("CODE", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.setFixedHeight(50);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Ins.", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 1", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 2", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("LTA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					/*
					 * maincell = new PdfPCell(new Phrase("ANONYMOUS",fbold));
					 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * main.addCell(maincell);
					 */
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);
					
					/*---------------Prasad-------------------*/
					
					maincell = new PdfPCell(new Phrase("EMP Status", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);
					

					document.add(main);

					/*datatab = new PdfPTable(18);
					datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);*/
					
					/*-----------------Prasad----------------------*/
					datatab = new PdfPTable(19);
					datatab.setWidthPercentage(new float[] { 4, 13.5f, 5.3f, 
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 
							4.8f, 4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f }, rec);
					
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
					maincell1.disableBorderSide(rec.TOP);
					maincell1.setFixedHeight(50);
					// maincell1.setColspan(2);
					datatab.addCell(maincell1);

					PdfPCell maincell2 = new PdfPCell(new Phrase("", fbold));
					maincell2.disableBorderSide(rec.TOP);
					maincell2.setFixedHeight(50);
					datatab.addCell(maincell2);

					PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
					maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell3);

					PdfPCell maincell4 = new PdfPCell(new Phrase("E.S.I.C",
							fbold));
					maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell4);

					PdfPCell maincell5 = new PdfPCell(new Phrase("P.T", fbold));
					maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell5);

					PdfPCell maincell6 = new PdfPCell(
							new Phrase("T.D.S", fbold));
					maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell6);

					PdfPCell maincell7 = new PdfPCell(new Phrase("Advance",
							fbold));
					maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell7);

					PdfPCell maincell8 = new PdfPCell(new Phrase("Loan Ded",
							fbold));
					maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell8);

					PdfPCell maincell9 = new PdfPCell(new Phrase("Mobile Ded",
							fbold));
					maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell9);

					PdfPCell maincell10 = new PdfPCell(new Phrase(
							"Net Charges", fbold));
					maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell10);

					PdfPCell maincell11 = new PdfPCell(new Phrase(
							"Current Advance", fbold));
					maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell11);

					PdfPCell maincell12 = new PdfPCell(new Phrase("Relif",
							fbold));
					maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell12);

					PdfPCell maincell13 = new PdfPCell(
							new Phrase("MLWF", fbold));
					maincell13.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell13);

					PdfPCell maincell111 = new PdfPCell(new Phrase("Other",
							fbold));
					maincell111.disableBorderSide(rec.TOP);
					maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell111);

					PdfPCell maincellmed = new PdfPCell(new Phrase("Med Ded",
							fbold));
					maincellmed.disableBorderSide(rec.TOP);
					maincellmed.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincellmed);

					PdfPCell maincellERP = new PdfPCell(
							new Phrase("ERP", fbold));
					maincellERP.disableBorderSide(rec.TOP);
					maincellERP.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincellERP);
					/*
					 * PdfPCell maincell1111 = new PdfPCell(new
					 * Phrase("",fbold));
					 * maincell1111.disableBorderSide(rec.TOP);
					 * maincell1111.setFixedHeight(50);
					 * datatab.addCell(maincell1111);
					 */

					PdfPCell maincell14 = new PdfPCell(new Phrase("Tot Ded",
							fbold));
					maincell14.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell14);

					PdfPCell maincell15 = new PdfPCell(new Phrase("Net Pay",
							fbold));
					maincell15.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell15);
					
					/*-----------------Prasad------------------------*/
					PdfPCell maincell16 = new PdfPCell(new Phrase("", fbold));
					maincell16.disableBorderSide(rec.TOP);
					maincell16.setFixedHeight(50);
					datatab.addCell(maincell16);

					document.add(datatab);

					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						System.out.println("this is pbrcd...." + pBrcd1);
						float pageHeight = writer.getPageSize().getHeight();

						/*
						 * if(pageHeight-70 == 3370 ){
						 * 
						 * }
						 */

						/*datatab = new PdfPTable(18);
						datatab.setWidthPercentage(
								new float[] { 4, 15.5f, 5.3f, 5.3f, 4.5f, 5.3f,
										5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
										5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f },
								rec);*/
						
						/*-------------------Prasad-------------------------*/
						datatab = new PdfPTable(19);
						datatab.setWidthPercentage(
								new float[] { 4, 13.5f, 5.3f, 
										5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 
										4.8f, 4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f },
								rec);
						
					
						
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						cell1.setFixedHeight(50);
						cell1.disableBorderSide(rec.BOTTOM);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f));
						cell2.disableBorderSide(rec.BOTTOM);
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell4 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell4);

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell11 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell11);

						medical_total = medical_total + rs.getFloat("medical");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell8 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell8);

						edu_total = edu_total + rs.getFloat("education");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						minins_total = minins_total + rs.getFloat("min_ins");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell7 = new PdfPCell(new Phrase(""
									+ rs.getFloat("splall"), f1));
							cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell7);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell7 = new PdfPCell(new Phrase(""
									+ splall1, f1));
							cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell7);
						}

						if (rs.getFloat("er1") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ rs.getFloat("er1"), f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						} else {
							float addless = rs.getFloat("er1");
							addlss_total = addlss_total + addless;
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("er2") == 0.0) {
							PdfPCell cell12 = new PdfPCell(new Phrase(""
									+ rs.getFloat("er2"), f1));
							cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell12);
						} else {
							float spcl = rs.getFloat("er2");
							special_total = special_total + spcl;
							PdfPCell cell12 = new PdfPCell(new Phrase(
									"" + spcl, f1));
							cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell12);
						}

						/*
						 * if (rs.getFloat("addinc") == 0.0) { PdfPCell cell23 =
						 * new PdfPCell(new Phrase("", f1));
						 * datatab.addCell(cell23); } else { float add_inc =
						 * rs.getFloat("addinc"); addinc_total = addinc_total +
						 * add_inc;
						 * System.out.println("Emp Bonus is:- "+addinc_total);
						 * PdfPCell cell23 = new PdfPCell(new Phrase("" +
						 * add_inc, f1));
						 * cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell23); }
						 */
						float add_inc = rs.getFloat("addinc");
						addinc_total = addinc_total + add_inc;
						System.out.println("Emp Bonus is:- " + addinc_total);
						PdfPCell cell23 = new PdfPCell(new Phrase(""
								+ (int) add_inc + ".0", f1));
						cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell23);

						leave_TC = leave_TC + rs.getFloat("leavetc");
						PdfPCell cell611 = new PdfPCell(new Phrase(""
								+ rs.getFloat("leavetc"), f1));
						cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell611);

						/*
						 * any_total = any_total + rs.getFloat("ANY"); PdfPCell
						 * cell6111 = new PdfPCell(new
						 * Phrase(""+rs.getFloat("ANY"),f1));
						 * cell6111.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell6111);
						 */
						PdfPCell cell2226 = new PdfPCell(new Phrase("", f1));
						cell2226.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2226);

						PdfPCell cell2227 = new PdfPCell(new Phrase("", f1));
						cell2227.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2227);

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell25 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("totear") + ".0", f1));
						cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell25);

						PdfPCell cell2228 = new PdfPCell(new Phrase("", f1));
						cell2228.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2228);
						
						/*--------Prasad-------------*/
						/*PdfPCell cell2229 = new PdfPCell(new Phrase(""
								+ rs.getString("STATUS"), f));
						cell2229.disableBorderSide(rec.BOTTOM);
						cell2229.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2229);*/

						
						if (rs.getString("DOL")!=null) {
							PdfPCell cell2229 = new PdfPCell(new Phrase("Non Active", f));
							cell2229.disableBorderSide(rec.BOTTOM);
							cell2229.setHorizontalAlignment(Element.ALIGN_CENTER);
							datatab.addCell(cell2229);
						} else {
							PdfPCell cell2229 = new PdfPCell(new Phrase("Active", f));
							cell2229.disableBorderSide(rec.BOTTOM);
							cell2229.setHorizontalAlignment(Element.ALIGN_CENTER);
							datatab.addCell(cell2229);
						}
						
						
						
						document.add(datatab);

						/*datatab = new PdfPTable(18);
						datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
						datatab.setWidthPercentage(
								new float[] { 4, 15.5f, 5.3f, 5.3f, 4.5f, 5.3f,
										5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
										5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f },
								rec);*/
						
						/*-----------------Prasad----------------------------*/
						datatab = new PdfPTable(19);
						datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
						datatab.setWidthPercentage(
								new float[] { 4, 13.5f, 5.3f, 
										5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 
										4.8f, 4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f  },
								rec);
						
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
						cell113.setFixedHeight(50);
						cell113.disableBorderSide(rec.TOP);
						datatab.addCell(cell113);

						PdfPCell cell213 = new PdfPCell(new Phrase("", f1));
						cell213.disableBorderSide(rec.TOP);
						datatab.addCell(cell213);

						if (rs.getFloat("pf") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase(""
									+ rs.getFloat("pf"), f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						} else {
							float pf = rs.getFloat("pf");
							pf_total = pf_total + pf;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + pf,
									f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						if (rs.getFloat("esic") == 0.0f) {
							PdfPCell cell17 = new PdfPCell(new Phrase(""
									+ rs.getFloat("esic"), f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						} else {
							float esic = rs.getFloat("esic");
							esic_total = esic_total + esic;
							PdfPCell cell17 = new PdfPCell(new Phrase(
									"" + esic, f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						}

						if (rs.getFloat("pt") == 0.0) {
							PdfPCell cell14 = new PdfPCell(new Phrase(""
									+ rs.getFloat("pt"), f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						} else {
							float pt = rs.getFloat("pt");
							pt_total = pt_total + pt;
							PdfPCell cell14 = new PdfPCell(new Phrase("" + pt,
									f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						}

						if (rs.getFloat("tds") == 0.0f) {
							PdfPCell cell22 = new PdfPCell(new Phrase(""
									+ rs.getFloat("tds"), f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						} else {
							float tds = rs.getFloat("tds");
							tds_total = tds_total + tds;
							PdfPCell cell22 = new PdfPCell(new Phrase("" + tds,
									f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						}

						if (rs.getFloat("adv") == 0.0f) {
							PdfPCell cell19 = new PdfPCell(new Phrase(""
									+ rs.getFloat("adv"), f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						} else {
							float adv = rs.getFloat("adv");
							adv_total = adv_total + adv;
							PdfPCell cell19 = new PdfPCell(new Phrase("" + adv,
									f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						}

						if (rs.getFloat("loan") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase(""
									+ rs.getFloat("loan"), f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						} else {
							float loan = rs.getFloat("loan");
							loan_total = loan_total + loan;
							PdfPCell cell16 = new PdfPCell(new Phrase(
									"" + loan, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						if (rs.getFloat("mob") == 0.0f) {
							PdfPCell cell18 = new PdfPCell(new Phrase(""
									+ rs.getFloat("mob"), f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						} else {
							float mob = rs.getFloat("mob");
							mob_total = mob_total + mob;
							PdfPCell cell18 = new PdfPCell(new Phrase("" + mob,
									f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						}

						if (rs.getFloat("netc") == 0.0f) {
							PdfPCell cell21 = new PdfPCell(new Phrase(""
									+ rs.getFloat("netc"), f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						} else {
							float netc = rs.getFloat("netc");
							netc_total = netc_total + netc;
							PdfPCell cell21 = new PdfPCell(new Phrase(
									"" + netc, f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						}

						if (rs.getFloat("CurrAdv") == 0.0) {
							PdfPCell cell15 = new PdfPCell(new Phrase(""
									+ rs.getFloat("CurrAdv"), f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						} else {
							float lic = rs.getFloat("CurrAdv");
							lic_total = lic_total + lic;
							PdfPCell cell15 = new PdfPCell(new Phrase("" + lic,
									f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						}

						if (rs.getFloat("relif") == 0.0f) {
							PdfPCell cell20 = new PdfPCell(new Phrase(""
									+ rs.getFloat("relif"), f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						} else {
							float relif = rs.getFloat("relif");
							relif_total = relif_total + relif;
							PdfPCell cell20 = new PdfPCell(new Phrase(""
									+ relif, f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						}

						if (rs.getFloat("mlwf") == 0.0) {
							PdfPCell cell24 = new PdfPCell(new Phrase(""
									+ rs.getFloat("mlwf"), f1));
							cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell24);
						} else {
							float mlwf_ded = rs.getFloat("mlwf");
							mlwf_total = mlwf_total + mlwf_ded;
							PdfPCell cell24 = new PdfPCell(new Phrase(""
									+ mlwf_ded, f1));
							cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell24);
						}

						other_total = other_total + rs.getFloat("other");
						PdfPCell cell2131 = new PdfPCell(new Phrase(""
								+ rs.getFloat("other"), f1));
						cell2131.disableBorderSide(rec.TOP);
						cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2131);

						/* for medical Insurance & ERP */
						if (rs.getFloat("med") == 0.0) {
							PdfPCell cellmed = new PdfPCell(new Phrase(""
									+ rs.getFloat("med"), f1));
							cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellmed);
						} else {
							float med_ded = rs.getFloat("med");
							med_total = med_total + med_ded;
							PdfPCell cellmed = new PdfPCell(new Phrase(""
									+ med_ded, f1));
							cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellmed);
						}

						if (rs.getFloat("erp") == 0.0) {
							PdfPCell cellERP = new PdfPCell(new Phrase(""
									+ rs.getFloat("erp"), f1));
							cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellERP);
						} else {
							float ERP_ded = rs.getFloat("erp");
							ERP_total = ERP_total + ERP_ded;
							PdfPCell cellERP = new PdfPCell(new Phrase(""
									+ ERP_ded, f1));
							cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellERP);
						}

						/*
						 * PdfPCell cell21311 = new PdfPCell(new Phrase("",f1));
						 * cell21311.disableBorderSide(rec.TOP);
						 * datatab.addCell(cell21311);
						 */

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell26 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("totded") + ".0", f1));
						cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell26);

						netpay_total = totinc_total - totded_total;
						// netpay_total = netpay_total + rs.getFloat("payable");
						System.out.println("Net Pay Total Old is:- "
								+ netpay_total);
						// System.out.println("Add Income is:- "+rs.getFloat("addinc"));
						PdfPCell cell27 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("payable") + ".0", f1));
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell27);
						
						/*-----------------Prasad-------------------*/
						PdfPCell cell28 = new PdfPCell(new Phrase("", f1));
						cell28.disableBorderSide(rec.TOP);
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell28);

						document.add(datatab);

						// Total of columns ...............

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					/*datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);*/
					
					/*-----------------Prasad-------------------------*/
					datatot = new PdfPTable(19);
					datatot.setWidthPercentage(new float[] {4, 13.5f, 5.3f, 
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 
							4.8f, 4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f }, rec);

					
					
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total Income:--",
							fbold));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstconvall_total = lstconvall_total + convall_total;
					convall_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase("" + minins_total,
							f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstsplall_total = lstsplall_total + splall_total;
					splall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(""
							+ special_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstspecial_total = lstspecial_total + special_total;
					special_total = 0.0f;

					PdfPCell cell23 = new PdfPCell(new Phrase(""
							+ (int) addinc_total + ".0", f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell23);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell61 = new PdfPCell(
							new Phrase("" + leave_TC, f1));
					cell61.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell61);
					lstleave_total = lstleave_total + leave_TC;
					leave_TC = 0.0f;

					/*
					 * PdfPCell cell611 = new PdfPCell(new
					 * Phrase(""+any_total,f1));
					 * cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell611); lstany_total = lstany_total
					 * +any_total; any_total = 0.0f;
					 */

					PdfPCell cellempty1 = new PdfPCell(new Phrase("", fbold));
					cellempty1.setFixedHeight(50);
					cellempty1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty1);

					PdfPCell cellempty2 = new PdfPCell(new Phrase("", fbold));
					cellempty2.setFixedHeight(50);
					cellempty2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty2);

					PdfPCell cell25 = new PdfPCell(new Phrase(""
							+ (int) totinc_total + ".0", fbold));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);
					System.out
							.println("~~~~~~~~before adding sitewise income~~~~~~~~~"
									+ lsttotinc_total);
					lsttotinc_total = lsttotinc_total + totinc_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ totinc_total);
					System.out
							.println("~~~~~~~~after adding sitewise income~~~~~~~~~"
									+ lsttotinc_total);

					totinc_total = 0.0f;

					PdfPCell cell28 = new PdfPCell(new Phrase("Net Pay", fbold));
					cell28.setFixedHeight(50);
					cell28.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell28);
					
					PdfPCell cell29 = new PdfPCell(new Phrase("",
							fbold));
					cell29.setColspan(2);
					cell29.setFixedHeight(50);
					cell29.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell29);

					document.add(datatot);

					// total second row....
					/*datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);*/
					
					datatot = new PdfPTable(19);
					datatot.setWidthPercentage(new float[] { 4, 13.5f, 5.3f, 
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 
							4.8f, 4.3f, 5.3f, 4.3f, 3.8f, 4.8f, 4.8f, 5.0f  }, rec);
					

					
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell0 = new PdfPCell(new Phrase(
							"Total Deduction:--", fbold));
					cell0.setColspan(2);
					cell0.setFixedHeight(50);
					cell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell0);

					PdfPCell cell13 = new PdfPCell(
							new Phrase("" + pf_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstpf_total = lstpf_total + pf_total;
					pf_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase("" + esic_total,
							f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lstesic_total = lstesic_total + esic_total;
					esic_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(
							new Phrase("" + pt_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstpt_total = lstpt_total + pt_total;
					pt_total = 0.0f;

					PdfPCell cell20 = new PdfPCell(new Phrase("" + tds_total,
							f1));
					cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell20);
					lsttds_total = lsttds_total + tds_total;
					tds_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase("" + adv_total,
							f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstadv_total = lstadv_total + adv_total;
					adv_total = 0.0f;

					PdfPCell cell16 = new PdfPCell(new Phrase("" + loan_total,
							f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstloan_total = lstloan_total + loan_total;
					loan_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase("" + mob_total,
							f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lstmob_total = lstmob_total + mob_total;
					mob_total = 0.0f;

					PdfPCell cell22 = new PdfPCell(new Phrase("" + netc_total,
							f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell22);
					lstnetc_total = lstnetc_total + netc_total;
					netc_total = 0.0f;

					PdfPCell cell15 = new PdfPCell(new Phrase("" + lic_total,
							f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstlic_total = lstlic_total + lic_total;
					lic_total = 0.0f;

					PdfPCell cell21 = new PdfPCell(new Phrase("" + relif_total,
							f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell21);
					lstrelif_total = lstrelif_total + relif_total;
					relif_total = 0.0f;

					PdfPCell cell24 = new PdfPCell(new Phrase("" + mlwf_total,
							f1));
					cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell24);
					lstmlwf_total = lstmlwf_total + mlwf_total;
					mlwf_total = 0.0f;

					PdfPCell cell131 = new PdfPCell(new Phrase(
							"" + other_total, f1));
					cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell131);
					lstother_total = lstother_total + other_total;
					other_total = 0.0f;

					/*
					 * for total deducton of MED & ERP NEW @.....
					 */
					PdfPCell cellmedded = new PdfPCell(new Phrase(""
							+ med_total, f1));
					cellmedded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellmedded);
					istotmed_total = istotmed_total + med_total;
					med_total = 0.0f;

					PdfPCell cellerpded = new PdfPCell(new Phrase(""
							+ ERP_total, f1));
					cellerpded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellerpded);
					istotERPDED_total = istotERPDED_total + ERP_total;
					ERP_total = 0.0f;

					/*
					 * PdfPCell cell1311 = new PdfPCell(new Phrase("",f1));
					 * cell1311.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell1311);
					 */

					PdfPCell cell26 = new PdfPCell(new Phrase(
							"" + totded_total, fbold));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ totded_total);

					totded_total = 0.0f;

					PdfPCell cell27 = new PdfPCell(new Phrase(""
							+ (int) netpay_total + ".0", fbold));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ netpay_total);

					netpay_total = 0.0f;
					
					PdfPCell cell229 = new PdfPCell(new Phrase("", fbold));
					cell229.setColspan(2);
					cell229.setFixedHeight(50);
					cell229.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell229);

					document.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(20);
					document.add(para);

				}

				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(
						Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 9, 9, 9, 9, 9, 9, 9, 9,
						9, 9 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" H.R.A Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsthra_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Col Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstcol_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Medical Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" LTA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstleave_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Education Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstedu_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Min Ins. Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Spl All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Earn 1 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Earn 2 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstspecial_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
				maincell.setFixedHeight(50);
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase(" ANONYMOUS Total:-",f));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstany_total), "", "", false,
				 * false),f2)); maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 */
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" P.F Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" E.S.I.C Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstesic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" P.T Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpt_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" T.D.S Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsttds_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Advance Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstadv_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Loan Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstloan_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Mobile Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstmob_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Net Chrgs Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Current Advance Total:-",
						f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstlic_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Relief Fund Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstrelif_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstmlwf_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Other :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstother_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				// for MED & ERP total summery
				maincell = new PdfPCell(new Phrase("MED DED :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (istotmed_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("ERP  :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (istotERPDED_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				// empty col
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(" Tot income Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				float tttt = 0;
				ResultSet rsss;
				try {
					// System.out.println("date===="+date);
					Statement sttt = con.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT) + "'  and trncd=999 ");

					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (tttt), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("",fbold));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("",fbold));
				 * maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 */

				document.add(main);

				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);

				para = new Paragraph(
						new Phrase(
								"Prepared By                         Checked By                        Approved By                 ",
								new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(30);
				document.add(para);

				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();

			}

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	
	/****************************************************Prasad Start*************************************************************************/
	
	public static void newpayregwithNewFormatPF(String PAYREGDT, String imgpath,
			String filepath, String type,String reptype) {
		

		String hname="";
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant Properties " + e);
		}
		
		if(reptype.equalsIgnoreCase("paytran"))
		{
			hname="Pre-Finalize";
		}
		else if(reptype.equalsIgnoreCase("paytran_stage"))
		{
			hname="Finalize";
		}
		else
		{
			hname="Release";
		}
		System.out.println("in new pay regdao..........aniket");
		System.out.println("in new pay regdao");
		System.out.println("type selected...." + type);
		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);

		BomDt = ReportDAO.BOM(PAYREGDT);
		EomDt = ReportDAO.EOM(PAYREGDT);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {
			if (type.equalsIgnoreCase("G")) {
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement();

				Document doc = new Document(new Rectangle(900, 500));

				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer ftr = dao.new Footer(lable1);
				writer.setPageEvent(ftr);
				doc.open();

				Font FONT = new Font(Font.HELVETICA, 30, Font.NORMAL,
						new GrayColor(0.75f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 450f,
						230, 45);

				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 8, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);

				image1.scaleAbsolute(90f, 50f);
				image1.setAbsolutePosition(50f, 405f);

				doc.add(image1);
				doc.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 8)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 8);
				Font f1 = new Font(Font.HELVETICA, 7);

				para = new Paragraph(new Phrase(
						"Salary Sheet For The Month Of :- " + temp, new Font(
								Font.TIMES_ROMAN, 10)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Rectangle rec = new Rectangle(650, 100);

				PdfPTable main = new PdfPTable(11);
				main.setSpacingBefore(10);
				// main.setWidthPercentage(new
				// float[]{35,57,40,30,23,20,25,25,25,30,25,20,20,30,30,30,30,170},
				// rec);
				main.setWidthPercentage(new float[] { 30, 99, 59, 59, 59, 59,
						59, 59, 49, 49, 60 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Emp code", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Emp Name", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("C.T.C", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("L.O.P Days", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 1", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earning 2", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Mobile Deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Advance Given", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Loan", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("TDS", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("NET PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				main.setHeaderRows(1);

				// EmpSql =
				// "select distinct p.empno,e.empcode from "+table_name+" p right join EMPMAST e on e.EMPNO = p.EMPNO where TRNDT BETWEEN '"
				// + BomDt + "' AND '" + EomDt + "' order by p.EMPNO";
				EmpSql = "select distinct p.empno,CONVERT(INT, e.empcode) as empcode,t.PRJ_SRNO,t.PRJ_CODE from paytran p right join EMPMAST e on e.EMPNO = p.EMPNO join EMPTRAN t on p.EMPNO = t.EMPNO where TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' and e.STATUS = 'A'"
						+ "and T.EFFDATE = (SELECT E2.EFFDATE FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "' and E2.srno=(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = e.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "')) order by t.PRJ_CODE,empcode";
				System.out.println(EmpSql);
				emp = st.executeQuery(EmpSql);

				List<Integer> results = new ArrayList<Integer>();

				while (emp.next()) {

					results.add(emp.getInt("empno"));
					// System.out.println(emp.getInt("empno"));
				}

				for (int empp : results) {

					EmpSql = "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from  paytran  where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from  paytran  where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from  paytran  where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from  paytran  where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from  paytran  where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from  paytran  where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from  paytran  where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from  paytran  where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from  paytran  where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t,paytran p1  where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ "  and p1.trndt  BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and p1.empno="
							+ empp
							+ " "
							+ "  UNION  "
							+ "select empmast.EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as  name, doj,t.PRJ_CODE,t.PRJ_SRNO, "
							+ "(select inp_AMT from   paytran_stage   where trncd = 199 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") ctc, "
							+ "(select cal_amt from   paytran_stage   where trncd = 301 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") abs_cnt,"
							+ "(select net_amt as earning1 from   paytran_stage   where trncd = 130 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ") earning1,"
							+ "(select net_amt as earning2 from   paytran_stage   where trncd = 131 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")earning2,"
							+ "(select net_amt as mobded from   paytran_stage   where trncd = 223 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")mobded,"
							+ "(select net_amt as added from   paytran_stage   where trncd = 225 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")added,"
							+ "(select net_amt as loan from   paytran_stage   where trncd = 227 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")loan,"
							+ "(select net_amt as tds from   paytran_stage   where trncd = 228 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")tds,"
							+ "(select net_amt as payable from   paytran_stage   where trncd = 999 and TRNDT BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt
							+ "' and empno="
							+ empp
							+ ")payable "
							+ "from empmast,EMPTRAN t ,paytran_stage p1 where empmast.empno="
							+ empp
							+ " and t.empno = "
							+ empp
							+ " and p1.trndt   BETWEEN '"
							+ BomDt
							+ "'and '"
							+ EomDt + "' and p1.empno=" + empp + "";
					System.out.println("newpayregwithNewFormatPF : "+EmpSql);
					// System.out.println(empp);
					emp = st.executeQuery(EmpSql);

					while (emp.next()) {
						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("empcode"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						maincell = new PdfPCell(new Phrase(""
								+ emp.getString("name"), f));
						maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
						main.addCell(maincell);

						float mthsal = 0.0f;
						float absent = 0.0f;

						mthsal = emp.getFloat("ctc");
						if (mthsal == 0) {
							mthsal = 0;

						} else {

							totmthsal1 = totmthsal1 + mthsal;
						}
						// ctc
						maincell = new PdfPCell(new Phrase("" + mthsal, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						absent = emp.getFloat("abs_cnt");
						// L.O.P days
						maincell = new PdfPCell(new Phrase("" + absent, f));
						maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
						main.addCell(maincell);

						float ear1 = 0.0f;
						ear1 = emp.getFloat("earning1");
						if (ear1 == 0.0) {
							ear1 = 0;

						} else {
							// earning1 = ear1;
							totearning1 = totearning1 + ear1;
						}

						// earning 1
						maincell = new PdfPCell(new Phrase("" + ear1, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float ear2 = 0.0f;

						ear2 = emp.getFloat("earning2");
						if (ear2 == 0.0) {
							ear2 = 0;

						} else {

							totearning2 = totearning2 + ear2;
						}

						// earning 2
						maincell = new PdfPCell(new Phrase("" + ear2, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float mobded = 0.0f;

						mobded = emp.getFloat("mobded");
						if (mobded == 0.0) {
							mobded = 0;

						} else {

							totmobded = totmobded + mobded;
						}

						// mobile ded
						maincell = new PdfPCell(new Phrase("" + mobded, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float advanc = 0.0f;

						advanc = emp.getFloat("added");
						if (advanc == 0.0) {
							advanc = 0;

						} else {

							totadvanc = totadvanc + advanc;
						}

						// advance given
						maincell = new PdfPCell(new Phrase("" + advanc, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float loan = 0.0f;
						/*
						 * EmpSql="select net_amt as loan from "+table_name+
						 * " where trncd = 227 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ loan =
						 * emp.getFloat("loan");
						 * 
						 * //System.out.println("loan "+emp.getString("loan"));
						 * }
						 */
						loan = emp.getFloat("loan");
						if (loan == 0.0) {
							loan = 0;

						} else {

							totloan = totloan + loan;
						}

						// loan
						maincell = new PdfPCell(new Phrase("" + loan, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						float tds = 0.0f;
						/*
						 * EmpSql="select net_amt as tds from "+table_name+
						 * " where trncd = 228 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp;
						 * //System.out.println(EmpSql); emp =
						 * st.executeQuery(EmpSql); while(emp.next()){ tds =
						 * emp.getFloat("tds");
						 * 
						 * //System.out.println("tds "+emp.getString("tds")); }
						 */
						tds = emp.getFloat("tds");
						if (tds == 0.0) {
							tds = 0;

						} else {

							tottds = tottds + tds;
						}

						// tds
						maincell = new PdfPCell(new Phrase("" + tds, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

						int payable = 0;
						/*
						 * EmpSql="select net_amt as payable from "+table_name+
						 * " where trncd = 999 and TRNDT BETWEEN '"
						 * +BomDt+"'and '"+EomDt+"' and empno="+empp; emp =
						 * st.executeQuery(EmpSql);
						 * //System.out.println(""+EmpSql); while(emp.next()){
						 * payable = emp.getInt("payable");
						 * 
						 * //System.out.println("payable "+emp.getString("payable"
						 * )); }
						 */
						payable = emp.getInt("payable");
						if (payable == 0) {
							payable = 0;
						} else {

							totactualpay = totactualpay + payable;

						}
						// actual pay
						maincell = new PdfPCell(new Phrase("" + payable, f));
						maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
						main.addCell(maincell);

					}

				}

				NumberFormat format = com.ibm.icu.text.NumberFormat
						.getCurrencyInstance(new Locale("en", "in"));
				String totpay = format.format(totmthsal1).substring(4);
				String eard1 = format.format(totearning1).substring(4);
				String eard2 = format.format(totearning2).substring(4);
				String totnetpay = format.format(totactualpay).substring(4);
				String tomobded = format.format(totmobded).substring(4);
				String toadv = format.format(totadvanc).substring(4);
				String toloan = format.format(totloan).substring(4);
				String totds = format.format(tottds).substring(4);

				maincell = new PdfPCell(new Phrase("TOTAL PAY", f));
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				maincell.setColspan(2);
				main.addCell(maincell);
				// totctc
				maincell = new PdfPCell(new Phrase("" + totpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totlop
				maincell = new PdfPCell(new Phrase("", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear1
				maincell = new PdfPCell(new Phrase("" + eard1, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totear2
				maincell = new PdfPCell(new Phrase("" + eard2, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totmobileded
				maincell = new PdfPCell(new Phrase("" + tomobded, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totadvancegiven
				maincell = new PdfPCell(new Phrase("" + toadv, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totloan
				maincell = new PdfPCell(new Phrase("" + toloan, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// tottds
				maincell = new PdfPCell(new Phrase("" + totds, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				// totnetpay
				maincell = new PdfPCell(new Phrase("" + totnetpay, f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);
				doc.add(main);
				st.close();
				con.close();
				doc.close();
			}

			else if (type.equals("I")) {

				System.out.println("hello am in IIIIIIIIII");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);

				System.out.println("in income head");
				Document doc = new Document(new Rectangle(2384, 3370));
				PdfWriter writer = PdfWriter.getInstance(doc,
						new FileOutputStream(filepath));
				Footer1 ftr = dao.new Footer1(lable1);
				writer.setPageEvent(ftr);
				doc.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f,
						1830f, 45);
				Image image1 = Image.getInstance(imgpath);
				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);
				image1.setAbsolutePosition(60f, 3200f);
				doc.add(image1);
				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 28)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				doc.add(para);

				Font f = new Font(Font.HELVETICA, 23);
				Font f1 = new Font(Font.HELVETICA, 20);
				/*
				 * if(TName.equalsIgnoreCase("after")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp,new Font(Font.TIMES_ROMAN,25))); else
				 * if(TName.equalsIgnoreCase("before")) para = new Paragraph(new
				 * Phrase
				 * ("Salary Sheet For The Income Heads for the Month Of :- "
				 * +temp+" (Before Finalize)",new Font(Font.TIMES_ROMAN,25)));
				 * else
				 */para = new Paragraph(new Phrase(
						"Salary Sheet For The Income Heads for the Month Of :- "
								+ temp + " (" + hname + ")", new Font(
								Font.TIMES_ROMAN, 25)));

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				doc.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f;
				float lstbasic_total = 0.0f;
				float currda_total = 0.0f;
				float lstcurrda_total = 0.0f;
				float hra_total = 0.0f;
				float lsthra_total = 0.0f;
				float medical_total = 0.0f;
				float lstmedical_total = 0.0f;
				float edu_total = 0.0f;
				float lstedu_total = 0.0f;
				float splall_total = 0.0f;
				float lstsplall_total = 0.0f;
				float convall_total = 0.0f;
				float lstconvall_total = 0.0f;
				float washingall_total = 0.0f;
				float lstwashingall_total = 0.0f;
				float bonus_total = 0.0f;
				float lstbonus_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;
				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;

				EmpSql = "select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from  PAYTRAN where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from  PAYTRAN where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from  PAYTRAN where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from  PAYTRAN where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ " PAYTRAN p1 on empmast.EMPNO = p1.EMPNO join  PAYTRAN p2 on empmast.EMPNO = p2.EMPNO "
						+ "join  PAYTRAN p3 on empmast.EMPNO = p3.EMPNO "
						+ "join  PAYTRAN p4 on empmast.EMPNO = p4.EMPNO "
						+ "join  PAYTRAN p5 on empmast.EMPNO = p5.EMPNO "
						+ "join  PAYTRAN p6 on empmast.EMPNO = p6.EMPNO "
						+ "join  PAYTRAN p7 on empmast.EMPNO = p7.EMPNO "
						+ "join  PAYTRAN p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT)
						+ "') "
						+

						" UNION  select CONVERT(INT, empmast.empcode) as EMPCODE ,rtrim(empmast.fname)+' '+rtrim(empmast.mname)+' '+rtrim(empmast.lname)as name,empmast.empno,t.PRJ_SRNO,"
						+ "p1.NET_AMT as basic,p2.NET_AMT as payable,p3.NET_AMT as hra,p4.NET_AMT as medical,"
						+ "p5.NET_AMT as education,p6.NET_AMT as convall,p7.NET_AMT as min_ins,"
						+ "p10.NET_AMT as col,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 127 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addless,"
						+
						// "(select net_amt from   paytran_stage  where TRNCD = 129 and trndt BETWEEN '"+BomDt+"'and '"+EomDt+"' and EMPNO = empmast.EMPNO) as special, "
						// +
						"(select net_amt from   paytran_stage  where TRNCD = 107 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as splall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 102 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as curda,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 115 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as washall,"
						+ "(select net_amt from   paytran_stage  where TRNCD = 135 and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as bonusall,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and TRNCD not in(101,103,104,105,108,126,127,128,107,102,115,135) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as addinc,"
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totded, "
						+ "(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198) and trndt BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) as totear "
						+ "from EMPMAST empmast join "
						+ "  paytran_stage  p1 on empmast.EMPNO = p1.EMPNO join   paytran_stage  p2 on empmast.EMPNO = p2.EMPNO "
						+ "join   paytran_stage  p3 on empmast.EMPNO = p3.EMPNO "
						+ "join   paytran_stage  p4 on empmast.EMPNO = p4.EMPNO "
						+ "join   paytran_stage  p5 on empmast.EMPNO = p5.EMPNO "
						+ "join   paytran_stage  p6 on empmast.EMPNO = p6.EMPNO "
						+ "join   paytran_stage  p7 on empmast.EMPNO = p7.EMPNO "
						+ "join   paytran_stage  p10 on empmast.EMPNO = p10.EMPNO "
						+ "join EMPTRAN t on t.EMPNO = empmast.EMPNO where "
						+ "p1.TRNCD = 101 and p1.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p2.TRNCD = 999 and p2.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p3.TRNCD = 103 and p3.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p4.TRNCD = 104 and p4.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p5.TRNCD = 105 and p5.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p6.TRNCD = 108 and p6.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p7.TRNCD = 126 and p7.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+ "and p10.TRNCD = 128 and p10.TRNDT BETWEEN '"
						+ BomDt
						+ "'and '"
						+ EomDt
						+ "' "
						+
						// "and empmast.STATUS = 'A'" +
						" and T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ ReportDAO.EOM(PAYREGDT) + "') " +

						"order by t.PRJ_SRNO,EMPCODE";
				System.out.println(EmpSql);
				ResultSet rs = st.executeQuery(EmpSql);

				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;
					Connection conn = ConnectionManager.getConnectionTech();
					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);
					ResultSet prj = stmt.executeQuery(prjquery);
					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}
					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;
					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);
					doc.add(para);
					prj.close();
					stmt.close();
					conn.close();
					PdfPTable datatab;
					PdfPTable datatot;
					PdfPTable main = new PdfPTable(18);
					main.setSpacingBefore(10);
					main.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5, 5,
							5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f }, rec);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("EMP CODE", f1));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Current D.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Washing All", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Bonus", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Insurance", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add less Amt", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					// maincell = new PdfPCell(new Phrase("Special",f));
					// maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					// main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot deduction", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Net pay", f));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					doc.add(main);
					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						datatab = new PdfPTable(18);
						datatab.setWidthPercentage(new float[] { 3, 12, 5, 5,
								5, 5, 5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
								5.5f, 5.5f, 5.5f, 5.5f }, rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f1));
						cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						if (rs.getFloat("curda") == 0.0) {
							PdfPCell cell4 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell4);
						} else {
							float curda = rs.getFloat("curda");
							currda_total = currda_total + curda;
							PdfPCell cell4 = new PdfPCell(new Phrase(
									"" + curda, f1));
							cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell4);
						}

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						medical_total = medical_total = rs.getFloat("medical");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						edu_total = edu_total = rs.getFloat("education");
						PdfPCell cell7 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell8 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell8);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell8 = new PdfPCell(new Phrase(""
									+ rs.getFloat("splall"), f1));
							cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell8);
						}

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("washall") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell10);
						} else {
							float washing = rs.getFloat("washall");
							washingall_total = washingall_total = rs
									.getFloat("washall");
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ washing, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("bonusall") == 0.0) {
							PdfPCell cell11 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell11);
						} else {
							float bonus = rs.getFloat("bonusall");
							bonus_total = bonus_total + rs.getFloat("bonusall");
							PdfPCell cell11 = new PdfPCell(new Phrase(""
									+ bonus, f1));
							cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell11);
						}

						minins_total = minins_total + +rs.getFloat("min_ins");
						PdfPCell cell12 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);

						if (rs.getFloat("addless") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell13);
						} else {
							float addless = rs.getFloat("addless");
							addlss_total = addlss_total + addless;
							PdfPCell cell13 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell14 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);

						/*
						 * if(rs.getFloat("special")==0.0){ PdfPCell cell15 =
						 * new PdfPCell(new Phrase("",f1));
						 * datatab.addCell(cell15); } else{ float spcl =
						 * rs.getFloat("special"); special_total = special_total
						 * + spcl; PdfPCell cell15 = new PdfPCell(new
						 * Phrase(""+spcl,f1));
						 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell15); }
						 */
						if (rs.getFloat("addinc") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase("", f1));
							datatab.addCell(cell16);
						} else {
							float add_inc = rs.getFloat("addinc");
							addinc_total = addinc_total + add_inc;
							PdfPCell cell16 = new PdfPCell(new Phrase(""
									+ add_inc, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell17 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totear"), f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell18 = new PdfPCell(new Phrase(""
								+ rs.getFloat("totded"), f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);

						netpay_total = netpay_total + rs.getFloat("payable");
						PdfPCell cell19 = new PdfPCell(new Phrase(""
								+ rs.getFloat("payable"), f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);

						doc.add(datatab);

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 3, 12, 5, 5, 5, 5,
							5, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
							5.5f, 5.5f, 5.5f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total:--", f1));
					cell1.setColspan(2);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(new Phrase("" + currda_total,
							f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lstcurrda_total = lstcurrda_total + currda_total;
					currda_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstsplall_total = lstsplall_total = splall_total;
					splall_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstconvall_total = lstconvall_total = convall_total;
					convall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(""
							+ washingall_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstwashingall_total = lstwashingall_total
							+ washingall_total;
					washingall_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + bonus_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstbonus_total = lstbonus_total + bonus_total;
					bonus_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(
							"" + minins_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell13 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					/*
					 * PdfPCell cell15 = new PdfPCell(new
					 * Phrase(""+special_total,f1));
					 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell15); lstspecial_total =
					 * lstspecial_total + special_total ; special_total = 0.0f;
					 */

					PdfPCell cell16 = new PdfPCell(new Phrase(
							"" + addinc_total, f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase(
							"" + totinc_total, f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lsttotinc_total = lsttotinc_total + totinc_total;
					totinc_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase(
							"" + totded_total, f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lsttotded_total = lsttotded_total + totded_total;
					totded_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase(
							"" + netpay_total, f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstnetpay_total = lstnetpay_total + netpay_total;
					netpay_total = 0.0f;

					doc.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(10);
					doc.add(para);

				}
				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(10);
				doc.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				PdfPTable main = new PdfPTable(18);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 5, 6, 5, 5.5f, 5.5f,
						5.5f, 5, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f, 5.5f,
						5.5f, 6, 6, 6 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("Summury", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Current D.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Washing All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Officiating All", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Insurance", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add less Amt", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("Special",f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("Add income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot deduction", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Net pay", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Gross Total:--", f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setColspan(2);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcurrda_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsthra_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstedu_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstwashingall_total), "", "", false,
								false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbonus_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstcol_total), "", "", false, false), f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstspecial_total), "", "", false,
				 * false),f));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetpay_total), "", "", false, false),
						f));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				doc.add(main);

				/*
				 * System.out.println("last basic = "+lstbasic_total);
				 * System.out.println("last current da = "+lstcurrda_total);
				 * System.out.println("last hra = "+lsthra_total);
				 * System.out.println("last medical = "+lstmedical_total);
				 * System.out.println("last education = "+lstedu_total);
				 * System.out.println("last splall = "+lstsplall_total);
				 * System.out.println("last convall = "+lstconvall_total);
				 * System.out.println("last washing = "+lstwashingall_total);
				 * System.out.println("last bonus = "+lstbonus_total);
				 * System.out.println("last minins = "+lstminins_total);
				 * System.out.println("last addless = "+lstaddlss_total);
				 * System.out.println("last col = "+lstcol_total);
				 * //System.out.println("last special = "+lstspecial_total);
				 * System.out.println("last addinc = "+lstaddinc_total);
				 * System.out.println("last totinc = "+lsttotinc_total);
				 * System.out.println("last totded = "+lsttotded_total);
				 * System.out.println("last totnetpay = "+lstnetpay_total);
				 */

				st.close();
				con.close();
				doc.close();

			}

			else if (type.equals("ID")) {
				System.out.println("hello am in IDDDDD");
				ReportDAO.OpenCon("", "", "", repBean);
				con = repBean.getCn();
				Statement st = con.createStatement(
						ResultSet.TYPE_SCROLL_INSENSITIVE,
						ResultSet.CONCUR_READ_ONLY);
				Statement stmtInsert = con.createStatement();
				Statement stmtTrnct = con.createStatement();

				DottedLineCell app = new DottedLineCell();
				System.out.println("in income & Deduction head");

				// A4 size pdf....
				Document document = new Document(new Rectangle(2384, 3370));
				// Document doc = new Document(new Rectangle(2834,4008));

				document.left(100f);
				document.top(100f);
				document.bottom(100f);
				document.right(100f);

				PdfWriter writer = PdfWriter.getInstance(document,
						new FileOutputStream(filepath));
				HeaderAndFooter haf = new HeaderAndFooter(lable1, label2);
				writer.setPageEvent(haf);
				document.open();
				Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
						new GrayColor(0.85f));
				ColumnText.showTextAligned(writer.getDirectContentUnder(),
						Element.ALIGN_CENTER,
						new Phrase(prop.getProperty("watermark"), FONT), 1300f,
						1830f, 45);
				Image image1 = Image.getInstance(imgpath);

				Phrase title = new Phrase(prop.getProperty("companyName"),
						new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
				Paragraph para = new Paragraph(title);
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingBefore(0);
				image1.scaleAbsolute(310f, 120f);

				// chaange possition of image
				/* image1.setAbsolutePosition(60f, 2750f); */
				image1.setAbsolutePosition(60f, 3200f);
				document.add(image1);
				document.add(para);

				para = new Paragraph(new Phrase(
						prop.getProperty("addressForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("contactForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(0);

				document.add(para);
				para = new Paragraph(new Phrase(
						prop.getProperty("mailForReport"), new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				document.add(para);

				Font f = new Font(Font.HELVETICA, 22);
				Font f1 = new Font(Font.HELVETICA, 22);
				Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
				Font f2 = new Font(Font.HELVETICA, 22);

				para = new Paragraph(new Phrase(
						"Salary Sheet For The Income Heads for the Month Of :- "
								+ temp + " (" + hname + ")", new Font(
								Font.TIMES_ROMAN, 20)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);

				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(30);

				document.add(para);

				Rectangle rec = new Rectangle(100, 100);

				float basic_total = 0.0f, lstbasic_total = 0.0f, lic_total = 0.0f, lstlic_total = 0.0f, hra_total = 0.0f, lsthra_total = 0.0f, medical_total = 0.0f;
				float lstmedical_total = 0.0f;

				float leave_TC = 0.0f, lstleave_total = 0.0f;

				float any_total = 0.0f, lstany_total = 0.0f;

				float edu_total = 0.0f, lstedu_total = 0.0f, splall_total = 0.0f, lstsplall_total = 0.0f, convall_total = 0.0f, lstconvall_total = 0.0f;
				float pf_total = 0.0f, lstpf_total = 0.0f, pt_total = 0.0f, lstpt_total = 0.0f;

				float mlwf_total = 0.0f, lstmlwf_total = 0.0f;
				float other_total = 0.0f, med_total = 0.0f, ERP_total = 0.0f, istotmed_total = 0.0f, istotERPDED_total = 0.0f, lstother_total = 0.0f;

				float esic_total = 0.0f;
				float lstesic_total = 0.0f;
				float mob_total = 0.0f;
				float lstmob_total = 0.0f;
				float adv_total = 0.0f;
				float lstadv_total = 0.0f;
				float tds_total = 0.0f;
				float lsttds_total = 0.0f;
				float relif_total = 0.0f;
				float lstrelif_total = 0.0f;
				float netc_total = 0.0f;
				float lstnetc_total = 0.0f;
				float minins_total = 0.0f;
				float lstminins_total = 0.0f;
				float addlss_total = 0.0f;
				float lstaddlss_total = 0.0f;
				float col_total = 0.0f;
				float lstcol_total = 0.0f;
				float special_total = 0.0f;
				float lstspecial_total = 0.0f;
				float addinc_total = 0.0f;
				float lstaddinc_total = 0.0f;
				float totinc_total = 0.0f;
				float lsttotinc_total = 0.0f;

				float loan_total = 0.0f, lstloan_total = 0.0f;

				// float addded_total = 0.0f;
				// float lstaddded_total = 0.0f;

				float totded_total = 0.0f;
				float lsttotded_total = 0.0f;
				float netpay_total = 0.0f;
				float lstnetpay_total = 0.0f;
				
				if(reptype.equalsIgnoreCase("paytran")){
				EmpSql = "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)   "
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC', "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',           "
						+

						" CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNCD=201 and NET_AMT !=0 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+

						"    UNION "
						+ "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNCD=201 and NET_AMT !=0 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
				      System.out.println(EmpSql);
				}
				
				
				else if(reptype.equalsIgnoreCase("ytdtran")){
				EmpSql =  "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   ytdtran WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   ytdtran WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   ytdtran WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   ytdtran WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   ytdtran WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   ytdtran WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   ytdtran WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   ytdtran WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   ytdtran WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   ytdtran WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   ytdtran WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   ytdtran WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   ytdtran WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   ytdtran WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   ytdtran WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   ytdtran WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   ytdtran WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   ytdtran WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   ytdtran WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   ytdtran WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   ytdtran WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   ytdtran WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   ytdtran WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   ytdtran WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   ytdtran WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   ytdtran WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   ytdtran  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   ytdtran  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM ytdtran WHERE TRNCD=201 and NET_AMT !=0 AND  TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
				     System.out.println(EmpSql);
				}
				
				else if(reptype.equalsIgnoreCase("paytran_stage")){
				EmpSql =  "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
						+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
						+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
						+

						"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
						+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		"
						+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
						+

						"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
						+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
						+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
						+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
						+

						"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
						+

						"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)    			"
						+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
						+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
						+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
						+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
						+

						"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
						+

						"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)	"
						+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
						+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' AND '"
						+ EomDt
						+ "' AND EMPNO = EMPMAST.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
						+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO )"
						+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
						+ "    and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO =  EMPMAST.EMPNO) "
						+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
						+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)	"
						+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
						+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO) "
						+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
						+ "     and trndt BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "' and EMPNO = empmast.EMPNO)"
						+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
						+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
						+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
						+ EomDt
						+ "'"
						+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
						+ EomDt
						+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
						+ BomDt
						+ "' )) )"
						+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNCD=201 and NET_AMT !=0 AND TRNDT BETWEEN '"
						+ BomDt
						+ "' and '"
						+ EomDt
						+ "') "
						+ "     order by   t.PRJ_SRNO,empno  ";
						System.out.println(EmpSql);
					}

				ResultSet rs = st.executeQuery(EmpSql);
				
				while (rs.next()) {

					String prj_name = null;
					String prj_code = null;

					Connection conn = ConnectionManager.getConnectionTech();

					Statement stmt = conn.createStatement();
					String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
							+ rs.getString("PRJ_SRNO") + "'";
					// System.out.println(prjquery);

					ResultSet prj = stmt.executeQuery(prjquery);

					if (prj.next()) {
						prj_name = prj.getString("Site_Name");
						prj_code = prj.getString("Project_Code");
					}

					pBrcd1 = rs.getString("PRJ_SRNO");
					br_tot_no_emp = 0;

					para = new Paragraph(new Phrase(
							"Employee's Salary List For Project Site : "
									+ prj_name + " (" + prj_code + ")", f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(4);

					document.add(para);

					prj.close();
					stmt.close();
					conn.close();

					PdfPTable datatab;
					PdfPTable datatot;

					PdfPTable main = new PdfPTable(18);
					main.setSpacingBefore(10);

					main.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
							4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
							5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
					main.setHorizontalAlignment(Element.ALIGN_LEFT);
					PdfPCell maincell;

					maincell = new PdfPCell(new Phrase("CODE", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.setFixedHeight(50);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					maincell.disableBorderSide(rec.BOTTOM);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Basic", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("H.R.A", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Col", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Medical", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Conv All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Education", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Min Ins.", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Spl All", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 1", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Earn 2", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Add Income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("LTA", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					/*
					 * maincell = new PdfPCell(new Phrase("ANONYMOUS",fbold));
					 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * main.addCell(maincell);
					 */
					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("Tot income", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					maincell = new PdfPCell(new Phrase("", fbold));
					maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
					main.addCell(maincell);

					document.add(main);

					datatab = new PdfPTable(18);
					datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
					maincell1.disableBorderSide(rec.TOP);
					maincell1.setFixedHeight(50);
					// maincell1.setColspan(2);
					datatab.addCell(maincell1);

					PdfPCell maincell2 = new PdfPCell(new Phrase("", fbold));
					maincell2.disableBorderSide(rec.TOP);
					maincell2.setFixedHeight(50);
					datatab.addCell(maincell2);

					PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
					maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell3);

					PdfPCell maincell4 = new PdfPCell(new Phrase("E.S.I.C",
							fbold));
					maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell4);

					PdfPCell maincell5 = new PdfPCell(new Phrase("P.T", fbold));
					maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell5);

					PdfPCell maincell6 = new PdfPCell(
							new Phrase("T.D.S", fbold));
					maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell6);

					PdfPCell maincell7 = new PdfPCell(new Phrase("Advance",
							fbold));
					maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell7);

					PdfPCell maincell8 = new PdfPCell(new Phrase("Loan Ded",
							fbold));
					maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell8);

					PdfPCell maincell9 = new PdfPCell(new Phrase("Mobile Ded",
							fbold));
					maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell9);

					PdfPCell maincell10 = new PdfPCell(new Phrase(
							"Net Charges", fbold));
					maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell10);

					PdfPCell maincell11 = new PdfPCell(new Phrase(
							"Current Advance", fbold));
					maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell11);

					PdfPCell maincell12 = new PdfPCell(new Phrase("Relif",
							fbold));
					maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell12);

					PdfPCell maincell13 = new PdfPCell(
							new Phrase("MLWF", fbold));
					maincell13.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell13);

					PdfPCell maincell111 = new PdfPCell(new Phrase("Other",
							fbold));
					maincell111.disableBorderSide(rec.TOP);
					maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell111);

					PdfPCell maincellmed = new PdfPCell(new Phrase("Med Ded",
							fbold));
					maincellmed.disableBorderSide(rec.TOP);
					maincellmed.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincellmed);

					PdfPCell maincellERP = new PdfPCell(
							new Phrase("ERP", fbold));
					maincellERP.disableBorderSide(rec.TOP);
					maincellERP.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincellERP);
					/*
					 * PdfPCell maincell1111 = new PdfPCell(new
					 * Phrase("",fbold));
					 * maincell1111.disableBorderSide(rec.TOP);
					 * maincell1111.setFixedHeight(50);
					 * datatab.addCell(maincell1111);
					 */

					PdfPCell maincell14 = new PdfPCell(new Phrase("Tot Ded",
							fbold));
					maincell14.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell14);

					PdfPCell maincell15 = new PdfPCell(new Phrase("Net Pay",
							fbold));
					maincell15.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(maincell15);

					document.add(datatab);

					while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						System.out.println("this is pbrcd...." + pBrcd1);
						float pageHeight = writer.getPageSize().getHeight();

						/*
						 * if(pageHeight-70 == 3370 ){
						 * 
						 * }
						 */

						datatab = new PdfPTable(18);
						datatab.setWidthPercentage(
								new float[] { 4, 15.5f, 5.3f, 5.3f, 4.5f, 5.3f,
										5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
										5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f },
								rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell1 = new PdfPCell(new Phrase(""
								+ rs.getString("EMPCODE"), f1));
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						cell1.setFixedHeight(50);
						cell1.disableBorderSide(rec.BOTTOM);

						datatab.addCell(cell1);

						PdfPCell cell2 = new PdfPCell(new Phrase(""
								+ rs.getString("name"), f));
						cell2.disableBorderSide(rec.BOTTOM);
						cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
						datatab.addCell(cell2);

						basic_total = basic_total + rs.getFloat("basic");
						PdfPCell cell3 = new PdfPCell(new Phrase(""
								+ rs.getFloat("basic"), f1));
						cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell3);

						hra_total = hra_total + rs.getFloat("hra");
						PdfPCell cell4 = new PdfPCell(new Phrase(""
								+ rs.getFloat("hra"), f1));
						cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell4);

						col_total = col_total + +rs.getFloat("col");
						PdfPCell cell11 = new PdfPCell(new Phrase(""
								+ rs.getFloat("col"), f1));
						cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell11);

						medical_total = medical_total + rs.getFloat("medical");
						PdfPCell cell5 = new PdfPCell(new Phrase(""
								+ rs.getFloat("medical"), f1));
						cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell5);

						convall_total = convall_total + rs.getFloat("convall");
						PdfPCell cell8 = new PdfPCell(new Phrase(""
								+ rs.getFloat("convall"), f1));
						cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell8);

						edu_total = edu_total + rs.getFloat("education");
						PdfPCell cell6 = new PdfPCell(new Phrase(""
								+ rs.getFloat("education"), f1));
						cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell6);

						minins_total = minins_total + rs.getFloat("min_ins");
						PdfPCell cell9 = new PdfPCell(new Phrase(""
								+ rs.getFloat("min_ins"), f1));
						cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell9);

						if (rs.getFloat("splall") == 0.0) {
							PdfPCell cell7 = new PdfPCell(new Phrase(""
									+ rs.getFloat("splall"), f1));
							cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell7);
						} else {
							float splall1 = rs.getFloat("splall");
							splall_total = splall_total + splall1;
							PdfPCell cell7 = new PdfPCell(new Phrase(""
									+ splall1, f1));
							cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell7);
						}

						if (rs.getFloat("er1") == 0.0) {
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ rs.getFloat("er1"), f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						} else {
							float addless = rs.getFloat("er1");
							addlss_total = addlss_total + addless;
							PdfPCell cell10 = new PdfPCell(new Phrase(""
									+ addless, f1));
							cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell10);
						}

						if (rs.getFloat("er2") == 0.0) {
							PdfPCell cell12 = new PdfPCell(new Phrase(""
									+ rs.getFloat("er2"), f1));
							cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell12);
						} else {
							float spcl = rs.getFloat("er2");
							special_total = special_total + spcl;
							PdfPCell cell12 = new PdfPCell(new Phrase(
									"" + spcl, f1));
							cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell12);
						}

						/*
						 * if (rs.getFloat("addinc") == 0.0) { PdfPCell cell23 =
						 * new PdfPCell(new Phrase("", f1));
						 * datatab.addCell(cell23); } else { float add_inc =
						 * rs.getFloat("addinc"); addinc_total = addinc_total +
						 * add_inc;
						 * System.out.println("Emp Bonus is:- "+addinc_total);
						 * PdfPCell cell23 = new PdfPCell(new Phrase("" +
						 * add_inc, f1));
						 * cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell23); }
						 */
						float add_inc = rs.getFloat("addinc");
						addinc_total = addinc_total + add_inc;
						System.out.println("Emp Bonus is:- " + addinc_total);
						PdfPCell cell23 = new PdfPCell(new Phrase(""
								+ (int) add_inc + ".0", f1));
						cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell23);

						leave_TC = leave_TC + rs.getFloat("leavetc");
						PdfPCell cell611 = new PdfPCell(new Phrase(""
								+ rs.getFloat("leavetc"), f1));
						cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell611);

						/*
						 * any_total = any_total + rs.getFloat("ANY"); PdfPCell
						 * cell6111 = new PdfPCell(new
						 * Phrase(""+rs.getFloat("ANY"),f1));
						 * cell6111.setHorizontalAlignment(Element.ALIGN_RIGHT);
						 * datatab.addCell(cell6111);
						 */
						PdfPCell cell2226 = new PdfPCell(new Phrase("", f1));
						cell2226.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2226);

						PdfPCell cell2227 = new PdfPCell(new Phrase("", f1));
						cell2227.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2227);

						totinc_total = totinc_total + rs.getFloat("totear");
						PdfPCell cell25 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("totear") + ".0", f1));
						cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell25);

						PdfPCell cell2228 = new PdfPCell(new Phrase("", f1));
						cell2228.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2228);

						document.add(datatab);

						datatab = new PdfPTable(18);
						/* datatab.setTableEvent(app.new DottedCells()); */
						datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
						datatab.setWidthPercentage(
								new float[] { 4, 15.5f, 5.3f, 5.3f, 4.5f, 5.3f,
										5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f,
										5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f },
								rec);
						datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

						PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
						cell113.setFixedHeight(50);
						cell113.disableBorderSide(rec.TOP);
						datatab.addCell(cell113);

						PdfPCell cell213 = new PdfPCell(new Phrase("", f1));
						cell213.disableBorderSide(rec.TOP);
						datatab.addCell(cell213);

						if (rs.getFloat("pf") == 0.0) {
							PdfPCell cell13 = new PdfPCell(new Phrase(""
									+ rs.getFloat("pf"), f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						} else {
							float pf = rs.getFloat("pf");
							pf_total = pf_total + pf;
							PdfPCell cell13 = new PdfPCell(new Phrase("" + pf,
									f1));
							cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell13);
						}

						if (rs.getFloat("esic") == 0.0f) {
							PdfPCell cell17 = new PdfPCell(new Phrase(""
									+ rs.getFloat("esic"), f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						} else {
							float esic = rs.getFloat("esic");
							esic_total = esic_total + esic;
							PdfPCell cell17 = new PdfPCell(new Phrase(
									"" + esic, f1));
							cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell17);
						}

						if (rs.getFloat("pt") == 0.0) {
							PdfPCell cell14 = new PdfPCell(new Phrase(""
									+ rs.getFloat("pt"), f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						} else {
							float pt = rs.getFloat("pt");
							pt_total = pt_total + pt;
							PdfPCell cell14 = new PdfPCell(new Phrase("" + pt,
									f1));
							cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell14);
						}

						if (rs.getFloat("tds") == 0.0f) {
							PdfPCell cell22 = new PdfPCell(new Phrase(""
									+ rs.getFloat("tds"), f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						} else {
							float tds = rs.getFloat("tds");
							tds_total = tds_total + tds;
							PdfPCell cell22 = new PdfPCell(new Phrase("" + tds,
									f1));
							cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell22);
						}

						if (rs.getFloat("adv") == 0.0f) {
							PdfPCell cell19 = new PdfPCell(new Phrase(""
									+ rs.getFloat("adv"), f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						} else {
							float adv = rs.getFloat("adv");
							adv_total = adv_total + adv;
							PdfPCell cell19 = new PdfPCell(new Phrase("" + adv,
									f1));
							cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell19);
						}

						if (rs.getFloat("loan") == 0.0) {
							PdfPCell cell16 = new PdfPCell(new Phrase(""
									+ rs.getFloat("loan"), f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						} else {
							float loan = rs.getFloat("loan");
							loan_total = loan_total + loan;
							PdfPCell cell16 = new PdfPCell(new Phrase(
									"" + loan, f1));
							cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell16);
						}

						if (rs.getFloat("mob") == 0.0f) {
							PdfPCell cell18 = new PdfPCell(new Phrase(""
									+ rs.getFloat("mob"), f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						} else {
							float mob = rs.getFloat("mob");
							mob_total = mob_total + mob;
							PdfPCell cell18 = new PdfPCell(new Phrase("" + mob,
									f1));
							cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell18);
						}

						if (rs.getFloat("netc") == 0.0f) {
							PdfPCell cell21 = new PdfPCell(new Phrase(""
									+ rs.getFloat("netc"), f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						} else {
							float netc = rs.getFloat("netc");
							netc_total = netc_total + netc;
							PdfPCell cell21 = new PdfPCell(new Phrase(
									"" + netc, f1));
							cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell21);
						}

						if (rs.getFloat("CurrAdv") == 0.0) {
							PdfPCell cell15 = new PdfPCell(new Phrase(""
									+ rs.getFloat("CurrAdv"), f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						} else {
							float lic = rs.getFloat("CurrAdv");
							lic_total = lic_total + lic;
							PdfPCell cell15 = new PdfPCell(new Phrase("" + lic,
									f1));
							cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell15);
						}

						if (rs.getFloat("relif") == 0.0f) {
							PdfPCell cell20 = new PdfPCell(new Phrase(""
									+ rs.getFloat("relif"), f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						} else {
							float relif = rs.getFloat("relif");
							relif_total = relif_total + relif;
							PdfPCell cell20 = new PdfPCell(new Phrase(""
									+ relif, f1));
							cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell20);
						}

						if (rs.getFloat("mlwf") == 0.0) {
							PdfPCell cell24 = new PdfPCell(new Phrase(""
									+ rs.getFloat("mlwf"), f1));
							cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell24);
						} else {
							float mlwf_ded = rs.getFloat("mlwf");
							mlwf_total = mlwf_total + mlwf_ded;
							PdfPCell cell24 = new PdfPCell(new Phrase(""
									+ mlwf_ded, f1));
							cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cell24);
						}

						other_total = other_total + rs.getFloat("other");
						PdfPCell cell2131 = new PdfPCell(new Phrase(""
								+ rs.getFloat("other"), f1));
						cell2131.disableBorderSide(rec.TOP);
						cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell2131);

						/* for medical Insurance & ERP */
						if (rs.getFloat("med") == 0.0) {
							PdfPCell cellmed = new PdfPCell(new Phrase(""
									+ rs.getFloat("med"), f1));
							cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellmed);
						} else {
							float med_ded = rs.getFloat("med");
							med_total = med_total + med_ded;
							PdfPCell cellmed = new PdfPCell(new Phrase(""
									+ med_ded, f1));
							cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellmed);
						}

						if (rs.getFloat("erp") == 0.0) {
							PdfPCell cellERP = new PdfPCell(new Phrase(""
									+ rs.getFloat("erp"), f1));
							cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellERP);
						} else {
							float ERP_ded = rs.getFloat("erp");
							ERP_total = ERP_total + ERP_ded;
							PdfPCell cellERP = new PdfPCell(new Phrase(""
									+ ERP_ded, f1));
							cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
							datatab.addCell(cellERP);
						}

						/*
						 * PdfPCell cell21311 = new PdfPCell(new Phrase("",f1));
						 * cell21311.disableBorderSide(rec.TOP);
						 * datatab.addCell(cell21311);
						 */

						totded_total = totded_total + rs.getFloat("totded");
						PdfPCell cell26 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("totded") + ".0", f1));
						cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell26);

						netpay_total = totinc_total - totded_total;
						// netpay_total = netpay_total + rs.getFloat("payable");
						System.out.println("Net Pay Total Old is:- "
								+ netpay_total);
						// System.out.println("Add Income is:- "+rs.getFloat("addinc"));
						PdfPCell cell27 = new PdfPCell(new Phrase(""
								+ (int) rs.getFloat("payable") + ".0", f1));
						cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell27);

						document.add(datatab);

						// Total of columns ...............

						tot_no_emp = tot_no_emp + 1;
						br_tot_no_emp = br_tot_no_emp + 1;
						if (!rs.next()) {
							break;
						}
						if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
							rs.previous();
							break;
						}
					}

					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);

					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase("Total Income:--",
							fbold));
					cell1.setColspan(2);
					cell1.setFixedHeight(50);
					cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell1);

					PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total,
							f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell3);
					lstbasic_total = lstbasic_total + basic_total;
					basic_total = 0.0f;

					PdfPCell cell4 = new PdfPCell(
							new Phrase("" + hra_total, f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell4);
					lsthra_total = lsthra_total + hra_total;
					hra_total = 0.0f;

					PdfPCell cell11 = new PdfPCell(new Phrase("" + col_total,
							f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell11);
					lstcol_total = lstcol_total + col_total;
					col_total = 0.0f;

					PdfPCell cell5 = new PdfPCell(new Phrase(
							"" + medical_total, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell5);
					lstmedical_total = lstmedical_total + medical_total;
					medical_total = 0.0f;

					PdfPCell cell8 = new PdfPCell(new Phrase(
							"" + convall_total, f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell8);
					lstconvall_total = lstconvall_total + convall_total;
					convall_total = 0.0f;

					PdfPCell cell6 = new PdfPCell(
							new Phrase("" + edu_total, f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell6);
					lstedu_total = lstedu_total + edu_total;
					edu_total = 0.0f;

					PdfPCell cell9 = new PdfPCell(new Phrase("" + minins_total,
							f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell9);
					lstminins_total = lstminins_total + minins_total;
					minins_total = 0.0f;

					PdfPCell cell7 = new PdfPCell(new Phrase("" + splall_total,
							f1));
					cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell7);
					lstsplall_total = lstsplall_total + splall_total;
					splall_total = 0.0f;

					PdfPCell cell10 = new PdfPCell(new Phrase(
							"" + addlss_total, f1));
					cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell10);
					lstaddlss_total = lstaddlss_total + addlss_total;
					addlss_total = 0.0f;

					PdfPCell cell12 = new PdfPCell(new Phrase(""
							+ special_total, f1));
					cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell12);
					lstspecial_total = lstspecial_total + special_total;
					special_total = 0.0f;

					PdfPCell cell23 = new PdfPCell(new Phrase(""
							+ (int) addinc_total + ".0", f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell23);
					lstaddinc_total = lstaddinc_total + addinc_total;
					addinc_total = 0.0f;

					PdfPCell cell61 = new PdfPCell(
							new Phrase("" + leave_TC, f1));
					cell61.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell61);
					lstleave_total = lstleave_total + leave_TC;
					leave_TC = 0.0f;

					/*
					 * PdfPCell cell611 = new PdfPCell(new
					 * Phrase(""+any_total,f1));
					 * cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell611); lstany_total = lstany_total
					 * +any_total; any_total = 0.0f;
					 */

					PdfPCell cellempty1 = new PdfPCell(new Phrase("", fbold));
					cellempty1.setFixedHeight(50);
					cellempty1.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty1);

					PdfPCell cellempty2 = new PdfPCell(new Phrase("", fbold));
					cellempty2.setFixedHeight(50);
					cellempty2.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellempty2);

					PdfPCell cell25 = new PdfPCell(new Phrase(""
							+ (int) totinc_total + ".0", fbold));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell25);
					System.out
							.println("~~~~~~~~before adding sitewise income~~~~~~~~~"
									+ lsttotinc_total);
					lsttotinc_total = lsttotinc_total + totinc_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ totinc_total);
					System.out
							.println("~~~~~~~~after adding sitewise income~~~~~~~~~"
									+ lsttotinc_total);

					totinc_total = 0.0f;

					PdfPCell cell28 = new PdfPCell(new Phrase("Net Pay", fbold));
					cell28.setFixedHeight(50);
					cell28.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell28);

					document.add(datatot);

					// total second row....
					datatot = new PdfPTable(18);
					datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
					datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell0 = new PdfPCell(new Phrase(
							"Total Deduction:--", fbold));
					cell0.setColspan(2);
					cell0.setFixedHeight(50);
					cell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell0);

					PdfPCell cell13 = new PdfPCell(
							new Phrase("" + pf_total, f1));
					cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell13);
					lstpf_total = lstpf_total + pf_total;
					pf_total = 0.0f;

					PdfPCell cell17 = new PdfPCell(new Phrase("" + esic_total,
							f1));
					cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell17);
					lstesic_total = lstesic_total + esic_total;
					esic_total = 0.0f;

					PdfPCell cell14 = new PdfPCell(
							new Phrase("" + pt_total, f1));
					cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell14);
					lstpt_total = lstpt_total + pt_total;
					pt_total = 0.0f;

					PdfPCell cell20 = new PdfPCell(new Phrase("" + tds_total,
							f1));
					cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell20);
					lsttds_total = lsttds_total + tds_total;
					tds_total = 0.0f;

					PdfPCell cell19 = new PdfPCell(new Phrase("" + adv_total,
							f1));
					cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell19);
					lstadv_total = lstadv_total + adv_total;
					adv_total = 0.0f;

					PdfPCell cell16 = new PdfPCell(new Phrase("" + loan_total,
							f1));
					cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell16);
					lstloan_total = lstloan_total + loan_total;
					loan_total = 0.0f;

					PdfPCell cell18 = new PdfPCell(new Phrase("" + mob_total,
							f1));
					cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell18);
					lstmob_total = lstmob_total + mob_total;
					mob_total = 0.0f;

					PdfPCell cell22 = new PdfPCell(new Phrase("" + netc_total,
							f1));
					cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell22);
					lstnetc_total = lstnetc_total + netc_total;
					netc_total = 0.0f;

					PdfPCell cell15 = new PdfPCell(new Phrase("" + lic_total,
							f1));
					cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell15);
					lstlic_total = lstlic_total + lic_total;
					lic_total = 0.0f;

					PdfPCell cell21 = new PdfPCell(new Phrase("" + relif_total,
							f1));
					cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell21);
					lstrelif_total = lstrelif_total + relif_total;
					relif_total = 0.0f;

					PdfPCell cell24 = new PdfPCell(new Phrase("" + mlwf_total,
							f1));
					cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell24);
					lstmlwf_total = lstmlwf_total + mlwf_total;
					mlwf_total = 0.0f;

					PdfPCell cell131 = new PdfPCell(new Phrase(
							"" + other_total, f1));
					cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell131);
					lstother_total = lstother_total + other_total;
					other_total = 0.0f;

					/*
					 * for total deducton of MED & ERP NEW @.....
					 */
					PdfPCell cellmedded = new PdfPCell(new Phrase(""
							+ med_total, f1));
					cellmedded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellmedded);
					istotmed_total = istotmed_total + med_total;
					med_total = 0.0f;

					PdfPCell cellerpded = new PdfPCell(new Phrase(""
							+ ERP_total, f1));
					cellerpded.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cellerpded);
					istotERPDED_total = istotERPDED_total + ERP_total;
					ERP_total = 0.0f;

					/*
					 * PdfPCell cell1311 = new PdfPCell(new Phrase("",f1));
					 * cell1311.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatot.addCell(cell1311);
					 */

					PdfPCell cell26 = new PdfPCell(new Phrase(
							"" + totded_total, fbold));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell26);
					lsttotded_total = lsttotded_total + totded_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ totded_total);

					totded_total = 0.0f;

					PdfPCell cell27 = new PdfPCell(new Phrase(""
							+ (int) netpay_total + ".0", fbold));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatot.addCell(cell27);
					lstnetpay_total = lstnetpay_total + netpay_total;
					System.out.println("@@@@@@@@@@@@@@@BRANCH ID--------->"
							+ prj_name + "#####TOTAL INCOME------>"
							+ netpay_total);

					netpay_total = 0.0f;

					document.add(datatot);

					para = new Paragraph(new Phrase("No Of Employee :- "
							+ br_tot_no_emp, f));
					para.setAlignment(Element.ALIGN_LEFT);
					para.setSpacingAfter(20);
					document.add(para);

				}

				para = new Paragraph(new Phrase("Total No Of Employee :- "
						+ tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(40);
				document.add(para);

				System.out.println("Total No Of Employee :- " + tot_no_emp);

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(
						Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				document.add(para);

				PdfPTable main = new PdfPTable(10);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 9, 9, 9, 9, 9, 9, 9, 9,
						9, 9 }, rec);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstbasic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" H.R.A Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsthra_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Col Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstcol_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Medical Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstmedical_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstconvall_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" LTA Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstleave_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Education Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstedu_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Min Ins. Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstminins_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Spl All Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstsplall_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Earn 1 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddlss_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Earn 2 Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (lstspecial_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
				maincell.setFixedHeight(50);
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstaddinc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase(" ANONYMOUS Total:-",f));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new
				 * Phrase(""+trans((int)(lstany_total), "", "", false,
				 * false),f2)); maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 */
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" P.F Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpf_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" E.S.I.C Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstesic_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" P.T Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstpt_total), "", "", false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" T.D.S Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lsttds_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Advance Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstadv_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Loan Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstloan_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Mobile Ded Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstmob_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Net Chrgs Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstnetc_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Current Advance Total:-",
						f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(""
								+ trans((int) (lstlic_total), "", "", false,
										false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Relief Fund Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstrelif_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstmlwf_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Other :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lstother_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				// for MED & ERP total summery
				maincell = new PdfPCell(new Phrase("MED DED :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (istotmed_total), "", "", false, false),
						f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("ERP  :-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(
						""
								+ trans((int) (istotERPDED_total), "", "",
										false, false), f2));
				maincell.setBorderWidthLeft(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				// empty col
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(
						new Phrase(" Tot income Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotinc_total), "", "", false, false),
						fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (lsttotded_total), "", "", false, false),
						fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				float tttt = 0;
				ResultSet rsss;
				try {
					// System.out.println("date===="+date);
					Statement sttt = con.createStatement(
							ResultSet.TYPE_SCROLL_INSENSITIVE,
							ResultSet.CONCUR_READ_ONLY);
					rs = st.executeQuery("select sum(net_amt) from paytran where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT)
							+ "'  and trncd=999  union  "
							+ "select sum(net_amt) from paytran_stage where trndt between '"
							+ ReportDAO.BOM(PAYREGDT)
							+ "' and '"
							+ ReportDAO.EOM(PAYREGDT) + "'  and trncd=999 ");

					while (rs.next()) {
						tttt += rs.getFloat(1);
					}
				} catch (Exception e) {
					e.printStackTrace();
				}

				maincell = new PdfPCell(new Phrase(""
						+ trans((int) (tttt), "", "", false, false), fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));

				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
				main.addCell(maincell);

				document.add(main);

				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);
				document.add(Chunk.NEWLINE);

				para = new Paragraph(
						new Phrase(
								"Prepared By                         Checked By                        Approved By                 ",
								new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
				para.setAlignment(Element.ALIGN_RIGHT);
				para.setSpacingBefore(30);
				document.add(para);

				stmtInsert.close();
				stmtTrnct.close();
				st.close();
				con.close();
				document.close();

			}

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	
		
		
		
	}

	
	/****************************************************Prasad End*************************************************************************/
	
	
	public static ArrayList<ExtraFieldBean> emplistToBeFinalise(String date) {

		Connection con = null;
		ResultSet emp = null;

		RepoartBean repBean = new RepoartBean();

		ArrayList<ExtraFieldBean> list = new ArrayList<ExtraFieldBean>();

		String EmpSql = "";
		String code = "";
		String empname = "";
		float totalIncome = 0;
		float totalDec = 0;
		float netpay = 0;
		try {
			String BomDt = ReportDAO.BOM(date);
			// String EomDt = ReportDAO.EOM(date1);

			/*
			 * EmpSql =
			 * "SELECT CONVERT(INT, EMPMAST.EMPCODE) AS EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+'  "
			 * +
			 * "'+RTRIM(EMPMAST.LNAME)AS NAME,EMPMAST.EMPNO,replace(right(convert(varchar, p.TRNDT, 106), 8), ' ', '-')  as Month,   "
			 * +
			 * "T.PRJ_SRNO ,p.INp_amt as totear ,p.cal_amt as totded ,p.net_amt as PAYABLE"
			 * +
			 * " from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO  "
			 * + "join PAYTRAN p on p.EMPNO=t.empno  " +
			 * "where   p.TRNCD=999 and TRNDT between '"
			 * +BomDt+"'  and '"+EomDt+"'   " +
			 * "  and   T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND  "
			 * + " E2.EFFDATE <= '"+EomDt+"'   and (( empmast.STATUS='A' AND  "
			 * + "empmast.DOJ <= '"+EomDt+
			 * "') or  (empmast.STATUS ='N' And empmast.DOL>= '"
			 * +BomDt+"' )) )  " +
			 * "AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE   TRNDT "
			 * +
			 * " BETWEEN  '"+BomDt+"' and '"+EomDt+"')      order by  p.TRNDT, "
			 * + " t.PRJ_SRNO,empcode   " ;
			 */
			// list of employee which are not finalise from to date.
			EmpSql = "SELECT CONVERT(INT, EMPMAST.EMPCODE) AS EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+'  "
					+ "'+RTRIM(EMPMAST.LNAME)AS NAME,EMPMAST.EMPNO,replace(right(convert(varchar, p.TRNDT, 106), 8), ' ', '-')  as Month,   "
					+ "T.PRJ_SRNO ,p.INp_amt as totear ,p.cal_amt as totded ,p.net_amt as PAYABLE"
					+ " from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO  "
					+ "join PAYTRAN p on p.EMPNO=t.empno  "
					+ "where   p.TRNCD=999 and TRNDT <='" + BomDt + "'   " +
					/*
					 * "  and   T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND  "
					 * + " E2.EFFDATE <= '"+EomDt+
					 * "'   and (( empmast.STATUS='A' AND  " +
					 * "empmast.DOJ <= '"
					 * +EomDt+"') or  (empmast.STATUS ='N' And empmast.DOL>= '"
					 * +BomDt+"' )) )  " +
					 * "AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE   TRNDT <="
					 * + "'"+EomDt+"')    " +
					 */
					"  order by  p.TRNDT, " + " t.PRJ_SRNO,empcode   ";

			System.out.println("we are in emplistToBeFinalise " + EmpSql);

			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();

			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			ResultSet rs = st.executeQuery(EmpSql);

			while (rs.next()) {
				ExtraFieldBean EFB = new ExtraFieldBean();
				EFB.setEmpno(rs.getInt("EMPNO"));
				EFB.setCode(rs.getString("EMPCODE"));
				EFB.setEmpName(rs.getString("NAME"));
				EFB.setTotalIncome(rs.getFloat("totear"));
				EFB.setTotaldec(rs.getFloat("totded"));
				EFB.setNetPay(rs.getFloat("PAYABLE"));
				EFB.setDate(rs.getString("Month"));

				list.add(EFB);
			}

		} catch (Exception e) {
			e.printStackTrace();
		}

		return list;
	}

	public static float getAbsentDays(String date, int empno) {
		float absentDays = 0;
		float toJoining = 0;
		ResultSet rs = null;
		ResultSet resultSet = null;
		Connection con = null;
		con = ConnectionManager.getConnection();
		Statement statement;
		try {
			statement = con.createStatement();

			String p = "if exists (select * from empmast where EMPNO=" + empno
					+ " and" + " DOJ between '" + ReportDAO.BOM(date)
					+ "' and '" + ReportDAO.EOM(date) + "' )  "
					+ "select DATEDIFF(day,'" + ReportDAO.BOM(date)
					+ "',(select doj from EMPMAST where" + " EMPNO=" + empno
					+ ")) AS differ else select 0 as differ ";
			// System.out.println("abseny 1st " + p);
			resultSet = statement.executeQuery(p);
			if (resultSet.next()) {
				toJoining = resultSet.getFloat("differ");
				// System.out.println("toJoining    " + toJoining);
			}

			String q = "select sum(NET_AMT) as absentDays from PAYTRAN_STAGE where EMPNO ="
					+ empno
					+ " and TRNCD =301 and  TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' ";
			// System.out.println("abseny  2nd" + q);
			rs = statement.executeQuery(q);

			if (rs.next()) {
				absentDays = rs.getFloat("absentDays");
				// System.out.println("absentDays    " + absentDays);
			}

			statement.close();

		} catch (SQLException e) {
			e.printStackTrace();
		}

		return absentDays + toJoining;
	}

	public static float getAbsentDays(String date, int empno, String DOJ) {
		/*
		 * String[] parts = DOJ.split("-"); String part1 = parts[1]; String
		 * part2 = parts[2]; DOJ=part1+"-"+part2; String
		 * sysdate=ReportDAO.getSysDate(); String[] parts3 = sysdate.split("-");
		 * String part13 = parts3[1]; String part23 = parts3[2];
		 * sysdate=part13+"-"+part23;
		 */
		float absentDays = 0;
		float absentDays1 = 0;
		float toJoining = 0;
		ResultSet rs = null;
		ResultSet resultSet = null;
		Connection con = null;
		con = ConnectionManager.getConnection();
		Statement statement;
		try {
			statement = con.createStatement();
			// if(DOJ.equalsIgnoreCase(sysdate))
			// {
			String q = "select sum(NET_AMT) as absentDays from PAYTRAN_STAGE where EMPNO ="
					+ empno
					+ " and TRNCD =301 and  TRNDT between '"
					+ ReportDAO.BOM(date)
					+ "' and '"
					+ ReportDAO.EOM(date)
					+ "' ";
			System.out.println("abseny  2nd" + q);
			rs = statement.executeQuery(q);

			if (rs.next()) {
				absentDays = rs.getFloat("absentDays");
				System.out.println("absentDays    " + absentDays);
			}
			// }
			/*
			 * else { String
			 * p="if exists (select * from empmast where EMPNO="+empno+" and" +
			 * " DOJ between '"
			 * +ReportDAO.BOM(date)+"' and '"+ReportDAO.EOM(date)+"' )  " +
			 * "select DATEDIFF(day,'"
			 * +ReportDAO.BOM(date)+"',(select doj from EMPMAST where" +
			 * " EMPNO="+empno+"))+1 AS differ else select 0 as differ ";
			 * System.out.println("abseny 1st "+p); resultSet =
			 * statement.executeQuery(p); if(resultSet.next()) { toJoining =
			 * resultSet.getFloat("differ");
			 * System.out.println("toJoining    "+toJoining); }
			 * 
			 * String q=
			 * "select sum(NET_AMT) as absentDays from PAYTRAN_STAGE where EMPNO ="
			 * +
			 * empno+" and TRNCD =301 and  TRNDT between '"+ReportDAO.BOM(date)+
			 * "' and '"+ReportDAO.EOM(date)+"' ";
			 * System.out.println("abseny  2nd"+q); rs =
			 * statement.executeQuery(q);
			 * 
			 * if(rs.next()) { absentDays1 = rs.getFloat("absentDays");
			 * System.out.println("absentDays    "+absentDays); }
			 * absentDays=absentDays1+toJoining; }
			 */
			statement.close();

		} catch (SQLException e) {
			e.printStackTrace();
		}

		return absentDays;
	}

	public static void loanReport(String empno, String emptype,
			String loantype, String imgpath, String filepath) {
		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant properties Manager " + e);
		}

		// System.out.println("in new loanReport generate"+sdate +" "+ emptype);

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		String EmpNO = "";
		ResultSet emp = null;
		String empsql = "";

		int srno = 0;
		float Total_loanAmt = 0;
		float ALLTotal_loanAmt = 0;
		float Total_actualpay = 0;
		float ALLTotal_actualpay = 0;
		float Total_paid = 0;
		float remainingAmt = 0;
		float Total_remainingAmt = 0;

		ResultSet prj1 = null;
		ResultSet prj2 = null;
		String total_paid = "";
		String Loan_Total = "";
		String Actual_Pay_Total = "";

		try {
			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			Statement stmt1 = con.createStatement();
			Statement stmt2 = con.createStatement();
			// System.out.println("in tdslist sheet");

			Document doc = new Document(new Rectangle(2384, 3370));
			PdfWriter writer = PdfWriter.getInstance(doc, new FileOutputStream(
					filepath));
			Footer1 ftr = dao.new Footer1(lable1);
			writer.setPageEvent(ftr);
			doc.open();

			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));

			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 1300f,
					1830f, 45);
			Image image1 = Image.getInstance(imgpath);
			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 38, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);
			image1.setAbsolutePosition(60f, 3200f);
			doc.add(image1);
			doc.add(para);

			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 28)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);
			doc.add(para);

			Font f = new Font(Font.HELVETICA, 30);
			Font f1 = new Font(Font.HELVETICA, 25);
			Font f2 = new Font(Font.HELVETICA, 32);

			/*
			 * para = new Paragraph(new
			 * Phrase("Loan Details Sheet for the Month Of :- "+sdate+"  ",new
			 * Font(Font.TIMES_ROMAN,25,Font.BOLD)));
			 * para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(10); doc.add(para);
			 */
			Rectangle rec = new Rectangle(100, 100);

			if (emptype.equalsIgnoreCase("All")) {

				if (loantype.equalsIgnoreCase("All")) {

					empsql = "SELECT E.EMPNO,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) as name ,E.EMPCODE,l.* "
							+ " FROM EMPMAST E , loan_detail l WHERE l.empno=e.empno ";
					System.out.println("0");
				}

				else {
					empsql = "SELECT E.EMPNO,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) as name ,E.EMPCODE,l.* "
							+ " FROM EMPMAST E , loan_detail l WHERE l.empno=e.empno and l.active ='"
							+ loantype + "' ";
					System.out.println("1");
				}
			} else {
				String employee[] = empno.split(":");
				empno = employee[2];

				if (loantype.equalsIgnoreCase("All")) {

					empsql = "SELECT E.EMPNO,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) as name ,E.EMPCODE,l.* "
							+ " FROM EMPMAST E , loan_detail l WHERE l.empno=e.empno and l.empno= "
							+ empno + "  ";
					System.out.println("2");
				}

				else {
					empsql = "SELECT E.EMPNO,CONVERT(NVARCHAR(100),E.LNAME+' '+ E.FNAME+' '+ E.MNAME) as name  ,E.EMPCODE,l.* "
							+ " FROM EMPMAST E , loan_detail l WHERE l.empno=e.empno and l.empno= "
							+ empno + " and  l.active ='" + loantype + "' ";
					System.out.println("3");
				}
			}

			System.out.println(empsql);

			ResultSet rs = st.executeQuery(empsql);

			String nameQuery = "";

			PdfPTable datatab;
			PdfPTable datatot;
			PdfPTable datatot1 = new PdfPTable(10);

			PdfPTable main = new PdfPTable(10);
			main.setSpacingBefore(10);
			main.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7, 8, 8,
					8f }, rec);

			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase("SRNO", f));
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Employee Code", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("EMPLOYEE NAME", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Start Date", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Loan End Date", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Monthly Instalments", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Percentage", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Loan Amount", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Actual pay", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			/*
			 * maincell = new PdfPCell(new Phrase("Total paid", f));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Remaing Amount", f));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 */

			maincell = new PdfPCell(new Phrase("Status", f));
			maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			main.addCell(maincell);

			doc.add(main);

			String previousEmpCode = "";
			String currentEmpCode = "";

			datatab = new PdfPTable(10);
			// datatab.setSpacingBefore(10);
			datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7, 8,
					8, 8f }, rec);
			datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

			if (emptype.equalsIgnoreCase("All")
					&& (loantype.equalsIgnoreCase("All"))) {

				while (rs.next()) {
					EmpNO = rs.getString("EMPNO");
					currentEmpCode = rs.getString("empcode");
					if (rs.getRow() != 1
							&& !previousEmpCode
									.equalsIgnoreCase(currentEmpCode)) {

						// PdfPCell cell1111 = new PdfPCell(new
						// Phrase("Total:-- "+ Total_loanAmt +
						// ",  Actual P:--"+Total_actualpay +
						// "  T Paid:--"+total_paid, f1));

						PdfPCell cell1111 = new PdfPCell(new Phrase(
								"  Total Loan Amount:-- " + Total_loanAmt, f));
						cell1111.setColspan(4);
						cell1111.setFixedHeight(70);
						cell1111.setPaddingTop(3);
						cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
						datatab.addCell(cell1111);

						PdfPCell cell1112 = new PdfPCell(new Phrase(
								"   Actual Pay Total:-- " + Total_actualpay, f));
						cell1112.setColspan(3);
						cell1112.setPaddingTop(3);
						cell1112.setFixedHeight(70);
						cell1112.setHorizontalAlignment(Element.ALIGN_LEFT);
						datatab.addCell(cell1112);

						PdfPCell cell1113 = new PdfPCell(new Phrase(
								"    Total Paid:-- " + total_paid, f));
						cell1113.setColspan(3);
						cell1113.setFixedHeight(70);
						cell1113.setPaddingTop(3);
						cell1113.setHorizontalAlignment(Element.ALIGN_LEFT);
						datatab.addCell(cell1113);

						Total_loanAmt = 0;
						Total_actualpay = 0;
					}
					System.out.println("hi");
					srno++;
					PdfPCell cell1 = new PdfPCell(new Phrase("" + srno, f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setPaddingTop(3);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("empcode"), f1));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell2);

					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);

					PdfPCell cell4 = new PdfPCell(new Phrase(""
							+ rs.getString("start_date"), f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);
					String string = rs.getString("end_date") == null ? " " : rs
							.getString("end_date");
					PdfPCell cell5 = new PdfPCell(new Phrase("" + string, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell5);

					PdfPCell cell6 = new PdfPCell(new Phrase(""
							+ rs.getFloat("monthly_install"), f1));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell6);

					PdfPCell cell7 = new PdfPCell(new Phrase(""
							+ rs.getFloat("loan_per"), f1));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell7);

					Total_loanAmt = Total_loanAmt + rs.getFloat("loan_amt");
					ALLTotal_loanAmt = ALLTotal_loanAmt
							+ rs.getFloat("loan_amt");

					PdfPCell cell8 = new PdfPCell(new Phrase(""
							+ rs.getFloat("loan_amt"), f1));
					cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell8);

					Total_actualpay = Total_actualpay
							+ rs.getFloat("Actual_pay");
					ALLTotal_actualpay = ALLTotal_actualpay
							+ rs.getFloat("Actual_pay");

					PdfPCell cell9 = new PdfPCell(new Phrase(""
							+ rs.getFloat("Actual_pay"), f1));
					cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell9);

					String prjquery1 = "select SUM(net_amt) AS total from PAYTRAN_STAGE where EMPNO='"
							+ EmpNO + "' and TRNCD=226";

					System.out.println(prjquery1);

					prj1 = stmt1.executeQuery(prjquery1);

					while (prj1.next()) {
						total_paid = prj1.getString("total");
						System.out.println("Result SEt...11  " + total_paid);

					}

					/*
					 * Total_paid = Total_paid + rs.getFloat("total_paid");
					 * PdfPCell cell10 = new PdfPCell(new Phrase("" +
					 * rs.getFloat("total_paid"), f1));
					 * cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * datatab.addCell(cell10);
					 * 
					 * remainingAmt = rs.getFloat("Actual_pay") -
					 * rs.getFloat("total_paid"); Total_remainingAmt =
					 * Total_remainingAmt + remainingAmt; PdfPCell cell11 = new
					 * PdfPCell(
					 * cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * datatab.addCell(cell11);
					 */

					PdfPCell cell12 = new PdfPCell(new Phrase(""
							+ rs.getString("Active"), f1));
					cell12.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell12);

					previousEmpCode = currentEmpCode;
				}
				doc.add(datatab);

				if (!rs.next()) {

					System.out.println("No more resul;t");
					datatab = new PdfPTable(10);

					datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8,
							7, 8, 8, 8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell1 = new PdfPCell(new Phrase(
							"No More record to display", f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					doc.add(datatab);

					System.out.println("No more resul;t  @@@@@@");
				}

				// rs.close();
				System.out.println("hey");
				// Total of columns start here

				datatot = new PdfPTable(10);
				datatot.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7,
						8, 8, 8f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				/*
				 * PdfPCell cell111 = new PdfPCell(new Phrase(""));
				 * cell111.setColspan(4); cell111.setFixedHeight(50);
				 * cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * datatot.addCell(cell111);
				 */

				PdfPCell cell22 = new PdfPCell(new Phrase(
						"  Total Loan Amount:  " + Total_loanAmt, f));
				cell22.setColspan(4);
				cell22.setFixedHeight(70);
				cell22.setHorizontalAlignment(Element.ALIGN_LEFT);
				datatot.addCell(cell22);

				PdfPCell cell33 = new PdfPCell(new Phrase("  Actual Pay:  "
						+ Total_actualpay, f));
				cell33.setHorizontalAlignment(Element.ALIGN_LEFT);
				cell33.setColspan(3);
				cell33.setFixedHeight(70);
				datatot.addCell(cell33);

				PdfPCell cell44 = new PdfPCell(new Phrase("  Total Paid:   "
						+ total_paid, f));
				cell44.setColspan(3);
				cell44.setFixedHeight(70);
				cell44.setHorizontalAlignment(Element.ALIGN_LEFT);
				datatot.addCell(cell44);

				/*
				 * PdfPCell cell55 = new PdfPCell(new Phrase("" +
				 * Total_remainingAmt, f1));
				 * cell55.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * datatot.addCell(cell55);
				 * 
				 * PdfPCell cell66 = new PdfPCell(new Phrase("", f1));
				 * cell66.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * datatot.addCell(cell66);
				 */

				doc.add(datatot);

				para = new Paragraph(new Phrase("Number Of Employees :- "
						+ srno, f));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(50);
				doc.add(para);

				String prjquery2 = "select SUM(loan_amt)AS loan_total,SUM(Actual_pay)AS Actual_pay  from loan_detail where Active='sanction' ";

				System.out.println(prjquery2);

				prj2 = stmt2.executeQuery(prjquery2);

				while (prj2.next()) {
					Loan_Total = prj2.getString("loan_total");
					Actual_Pay_Total = prj2.getString("Actual_pay");
					System.out.println("Total Loan AmT  " + Loan_Total);
					System.out.println("Actual Pay Total  " + Actual_Pay_Total);
				}

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(
						Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				doc.add(para);

				main = new PdfPTable(4);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 10, 10, 10, 10 }, rec);

				maincell = new PdfPCell(new Phrase("Loan Amount Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + Loan_Total, f));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("",f2));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("",f2));
				 * maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("",f));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("",f2));
				 * maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 */
				maincell = new PdfPCell(new Phrase("Actual Pay Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + Actual_Pay_Total, f));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				doc.add(main);

				st.close();
				con.close();
				doc.close();
			} else {
				while (rs.next()) {
					System.out.println("hi");
					datatab = new PdfPTable(10);

					datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8,
							7, 8, 8, 8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					srno++;

					PdfPCell cell1 = new PdfPCell(new Phrase("" + srno, f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("empcode"), f1));
					cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell2);

					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f1));
					cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell3);

					PdfPCell cell4 = new PdfPCell(new Phrase(""
							+ rs.getString("start_date"), f1));
					cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell4);
					String string = rs.getString("end_date") == null ? " " : rs
							.getString("end_date");
					PdfPCell cell5 = new PdfPCell(new Phrase("" + string, f1));
					cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell5);

					PdfPCell cell6 = new PdfPCell(new Phrase(""
							+ rs.getFloat("monthly_install"), f1));
					cell6.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell6);

					PdfPCell cell7 = new PdfPCell(new Phrase(""
							+ rs.getFloat("loan_per"), f1));
					cell7.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell7);

					Total_loanAmt = Total_loanAmt + rs.getFloat("loan_amt");

					PdfPCell cell8 = new PdfPCell(new Phrase(""
							+ rs.getFloat("loan_amt"), f1));
					cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell8);

					Total_actualpay = Total_actualpay
							+ rs.getFloat("Actual_pay");

					PdfPCell cell9 = new PdfPCell(new Phrase(""
							+ rs.getFloat("Actual_pay"), f1));
					cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell9);

					/*
					 * Total_paid = Total_paid + rs.getFloat("total_paid");
					 * PdfPCell cell10 = new PdfPCell(new
					 * Phrase(""+rs.getFloat("total_paid"),f1));
					 * cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * datatab.addCell(cell10);
					 * 
					 * 
					 * remainingAmt = rs.getFloat("Actual_pay")-
					 * rs.getFloat("total_paid"); Total_remainingAmt =
					 * Total_remainingAmt + remainingAmt; PdfPCell cell11 = new
					 * PdfPCell(new Phrase(""+remainingAmt,f1));
					 * cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
					 * datatab.addCell(cell11);
					 */

					PdfPCell cell12 = new PdfPCell(new Phrase(""
							+ rs.getString("Active"), f1));
					cell12.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell12);

					doc.add(datatab);
				}

				if (!rs.next()) {

					System.out.println("No more resul;t");
					datatab = new PdfPTable(10);

					datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8,
							7, 8, 8, 8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_CENTER);

					PdfPCell cell1 = new PdfPCell(new Phrase(
							"No More record to display", f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					datatab.addCell(cell1);

					doc.add(datatab);

					System.out.println("No more resul;t  @@@@@@");
				}

				// rs.close();
				System.out.println("hey");
				// Total of columns start here

				datatot = new PdfPTable(10);
				datatot.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7,
						8, 8, 8f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_CENTER);

				PdfPCell cell111 = new PdfPCell(new Phrase("Total:--", f1));
				cell111.setColspan(7);
				cell111.setFixedHeight(50);
				cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell111);

				PdfPCell cell22 = new PdfPCell(new Phrase("" + Total_loanAmt,
						f1));
				cell22.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell22);

				PdfPCell cell33 = new PdfPCell(new Phrase("" + Total_actualpay,
						f1));
				cell33.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell33);

				PdfPCell cell44 = new PdfPCell(new Phrase("" + Total_paid, f1));
				cell44.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell44);

				PdfPCell cell55 = new PdfPCell(new Phrase(""
						+ Total_remainingAmt, f1));
				cell55.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell55);

				PdfPCell cell66 = new PdfPCell(new Phrase("", f1));
				cell66.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatot.addCell(cell66);

				doc.add(datatot);

				/*
				 * para = new Paragraph(new Phrase("Number Of Employees :- "+
				 * srno,f)); para.setAlignment(Element.ALIGN_CENTER);
				 * para.setSpacingAfter(50); doc.add(para);
				 */

				String prjquery2 = "select SUM(loan_amt)AS loan_total,SUM(Actual_pay)AS Actual_pay  from loan_detail where Active='sanction' ";

				System.out.println(prjquery2);

				prj2 = stmt2.executeQuery(prjquery2);

				while (prj2.next()) {
					Loan_Total = prj2.getString("loan_total");
					Actual_Pay_Total = prj2.getString("Actual_pay");
					System.out.println("Total Loan AmT  " + Loan_Total);
					System.out.println("Actual Pay Total  " + Actual_Pay_Total);
				}

				para = new Paragraph(new Phrase("-:Summary :- ", new Font(
						Font.HELVETICA, 40, Font.BOLDITALIC)));
				para.setAlignment(Element.ALIGN_CENTER);
				para.setSpacingAfter(10);
				doc.add(para);

				main = new PdfPTable(4);
				main.setSpacingBefore(10);
				main.setWidthPercentage(new float[] { 10, 10, 10, 10 }, rec);

				maincell = new PdfPCell(new Phrase("Loan Amount Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setFixedHeight(50);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + Total_loanAmt, f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("Actual Pay Total:-", f));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("" + Total_actualpay,
				 * f2)); maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("Total Paid Total:-", f));
				 * maincell.setBorderWidthRight(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 * 
				 * maincell = new PdfPCell(new Phrase("" + Total_paid, f2));
				 * maincell.setBorderWidthLeft(0);
				 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				 * main.addCell(maincell);
				 */

				maincell = new PdfPCell(new Phrase("Actual Pay Total:-", f));
				maincell.setBorderWidthRight(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("" + Total_actualpay, f2));
				maincell.setBorderWidthLeft(0);
				maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
				main.addCell(maincell);

				doc.add(main);

				st.close();
				con.close();
				doc.close();
			}

		}

		catch (Exception e) {
			e.printStackTrace();
		}

	}

	public static void sitewisepayreg(String PAYREGDT, String imgpath,
			String filepath, int siteId) {

		Properties prop = new Properties();
		try {
			ClassLoader classLoader = Thread.currentThread()
					.getContextClassLoader();
			InputStream stream = classLoader
					.getResourceAsStream("constant.properties");
			prop.load(stream);
		} catch (Exception e) {
			System.out.println("Error in constant Properties " + e);
		}

		System.out.println("in new pay regdao");

		RepoartBean repBean = new RepoartBean();
		UtilityDAO dao = new UtilityDAO();
		Connection con = null;
		String BomDt = "";
		String EomDt = "";
		int lastdat = 0;

		String table_name = null;

		lastdat = (int) Calculate.getDays(PAYREGDT);

		BomDt = ReportDAO.BOM(PAYREGDT);
		EomDt = ReportDAO.EOM(PAYREGDT);

		String temp = PAYREGDT.substring(2);
		ResultSet emp = null;
		String EmpSql = "";
		String pBrcd1 = "";
		int tot_no_emp = 0;
		int br_tot_no_emp = 0;
		float totmthsal1 = 0.0f;
		float totearning1 = 0.0f;
		float totearning2 = 0.0f;
		float totactualpay = 0.0f;
		float totmobded = 0.0f;
		float totadvanc = 0.0f;
		float totloan = 0.0f;
		float tottds = 0.0f;

		try {
			// CMT FOR ADDING @ COLUMN MED DED AND ERP DED FOR SITEWISE PAYREG
			/*
			 * ReportDAO.OpenCon("", "", "", repBean); con = repBean.getCn();
			 * Statement st = con.createStatement(
			 * ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_READ_ONLY);
			 * Statement stmtInsert = con.createStatement(); Statement stmtTrnct
			 * = con.createStatement();
			 * 
			 * DottedLineCell app = new DottedLineCell();
			 * System.out.println("in income & Deduction head");
			 * 
			 * // A4 size pdf.... Document document = new Document(new
			 * Rectangle(2384, 3370)); // Document doc = new Document(new
			 * Rectangle(2834,4008));
			 * 
			 * document.left(100f); document.top(100f); document.bottom(100f);
			 * document.right(100f);
			 * 
			 * PdfWriter writer = PdfWriter.getInstance(document, new
			 * FileOutputStream(filepath)); HeaderAndFooter haf = new
			 * HeaderAndFooter(lable1, label2); writer.setPageEvent(haf);
			 * document.open(); Font FONT = new Font(Font.HELVETICA, 190,
			 * Font.NORMAL, new GrayColor(0.85f));
			 * ColumnText.showTextAligned(writer.getDirectContentUnder(),
			 * Element.ALIGN_CENTER, new Phrase(prop.getProperty("watermark"),
			 * FONT), 1300f, 1830f, 45); Image image1 =
			 * Image.getInstance(imgpath);
			 * 
			 * Phrase title = new Phrase(prop.getProperty("companyName"), new
			 * Font(FONT.TIMES_ROMAN, 22, Font.BOLD)); Paragraph para = new
			 * Paragraph(title); para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingBefore(0); image1.scaleAbsolute(310f, 120f);
			 * 
			 * // chaange possition of image image1.setAbsolutePosition(60f,
			 * 2750f); image1.setAbsolutePosition(60f, 3200f);
			 * document.add(image1); document.add(para);
			 * 
			 * para = new Paragraph(new Phrase(
			 * prop.getProperty("addressForReport"), new Font( Font.TIMES_ROMAN,
			 * 20))); para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(0);
			 * 
			 * document.add(para); para = new Paragraph(new Phrase(
			 * prop.getProperty("contactForReport"), new Font( Font.TIMES_ROMAN,
			 * 20))); para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(0);
			 * 
			 * document.add(para); para = new Paragraph(new
			 * Phrase(prop.getProperty("mailForReport"), new
			 * Font(Font.TIMES_ROMAN, 20)));
			 * para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(10);
			 * 
			 * document.add(para);
			 * 
			 * Font f = new Font(Font.HELVETICA, 22); Font f1 = new
			 * Font(Font.HELVETICA, 22); Font fbold = new Font(Font.HELVETICA,
			 * 22, Font.BOLD); Font f2 = new Font(Font.HELVETICA, 22);
			 * 
			 * para = new Paragraph(new Phrase(
			 * "Salary Sheet For The Income Heads for the Month Of :- " + temp +
			 * " (Pending for Release)", new Font( Font.TIMES_ROMAN, 20)));
			 * para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(10);
			 * 
			 * para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(30);
			 * 
			 * document.add(para);
			 * 
			 * Rectangle rec = new Rectangle(100, 100);
			 * 
			 * float basic_total = 0.0f, lstbasic_total = 0.0f, lic_total =
			 * 0.0f, lstlic_total = 0.0f, hra_total = 0.0f, lsthra_total = 0.0f,
			 * medical_total = 0.0f; float lstmedical_total = 0.0f;
			 * 
			 * float leave_TC = 0.0f, lstleave_total = 0.0f;
			 * 
			 * float any_total = 0.0f, lstany_total = 0.0f;
			 * 
			 * float edu_total = 0.0f, lstedu_total = 0.0f, splall_total = 0.0f,
			 * lstsplall_total = 0.0f, convall_total = 0.0f, lstconvall_total =
			 * 0.0f; float pf_total = 0.0f, lstpf_total = 0.0f, pt_total = 0.0f,
			 * lstpt_total = 0.0f;
			 * 
			 * float mlwf_total = 0.0f, lstmlwf_total = 0.0f; float other_total
			 * = 0.0f, lstother_total = 0.0f;
			 * 
			 * float esic_total = 0.0f; float lstesic_total = 0.0f; float
			 * mob_total = 0.0f; float lstmob_total = 0.0f; float adv_total =
			 * 0.0f; float lstadv_total = 0.0f; float tds_total = 0.0f; float
			 * lsttds_total = 0.0f; float relif_total = 0.0f; float
			 * lstrelif_total = 0.0f; float netc_total = 0.0f; float
			 * lstnetc_total = 0.0f; float minins_total = 0.0f; float
			 * lstminins_total = 0.0f; float addlss_total = 0.0f; float
			 * lstaddlss_total = 0.0f; float col_total = 0.0f; float
			 * lstcol_total = 0.0f; float special_total = 0.0f; float
			 * lstspecial_total = 0.0f; float addinc_total = 0.0f; float
			 * lstaddinc_total = 0.0f; float totinc_total = 0.0f; float
			 * lsttotinc_total = 0.0f;
			 * 
			 * float loan_total = 0.0f, lstloan_total = 0.0f;
			 * 
			 * // float addded_total = 0.0f; // float lstaddded_total = 0.0f;
			 * 
			 * float totded_total = 0.0f; float lsttotded_total = 0.0f; float
			 * netpay_total = 0.0f; float lstnetpay_total = 0.0f;
			 * 
			 * EmpSql =
			 * "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
			 * + "     	EMPMAST.EMPNO,   T.PRJ_SRNO," +
			 * "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)   " +
			 * "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC'," +
			 * "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE'," +
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS HRA) END AS 'HRA'," +
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   " +
			 * 
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		" +
			 * "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC', " +
			 * 
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		" +
			 * "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',           "
			 * +
			 * 
			 * " CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL'," +
			 * "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS'," +
			 * "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS COL) END AS 'COL'," +
			 * "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			ELSE				(SELECT 0 AS ER2) END AS 'er2'," +
			 * "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)    			" +
			 * "	ELSE (SELECT 0 AS splall) END AS 'splall'," +
			 * 
			 * "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', " +
			 * 
			 * "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)    			" +
			 * "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
			 * +
			 * "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS esic) END AS 'esic'," +
			 * "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE  (SELECT 0 AS mob) END AS 'mob'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE	(SELECT 0 AS adv) END AS 'adv'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS tds) END AS 'tds'," +
			 * 
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf'," +
			 * 
			 * "	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)	" +
			 * "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS netc) END AS 'netc'," +
			 * " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN'," +
			 * "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * +
			 * "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
			 * + "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO =  EMPMAST.EMPNO )" +
			 * "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * +
			 * "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
			 * + "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO =  EMPMAST.EMPNO) " +
			 * "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc'," +
			 * "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
			 * +
			 * "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227) and trndt BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)" +
			 * "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
			 * +
			 * "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227) and trndt BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)" +
			 * "	  ELSE	(SELECT 0 AS other) END AS 'other' ," +
			 * "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)" +
			 * "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)	" +
			 * "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ," +
			 * "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO) " +
			 * "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)" +
			 * "	  ELSE		(SELECT 0 AS totear) END AS 'totear'" +
			 * "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
			 * +
			 * "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
			 * + EomDt + "'" +
			 * "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt +
			 * "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt +
			 * "' )) )" +
			 * "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNDT BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "') " + "    AND T.PRJ_SRNO=" +
			 * siteId + " " + "    UNION " +
			 * "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
			 * + "     	EMPMAST.EMPNO,   T.PRJ_SRNO," +
			 * "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC'," +
			 * "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE'," +
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS HRA) END AS 'HRA'," +
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   " +
			 * 
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		" +
			 * "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  " +
			 * "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)		" +
			 * "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  " +
			 * 
			 * "          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL'," +
			 * "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS'," +
			 * "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS COL) END AS 'COL'," +
			 * "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			ELSE				(SELECT 0 AS ER2) END AS 'er2'," +
			 * "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)    			" +
			 * "	ELSE (SELECT 0 AS splall) END AS 'splall'," +
			 * 
			 * "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', " +
			 * 
			 * "			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)    			" +
			 * "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt +
			 * "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
			 * +
			 * "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE		(SELECT 0 AS esic) END AS 'esic'," +
			 * "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "		ELSE  (SELECT 0 AS mob) END AS 'mob'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE	(SELECT 0 AS adv) END AS 'adv'," +
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS tds) END AS 'tds'," +
			 * 
			 * "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf'," +
			 * 
			 * "	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)	" +
			 * "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	ELSE		(SELECT 0 AS netc) END AS 'netc'," +
			 * " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
			 * + BomDt + "' AND '" + EomDt + "' AND EMPNO = EMPMAST.EMPNO)" +
			 * "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN'," +
			 * "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * +
			 * "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
			 * + "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO =  EMPMAST.EMPNO )" +
			 * "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * +
			 * "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
			 * + "    and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO =  EMPMAST.EMPNO) " +
			 * "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc'," +
			 * "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
			 * +
			 * "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227) and trndt BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)" +
			 * "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
			 * +
			 * "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227) and trndt BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "' and EMPNO = empmast.EMPNO)" +
			 * "	  ELSE	(SELECT 0 AS other) END AS 'other' ," +
			 * "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)" +
			 * "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)	" +
			 * "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ," +
			 * "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO) " +
			 * "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
			 * + "     and trndt BETWEEN '" + BomDt + "' and '" + EomDt +
			 * "' and EMPNO = empmast.EMPNO)" +
			 * "	  ELSE		(SELECT 0 AS totear) END AS 'totear'" +
			 * "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
			 * +
			 * "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
			 * + EomDt + "'" +
			 * "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '" + EomDt +
			 * "') or  (empmast.STATUS ='N' And empmast.DOL>='" + BomDt +
			 * "' )) )" +
			 * "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
			 * + BomDt + "' and '" + EomDt + "') " + "    AND T.PRJ_SRNO=" +
			 * siteId + " " + "     order by   t.PRJ_SRNO,empno  ";
			 * 
			 * System.out.println(EmpSql);
			 * 
			 * ResultSet rs = st.executeQuery(EmpSql);
			 * 
			 * while (rs.next()) {
			 * 
			 * String prj_name = null; String prj_code = null;
			 * 
			 * Connection conn = ConnectionManager.getConnectionTech();
			 * 
			 * Statement stmt = conn.createStatement(); String prjquery =
			 * "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
			 * + rs.getString("PRJ_SRNO") + "'"; //
			 * System.out.println(prjquery);
			 * 
			 * ResultSet prj = stmt.executeQuery(prjquery);
			 * 
			 * if (prj.next()) { prj_name = prj.getString("Site_Name"); prj_code
			 * = prj.getString("Project_Code"); }
			 * 
			 * pBrcd1 = rs.getString("PRJ_SRNO"); br_tot_no_emp = 0;
			 * 
			 * para = new Paragraph(new Phrase(
			 * "Employee's Salary List For Project Site : " + prj_name + " (" +
			 * prj_code + ")", f)); para.setAlignment(Element.ALIGN_LEFT);
			 * para.setSpacingAfter(4);
			 * 
			 * document.add(para);
			 * 
			 * prj.close(); stmt.close(); conn.close();
			 * 
			 * PdfPTable datatab; PdfPTable datatot;
			 * 
			 * PdfPTable main = new PdfPTable(16); main.setSpacingBefore(10);
			 * 
			 * main.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f
			 * }, rec); main.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * PdfPCell maincell;
			 * 
			 * maincell = new PdfPCell(new Phrase("CODE", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * maincell.setFixedHeight(50);
			 * maincell.disableBorderSide(rec.BOTTOM); main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * maincell.disableBorderSide(rec.BOTTOM); main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Basic", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("H.R.A", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Col", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Medical", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Conv All", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Education", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Min Ins.", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Spl All", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Earn 1", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Earn 2", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Add Income", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("LTA", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * 
			 * maincell = new PdfPCell(new Phrase("ANONYMOUS",fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * 
			 * maincell = new PdfPCell(new Phrase("Tot income", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * main.addCell(maincell);
			 * 
			 * document.add(main);
			 * 
			 * datatab = new PdfPTable(16); datatab.setWidthPercentage(new
			 * float[] { 4, 15.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f }, rec);
			 * datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * 
			 * PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
			 * maincell1.disableBorderSide(rec.TOP);
			 * maincell1.setFixedHeight(50); // maincell1.setColspan(2);
			 * datatab.addCell(maincell1);
			 * 
			 * PdfPCell maincell2 = new PdfPCell(new Phrase("", fbold));
			 * maincell2.disableBorderSide(rec.TOP);
			 * maincell2.setFixedHeight(50); datatab.addCell(maincell2);
			 * 
			 * PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
			 * maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell3);
			 * 
			 * PdfPCell maincell4 = new PdfPCell(new Phrase("E.S.I.C", fbold));
			 * maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell4);
			 * 
			 * PdfPCell maincell5 = new PdfPCell(new Phrase("P.T", fbold));
			 * maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell5);
			 * 
			 * PdfPCell maincell6 = new PdfPCell(new Phrase("T.D.S", fbold));
			 * maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell6);
			 * 
			 * PdfPCell maincell7 = new PdfPCell(new Phrase("Advance", fbold));
			 * maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell7);
			 * 
			 * PdfPCell maincell8 = new PdfPCell(new Phrase("Loan Ded", fbold));
			 * maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell8);
			 * 
			 * PdfPCell maincell9 = new PdfPCell(new Phrase("Mobile Ded",
			 * fbold)); maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell9);
			 * 
			 * PdfPCell maincell10 = new PdfPCell(new Phrase("Net Charges",
			 * fbold)); maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell10);
			 * 
			 * PdfPCell maincell11 = new PdfPCell(new Phrase( "Current Advance",
			 * fbold)); maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell11);
			 * 
			 * PdfPCell maincell12 = new PdfPCell(new Phrase("Relif", fbold));
			 * maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell12);
			 * 
			 * PdfPCell maincell13 = new PdfPCell(new Phrase("MLWF", fbold));
			 * maincell13.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell13);
			 * 
			 * PdfPCell maincell111 = new PdfPCell(new Phrase("Other", fbold));
			 * maincell111.disableBorderSide(rec.TOP);
			 * maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell111);
			 * 
			 * 
			 * PdfPCell maincell1111 = new PdfPCell(new Phrase("",fbold));
			 * maincell1111.disableBorderSide(rec.TOP);
			 * maincell1111.setFixedHeight(50); datatab.addCell(maincell1111);
			 * 
			 * 
			 * PdfPCell maincell14 = new PdfPCell(new Phrase("Tot Ded", fbold));
			 * maincell14.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell14);
			 * 
			 * PdfPCell maincell15 = new PdfPCell(new Phrase("Net Pay", fbold));
			 * maincell15.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(maincell15);
			 * 
			 * document.add(datatab);
			 * 
			 * while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) { float
			 * pageHeight = writer.getPageSize().getHeight();
			 * 
			 * 
			 * if(pageHeight-70 == 3370 ){
			 * 
			 * }
			 * 
			 * 
			 * datatab = new PdfPTable(16); datatab.setWidthPercentage(new
			 * float[] { 4, 15.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f }, rec);
			 * datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * 
			 * PdfPCell cell1 = new PdfPCell(new Phrase("" +
			 * rs.getString("EMPCODE"), f1));
			 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * cell1.setFixedHeight(50); cell1.disableBorderSide(rec.BOTTOM);
			 * 
			 * datatab.addCell(cell1);
			 * 
			 * PdfPCell cell2 = new PdfPCell(new Phrase("" +
			 * rs.getString("name"), f)); cell2.disableBorderSide(rec.BOTTOM);
			 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
			 * datatab.addCell(cell2);
			 * 
			 * basic_total = basic_total + rs.getFloat("basic"); PdfPCell cell3
			 * = new PdfPCell(new Phrase("" + rs.getFloat("basic"), f1));
			 * cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell3);
			 * 
			 * hra_total = hra_total + rs.getFloat("hra"); PdfPCell cell4 = new
			 * PdfPCell(new Phrase("" + rs.getFloat("hra"), f1));
			 * cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell4);
			 * 
			 * col_total = col_total + +rs.getFloat("col"); PdfPCell cell11 =
			 * new PdfPCell(new Phrase("" + rs.getFloat("col"), f1));
			 * cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell11);
			 * 
			 * medical_total = medical_total + rs.getFloat("medical"); PdfPCell
			 * cell5 = new PdfPCell(new Phrase("" + rs.getFloat("medical"),
			 * f1)); cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell5);
			 * 
			 * convall_total = convall_total + rs.getFloat("convall"); PdfPCell
			 * cell8 = new PdfPCell(new Phrase("" + rs.getFloat("convall"),
			 * f1)); cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell8);
			 * 
			 * edu_total = edu_total + rs.getFloat("education"); PdfPCell cell6
			 * = new PdfPCell(new Phrase("" + rs.getFloat("education"), f1));
			 * cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell6);
			 * 
			 * minins_total = minins_total + +rs.getFloat("min_ins"); PdfPCell
			 * cell9 = new PdfPCell(new Phrase("" + rs.getFloat("min_ins"),
			 * f1)); cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell9);
			 * 
			 * if (rs.getFloat("splall") == 0.0) { PdfPCell cell7 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell7); } else {
			 * float splall1 = rs.getFloat("splall"); splall_total =
			 * splall_total + splall1; PdfPCell cell7 = new PdfPCell(new
			 * Phrase("" + splall1, f1));
			 * cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell7); }
			 * 
			 * if (rs.getFloat("er1") == 0.0) { PdfPCell cell10 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell10); } else {
			 * float addless = rs.getFloat("er1"); addlss_total = addlss_total +
			 * addless; PdfPCell cell10 = new PdfPCell(new Phrase("" + addless,
			 * f1)); cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell10); }
			 * 
			 * if (rs.getFloat("er2") == 0.0) { PdfPCell cell12 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell12); } else {
			 * float spcl = rs.getFloat("er2"); special_total = special_total +
			 * spcl; PdfPCell cell12 = new PdfPCell( new Phrase("" + spcl, f1));
			 * cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell12); }
			 * 
			 * if (rs.getFloat("addinc") == 0.0) { PdfPCell cell23 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell23); } else {
			 * float add_inc = rs.getFloat("addinc"); addinc_total =
			 * addinc_total + add_inc; PdfPCell cell23 = new PdfPCell(new
			 * Phrase("" + add_inc, f1));
			 * cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell23); }
			 * 
			 * leave_TC = leave_TC + rs.getFloat("leavetc"); PdfPCell cell611 =
			 * new PdfPCell(new Phrase("" + rs.getFloat("leavetc"), f1));
			 * cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell611);
			 * 
			 * 
			 * any_total = any_total + rs.getFloat("ANY"); PdfPCell cell6111 =
			 * new PdfPCell(new Phrase(""+rs.getFloat("ANY"),f1));
			 * cell6111.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell6111);
			 * 
			 * 
			 * totinc_total = totinc_total + rs.getFloat("totear"); PdfPCell
			 * cell25 = new PdfPCell(new Phrase("" + rs.getFloat("totear"),
			 * f1)); cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell25);
			 * 
			 * PdfPCell cell2226 = new PdfPCell(new Phrase("", f1));
			 * cell2226.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell2226);
			 * 
			 * document.add(datatab);
			 * 
			 * datatab = new PdfPTable(16); datatab.setTableEvent(app.new
			 * DottedCells());
			 * datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
			 * datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f,
			 * 5.3f }, rec); datatab.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * 
			 * PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
			 * cell113.setFixedHeight(50); cell113.disableBorderSide(rec.TOP);
			 * datatab.addCell(cell113);
			 * 
			 * PdfPCell cell213 = new PdfPCell(new Phrase("", f1));
			 * cell213.disableBorderSide(rec.TOP); datatab.addCell(cell213);
			 * 
			 * if (rs.getFloat("pf") == 0.0) { PdfPCell cell13 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell13); } else {
			 * float pf = rs.getFloat("pf"); pf_total = pf_total + pf; PdfPCell
			 * cell13 = new PdfPCell(new Phrase("" + pf, f1));
			 * cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell13); }
			 * 
			 * if (rs.getFloat("esic") == 0.0f) { PdfPCell cell17 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell17); } else {
			 * float esic = rs.getFloat("esic"); esic_total = esic_total + esic;
			 * PdfPCell cell17 = new PdfPCell( new Phrase("" + esic, f1));
			 * cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell17); }
			 * 
			 * if (rs.getFloat("pt") == 0.0) { PdfPCell cell14 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell14); } else {
			 * float pt = rs.getFloat("pt"); pt_total = pt_total + pt; PdfPCell
			 * cell14 = new PdfPCell(new Phrase("" + pt, f1));
			 * cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell14); }
			 * 
			 * if (rs.getFloat("tds") == 0.0f) { PdfPCell cell22 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell22); } else {
			 * float tds = rs.getFloat("tds"); tds_total = tds_total + tds;
			 * PdfPCell cell22 = new PdfPCell(new Phrase("" + tds, f1));
			 * cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell22); }
			 * 
			 * if (rs.getFloat("adv") == 0.0f) { PdfPCell cell19 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell19); } else {
			 * float adv = rs.getFloat("adv"); adv_total = adv_total + adv;
			 * PdfPCell cell19 = new PdfPCell(new Phrase("" + adv, f1));
			 * cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell19); }
			 * 
			 * if (rs.getFloat("loan") == 0.0) { PdfPCell cell16 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell16); } else {
			 * float loan = rs.getFloat("loan"); loan_total = loan_total + loan;
			 * PdfPCell cell16 = new PdfPCell( new Phrase("" + loan, f1));
			 * cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell16); }
			 * 
			 * if (rs.getFloat("mob") == 0.0f) { PdfPCell cell18 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell18); } else {
			 * float mob = rs.getFloat("mob"); mob_total = mob_total + mob;
			 * PdfPCell cell18 = new PdfPCell(new Phrase("" + mob, f1));
			 * cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell18); }
			 * 
			 * if (rs.getFloat("netc") == 0.0f) { PdfPCell cell21 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell21); } else {
			 * float netc = rs.getFloat("netc"); netc_total = netc_total + netc;
			 * PdfPCell cell21 = new PdfPCell( new Phrase("" + netc, f1));
			 * cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell21); }
			 * 
			 * if (rs.getFloat("CurrAdv") == 0.0) { PdfPCell cell15 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell15); } else {
			 * float lic = rs.getFloat("CurrAdv"); lic_total = lic_total + lic;
			 * PdfPCell cell15 = new PdfPCell(new Phrase("" + lic, f1));
			 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell15); }
			 * 
			 * if (rs.getFloat("relif") == 0.0f) { PdfPCell cell20 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell20); } else {
			 * float relif = rs.getFloat("relif"); relif_total = relif_total +
			 * relif; PdfPCell cell20 = new PdfPCell(new Phrase("" + relif,
			 * f1)); cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell20); }
			 * 
			 * if (rs.getFloat("mlwf") == 0.0) { PdfPCell cell24 = new
			 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell24); } else {
			 * float mlwf_ded = rs.getFloat("mlwf"); mlwf_total = mlwf_total +
			 * mlwf_ded; PdfPCell cell24 = new PdfPCell(new Phrase( "" +
			 * mlwf_ded, f1));
			 * cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell24); }
			 * 
			 * other_total = other_total + rs.getFloat("other"); PdfPCell
			 * cell2131 = new PdfPCell(new Phrase("" + rs.getFloat("other"),
			 * f1)); cell2131.disableBorderSide(rec.TOP);
			 * cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell2131);
			 * 
			 * 
			 * PdfPCell cell21311 = new PdfPCell(new Phrase("",f1));
			 * cell21311.disableBorderSide(rec.TOP); datatab.addCell(cell21311);
			 * 
			 * 
			 * totded_total = totded_total + rs.getFloat("totded"); PdfPCell
			 * cell26 = new PdfPCell(new Phrase("" + rs.getFloat("totded"),
			 * f1)); cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell26);
			 * 
			 * 
			 * // netpay_total = totinc_total - totded_total; netpay_total =
			 * netpay_total + rs.getFloat("payable"); //
			 * System.out.println("Net_pay_total is :" +netpay_total); PdfPCell
			 * cell27 = new PdfPCell(new Phrase("" + netpay_total, f1));
			 * cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatab.addCell(cell27);
			 * 
			 * document.add(datatab);
			 * 
			 * // Total of columns ...............
			 * 
			 * tot_no_emp = tot_no_emp + 1; br_tot_no_emp = br_tot_no_emp + 1;
			 * if (!rs.next()) { break; } if
			 * (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) { rs.previous();
			 * break; } }
			 * 
			 * datatot = new PdfPTable(16); datatot.setWidthPercentage(new
			 * float[] { 4, 15.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f }, rec);
			 * 
			 * datatot.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * 
			 * PdfPCell cell1 = new PdfPCell(new Phrase("Total Income:--",
			 * fbold)); cell1.setColspan(2); cell1.setFixedHeight(50);
			 * cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell1);
			 * 
			 * PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total, f1));
			 * cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell3); lstbasic_total = lstbasic_total +
			 * basic_total; basic_total = 0.0f;
			 * 
			 * PdfPCell cell4 = new PdfPCell(new Phrase("" + hra_total, f1));
			 * cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell4); lsthra_total = lsthra_total + hra_total;
			 * hra_total = 0.0f;
			 * 
			 * PdfPCell cell11 = new PdfPCell(new Phrase("" + col_total, f1));
			 * cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell11); lstcol_total = lstcol_total + col_total;
			 * col_total = 0.0f;
			 * 
			 * PdfPCell cell5 = new PdfPCell( new Phrase("" + medical_total,
			 * f1)); cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell5); lstmedical_total = lstmedical_total +
			 * medical_total; medical_total = 0.0f;
			 * 
			 * PdfPCell cell8 = new PdfPCell( new Phrase("" + convall_total,
			 * f1)); cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell8); lstconvall_total = lstconvall_total +
			 * convall_total; convall_total = 0.0f;
			 * 
			 * PdfPCell cell6 = new PdfPCell(new Phrase("" + edu_total, f1));
			 * cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell6); lstedu_total = lstedu_total + edu_total;
			 * edu_total = 0.0f;
			 * 
			 * PdfPCell cell9 = new PdfPCell(new Phrase("" + minins_total, f1));
			 * cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell9); lstminins_total = lstminins_total +
			 * minins_total; minins_total = 0.0f;
			 * 
			 * PdfPCell cell7 = new PdfPCell(new Phrase("" + splall_total, f1));
			 * cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell7); lstsplall_total = lstsplall_total +
			 * splall_total; splall_total = 0.0f;
			 * 
			 * PdfPCell cell10 = new PdfPCell( new Phrase("" + addlss_total,
			 * f1)); cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell10); lstaddlss_total = lstaddlss_total +
			 * addlss_total; addlss_total = 0.0f;
			 * 
			 * PdfPCell cell12 = new PdfPCell(new Phrase("" + special_total,
			 * f1)); cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell12); lstspecial_total = lstspecial_total +
			 * special_total; special_total = 0.0f;
			 * 
			 * PdfPCell cell23 = new PdfPCell( new Phrase("" + addinc_total,
			 * f1)); cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell23); lstaddinc_total = lstaddinc_total +
			 * addinc_total; addinc_total = 0.0f;
			 * 
			 * PdfPCell cell61 = new PdfPCell(new Phrase("" + leave_TC, f1));
			 * cell61.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell61); lstleave_total = lstleave_total +
			 * leave_TC; leave_TC = 0.0f;
			 * 
			 * 
			 * PdfPCell cell611 = new PdfPCell(new Phrase(""+any_total,f1));
			 * cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell611); lstany_total = lstany_total +any_total;
			 * any_total = 0.0f;
			 * 
			 * 
			 * PdfPCell cell25 = new PdfPCell(new Phrase("" + totinc_total,
			 * fbold)); cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell25); lsttotinc_total = lsttotinc_total +
			 * totinc_total; totinc_total = 0.0f;
			 * 
			 * PdfPCell cell28 = new PdfPCell(new Phrase("Net Pay", fbold));
			 * cell28.setFixedHeight(50);
			 * cell28.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell28);
			 * 
			 * document.add(datatot);
			 * 
			 * // total second row.... datatot = new PdfPTable(16);
			 * datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
			 * 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f,
			 * 5.3f }, rec); datatot.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * 
			 * PdfPCell cell0 = new PdfPCell(new Phrase("Total Deduction:--",
			 * fbold)); cell0.setColspan(2); cell0.setFixedHeight(50);
			 * cell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell0);
			 * 
			 * PdfPCell cell13 = new PdfPCell(new Phrase("" + pf_total, f1));
			 * cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell13); lstpf_total = lstpf_total + pf_total;
			 * pf_total = 0.0f;
			 * 
			 * PdfPCell cell17 = new PdfPCell(new Phrase("" + esic_total, f1));
			 * cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell17); lstesic_total = lstesic_total +
			 * esic_total; esic_total = 0.0f;
			 * 
			 * PdfPCell cell14 = new PdfPCell(new Phrase("" + pt_total, f1));
			 * cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell14); lstpt_total = lstpt_total + pt_total;
			 * pt_total = 0.0f;
			 * 
			 * PdfPCell cell20 = new PdfPCell(new Phrase("" + tds_total, f1));
			 * cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell20); lsttds_total = lsttds_total + tds_total;
			 * tds_total = 0.0f;
			 * 
			 * PdfPCell cell19 = new PdfPCell(new Phrase("" + adv_total, f1));
			 * cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell19); lstadv_total = lstadv_total + adv_total;
			 * adv_total = 0.0f;
			 * 
			 * PdfPCell cell16 = new PdfPCell(new Phrase("" + loan_total, f1));
			 * cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell16); lstloan_total = lstloan_total +
			 * loan_total; loan_total = 0.0f;
			 * 
			 * PdfPCell cell18 = new PdfPCell(new Phrase("" + mob_total, f1));
			 * cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell18); lstmob_total = lstmob_total + mob_total;
			 * mob_total = 0.0f;
			 * 
			 * PdfPCell cell22 = new PdfPCell(new Phrase("" + netc_total, f1));
			 * cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell22); lstnetc_total = lstnetc_total +
			 * netc_total; netc_total = 0.0f;
			 * 
			 * PdfPCell cell15 = new PdfPCell(new Phrase("" + lic_total, f1));
			 * cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell15); lstlic_total = lstlic_total + lic_total;
			 * lic_total = 0.0f;
			 * 
			 * PdfPCell cell21 = new PdfPCell(new Phrase("" + relif_total, f1));
			 * cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell21); lstrelif_total = lstrelif_total +
			 * relif_total; relif_total = 0.0f;
			 * 
			 * PdfPCell cell24 = new PdfPCell(new Phrase("" + mlwf_total, f1));
			 * cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell24); lstmlwf_total = lstmlwf_total +
			 * mlwf_total; mlwf_total = 0.0f;
			 * 
			 * PdfPCell cell131 = new PdfPCell( new Phrase("" + other_total,
			 * f1)); cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell131); lstother_total = lstother_total +
			 * other_total; other_total = 0.0f;
			 * 
			 * 
			 * PdfPCell cell1311 = new PdfPCell(new Phrase("",f1));
			 * cell1311.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell1311);
			 * 
			 * 
			 * PdfPCell cell26 = new PdfPCell(new Phrase("" + totded_total,
			 * fbold)); cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell26); lsttotded_total = lsttotded_total +
			 * totded_total; totded_total = 0.0f;
			 * 
			 * PdfPCell cell27 = new PdfPCell(new Phrase("" + netpay_total,
			 * fbold)); cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * datatot.addCell(cell27); lstnetpay_total = lstnetpay_total +
			 * netpay_total; // netpay_total = 0.0f;
			 * 
			 * document.add(datatot);
			 * 
			 * para = new Paragraph(new Phrase("No Of Employee :- " +
			 * br_tot_no_emp, f)); para.setAlignment(Element.ALIGN_LEFT);
			 * para.setSpacingAfter(20); document.add(para);
			 * 
			 * }
			 * 
			 * para = new Paragraph(new Phrase("Total No Of Employee :- " +
			 * tot_no_emp, f)); para.setAlignment(Element.ALIGN_LEFT);
			 * para.setSpacingAfter(40); document.add(para);
			 * 
			 * System.out.println("Total No Of Employee :- " + tot_no_emp);
			 * 
			 * para = new Paragraph(new Phrase("-:Summary :- ", new Font(
			 * Font.HELVETICA, 40, Font.BOLDITALIC)));
			 * para.setAlignment(Element.ALIGN_CENTER);
			 * para.setSpacingAfter(10); document.add(para);
			 * 
			 * PdfPTable main = new PdfPTable(10); main.setSpacingBefore(10);
			 * main.setWidthPercentage( new float[] { 9, 9, 9, 9, 9, 9, 9, 9, 9,
			 * 9 }, rec); PdfPCell maincell;
			 * 
			 * maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
			 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstbasic_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" H.R.A Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lsthra_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Col Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstcol_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Medical Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell( new Phrase("" + trans((int)
			 * (lstmedical_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell( new Phrase("" + trans((int)
			 * (lstconvall_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" LTA Total:-", f));
			 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstleave_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Education Total:-", f));
			 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstedu_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Min Ins. Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstminins_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Spl All Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstsplall_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Earn 1 Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstaddlss_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Earn 2 Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell( new Phrase("" + trans((int)
			 * (lstspecial_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
			 * maincell.setFixedHeight(50); maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstaddinc_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * 
			 * maincell = new PdfPCell(new Phrase(" ANONYMOUS Total:-",f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(""+trans((int)(lstany_total),
			 * "", "", false, false),f2)); maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("", fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" P.F Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstpf_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" E.S.I.C Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstesic_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" P.T Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstpt_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" T.D.S Total:-", f));
			 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lsttds_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Advance Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstadv_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Loan Ded Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstloan_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Mobile Ded Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstmob_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Net Chrgs Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstnetc_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Current Advance Total:-",
			 * f)); maincell.setBorderWidthRight(0);
			 * maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstlic_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Relief Fund Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstrelif_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstmlwf_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("Other :-", f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lstother_total), "", "", false, false), f2));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Tot income Total:-",
			 * fbold)); maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lsttotinc_total), "", "", false, false), fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (lsttotded_total), "", "", false, false), fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
			 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("" + trans((int)
			 * (netpay_total), "", "", false, false), fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * 
			 * maincell = new PdfPCell(new Phrase("",fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("",fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 * 
			 * 
			 * document.add(main);
			 * 
			 * document.add(Chunk.NEWLINE); document.add(Chunk.NEWLINE);
			 * document.add(Chunk.NEWLINE); document.add(Chunk.NEWLINE);
			 * 
			 * para = new Paragraph( new Phrase(
			 * "Prepared By                         Checked By                        Approved By                 "
			 * , new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
			 * para.setAlignment(Element.ALIGN_RIGHT);
			 * para.setSpacingBefore(30); document.add(para);
			 * 
			 * stmtInsert.close(); stmtTrnct.close(); st.close(); con.close();
			 * document.close();
			 * 
			 * }
			 * 
			 * catch (Exception e) { e.printStackTrace(); }
			 */

			System.out.println("hello am in IDDDDD");
			ReportDAO.OpenCon("", "", "", repBean);
			con = repBean.getCn();
			Statement st = con.createStatement(
					ResultSet.TYPE_SCROLL_INSENSITIVE,
					ResultSet.CONCUR_READ_ONLY);
			Statement stmtInsert = con.createStatement();
			Statement stmtTrnct = con.createStatement();

			DottedLineCell app = new DottedLineCell();
			System.out.println("in income & Deduction head");

			// A4 size pdf....
			Document document = new Document(new Rectangle(2384, 3370));
			// Document doc = new Document(new Rectangle(2834,4008));

			document.left(100f);
			document.top(100f);
			document.bottom(100f);
			document.right(100f);

			PdfWriter writer = PdfWriter.getInstance(document,
					new FileOutputStream(filepath));
			HeaderAndFooter haf = new HeaderAndFooter(lable1, label2);
			writer.setPageEvent(haf);
			document.open();
			Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL,
					new GrayColor(0.85f));
			ColumnText.showTextAligned(writer.getDirectContentUnder(),
					Element.ALIGN_CENTER,
					new Phrase(prop.getProperty("watermark"), FONT), 1300f,
					1830f, 45);
			Image image1 = Image.getInstance(imgpath);

			Phrase title = new Phrase(prop.getProperty("companyName"),
					new Font(FONT.TIMES_ROMAN, 22, Font.BOLD));
			Paragraph para = new Paragraph(title);
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingBefore(0);
			image1.scaleAbsolute(310f, 120f);

			// chaange possition of image
			/* image1.setAbsolutePosition(60f, 2750f); */
			image1.setAbsolutePosition(60f, 3200f);
			document.add(image1);
			document.add(para);

			para = new Paragraph(new Phrase(
					prop.getProperty("addressForReport"), new Font(
							Font.TIMES_ROMAN, 20)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(
					prop.getProperty("contactForReport"), new Font(
							Font.TIMES_ROMAN, 20)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(0);

			document.add(para);
			para = new Paragraph(new Phrase(prop.getProperty("mailForReport"),
					new Font(Font.TIMES_ROMAN, 20)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			document.add(para);

			Font f = new Font(Font.HELVETICA, 22);
			Font f1 = new Font(Font.HELVETICA, 22);
			Font fbold = new Font(Font.HELVETICA, 22, Font.BOLD);
			Font f2 = new Font(Font.HELVETICA, 22);

			para = new Paragraph(new Phrase(
					"Salary Sheet For The Income Heads for the Month Of :- "
							+ temp + " (Pending for Release)", new Font(
							Font.TIMES_ROMAN, 20)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);

			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(30);

			document.add(para);

			Rectangle rec = new Rectangle(100, 100);

			float basic_total = 0.0f, lstbasic_total = 0.0f, lic_total = 0.0f, lstlic_total = 0.0f, hra_total = 0.0f, lsthra_total = 0.0f, medical_total = 0.0f;
			float lstmedical_total = 0.0f;

			float leave_TC = 0.0f, lstleave_total = 0.0f;

			float any_total = 0.0f, lstany_total = 0.0f;

			float edu_total = 0.0f, lstedu_total = 0.0f, splall_total = 0.0f, lstsplall_total = 0.0f, convall_total = 0.0f, lstconvall_total = 0.0f;
			float pf_total = 0.0f, lstpf_total = 0.0f, pt_total = 0.0f, lstpt_total = 0.0f;

			float mlwf_total = 0.0f, lstmlwf_total = 0.0f;
			float other_total = 0.0f, med_total = 0.0f, ERP_total = 0.0f, istotmed_total = 0.0f, istotERPDED_total = 0.0f, lstother_total = 0.0f;

			float esic_total = 0.0f;
			float lstesic_total = 0.0f;
			float mob_total = 0.0f;
			float lstmob_total = 0.0f;
			float adv_total = 0.0f;
			float lstadv_total = 0.0f;
			float tds_total = 0.0f;
			float lsttds_total = 0.0f;
			float relif_total = 0.0f;
			float lstrelif_total = 0.0f;
			float netc_total = 0.0f;
			float lstnetc_total = 0.0f;
			float minins_total = 0.0f;
			float lstminins_total = 0.0f;
			float addlss_total = 0.0f;
			float lstaddlss_total = 0.0f;
			float col_total = 0.0f;
			float lstcol_total = 0.0f;
			float special_total = 0.0f;
			float lstspecial_total = 0.0f;
			float addinc_total = 0.0f;
			float lstaddinc_total = 0.0f;
			float totinc_total = 0.0f;
			float lsttotinc_total = 0.0f;

			float loan_total = 0.0f, lstloan_total = 0.0f;

			// float addded_total = 0.0f;
			// float lstaddded_total = 0.0f;

			float totded_total = 0.0f;
			float lsttotded_total = 0.0f;
			float netpay_total = 0.0f;
			float lstnetpay_total = 0.0f;

			EmpSql = "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
					+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
					+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)   "
					+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN WHERE TRNCD = 101 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
					+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN WHERE TRNCD = 999 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
					+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN WHERE TRNCD = 103 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
					+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN WHERE TRNCD = 104 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
					+

					"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		"
					+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN WHERE TRNCD = 106 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC', "
					+

					"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		"
					+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN WHERE TRNCD = 105 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',           "
					+

					" CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN WHERE TRNCD = 108 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
					+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN WHERE TRNCD = 126 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
					+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN WHERE TRNCD = 128 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
					+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN WHERE TRNCD = 131 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
					+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN WHERE TRNCD = 130 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 107 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN WHERE TRNCD = 107  AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)    			"
					+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
					+

					"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
					+

					"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN WHERE TRNCD = 201 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)    			"
					+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN WHERE TRNCD = 202 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
					+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN WHERE TRNCD = 227 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN WHERE TRNCD = 221 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
					+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN WHERE TRNCD = 223 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN WHERE TRNCD = 225 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN WHERE TRNCD = 228 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN WHERE TRNCD = 211 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN WHERE TRNCD = 207 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN WHERE TRNCD = 208 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
					+

					"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN WHERE TRNCD = 229 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)	"
					+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN WHERE TRNCD = 230 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
					+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN WHERE TRNCD = 226 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
					+ "    case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
					+ "    and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO =  EMPMAST.EMPNO )"
					+ "	 THEN	(select SUM(net_amt) as addinc from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
					+ "    and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO =  EMPMAST.EMPNO) "
					+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
					+ "      case when EXISTS(select SUM(net_amt)   from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
					+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  THEN	(select SUM(net_amt)  as other from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
					+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
					+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  THEN			(select SUM(net_amt) as totded from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 201 and 299) "
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)	"
					+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
					+ "	  case when EXISTS(select SUM(net_amt) from   PAYTRAN  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO) "
					+ "	  THEN	(select SUM(net_amt) from   PAYTRAN  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
					+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
					+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
					+ EomDt
					+ "'"
					+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
					+ EomDt
					+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
					+ BomDt
					+ "' )) )"
					+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN WHERE TRNDT BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' AND T.PRJ_SRNO="
					+ siteId
					+ " ) "
					+

					"    UNION "
					+ "         SELECT  EMPCODE , RTRIM(EMPMAST.FNAME)+' '+RTRIM(EMPMAST.MNAME)+' '+RTRIM(EMPMAST.LNAME)AS NAME,"
					+ "     	EMPMAST.EMPNO,   T.PRJ_SRNO,"
					+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN	(SELECT NET_AMT AS BASIC  FROM   PAYTRAN_STAGE WHERE TRNCD = 101 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE	(SELECT 0 AS BASIC) END AS 'BASIC',"
					+ "	    CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS PAYABLE  FROM   PAYTRAN_STAGE WHERE TRNCD = 999 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS PAYABLE) END AS 'PAYABLE',"
					+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS HRA  FROM   PAYTRAN_STAGE WHERE TRNCD = 103 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS HRA) END AS 'HRA',"
					+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN			(SELECT NET_AMT AS MEDICAL  FROM   PAYTRAN_STAGE WHERE TRNCD = 104 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS MEDICAL) END AS 'MEDICAL',   "
					+

					"       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		"
					+ "	    THEN		(SELECT NET_AMT AS LEAVETC  FROM   PAYTRAN_STAGE WHERE TRNCD = 106 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    ELSE 	(SELECT 0 AS LEAVETC) END AS 'LEAVETC',  "
					+ "       CASE  WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		"
					+ "	    THEN		(SELECT NET_AMT AS EDUCATION  FROM   PAYTRAN_STAGE WHERE TRNCD = 105 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    ELSE 	(SELECT 0 AS EDUCATION) END AS 'EDUCATION',  "
					+

					"          CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	    THEN			(SELECT NET_AMT AS CONVALL  FROM   PAYTRAN_STAGE WHERE TRNCD = 108 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS CONVALL) END AS 'CONVALL',"
					+ "       CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN		(SELECT NET_AMT AS MIN_INS  FROM   PAYTRAN_STAGE WHERE TRNCD = 126 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS MIN_INS) END AS 'MIN_INS',"
					+ "         CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN			(SELECT NET_AMT AS COL  FROM   PAYTRAN_STAGE WHERE TRNCD = 128 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS COL) END AS 'COL',"
					+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS ER2  FROM   PAYTRAN_STAGE WHERE TRNCD = 131 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			ELSE				(SELECT 0 AS ER2) END AS 'er2',"
					+ "				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS ER1  FROM   PAYTRAN_STAGE WHERE TRNCD = 130 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE				(SELECT 0 AS ER1) END AS 'er1',  CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 107 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "				THEN (SELECT NET_AMT AS splall  FROM   PAYTRAN_STAGE WHERE TRNCD = 107  AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)    			"
					+ "	ELSE (SELECT 0 AS splall) END AS 'splall',"
					+

					"				 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS ANYm  FROM   PAYTRAN WHERE TRNCD = 145 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE				(SELECT 0 AS ANYm) END AS 'ANY', "
					+

					"			 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS pf  FROM   PAYTRAN_STAGE WHERE TRNCD = 201 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)    			"
					+ "		ELSE		(SELECT 0 AS pf) END AS 'pf',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS pt  FROM   PAYTRAN_STAGE WHERE TRNCD = 202 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)		ELSE			(SELECT 0 AS pt) END AS 'pt', "
					+ "   CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN			(SELECT NET_AMT AS CurrAdv  FROM   PAYTRAN_STAGE WHERE TRNCD = 227 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "				ELSE		(SELECT 0 AS CurrAdv) END AS 'CurrAdv',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS esic  FROM   PAYTRAN_STAGE WHERE TRNCD = 221 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE		(SELECT 0 AS esic) END AS 'esic',"
					+ "		 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		THEN		(SELECT NET_AMT AS mob  FROM   PAYTRAN_STAGE WHERE TRNCD = 223 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "		ELSE  (SELECT 0 AS mob) END AS 'mob',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "			THEN		(SELECT NET_AMT AS adv  FROM   PAYTRAN_STAGE WHERE TRNCD = 225 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE	(SELECT 0 AS adv) END AS 'adv',"
					+ "	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS tds  FROM   PAYTRAN_STAGE WHERE TRNCD = 228 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS tds) END AS 'tds',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS mlwf  FROM   PAYTRAN_STAGE WHERE TRNCD = 211 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS mlwf) END AS 'mlwf',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS med  FROM   PAYTRAN_STAGE WHERE TRNCD = 207 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS med) END AS 'med',"
					+

					"	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS erp  FROM   PAYTRAN_STAGE WHERE TRNCD = 208 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS erp) END AS 'erp',"
					+

					"	CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS relif  FROM   PAYTRAN_STAGE WHERE TRNCD = 229 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)	"
					+ "	ELSE	(SELECT 0 AS relif) END AS 'relif',	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN		(SELECT NET_AMT AS netc  FROM   PAYTRAN_STAGE WHERE TRNCD = 230 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	ELSE		(SELECT 0 AS netc) END AS 'netc',"
					+ " 	 CASE WHEN EXISTS(SELECT NET_AMT FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	THEN	(SELECT NET_AMT AS loan  FROM   PAYTRAN_STAGE WHERE TRNCD = 226 AND TRNDT BETWEEN '"
					+ BomDt
					+ "' AND '"
					+ EomDt
					+ "' AND EMPNO = EMPMAST.EMPNO)"
					+ "	  ELSE		(SELECT 0 AS loan) END AS 'LOAN',"
					+ "    case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
					+ "    and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO =  EMPMAST.EMPNO )"
					+ "	 THEN	(select SUM(net_amt) as addinc from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "    and TRNCD not in(101,103,104,105,106,108,126,128,107,130,131,145)"
					+ "    and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO =  EMPMAST.EMPNO) "
					+ "	 ELSE		(SELECT 0 AS addinc) END AS 'addinc',"
					+ "      case when EXISTS(select SUM(net_amt)   from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
					+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  THEN	(select SUM(net_amt)  as other from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
					+ "     and TRNCD not in(201,202,205,221,223,225,228,229,230,226,211,227,207,208) and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  ELSE	(SELECT 0 AS other) END AS 'other' ,"
					+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  THEN			(select SUM(net_amt) as totded from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 200 and 299) "
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)	"
					+ "	  ELSE 	(SELECT 0 AS totded) END AS 'totded' ,"
					+ "	  case when EXISTS(select SUM(net_amt) from   paytran_stage  where TRNCD in (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO) "
					+ "	  THEN	(select SUM(net_amt) from   paytran_stage  where TRNCD in    (select TRNCD from CDMAST where PSLIPYN = 'Y' and TRNCD between 100 and 198)"
					+ "     and trndt BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "' and EMPNO = empmast.EMPNO)"
					+ "	  ELSE		(SELECT 0 AS totear) END AS 'totear'"
					+ "     from EMPMAST empmast     join   EMPTRAN t on t.EMPNO = empmast.EMPNO"
					+ "     where      T.srno =(SELECT MAX(E2.SRNO) FROM EMPTRAN E2 WHERE E2.EMPNO = empmast.EMPNO AND E2.EFFDATE <= '"
					+ EomDt
					+ "'"
					+ "     and (( empmast.STATUS='A' AND	empmast.DOJ <= '"
					+ EomDt
					+ "') or  (empmast.STATUS ='N' And empmast.DOL>='"
					+ BomDt
					+ "' )) )"
					+ "     AND T.EMPNO in (SELECT DISTINCT EMPNO FROM PAYTRAN_STAGE WHERE TRNDT BETWEEN '"
					+ BomDt
					+ "' and '"
					+ EomDt
					+ "') "
					+ " AND T.PRJ_SRNO="
					+ siteId + "     order by   t.PRJ_SRNO,empno  ";

			System.out.println(EmpSql);

			ResultSet rs = st.executeQuery(EmpSql);

			while (rs.next()) {

				String prj_name = null;
				String prj_code = null;

				Connection conn = ConnectionManager.getConnectionTech();

				Statement stmt = conn.createStatement();
				String prjquery = "select Site_Name,Project_Code from Project_Sites where SITE_ID = '"
						+ rs.getString("PRJ_SRNO") + "'";
				// System.out.println(prjquery);

				ResultSet prj = stmt.executeQuery(prjquery);

				if (prj.next()) {
					prj_name = prj.getString("Site_Name");
					prj_code = prj.getString("Project_Code");
				}

				pBrcd1 = rs.getString("PRJ_SRNO");
				br_tot_no_emp = 0;

				para = new Paragraph(new Phrase(
						"Employee's Salary List For Project Site : " + prj_name
								+ " (" + prj_code + ")", f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(4);

				document.add(para);

				prj.close();
				stmt.close();
				conn.close();

				PdfPTable datatab;
				PdfPTable datatot;

				PdfPTable main = new PdfPTable(18);
				main.setSpacingBefore(10);

				main.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
						4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 5.3f,
						5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
				main.setHorizontalAlignment(Element.ALIGN_LEFT);
				PdfPCell maincell;

				maincell = new PdfPCell(new Phrase("CODE", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.setFixedHeight(50);
				maincell.disableBorderSide(rec.BOTTOM);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("EMPNAME", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				maincell.disableBorderSide(rec.BOTTOM);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Basic", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("H.R.A", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Col", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Medical", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Conv All", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Education", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Min Ins.", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Spl All", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 1", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Earn 2", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Add Income", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("LTA", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				/*
				 * maincell = new PdfPCell(new Phrase("ANONYMOUS",fbold));
				 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				 * main.addCell(maincell);
				 */
				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("Tot income", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				maincell = new PdfPCell(new Phrase("", fbold));
				maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
				main.addCell(maincell);

				document.add(main);

				datatab = new PdfPTable(18);
				datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
						4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 5.3f,
						5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
				datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell maincell1 = new PdfPCell(new Phrase("", fbold));
				maincell1.disableBorderSide(rec.TOP);
				maincell1.setFixedHeight(50);
				// maincell1.setColspan(2);
				datatab.addCell(maincell1);

				PdfPCell maincell2 = new PdfPCell(new Phrase("", fbold));
				maincell2.disableBorderSide(rec.TOP);
				maincell2.setFixedHeight(50);
				datatab.addCell(maincell2);

				PdfPCell maincell3 = new PdfPCell(new Phrase("PF", fbold));
				maincell3.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell3);

				PdfPCell maincell4 = new PdfPCell(new Phrase("E.S.I.C", fbold));
				maincell4.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell4);

				PdfPCell maincell5 = new PdfPCell(new Phrase("P.T", fbold));
				maincell5.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell5);

				PdfPCell maincell6 = new PdfPCell(new Phrase("T.D.S", fbold));
				maincell6.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell6);

				PdfPCell maincell7 = new PdfPCell(new Phrase("Advance", fbold));
				maincell7.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell7);

				PdfPCell maincell8 = new PdfPCell(new Phrase("Loan Ded", fbold));
				maincell8.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell8);

				PdfPCell maincell9 = new PdfPCell(new Phrase("Mobile Ded",
						fbold));
				maincell9.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell9);

				PdfPCell maincell10 = new PdfPCell(new Phrase("Net Charges",
						fbold));
				maincell10.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell10);

				PdfPCell maincell11 = new PdfPCell(new Phrase(
						"Current Advance", fbold));
				maincell11.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell11);

				PdfPCell maincell12 = new PdfPCell(new Phrase("Relif", fbold));
				maincell12.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell12);

				PdfPCell maincell13 = new PdfPCell(new Phrase("MLWF", fbold));
				maincell13.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell13);

				PdfPCell maincell111 = new PdfPCell(new Phrase("Other", fbold));
				maincell111.disableBorderSide(rec.TOP);
				maincell111.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell111);

				PdfPCell maincellmed = new PdfPCell(
						new Phrase("Med Ded", fbold));
				maincellmed.disableBorderSide(rec.TOP);
				maincellmed.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincellmed);

				PdfPCell maincellERP = new PdfPCell(new Phrase("ERP", fbold));
				maincellERP.disableBorderSide(rec.TOP);
				maincellERP.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincellERP);
				/*
				 * PdfPCell maincell1111 = new PdfPCell(new Phrase("",fbold));
				 * maincell1111.disableBorderSide(rec.TOP);
				 * maincell1111.setFixedHeight(50);
				 * datatab.addCell(maincell1111);
				 */

				PdfPCell maincell14 = new PdfPCell(new Phrase("Tot Ded", fbold));
				maincell14.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell14);

				PdfPCell maincell15 = new PdfPCell(new Phrase("Net Pay", fbold));
				maincell15.setHorizontalAlignment(Element.ALIGN_CENTER);
				datatab.addCell(maincell15);

				document.add(datatab);

				while (pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
					System.out.println("this is pbrcd...." + pBrcd1);
					float pageHeight = writer.getPageSize().getHeight();

					/*
					 * if(pageHeight-70 == 3370 ){
					 * 
					 * }
					 */

					datatab = new PdfPTable(18);
					datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell1 = new PdfPCell(new Phrase(""
							+ rs.getString("EMPCODE"), f1));
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					cell1.setFixedHeight(50);
					cell1.disableBorderSide(rec.BOTTOM);

					datatab.addCell(cell1);

					PdfPCell cell2 = new PdfPCell(new Phrase(""
							+ rs.getString("name"), f));
					cell2.disableBorderSide(rec.BOTTOM);
					cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
					datatab.addCell(cell2);

					basic_total = basic_total + rs.getFloat("basic");
					PdfPCell cell3 = new PdfPCell(new Phrase(""
							+ rs.getFloat("basic"), f1));
					cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell3);

					hra_total = hra_total + rs.getFloat("hra");
					PdfPCell cell4 = new PdfPCell(new Phrase(""
							+ rs.getFloat("hra"), f1));
					cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell4);

					col_total = col_total + +rs.getFloat("col");
					PdfPCell cell11 = new PdfPCell(new Phrase(""
							+ rs.getFloat("col"), f1));
					cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell11);

					medical_total = medical_total + rs.getFloat("medical");
					PdfPCell cell5 = new PdfPCell(new Phrase(""
							+ rs.getFloat("medical"), f1));
					cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell5);

					convall_total = convall_total + rs.getFloat("convall");
					PdfPCell cell8 = new PdfPCell(new Phrase(""
							+ rs.getFloat("convall"), f1));
					cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell8);

					edu_total = edu_total + rs.getFloat("education");
					PdfPCell cell6 = new PdfPCell(new Phrase(""
							+ rs.getFloat("education"), f1));
					cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell6);

					minins_total = minins_total + rs.getFloat("min_ins");
					PdfPCell cell9 = new PdfPCell(new Phrase(""
							+ rs.getFloat("min_ins"), f1));
					cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell9);

					if (rs.getFloat("splall") == 0.0) {
						PdfPCell cell7 = new PdfPCell(new Phrase(""
								+ rs.getFloat("splall"), f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);
					} else {
						float splall1 = rs.getFloat("splall");
						splall_total = splall_total + splall1;
						PdfPCell cell7 = new PdfPCell(new Phrase("" + splall1,
								f1));
						cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell7);
					}

					if (rs.getFloat("er1") == 0.0) {
						PdfPCell cell10 = new PdfPCell(new Phrase(""
								+ rs.getFloat("er1"), f1));
						cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell10);
					} else {
						float addless = rs.getFloat("er1");
						addlss_total = addlss_total + addless;
						PdfPCell cell10 = new PdfPCell(new Phrase("" + addless,
								f1));
						cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell10);
					}

					if (rs.getFloat("er2") == 0.0) {
						PdfPCell cell12 = new PdfPCell(new Phrase(""
								+ rs.getFloat("er2"), f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);
					} else {
						float spcl = rs.getFloat("er2");
						special_total = special_total + spcl;
						PdfPCell cell12 = new PdfPCell(
								new Phrase("" + spcl, f1));
						cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell12);
					}

					/*
					 * if (rs.getFloat("addinc") == 0.0) { PdfPCell cell23 = new
					 * PdfPCell(new Phrase("", f1)); datatab.addCell(cell23); }
					 * else { float add_inc = rs.getFloat("addinc");
					 * addinc_total = addinc_total + add_inc;
					 * System.out.println("Emp Bonus is:- "+addinc_total);
					 * PdfPCell cell23 = new PdfPCell(new Phrase("" + add_inc,
					 * f1)); cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatab.addCell(cell23); }
					 */
					float add_inc = rs.getFloat("addinc");
					addinc_total = addinc_total + add_inc;
					System.out.println("Emp Bonus is:- " + addinc_total);
					PdfPCell cell23 = new PdfPCell(new Phrase("" + add_inc, f1));
					cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell23);

					leave_TC = leave_TC + rs.getFloat("leavetc");
					PdfPCell cell611 = new PdfPCell(new Phrase(""
							+ rs.getFloat("leavetc"), f1));
					cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell611);

					/*
					 * any_total = any_total + rs.getFloat("ANY"); PdfPCell
					 * cell6111 = new PdfPCell(new
					 * Phrase(""+rs.getFloat("ANY"),f1));
					 * cell6111.setHorizontalAlignment(Element.ALIGN_RIGHT);
					 * datatab.addCell(cell6111);
					 */
					PdfPCell cell2226 = new PdfPCell(new Phrase("", f1));
					cell2226.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell2226);

					PdfPCell cell2227 = new PdfPCell(new Phrase("", f1));
					cell2227.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell2227);

					totinc_total = totinc_total + rs.getFloat("totear");
					PdfPCell cell25 = new PdfPCell(new Phrase(""
							+ rs.getFloat("totear"), f1));
					cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell25);

					PdfPCell cell2228 = new PdfPCell(new Phrase("", f1));
					cell2228.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell2228);

					document.add(datatab);

					datatab = new PdfPTable(18);
					/* datatab.setTableEvent(app.new DottedCells()); */
					datatab.getDefaultCell().setBorder(PdfPCell.NO_BORDER);
					datatab.setWidthPercentage(new float[] { 4, 15.5f, 5.3f,
							5.3f, 4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f,
							4.8f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
					datatab.setHorizontalAlignment(Element.ALIGN_LEFT);

					PdfPCell cell113 = new PdfPCell(new Phrase("", f1));
					cell113.setFixedHeight(50);
					cell113.disableBorderSide(rec.TOP);
					datatab.addCell(cell113);

					PdfPCell cell213 = new PdfPCell(new Phrase("", f1));
					cell213.disableBorderSide(rec.TOP);
					datatab.addCell(cell213);

					if (rs.getFloat("pf") == 0.0) {
						PdfPCell cell13 = new PdfPCell(new Phrase(""
								+ rs.getFloat("pf"), f1));
						cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell13);
					} else {
						float pf = rs.getFloat("pf");
						pf_total = pf_total + pf;
						PdfPCell cell13 = new PdfPCell(new Phrase("" + pf, f1));
						cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell13);
					}

					if (rs.getFloat("esic") == 0.0f) {
						PdfPCell cell17 = new PdfPCell(new Phrase(""
								+ rs.getFloat("esic"), f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);
					} else {
						float esic = rs.getFloat("esic");
						esic_total = esic_total + esic;
						PdfPCell cell17 = new PdfPCell(
								new Phrase("" + esic, f1));
						cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell17);
					}

					if (rs.getFloat("pt") == 0.0) {
						PdfPCell cell14 = new PdfPCell(new Phrase(""
								+ rs.getFloat("pt"), f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);
					} else {
						float pt = rs.getFloat("pt");
						pt_total = pt_total + pt;
						PdfPCell cell14 = new PdfPCell(new Phrase("" + pt, f1));
						cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell14);
					}

					if (rs.getFloat("tds") == 0.0f) {
						PdfPCell cell22 = new PdfPCell(new Phrase(""
								+ rs.getFloat("tds"), f1));
						cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell22);
					} else {
						float tds = rs.getFloat("tds");
						tds_total = tds_total + tds;
						PdfPCell cell22 = new PdfPCell(new Phrase("" + tds, f1));
						cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell22);
					}

					if (rs.getFloat("adv") == 0.0f) {
						PdfPCell cell19 = new PdfPCell(new Phrase(""
								+ rs.getFloat("adv"), f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);
					} else {
						float adv = rs.getFloat("adv");
						adv_total = adv_total + adv;
						PdfPCell cell19 = new PdfPCell(new Phrase("" + adv, f1));
						cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell19);
					}

					if (rs.getFloat("loan") == 0.0) {
						PdfPCell cell16 = new PdfPCell(new Phrase(""
								+ rs.getFloat("loan"), f1));
						cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell16);
					} else {
						float loan = rs.getFloat("loan");
						loan_total = loan_total + loan;
						PdfPCell cell16 = new PdfPCell(
								new Phrase("" + loan, f1));
						cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell16);
					}

					if (rs.getFloat("mob") == 0.0f) {
						PdfPCell cell18 = new PdfPCell(new Phrase(""
								+ rs.getFloat("mob"), f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);
					} else {
						float mob = rs.getFloat("mob");
						mob_total = mob_total + mob;
						PdfPCell cell18 = new PdfPCell(new Phrase("" + mob, f1));
						cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell18);
					}

					if (rs.getFloat("netc") == 0.0f) {
						PdfPCell cell21 = new PdfPCell(new Phrase(""
								+ rs.getFloat("netc"), f1));
						cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell21);
					} else {
						float netc = rs.getFloat("netc");
						netc_total = netc_total + netc;
						PdfPCell cell21 = new PdfPCell(
								new Phrase("" + netc, f1));
						cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell21);
					}

					if (rs.getFloat("CurrAdv") == 0.0) {
						PdfPCell cell15 = new PdfPCell(new Phrase(""
								+ rs.getFloat("CurrAdv"), f1));
						cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell15);
					} else {
						float lic = rs.getFloat("CurrAdv");
						lic_total = lic_total + lic;
						PdfPCell cell15 = new PdfPCell(new Phrase("" + lic, f1));
						cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell15);
					}

					if (rs.getFloat("relif") == 0.0f) {
						PdfPCell cell20 = new PdfPCell(new Phrase(""
								+ rs.getFloat("relif"), f1));
						cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell20);
					} else {
						float relif = rs.getFloat("relif");
						relif_total = relif_total + relif;
						PdfPCell cell20 = new PdfPCell(new Phrase("" + relif,
								f1));
						cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell20);
					}

					if (rs.getFloat("mlwf") == 0.0) {
						PdfPCell cell24 = new PdfPCell(new Phrase(""
								+ rs.getFloat("mlwf"), f1));
						cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell24);
					} else {
						float mlwf_ded = rs.getFloat("mlwf");
						mlwf_total = mlwf_total + mlwf_ded;
						PdfPCell cell24 = new PdfPCell(new Phrase(
								"" + mlwf_ded, f1));
						cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cell24);
					}

					other_total = other_total + rs.getFloat("other");
					PdfPCell cell2131 = new PdfPCell(new Phrase(""
							+ rs.getFloat("other"), f1));
					cell2131.disableBorderSide(rec.TOP);
					cell2131.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell2131);

					/* for medical Insurance & ERP */
					if (rs.getFloat("med") == 0.0) {
						PdfPCell cellmed = new PdfPCell(new Phrase(""
								+ rs.getFloat("med"), f1));
						cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cellmed);
					} else {
						float med_ded = rs.getFloat("med");
						med_total = med_total + med_ded;
						PdfPCell cellmed = new PdfPCell(new Phrase(
								"" + med_ded, f1));
						cellmed.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cellmed);
					}

					if (rs.getFloat("erp") == 0.0) {
						PdfPCell cellERP = new PdfPCell(new Phrase(""
								+ rs.getFloat("erp"), f1));
						cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cellERP);
					} else {
						float ERP_ded = rs.getFloat("erp");
						ERP_total = ERP_total + ERP_ded;
						PdfPCell cellERP = new PdfPCell(new Phrase(
								"" + ERP_ded, f1));
						cellERP.setHorizontalAlignment(Element.ALIGN_RIGHT);
						datatab.addCell(cellERP);
					}

					/*
					 * PdfPCell cell21311 = new PdfPCell(new Phrase("",f1));
					 * cell21311.disableBorderSide(rec.TOP);
					 * datatab.addCell(cell21311);
					 */

					totded_total = totded_total + rs.getFloat("totded");
					PdfPCell cell26 = new PdfPCell(new Phrase(""
							+ rs.getFloat("totded"), f1));
					cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell26);

					netpay_total = totinc_total - totded_total;
					// netpay_total = netpay_total + rs.getFloat("payable");
					System.out
							.println("Net Pay Total Old is:- " + netpay_total);
					// System.out.println("Add Income is:- "+rs.getFloat("addinc"));
					PdfPCell cell27 = new PdfPCell(new Phrase(""
							+ rs.getFloat("payable"), f1));
					cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
					datatab.addCell(cell27);

					document.add(datatab);

					// Total of columns ...............

					tot_no_emp = tot_no_emp + 1;
					br_tot_no_emp = br_tot_no_emp + 1;
					if (!rs.next()) {
						break;
					}
					if (!pBrcd1.equals(rs.getString("PRJ_SRNO"))) {
						rs.previous();
						break;
					}
				}

				datatot = new PdfPTable(18);
				datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
						4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 5.3f,
						5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);

				datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell1 = new PdfPCell(new Phrase("Total Income:--",
						fbold));
				cell1.setColspan(2);
				cell1.setFixedHeight(50);
				cell1.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell1);

				PdfPCell cell3 = new PdfPCell(new Phrase("" + basic_total, f1));
				cell3.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell3);
				lstbasic_total = lstbasic_total + basic_total;
				basic_total = 0.0f;

				PdfPCell cell4 = new PdfPCell(new Phrase("" + hra_total, f1));
				cell4.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell4);
				lsthra_total = lsthra_total + hra_total;
				hra_total = 0.0f;

				PdfPCell cell11 = new PdfPCell(new Phrase("" + col_total, f1));
				cell11.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell11);
				lstcol_total = lstcol_total + col_total;
				col_total = 0.0f;

				PdfPCell cell5 = new PdfPCell(
						new Phrase("" + medical_total, f1));
				cell5.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell5);
				lstmedical_total = lstmedical_total + medical_total;
				medical_total = 0.0f;

				PdfPCell cell8 = new PdfPCell(
						new Phrase("" + convall_total, f1));
				cell8.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell8);
				lstconvall_total = lstconvall_total + convall_total;
				convall_total = 0.0f;

				PdfPCell cell6 = new PdfPCell(new Phrase("" + edu_total, f1));
				cell6.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell6);
				lstedu_total = lstedu_total + edu_total;
				edu_total = 0.0f;

				PdfPCell cell9 = new PdfPCell(new Phrase("" + minins_total, f1));
				cell9.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell9);
				lstminins_total = lstminins_total + minins_total;
				minins_total = 0.0f;

				PdfPCell cell7 = new PdfPCell(new Phrase("" + splall_total, f1));
				cell7.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell7);
				lstsplall_total = lstsplall_total + splall_total;
				splall_total = 0.0f;

				PdfPCell cell10 = new PdfPCell(
						new Phrase("" + addlss_total, f1));
				cell10.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell10);
				lstaddlss_total = lstaddlss_total + addlss_total;
				addlss_total = 0.0f;

				PdfPCell cell12 = new PdfPCell(new Phrase("" + special_total,
						f1));
				cell12.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell12);
				lstspecial_total = lstspecial_total + special_total;
				special_total = 0.0f;

				PdfPCell cell23 = new PdfPCell(
						new Phrase("" + addinc_total, f1));
				cell23.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell23);
				lstaddinc_total = lstaddinc_total + addinc_total;
				addinc_total = 0.0f;

				PdfPCell cell61 = new PdfPCell(new Phrase("" + leave_TC, f1));
				cell61.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell61);
				lstleave_total = lstleave_total + leave_TC;
				leave_TC = 0.0f;

				/*
				 * PdfPCell cell611 = new PdfPCell(new Phrase(""+any_total,f1));
				 * cell611.setHorizontalAlignment(Element.ALIGN_RIGHT);
				 * datatot.addCell(cell611); lstany_total = lstany_total
				 * +any_total; any_total = 0.0f;
				 */

				PdfPCell cellempty1 = new PdfPCell(new Phrase("", fbold));
				cellempty1.setFixedHeight(50);
				cellempty1.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cellempty1);

				PdfPCell cellempty2 = new PdfPCell(new Phrase("", fbold));
				cellempty2.setFixedHeight(50);
				cellempty2.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cellempty2);

				PdfPCell cell25 = new PdfPCell(new Phrase("" + totinc_total,
						fbold));
				cell25.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell25);
				lsttotinc_total = lsttotinc_total + totinc_total;
				totinc_total = 0.0f;

				PdfPCell cell28 = new PdfPCell(new Phrase("Net Pay", fbold));
				cell28.setFixedHeight(50);
				cell28.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell28);

				document.add(datatot);

				// total second row....
				datatot = new PdfPTable(18);
				datatot.setWidthPercentage(new float[] { 4, 15.5f, 5.3f, 5.3f,
						4.5f, 5.3f, 5.3f, 5.3f, 5.3f, 5.3f, 4.8f, 4.8f, 5.3f,
						5.3f, 5.3f, 4.8f, 4.8f, 4.8f }, rec);
				datatot.setHorizontalAlignment(Element.ALIGN_LEFT);

				PdfPCell cell0 = new PdfPCell(new Phrase("Total Deduction:--",
						fbold));
				cell0.setColspan(2);
				cell0.setFixedHeight(50);
				cell0.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell0);

				PdfPCell cell13 = new PdfPCell(new Phrase("" + pf_total, f1));
				cell13.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell13);
				lstpf_total = lstpf_total + pf_total;
				pf_total = 0.0f;

				PdfPCell cell17 = new PdfPCell(new Phrase("" + esic_total, f1));
				cell17.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell17);
				lstesic_total = lstesic_total + esic_total;
				esic_total = 0.0f;

				PdfPCell cell14 = new PdfPCell(new Phrase("" + pt_total, f1));
				cell14.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell14);
				lstpt_total = lstpt_total + pt_total;
				pt_total = 0.0f;

				PdfPCell cell20 = new PdfPCell(new Phrase("" + tds_total, f1));
				cell20.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell20);
				lsttds_total = lsttds_total + tds_total;
				tds_total = 0.0f;

				PdfPCell cell19 = new PdfPCell(new Phrase("" + adv_total, f1));
				cell19.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell19);
				lstadv_total = lstadv_total + adv_total;
				adv_total = 0.0f;

				PdfPCell cell16 = new PdfPCell(new Phrase("" + loan_total, f1));
				cell16.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell16);
				lstloan_total = lstloan_total + loan_total;
				loan_total = 0.0f;

				PdfPCell cell18 = new PdfPCell(new Phrase("" + mob_total, f1));
				cell18.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell18);
				lstmob_total = lstmob_total + mob_total;
				mob_total = 0.0f;

				PdfPCell cell22 = new PdfPCell(new Phrase("" + netc_total, f1));
				cell22.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell22);
				lstnetc_total = lstnetc_total + netc_total;
				netc_total = 0.0f;

				PdfPCell cell15 = new PdfPCell(new Phrase("" + lic_total, f1));
				cell15.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell15);
				lstlic_total = lstlic_total + lic_total;
				lic_total = 0.0f;

				PdfPCell cell21 = new PdfPCell(new Phrase("" + relif_total, f1));
				cell21.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell21);
				lstrelif_total = lstrelif_total + relif_total;
				relif_total = 0.0f;

				PdfPCell cell24 = new PdfPCell(new Phrase("" + mlwf_total, f1));
				cell24.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell24);
				lstmlwf_total = lstmlwf_total + mlwf_total;
				mlwf_total = 0.0f;

				PdfPCell cell131 = new PdfPCell(
						new Phrase("" + other_total, f1));
				cell131.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell131);
				lstother_total = lstother_total + other_total;
				other_total = 0.0f;

				/*
				 * for total deducton of MED & ERP NEW @.....
				 */
				PdfPCell cellmedded = new PdfPCell(new Phrase("" + med_total,
						f1));
				cellmedded.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cellmedded);
				istotmed_total = istotmed_total + med_total;
				med_total = 0.0f;

				PdfPCell cellerpded = new PdfPCell(new Phrase("" + ERP_total,
						f1));
				cellerpded.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cellerpded);
				istotERPDED_total = istotERPDED_total + ERP_total;
				ERP_total = 0.0f;

				/*
				 * PdfPCell cell1311 = new PdfPCell(new Phrase("",f1));
				 * cell1311.setHorizontalAlignment(Element.ALIGN_RIGHT);
				 * datatot.addCell(cell1311);
				 */

				PdfPCell cell26 = new PdfPCell(new Phrase("" + totded_total,
						fbold));
				cell26.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell26);
				lsttotded_total = lsttotded_total + totded_total;
				totded_total = 0.0f;

				PdfPCell cell27 = new PdfPCell(new Phrase("" + netpay_total,
						fbold));
				cell27.setHorizontalAlignment(Element.ALIGN_RIGHT);
				datatot.addCell(cell27);
				lstnetpay_total = lstnetpay_total + netpay_total;
				netpay_total = 0.0f;

				document.add(datatot);

				para = new Paragraph(new Phrase("No Of Employee :- "
						+ br_tot_no_emp, f));
				para.setAlignment(Element.ALIGN_LEFT);
				para.setSpacingAfter(20);
				document.add(para);

			}

			para = new Paragraph(new Phrase("Total No Of Employee :- "
					+ tot_no_emp, f));
			para.setAlignment(Element.ALIGN_LEFT);
			para.setSpacingAfter(40);
			document.add(para);

			System.out.println("Total No Of Employee :- " + tot_no_emp);

			para = new Paragraph(new Phrase("-:Summary :- ", new Font(
					Font.HELVETICA, 40, Font.BOLDITALIC)));
			para.setAlignment(Element.ALIGN_CENTER);
			para.setSpacingAfter(10);
			document.add(para);

			PdfPTable main = new PdfPTable(10);
			main.setSpacingBefore(10);
			main.setWidthPercentage(
					new float[] { 9, 9, 9, 9, 9, 9, 9, 9, 9, 9 }, rec);
			PdfPCell maincell;

			maincell = new PdfPCell(new Phrase(" Basic Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstbasic_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" H.R.A Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsthra_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Col Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstcol_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Medical Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(
					new Phrase(""
							+ trans((int) (lstmedical_total), "", "", false,
									false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Conv All Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(
					new Phrase(""
							+ trans((int) (lstconvall_total), "", "", false,
									false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" LTA Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstleave_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Education Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstedu_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Min Ins. Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstminins_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Spl All Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstsplall_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Earn 1 Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstaddlss_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Earn 2 Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(
					new Phrase(""
							+ trans((int) (lstspecial_total), "", "", false,
									false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Add Income Total:-", f));
			maincell.setFixedHeight(50);
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstaddinc_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			/*
			 * maincell = new PdfPCell(new Phrase(" ANONYMOUS Total:-",f));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase(""+trans((int)(lstany_total),
			 * "", "", false, false),f2)); maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 */
			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" P.F Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstpf_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" E.S.I.C Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstesic_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" P.T Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstpt_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" T.D.S Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsttds_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Advance Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstadv_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Loan Ded Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstloan_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Mobile Ded Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstmob_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Net Chrgs Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstnetc_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Current Advance Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstlic_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Relief Fund Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstrelif_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" MLWF Total:-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstmlwf_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("Other :-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstother_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			// for MED & ERP total summery
			maincell = new PdfPCell(new Phrase("MED DED :-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (istotmed_total), "", "", false, false), f2));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("ERP  :-", f));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (istotERPDED_total), "", "", false, false),
					f2));
			maincell.setBorderWidthLeft(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			// empty col
			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Tot income Total:-", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsttotinc_total), "", "", false, false),
					fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Tot Ded. Total:-", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lsttotded_total), "", "", false, false),
					fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase(" Net Pay Total:-", fbold));
			maincell.setBorderWidthRight(0);
			maincell.setFixedHeight(50);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			// NO USE >>>USED FOR ALL BRANCHES PAYREG @..
			/*
			 * float tttt = 0; ResultSet rsss; try { //
			 * System.out.println("date===="+date); Statement sttt =
			 * con.createStatement( ResultSet.TYPE_SCROLL_INSENSITIVE,
			 * ResultSet.CONCUR_READ_ONLY); rs = st.executeQuery(
			 * "select sum(net_amt) from paytran where trndt between '" +
			 * ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT) +
			 * "'  and trncd=999  union  " +
			 * "select sum(net_amt) from paytran_stage where trndt between '" +
			 * ReportDAO.BOM(PAYREGDT) + "' and '" + ReportDAO.EOM(PAYREGDT) +
			 * "'  and trncd=999 ");
			 * 
			 * while (rs.next()) { tttt += rs.getFloat(1); } } catch (Exception
			 * e) { e.printStackTrace(); }
			 */

			maincell = new PdfPCell(new Phrase(""
					+ trans((int) (lstnetpay_total), "", "", false, false),
					fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));

			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));

			maincell.setBorderWidthRight(0);
			maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			main.addCell(maincell);

			maincell = new PdfPCell(new Phrase("", fbold));
			maincell.setBorderWidthLeft(0);
			maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			main.addCell(maincell);

			/*
			 * maincell = new PdfPCell(new Phrase("",fbold));
			 * maincell.setBorderWidthRight(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_RIGHT);
			 * main.addCell(maincell);
			 * 
			 * maincell = new PdfPCell(new Phrase("",fbold));
			 * maincell.setBorderWidthLeft(0);
			 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
			 * main.addCell(maincell);
			 */

			document.add(main);

			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);
			document.add(Chunk.NEWLINE);

			para = new Paragraph(
					new Phrase(
							"Prepared By                         Checked By                        Approved By                 ",
							new Font(Font.TIMES_ROMAN, 35, Font.BOLD)));
			para.setAlignment(Element.ALIGN_RIGHT);
			para.setSpacingBefore(30);
			document.add(para);

			stmtInsert.close();
			stmtTrnct.close();
			st.close();
			con.close();
			document.close();

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	/*
	 * public static void sumloanReport(String empno, String emptype, String
	 * loantype, String imgpath, String filepath) { Properties prop = new
	 * Properties(); try { ClassLoader classLoader = Thread.currentThread()
	 * .getContextClassLoader(); InputStream stream = classLoader
	 * .getResourceAsStream("constant.properties"); prop.load(stream); } catch
	 * (Exception e) {
	 * System.out.println("Error in constant properties Manager " + e); }
	 * 
	 * // System.out.println("in new loanReport generate"+sdate +" "+ emptype);
	 * 
	 * RepoartBean repBean = new RepoartBean(); UtilityDAO dao = new
	 * UtilityDAO(); Connection con = null; String BomDt = ""; String EomDt =
	 * ""; String EmpNO = ""; ResultSet emp = null; String empsql = "";
	 * 
	 * int srno = 0; float Total_loanAmt = 0; float ALLTotal_loanAmt = 0; float
	 * Total_actualpay = 0; float ALLTotal_actualpay = 0; float Total_paid = 0;
	 * float remainingAmt = 0; float Total_remainingAmt = 0;
	 * 
	 * ResultSet prj1 = null; ResultSet prj2 = null; String total_paid ="";
	 * String Loan_Total =""; String Actual_Pay_Total ="";
	 * 
	 * try { ReportDAO.OpenCon("", "", "", repBean); con = repBean.getCn();
	 * Statement st = con.createStatement( ResultSet.TYPE_SCROLL_INSENSITIVE,
	 * ResultSet.CONCUR_READ_ONLY); Statement stmt1 = con.createStatement();
	 * Statement stmt2 = con.createStatement(); //
	 * System.out.println("in tdslist sheet");
	 * 
	 * Document doc = new Document(new Rectangle(2384, 3370)); PdfWriter writer
	 * = PdfWriter.getInstance(doc, new FileOutputStream( filepath)); Footer1
	 * ftr = dao.new Footer1(lable1); writer.setPageEvent(ftr); doc.open();
	 * 
	 * Font FONT = new Font(Font.HELVETICA, 190, Font.NORMAL, new
	 * GrayColor(0.85f));
	 * 
	 * ColumnText.showTextAligned(writer.getDirectContentUnder(),
	 * Element.ALIGN_CENTER, new Phrase(prop.getProperty("watermark"), FONT),
	 * 1300f, 1830f, 45); Image image1 = Image.getInstance(imgpath); Phrase
	 * title = new Phrase(prop.getProperty("companyName"), new
	 * Font(FONT.TIMES_ROMAN, 38, Font.BOLD)); Paragraph para = new
	 * Paragraph(title); para.setAlignment(Element.ALIGN_CENTER);
	 * para.setSpacingBefore(0); image1.scaleAbsolute(310f, 120f);
	 * image1.setAbsolutePosition(60f, 3200f); doc.add(image1); doc.add(para);
	 * 
	 * para = new Paragraph(new Phrase( prop.getProperty("addressForReport"),
	 * new Font( Font.TIMES_ROMAN, 28)));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(0);
	 * doc.add(para);
	 * 
	 * para = new Paragraph(new Phrase( prop.getProperty("contactForReport"),
	 * new Font( Font.TIMES_ROMAN, 28)));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(0);
	 * doc.add(para);
	 * 
	 * para = new Paragraph(new Phrase(prop.getProperty("mailForReport"), new
	 * Font(Font.TIMES_ROMAN, 28))); para.setAlignment(Element.ALIGN_CENTER);
	 * para.setSpacingAfter(0); doc.add(para);
	 * 
	 * Font f = new Font(Font.HELVETICA, 30); Font f1 = new Font(Font.HELVETICA,
	 * 25); Font f2 = new Font(Font.HELVETICA, 32);
	 * 
	 * 
	 * para = new Paragraph(new
	 * Phrase("Loan Details Sheet for the Month Of :- "+sdate+"  ",new
	 * Font(Font.TIMES_ROMAN,25,Font.BOLD)));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(10);
	 * doc.add(para);
	 * 
	 * Rectangle rec = new Rectangle(100, 100);
	 * 
	 * if (emptype.equalsIgnoreCase("All")) {
	 * 
	 * if (loantype.equalsIgnoreCase("All")) {
	 * 
	 * empsql = " SELECT l.empno,E.EMPCODE, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname) name, "
	 * +"Min(l.start_date)AS start_date,Max(l.end_date)  AS end_date, "
	 * +"Sum(l.loan_amt)  loanamt,Sum(l.actual_pay)actualpay,l.active "
	 * +"FROM   loan_detail l,empmast e WHERE  l.empno = e.empno "
	 * +"GROUP  BY l.active,l.empno, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname), "
	 * +"e.empcode ORDER  BY convert(int,e.EMPCODE) ,l.active   ";
	 * System.out.println("0"); }
	 * 
	 * else { empsql = "SELECT l.empno,E.EMPCODE, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname) name, "
	 * +"Min(l.start_date)AS start_date,Max(l.end_date)  AS end_date, "
	 * +"Sum(l.loan_amt)  loanamt,Sum(l.actual_pay)actualpay,l.active "
	 * +"FROM   loan_detail l,empmast e WHERE  l.empno = e.empno and l.active='"
	 * +loantype+"' " +"GROUP  BY l.active,l.empno, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname), "
	 * +"e.empcode ORDER  BY convert(int,e.EMPCODE) ,l.active   ";
	 * System.out.println("1"); } } else { String employee[] = empno.split(":");
	 * empno = employee[2];
	 * 
	 * if (loantype.equalsIgnoreCase("All")) {
	 * 
	 * empsql = "SELECT l.empno,E.EMPCODE, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname) name, "
	 * +"Min(l.start_date)AS start_date,Max(l.end_date)  AS end_date, "
	 * +"Sum(l.loan_amt)  loanamt,Sum(l.actual_pay)actualpay,l.active "
	 * +"FROM   loan_detail l,empmast e WHERE  l.empno = e.empno   and l.empno= "
	 * + empno + "" +"GROUP  BY l.active,l.empno, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname), "
	 * +"e.empcode ORDER  BY convert(int,e.EMPCODE) ,l.active      ";
	 * System.out.println("2"); }
	 * 
	 * else { empsql = "SELECT l.empno,E.EMPCODE, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname) name, "
	 * +"Min(l.start_date)AS start_date,Max(l.end_date)  AS end_date, "
	 * +"Sum(l.loan_amt)  loanamt,Sum(l.actual_pay)actualpay,l.active "
	 * +"FROM   loan_detail l,empmast e WHERE  l.empno = e.empno and l.active='"
	 * +loantype+"' and l.empno= " + empno + "" +"GROUP  BY l.active,l.empno, "
	 * +"CONVERT(NVARCHAR(100), E.lname + ' ' + E.fname + ' ' + E.mname), "
	 * +"e.empcode ORDER  BY convert(int,e.EMPCODE) ,l.active   ";
	 * System.out.println("3"); } }
	 * 
	 * System.out.println(empsql);
	 * 
	 * ResultSet rs = st.executeQuery(empsql);
	 * 
	 * String nameQuery = "";
	 * 
	 * PdfPTable datatab; PdfPTable datatot; PdfPTable datatot1= new
	 * PdfPTable(10);
	 * 
	 * PdfPTable main = new PdfPTable(10); main.setSpacingBefore(10);
	 * main.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7, 8, 8 , 8f },
	 * rec);
	 * 
	 * PdfPCell maincell;
	 * 
	 * maincell = new PdfPCell(new Phrase("SRNO", f));
	 * maincell.setFixedHeight(50);
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Employee Code", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("EMPLOYEE NAME", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Start Date", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase(" End Date", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * 
	 * maincell = new PdfPCell(new Phrase("Total Loan Amount", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Total Actual pay", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Total Amount paid", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Total Remaing Amount", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Status", f));
	 * maincell.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * main.addCell(maincell);
	 * 
	 * doc.add(main);
	 * 
	 * String previousEmpCode=""; String currentEmpCode="";
	 * 
	 * datatab = new PdfPTable(10); //datatab.setSpacingBefore(10);
	 * datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7, 8, 8, 8f
	 * }, rec); datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * if(emptype.equalsIgnoreCase("All") && (loantype.equalsIgnoreCase("All")))
	 * {
	 * 
	 * while (rs.next()) { EmpNO = rs.getString("empno");
	 * currentEmpCode=rs.getString("EMPCODE"); if(rs.getRow()!=1 &&
	 * !previousEmpCode.equalsIgnoreCase(currentEmpCode)){
	 * 
	 * // PdfPCell cell1111 = new PdfPCell(new Phrase("Total:-- "+ Total_loanAmt
	 * + ",  Actual P:--"+Total_actualpay + "  T Paid:--"+total_paid, f1));
	 * 
	 * PdfPCell cell1111 = new PdfPCell(new Phrase("  Total Loan Amount:-- "+
	 * Total_loanAmt ,f)); cell1111.setColspan(4); cell1111.setFixedHeight(70);
	 * cell1111.setPaddingTop(3);
	 * cell1111.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * datatab.addCell(cell1111);
	 * 
	 * PdfPCell cell1112 = new PdfPCell(new
	 * Phrase("   Actual Pay Total:-- "+Total_actualpay,f));
	 * cell1112.setColspan(3); cell1112.setPaddingTop(3);
	 * cell1112.setFixedHeight(70);
	 * cell1112.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * datatab.addCell(cell1112);
	 * 
	 * PdfPCell cell1113 = new PdfPCell(new
	 * Phrase("    Total Paid:-- "+total_paid, f)); cell1113.setColspan(3);
	 * cell1113.setFixedHeight(70); cell1113.setPaddingTop(3);
	 * cell1113.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * datatab.addCell(cell1113);
	 * 
	 * Total_loanAmt =0; Total_actualpay=0; } System.out.println("hi"); srno++;
	 * PdfPCell cell1 = new PdfPCell(new Phrase("" + srno, f1));
	 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * cell1.setPaddingTop(3); cell1.setFixedHeight(50); datatab.addCell(cell1);
	 * 
	 * PdfPCell cell2 = new PdfPCell(new Phrase("" + rs.getString("EMPCODE"),
	 * f1)); cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell2);
	 * 
	 * PdfPCell cell3 = new PdfPCell(new Phrase("" + rs.getString("name"), f1));
	 * cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell3);
	 * 
	 * PdfPCell cell4 = new PdfPCell(new Phrase("" + rs.getString("start_date"),
	 * f1)); cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell4); String string = rs.getString("end_date") == null
	 * ? " " : rs.getString("end_date"); PdfPCell cell5 = new PdfPCell(new
	 * Phrase("" + string, f1));
	 * cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell5);
	 * 
	 * 
	 * Total_loanAmt = Total_loanAmt + rs.getFloat("loanamt"); ALLTotal_loanAmt
	 * = ALLTotal_loanAmt+rs.getFloat("loanamt");
	 * 
	 * PdfPCell cell8 = new PdfPCell(new Phrase("" + rs.getFloat("loanamt"),
	 * f1)); cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell8);
	 * 
	 * Total_actualpay = Total_actualpay + rs.getFloat("actualpay");
	 * ALLTotal_actualpay = ALLTotal_actualpay + rs.getFloat("actualpay");
	 * 
	 * PdfPCell cell9 = new PdfPCell(new Phrase("" + rs.getFloat("actualpay"),
	 * f1)); cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell9);
	 * 
	 * 
	 * String prjquery1 =
	 * " select isnull(SUM(net_amt),0) AS total from PAYTRAN_STAGE "+
	 * "where EMPNO="+rs.getString("empno")+" and TRNCD in(226,227,228) and "+
	 * "TRNDT between '"
	 * +rs.getString("start_date")+"' and '"+rs.getString("end_date")+"' ";
	 * 
	 * System.out.println(prjquery1);
	 * 
	 * prj1 = stmt1.executeQuery(prjquery1);
	 * 
	 * 
	 * 
	 * if(prj1.next()){ total_paid = prj1.getString("total");
	 * System.out.println("Result SEt...11  " +total_paid);
	 * 
	 * }
	 * 
	 * Total_paid = Total_paid + prj1.getFloat("total"); PdfPCell cell10 = new
	 * PdfPCell(new Phrase("" + prj1.getFloat("total"), f1));
	 * cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell10);
	 * 
	 * remainingAmt = rs.getFloat("actualpay") - prj1.getFloat("total");
	 * Total_remainingAmt = Total_remainingAmt + remainingAmt; PdfPCell cell11 =
	 * new PdfPCell(new Phrase("" +remainingAmt, f1));
	 * cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell11);
	 * 
	 * PdfPCell cell12 = new PdfPCell(new Phrase("" + rs.getString("active"),
	 * f1)); cell12.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell12);
	 * 
	 * 
	 * previousEmpCode = currentEmpCode; } doc.add(datatab);
	 * 
	 * if (!rs.next()) {
	 * 
	 * System.out.println("No more resul;t"); datatab = new PdfPTable(10);
	 * 
	 * datatab.setWidthPercentage(new float[] { 4, 6, 20, 6, 6, 8, 7, 8, 8, 8f
	 * }, rec); datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * PdfPCell cell1 = new PdfPCell(new Phrase( "No More record to display",
	 * f1)); cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * cell1.setFixedHeight(50); datatab.addCell(cell1);
	 * 
	 * doc.add(datatab);
	 * 
	 * System.out.println("No more resul;t  @@@@@@"); }
	 * 
	 * // rs.close(); System.out.println("hey"); // Total of columns start here
	 * 
	 * datatot = new PdfPTable(10); datatot.setWidthPercentage(new float[] { 4,
	 * 6, 20, 6, 6, 8, 7, 8, 8, 8f }, rec);
	 * datatot.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * 
	 * PdfPCell cell22 = new PdfPCell(new Phrase("  Total Loan Amount:  " +
	 * Total_loanAmt, f)); cell22.setColspan(4); cell22.setFixedHeight(70);
	 * cell22.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * datatot.addCell(cell22);
	 * 
	 * PdfPCell cell33 = new PdfPCell(new Phrase("  Actual Pay:  " +
	 * Total_actualpay, f)); cell33.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * cell33.setColspan(3); cell33.setFixedHeight(70); datatot.addCell(cell33);
	 * 
	 * PdfPCell cell44 = new PdfPCell(new Phrase("  Total Paid:   "+total_paid,
	 * f)); cell44.setColspan(3); cell44.setFixedHeight(70);
	 * cell44.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * datatot.addCell(cell44);
	 * 
	 * PdfPCell cell55 = new PdfPCell(new Phrase("" + Total_remainingAmt, f1));
	 * cell55.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell55);
	 * 
	 * PdfPCell cell66 = new PdfPCell(new Phrase("", f1));
	 * cell66.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell66);
	 * 
	 * doc.add(datatot);
	 * 
	 * para = new Paragraph( new Phrase("Number Of Employees :- " + srno, f));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(50);
	 * doc.add(para);
	 * 
	 * 
	 * String prjquery2 =
	 * "select SUM(loan_amt)AS loan_total,SUM(Actual_pay)AS Actual_pay  from loan_detail where Active='sanction' "
	 * ;
	 * 
	 * System.out.println(prjquery2);
	 * 
	 * prj2 = stmt2.executeQuery(prjquery2);
	 * 
	 * 
	 * 
	 * while(prj2.next()){ Loan_Total = prj2.getString("loan_total");
	 * Actual_Pay_Total = prj2.getString("Actual_pay");
	 * System.out.println("Total Loan AmT  " +Loan_Total);
	 * System.out.println("Actual Pay Total  " +Actual_Pay_Total); }
	 * 
	 * 
	 * para = new Paragraph(new Phrase("-:Summary :- ",new
	 * Font(Font.HELVETICA,40,Font.BOLDITALIC)));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(10);
	 * doc.add(para);
	 * 
	 * main = new PdfPTable(4); main.setSpacingBefore(10);
	 * main.setWidthPercentage(new float[]{10,10,10,10}, rec);
	 * 
	 * 
	 * maincell = new PdfPCell(new Phrase("Loan Amount Total:-",f));
	 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase(""+ALLTotal_loanAmt,f));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("",f2));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("",f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("",f));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("",f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Actual Pay Total:-",f));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase(""+ALLTotal_actualpay,f));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * doc.add(main);
	 * 
	 * st.close(); con.close(); doc.close(); } else {
	 * 
	 * 
	 * while (rs.next()) {
	 * 
	 * String prjquery1 =
	 * " select isnull(SUM(net_amt),0) AS total from PAYTRAN_STAGE "+
	 * "where EMPNO="+rs.getString("empno")+" and TRNCD in(226,227,228) and "+
	 * "TRNDT between '"
	 * +rs.getString("start_date")+"' and '"+rs.getString("end_date")+"' ";
	 * 
	 * System.out.println(prjquery1);
	 * 
	 * prj1 = stmt1.executeQuery(prjquery1); prj1.next();
	 * System.out.println("hi"); datatab = new PdfPTable(10);
	 * 
	 * datatab.setWidthPercentage(new float[]{4,6,20,6,6,8,7,8,8,8f}, rec);
	 * datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * srno++;
	 * 
	 * PdfPCell cell1 = new PdfPCell(new Phrase(""+srno,f1));
	 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * cell1.setFixedHeight(50); datatab.addCell(cell1);
	 * 
	 * PdfPCell cell2 = new PdfPCell(new Phrase(""+
	 * rs.getString("EMPCODE"),f1));
	 * cell2.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell2);
	 * 
	 * PdfPCell cell3 = new PdfPCell(new Phrase(""+rs.getString("name"),f1));
	 * cell3.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell3);
	 * 
	 * PdfPCell cell4 = new PdfPCell(new
	 * Phrase(""+rs.getString("start_date"),f1));
	 * cell4.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell4); String
	 * string=rs.getString("end_date")==null?" ":rs.getString("end_date");
	 * PdfPCell cell5 = new PdfPCell(new Phrase(""+string,f1));
	 * cell5.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell5);
	 * 
	 * 
	 * 
	 * Total_loanAmt = Total_loanAmt + rs.getFloat("loanamt") ;
	 * 
	 * 
	 * PdfPCell cell8 = new PdfPCell(new Phrase(""+rs.getFloat("loanamt"),f1));
	 * cell8.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell8);
	 * 
	 * Total_actualpay = Total_actualpay + rs.getFloat("actualpay");
	 * 
	 * 
	 * PdfPCell cell9 = new PdfPCell(new
	 * Phrase(""+rs.getFloat("actualpay"),f1));
	 * cell9.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell9);
	 * 
	 * Total_paid = Total_paid + prj1.getFloat("total"); PdfPCell cell10 = new
	 * PdfPCell(new Phrase(""+prj1.getFloat("total"),f1));
	 * cell10.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell10);
	 * 
	 * 
	 * remainingAmt = rs.getFloat("actualpay")- prj1.getFloat("total");
	 * Total_remainingAmt = Total_remainingAmt + remainingAmt; PdfPCell cell11 =
	 * new PdfPCell(new Phrase(""+remainingAmt,f1));
	 * cell11.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell11);
	 * 
	 * PdfPCell cell12 = new PdfPCell(new Phrase(""+rs.getString("active"),f1));
	 * cell12.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatab.addCell(cell12);
	 * 
	 * 
	 * doc.add(datatab); }
	 * 
	 * if(!rs.next()){
	 * 
	 * System.out.println("No more resul;t"); datatab = new PdfPTable(10);
	 * 
	 * datatab.setWidthPercentage(new float[]{4,6,20,6,6,8,7,8,8,8f}, rec);
	 * datatab.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * PdfPCell cell1 = new PdfPCell(new
	 * Phrase("No More record to display",f1));
	 * cell1.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * cell1.setFixedHeight(50); datatab.addCell(cell1);
	 * 
	 * doc.add(datatab);
	 * 
	 * System.out.println("No more resul;t  @@@@@@"); }
	 * 
	 * // rs.close(); System.out.println("hey"); // Total of columns start here
	 * 
	 * datatot = new PdfPTable(10); datatot.setWidthPercentage(new
	 * float[]{4,6,20,6,6,8,7,8,8,8f}, rec);
	 * datatot.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * 
	 * PdfPCell cell111 = new PdfPCell(new Phrase("Total:--",f1));
	 * cell111.setColspan(7); cell111.setFixedHeight(50);
	 * cell111.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell111);
	 * 
	 * PdfPCell cell22 = new PdfPCell(new Phrase(""+Total_loanAmt,f1));
	 * cell22.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell22);
	 * 
	 * PdfPCell cell33 = new PdfPCell(new Phrase(""+Total_actualpay,f1));
	 * cell33.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell33);
	 * 
	 * 
	 * PdfPCell cell44 = new PdfPCell(new Phrase(""+Total_paid,f1));
	 * cell44.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell44);
	 * 
	 * PdfPCell cell55 = new PdfPCell(new Phrase(""+Total_remainingAmt,f1));
	 * cell55.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell55);
	 * 
	 * PdfPCell cell66 = new PdfPCell(new Phrase("",f1));
	 * cell66.setHorizontalAlignment(Element.ALIGN_CENTER);
	 * datatot.addCell(cell66);
	 * 
	 * 
	 * doc.add(datatot);
	 * 
	 * para = new Paragraph(new Phrase("Number Of Employees :- "+ srno,f));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(50);
	 * doc.add(para);
	 * 
	 * 
	 * String prjquery2 =
	 * "select SUM(loan_amt)AS loan_total,SUM(Actual_pay)AS Actual_pay  from loan_detail where Active='sanction' "
	 * ;
	 * 
	 * System.out.println(prjquery2);
	 * 
	 * prj2 = stmt2.executeQuery(prjquery2);
	 * 
	 * 
	 * 
	 * while(prj2.next()){ Loan_Total = prj2.getString("loan_total");
	 * Actual_Pay_Total = prj2.getString("Actual_pay");
	 * System.out.println("Total Loan AmT  " +Loan_Total);
	 * System.out.println("Actual Pay Total  " +Actual_Pay_Total); }
	 * 
	 * 
	 * 
	 * para = new Paragraph(new Phrase("-:Summary :- ", new Font(
	 * Font.HELVETICA, 40, Font.BOLDITALIC)));
	 * para.setAlignment(Element.ALIGN_CENTER); para.setSpacingAfter(10);
	 * doc.add(para);
	 * 
	 * main = new PdfPTable(4); main.setSpacingBefore(10);
	 * main.setWidthPercentage(new float[] { 10, 10, 10, 10 }, rec);
	 * 
	 * maincell = new PdfPCell(new Phrase("Loan Amount Total:-", f));
	 * maincell.setBorderWidthRight(0); maincell.setFixedHeight(50);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("" + Total_loanAmt, f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Actual Pay Total:-", f));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("" + Total_actualpay, f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Total Paid Total:-", f));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("" + Total_paid, f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("Actual Pay Total:-", f));
	 * maincell.setBorderWidthRight(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * maincell = new PdfPCell(new Phrase("" + Total_actualpay, f2));
	 * maincell.setBorderWidthLeft(0);
	 * maincell.setHorizontalAlignment(Element.ALIGN_LEFT);
	 * main.addCell(maincell);
	 * 
	 * 
	 * doc.add(main);
	 * 
	 * st.close(); con.close(); doc.close(); }
	 * 
	 * 
	 * }
	 * 
	 * catch (Exception e) { e.printStackTrace(); }
	 * 
	 * }
	 */

}
